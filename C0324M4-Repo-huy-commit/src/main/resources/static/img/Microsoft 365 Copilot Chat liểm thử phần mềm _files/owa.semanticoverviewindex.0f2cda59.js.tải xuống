(globalThis.webpackChunkOwa=globalThis.webpackChunkOwa||[]).push([[1486,3193,14050,31791,32227,32501,36526,43761,44951,45228,46235,47106,48527,56911,68630,75432,90414,91425],{121562:(e,t,r)=>{"use strict";let n,o,i,a;var s=r(717208),l=r(654470),c=r(324233);class u extends c.q{constructor(e,t,r){super(e,t);let n=this;this.importAndExecute=function(...e){return r?.captureBundleTime&&Date.now(),n.import("LazyAction").then(t=>t.apply(null,e))}}}var d=r(412506);r(788074),r(940962),r(491306);var f=r(412145),h=r(574221),p=r(654018),m=r(320498),g=r(266143),v=r(988622),b=r(819988),y=r(764859),w=r(603722),S=r(544569);let C=({children:e,callback:t})=>((0,w.useLayoutEffect)(()=>{t?.()},[t]),w.createElement(w.Fragment,null,e)),I=(e,t,r,n)=>{let o=t?.ownerDocument??window.document;if(!n)return(0,y.render)(w.createElement(w.StrictMode,null,w.createElement(S.A,{targetDocument:o},e)),t,r),()=>{(0,y.unmountComponentAtNode)(t)};{let n=(0,b.H)(t);return n.render(w.createElement(C,{callback:r},w.createElement(w.StrictMode,null,w.createElement(S.A,{targetDocument:o},e)))),()=>{n.unmount()}}};var k=r(237602),E=(e=>(e[e.Full=0]="Full",e[e.Simple=1]="Simple",e[e.None=2]="None",e))(E||{});class _ extends w.Component{constructor(e){super(e),this.state={}}componentDidCatch(e,t){this.props.onError?.(e,t),this.setState({error:e})}render(){let{error:e}=this.state,{children:t,type:r,windowIcons:n}=this.props;if(!e)return t;{if(2==r)return null;if(1==r||!this.props.fullErrorComponent)return w.createElement("div",null,e.toString());let t=this.props.fullErrorComponent;return w.createElement(t,{error:e,windowIcons:n,...this.props.fullErrorComponentProps})}}}let A=(0,k.P)(_);var T=r(643108),P=r(223093),O=r(634091),R=r(873209),x=r(366482),M=r(773509),N=r(758416);r(766914),r(446623),r(923161),r(295806);var F=r(859645),L=r(771262);let z=new u(new l.Ay(()=>Promise.all([r.e(66815),r.e(89167)]).then(r.bind(r,411548))),e=>e.getBootLogger),D={"bizchat-metaOS-app.set-performance-mark-imported":[],"bizchat-metaOS-app.IndexJSStart":["bizchat-metaOS-app.set-performance-mark-imported"],"bizchat-metaOS-app.IndexJSFetchHubInfoStart":["bizchat-metaOS-app.IndexJSStart"],"bizchat-metaOS-app.IndexJSGetAccountInfoAndEcsEnd":["bizchat-metaOS-app.IndexJSStart"],"bizchat-metaOS-app.IndexJSGetAccountInfoAndEcsEndError":["bizchat-metaOS-app.IndexJSStart"],"bizchat-metaOS-app.IndexJSFetchAccountInfoEnd":["bizchat-metaOS-app.IndexJSStart"],"bizchat-metaOS-app.IndexJSFetchEcsEnd":["bizchat-metaOS-app.IndexJSFetchAccountInfoEnd"],"bizchat-metaOS-app.BootstrapStart":["bizchat-metaOS-app.IndexJSGetAccountInfoAndEcsEndError","bizchat-metaOS-app.IndexJSGetAccountInfoAndEcsEnd","bizchat-metaOS-app.IndexJSStart"],"bizchat-metaOS-app.StartupDataEnd":["bizchat-metaOS-app.BootstrapStart"],"bizchat-metaOS-app.BootstrapEnd":["bizchat-metaOS-app.StartupDataEnd"],"bizchat-metaOS-app.IndexJSCreateRuntimeFactory":["bizchat-metaOS-app.IndexJSFetchHubInfoStart"],"bizchat-metaOS-app.StartRenderImmersiveBizChatView":["bizchat-metaOS-app.StartupDataEnd"],"bizchat-metaOS-app.ReactAppStart":["bizchat-metaOS-app.StartRenderImmersiveBizChatView"],"bizchat-metaOS-app.FetchChatLoaderStart":["bizchat-metaOS-app.ReactAppStart"],"bizchat-metaOS-app.InputboxRenderLoading":["bizchat-metaOS-app.StartupDataEnd"],"bizchat-metaOS-app.InputboxRenderEnd":["bizchat-metaOS-app.InputboxRenderLoading"],"bizchat-metaOS-app.Initialize":[],"bizchat-metaOS-app.InitializeStart":[],"bizchat-metaOS-app.InitializeEnd":["bizchat-metaOS-app.InitializeStart"],"bizchat-metaOS-app.GetContextStart":["bizchat-metaOS-app.InitializeEnd"],"bizchat-metaOS-app.GetContextEnd":["bizchat-metaOS-app.GetContextStart"],"bizchat-metaOS-app.NotifySuccess":["bizchat-metaOS-app.Initialize"],"bizchat-metaOS-app.FetchEligibilityStart":[],"bizchat-metaOS-app.FetchEligibilityEnd":["bizchat-metaOS-app.FetchEligibilityStart"],"bizchat-metaOS-app.createM365ChatRuntimeFactoryStart":[],"bizchat-metaOS-app.createM365ChatRuntimeFactoryEnd":["bizchat-metaOS-app.createM365ChatRuntimeFactoryStart"]};function B(e){try{r.g?.performance&&r.g.performance.mark(e)}catch{}}function U(e,t){try{if((0,g.J2)(window,t,String(new Date().getTime())),r.g?.performance){r.g.performance.mark(e);let t="";if(D[e]){let n=r.g.performance.getEntriesByType("measure").filter(t=>t?.name&&D[e].indexOf(t.name)>=0);if(n.length>0){let r=!1;for(let o=0;o<D[e].length;o++){let i=D[e][o];for(let e=0;e<n.length;e++){let o=n[e];if(i.toLowerCase()===o.name.toLowerCase()){t=o.name,r=!0;break}}if(r)break}}}t?r.g.performance.measure(e,t,e):r.g.performance.measure(e,{},e)}}catch{}}var H=r(254812);let q=!1,j=!1,$="",W="",V="",G="",K="",X="BizChatBootstrapperLoggingKey";async function Y(){try{if(!q){let e=await z.importAndExecute();e.initLogger($,W,o,V,G,K),n=e,q=!0}}catch{q=!1}}let Z="",Q="",J="";function ee(e,t=!0){try{let r=" ||| Info: "+e+" - time: "+new Date().getTime();if(Z+=r,!j&&t&&en(r),!q){Q+=" ||| "+e+" - time: "+new Date().getTime();return}""!==Q&&(n.logBootstrapInfo(Q),Q=""),""!==J&&(n.logBootstrapError(J),J=""),n.logBootstrapInfo(e)}catch{}}function et(e){try{let t=" ||| Error: "+e+" - time: "+new Date().getTime();if(Z+=t,j||en(t),!q){J+=" ||| "+e+" - time: "+new Date().getTime();return}""!==Q&&(n.logBootstrapInfo(Q),Q=""),""!==J&&(n.logBootstrapError(J),J=""),n.logBootstrapError(e)}catch{}}function er(e){let t="";try{t=(0,g.Hd)(window,X)??"",e&&function(){try{j=!0,(0,g.X)(window,X)}catch{}}()}catch{}return`[isDevMode:${(0,x.n)()}]`+Z+"PreviousSessionInfo: "+t}function en(e){try{let t=(0,g.Hd)(window,X)??"";if(t.length>1e5)return;t+=e,(0,g.J2)(window,X,t)}catch{}}function eo(e=!0,t=!0){try{ee(function(e=!0){try{let t="",r=performance.getEntries(),n=r.filter(e=>e?.entryType==="navigation"&&(e?.name??"").indexOf("semanticoverview")>=0);if(n.length>=1){let e=n[0];t+=`||indexHTML-startTime:${e?.startTime},workerStart:${e?.workerStart},fetchStart:${e?.fetchStart},requestStart:${e?.requestStart},responseStart:${e?.responseStart},responseEnd:${e?.responseEnd}||`}let o=r.filter(e=>e?.entryType==="resource");return(e?["owa.immersebizchat.runtime.","owa.semanticoverviewindex."]:["owa.immersebizchat.runtime.","owa.semanticoverviewindex.","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-strings.","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-prod.","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-prod-m365chatlogger_","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-prod-m365chat_","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-dev.","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-dev-m365chatlogger_","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-dev-m365chat_"]).forEach(e=>{let r=o.filter(t=>(t?.name??"").indexOf(e)>=0)[0];t+="||"+e+"-"+`startTime:${r?.startTime},`+`workerStart:${r?.workerStart},`+`fetchStart:${r?.fetchStart},`+`requestStart:${r?.requestStart},`+`responseStart:${r?.responseStart},`+`responseEnd:${r?.responseEnd}||`+`responseStatus:${r?.responseStatus}||`}),t}catch(e){throw e}}(e),t)}catch{}}function ei(){if("1"===(0,p.j)("bO")){try{Y().then(()=>{et("[App failed to start] notifyFailure()")})}catch{}setTimeout(()=>{H.notifyFailure({reason:H.FailedReason.Other,message:er()})},3e3)}else{try{Y().then(()=>{et("[App reload] try to reload with bO=1 to bypass sw")})}catch{}(0,F.fF)(),setTimeout(()=>{let e=new URLSearchParams(window.location.search);e.set("bO","1"),window.location.search=e.toString()},3e3)}}let ea=0,es=(0,f.r9)({maximumAttempts:5,timeBetweenRetryInMS:()=>100,errorLogFunc:e=>et(`fetchEcsFlights error - attempt ${e} timeout limit reached at ${el} secs`)}),el=2e3,ec={},eu=async(e,t,r,n,o,i,a=!0,s,l,c)=>await es(async()=>await em(eh(e),t,r,n,o,i,a,l,c,s)).retriableFunc(),ed=async(e,t,r,n,o,i,a=!0,s,l)=>await es(async()=>await (0,f.MK)(em(eh(e),t,r,n,o,i,a,l,void 0,s),el)).retriableFunc().then(e=>e).catch(e=>{throw et(`fetchEcsFlights error - total timeout limit reached at ${5*el}s`),e}),ef=(e,t)=>("Dogfood"===e||"SDFV2"===e)&&"monarchhub"===t?ed:eu,eh=e=>"SDFV2"===e||"Dogfood"===e?"SDFV2":"MSIT"===e?"MSIT":"WW";function ep(){try{var e=(0,T.x)("bootFlights");if(!e)return ee("getEcsFlightsFromHeader - bootFlights is null"),null;let t=function(e){let t="bizchat(",r=e.indexOf(t);if(-1===r)return ee("extractBizchatFlights - no bizchat in bootFlights"),null;let n=r+t.length-1,o=e.indexOf(")",n);return -1===o||n>=o?(ee("extractBizchatFlights - no end bracket in bootFlights"),null):e.substring(n+1,o)}(e);if(!t||0===t.length)return ee("getEcsFlightsFromHeader - no bizchat in bootFlights"),null;let r=t.split(";");if(!r||2!==r.length)return ee("getEcsFlightsFromHeader - bizchatFlights cannot be split by semicolon"),null;let n=r[0]?.split(",");if(!n||0===n.length)return ee("getEcsFlightsFromHeader - no flights in bootFlights"),null;if(!r[1]||0===r[1].length)return ee("getEcsFlightsFromHeader - no configIds in bootFlights"),null;let o={};for(let e=0;e<n.length;e++)o[n[e]]=!0;let a={flights:o,configIds:r[1],isFromCache:!1};return i=a,a}catch(e){return et("getEcsFlightsFromHeader error"),i=null,null}}let em=async(e,t,r,n,o,i,a=!0,s,l,c)=>{let u=ea%2==0?"https://ecs.office.com/config/v1/":"https://config.edge.skype.com/config/v1/";ea++;let d=u+`/M365ChatClient/1.0.0.0?agents=M365ChatClient&DeploymentRing=${e}&Region=${s}&UserID=${t}&TenantId=${r}&HostName=${n}&ScriptVersion=${o}&Locale=${i}&AccountType=${c}&Environment=${l}`,f=new Headers;f.append("Origin",window.location.origin);let h=await eg(d,f);if(!h.ok)throw et(`fetchEcsFlightsInternal fail: HTTP Error! status: ${h.status}`),Error(`HTTP Error! status: ${h.status}`);ee("fetchEcsFlightsInternal success: response.ok is true");let p=await h.json();return ee("fetchEcsFlightsInternal parse response succeeds"),a&&U("bizchat-metaOS-app.IndexJSFetchEcsEnd","ImmersiveBizChat-IndexJSFetchEcsEnd"),p},eg=async(e,t,r=1)=>{try{let n=await (0,s.h)(e,{method:"GET",headers:t});if(!n.ok&&r<3)return ee("fetchEcsFlightsInternal - response.ok is false - retry:"+r),eg(e,t,r+1);return ee("fetchEcsFlightsInternal - success"),n}catch(n){if(r<3)return ee("fetchEcsFlightsInternal retry:"+r),eg(e,t,r+1);throw et("fetchEcsFlightsInternal retry - Max retries exceeded"),Error("Max retries exceeded: "+n)}};async function ev(e,t,r,n,o,i,a,s,l){let c=ep();if(c&&c.flights&&(0,h._2)(c.flights,"immersive-bizchat-perf-server-ecs-flights")&&!(0,h._2)(c.flights,"immersive-bizchat-e2e-test")&&"undefined"!==(0,p.j)("hostName"))return ee("getEcsFlightsFromHeader"),U("bizchat-metaOS-app.IndexJSFetchEcsEnd","ImmersiveBizChat-IndexJSFetchEcsEnd"),c;let u=await ef(e,n)(e,t,r,n,o,i,!0,l,a,s);return{flights:u?.M365ChatClient,configIds:u?.ConfigIDs?.M365ChatClient??"",isFromCache:!1}}function eb(e){try{return void 0===i&&"undefined"!==(0,p.j)("hostName")&&ep(),!!i?.flights?.[e]}catch{return!1}}var ey=r(467439),ew=r(858881);let eS=new Set(["en-us","en-gb","es-es","es-mx","fr-fr","fr-ca","de-de","it-it","pt-br","zh-cn","ja-jp","ar-sa","nl-nl","sv-se","da-dk","he-il","hu-hu","ru-ru","th-th","zh-tw","fi-fi","nb-no","pt-pt","cs-cz","pl-pl","tr-tr","uk-ua","ko-kr","ca-es","nl-nl","ro-ro","sk-sk","vi-vn","bg-bg","hr-hr","sr-latn-rs","sl-sl","et-ee","lv-lv","lt-lt","el-gr","id-id"]),eC={en:"en-US",us:"en-US",es:"es-ES",fr:"fr-FR",de:"de-DE",it:"it-IT",pt:"pt-BR",zh:"zh-CN",ja:"ja-JP",ar:"ar-sa",nl:"nl-nl",sv:"sv-se",da:"da-dk",he:"he-il",hu:"hu-hu",ru:"ru-ru",th:"th-th",fi:"fi-fi",nb:"nb-no",cs:"cs-cz",pl:"pl-pl",tr:"tr-tr",uk:"uk-ua",ko:"ko-kr","ca-es-valencia":"ca-es","ne-bl":"nl-nl","de-ch":"de-de",ca:"ca-es",el:"el-gr",gb:"en-gb",mx:"es-mx",ch:"fr-ch",at:"de-at",tl:"pt-tl",dk:"da-dk",esp:"eo",rs:"sr-rs",in:"en-in",cz:"cs-cz",jp:"ja-jp",ge:"ka-ge",ht:"fr-ht",na:"en-na",tw:"zh-hant-tw",bh:"ar-bh",ie:"en-ie",vn:"vi-vn",za:"en-za",usa:"en-us",cc:"en-cc",au:"en-au",sm:"it-sm",cfr:"fr-cf","ro-md":"ro-ro",sk:"sk-sk",vi:"vi-vn",bg:"bg-bg",hr:"hr-hr",sr:"sr-latn-rs","sr-cyrl":"sr-cyrl-rs",sl:"sl-sl",et:"et-ee",lv:"lv-lv",lt:"lt-lt",id:"id-id",ro:"ro-ro",cy:"cy-gb"},eI="9188040d-6c67-4c5b-b112-36a304b66dad",ek="84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa",eE=/OID:([a-f0-9-]+)@([a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12})/,e_=(0,f.r9)({maximumAttempts:10,timeBetweenRetryInMS:()=>100}),eA=async(e,t,r,n)=>{let o,i,s,l;if(i=(0,p.j)("hostName"),s=(0,p.j)("hostClientType"),l=(0,p.j)("culture"),eb("immersive-bizchat-app-initialize-async")&&i&&s&&l?(0,m.h8)(e,r,n,eb("immersive-bizchat-app-edge-mos")):(o=await e_(async()=>(0,m.Cs)(e,t,r,n,eb("immersive-bizchat-app-edge-mos"))).retriableFunc(),i=o?.app?.host?.name,s=o?.app?.host?.clientType,l=o?.app?.locale),(0,P.mW)(i,s),l=ex(l=l??"en-US"),eS.has(l.toLowerCase()))a=l;else{let e=eR(l.toLowerCase());a=e in eC?eC[e]:l}return o},eT=()=>(0,P.iq)(),eP=(e,t,r)=>{try{let n=eb("immersive-bizchat-msa-support"),o=e.user?.tenant?.id===ek||n&&e.user?.tenant?.id===eI?"MSA":"AAD",i=n&&"MSA"===o?(0,L.dg)(e.user?.id):e.user?.id,a=e.user?.tenant?.id;eb("immersive-bizchat-msa-fix-tenantid")&&"MSA"===o&&a===ek&&(a=eI);let s={accountType:o,accountUpn:e.user?.userPrincipalName,objectId:i,tenantId:a,substrateTenantId:eb("immersive-bizchat-enable-substrate-tenant-id-and-msa-scenario-name")?n&&"MSA"===o?ek:e.user?.tenant?.id:void 0,puid:"",userName:e.user?.displayName,physicalRing:t,environment:r,fetchUserName:R.K};return U("bizchat-metaOS-app.IndexJSFetchAccountInfoEnd","ImmersiveBizChat-IndexJSFetchAccountInfoEnd"),s}catch(e){et("getAccountInfoFromHubContext fail"),(0,g.J2)(window,"ImmersiveBizChat-IndexJSFetchAccountInfoEnd-Error",String(new Date().getTime()));return}},eO=e=>{let t="mockedObjectId",r="mockedTenantId";var n=window?.location?.pathname;if(n){let e=n.split("/");if(e.length>=2){let n;for(let t of e)if(n=t.match(eE))break;n&&4===n.length&&(n[1]&&(t=(0,L.dg)(n[1])),n[2]&&(r=n[2]))}}return{accountType:"AAD",accountUpn:"mockedUpn",objectId:t,tenantId:r,puid:"mockedPuid",userName:"mockedUserName",physicalRing:e}},eR=e=>e.split("-")[0],ex=e=>("_"===(e=e.split(",")[0]).charAt(2)&&(e=e.replace("_","-")),e),eM=ey.dn,eN=()=>{B("bizchat-metaOS-app.createM365ChatRuntimeFactoryStart");let e="https://res.cdn.office.net/midgard/";if(eb("immersive-bizchat-use-weighted-endpoints")){let t=new URLSearchParams(window.location.search).get("bO");e=t&&"2"===t?"https://res-1.cdn.office.net/midgard/":"https://res.cdn.office.net/midgard/"}let t=eb("immersive-bizchat-use-weighted-endpoints")?{baseUrl:e,preload:!0}:{preload:!0},r=eF()?(0,ew.ug)(t):(0,ey.ug)(t);return B("bizchat-metaOS-app.createM365ChatRuntimeFactoryEnd"),eF()||eb("immersive-bizchat-disable-m365chat-alt-element")||I(w.createElement(A,null,w.createElement(eM,{value:(0,ey.oE)({tokenProviders:{substrate:()=>Promise.resolve(""),sydney:()=>Promise.resolve("")},entitySettings:{},preload:!0,locale:"en-US"})},w.createElement(ey.WB,null))),document.createElement("appAlt")),U("bizchat-metaOS-app.IndexJSCreateRuntimeFactory","ImmersiveBizChat-IndexJSCreateRuntimeFactory"),r};function eF(){let e=(0,p.j)("M365ChatLocal")??"",t=(0,p.j)("M365ChatBranch")??"",r=(0,p.j)("M365ChatFeatures")??"";return!((""!=e||""!=t)&&0>r.indexOf("immersive-bizchat-blaze-dev"))&&(eb("immersive-bizchat-blaze-feature")&&"1"===(0,p.j)("blaze")||eb("immersive-bizchat-blaze-feature-bypass-url")||r.indexOf("immersive-bizchat-blaze-feature")>=0)&&0>r.indexOf("immersive-bizchat-disable-blaze-feature")}var eL=(e=>(e.WW="WW",e.Dogfood="Dogfood",e.MSIT="MSIT",e.SDFV2="SDFV2",e))(eL||{});let ez=["WW","Dogfood","MSIT","SDFV2"];var eD=r(643761);async function eB(e,t,r){return new Promise(function(n,o){function i(){let e=document.getElementById("loadingScreen");e&&e.parentNode==document.body&&document.body.removeChild(e),setTimeout(n,0)}function a(){return w.useEffect(i,[]),e}function s(){try{I(w.createElement(a,null),t,void 0,r)}catch(e){o(e)}}"loading"!=window.document.readyState?s():window.document.addEventListener?window.document.addEventListener(eU,function e(){window.document.removeEventListener(eU,e),s()},!1):window.onload=()=>s()})}let eU="DOMContentLoaded";var eH=r(243034),eq=r(160092),ej=r(45228),e$=r(344743),eW=r(664866);let eV=e=>{let t=(0,eW.v)(),r=e.SessionSettings,n=r?.DefaultFolderNames,o=r?.DefaultFolderIds;return void 0!==n&&void 0!==o&&n.forEach((e,r)=>{if(e){let n=o[r];n&&(t.defaultFolderNameToIdMap.set(e,n.Id),t.defaultFolderIdToNameMap.set(n.Id,e))}}),t},eG=(0,ej.XI)("userConfigurationSet",(e,t,r)=>({userConfiguration:e,userIdentity:t,mailboxInfo:r})),eK=(0,ej.jK)("setUserConfigurationInternal",(e,t)=>{let r=(0,e$.K)();t?(r.connectedAccountsUserConfigurationMap||(r.connectedAccountsUserConfigurationMap=new Map([])),r.connectedAccountsUserConfigurationMap.set(t,e)):r.userConfiguration={...e,...eV(e)}}),eX=(e,t)=>{eK(e,t),t?eG(e,t):eG(e)};async function eY(e,t,r,n,o,i,a,s,l,c,u){let f;U("bizchat-metaOS-app.BootstrapStart","ImmersiveBizChat-BootstrapStart"),U("bizchat-metaOS-app.StartupDataEnd","ImmersiveBizChat-StartupDataEnd"),ee("startAppV2 - begin"),ee("startAppV2 - begin unblockLazyLoadCallbacks"),(0,eq.t5)(),(0,M.t5)();let h=await (0,N.kR)(),g=(0,p.j)("referrer");"{bizchatapp.host.referrer}"===g&&(g=void 0);let b=(0,p.j)("navigationType");if(b?.toLowerCase()==="{bizchatapp.host.navigationtype}"&&(b=void 0),c||a?.isPrewarm||(c=await (0,m.Ge)(ee,et,U)),r["immersive-bizchat-darkmode-loadingscreen-flashwhite"]){let e=c?.app.theme;("dark"===e||"light"===e||"normal"===e)&&document.documentElement.style.setProperty("color-scheme",e)}a?.isPrewarm?f=eO(e):c&&(f=eP(c,e,t)),f||(et("accountInfo is empty"),ei());let y={accountInfo:f,ecsFlights:r,isFlightsFromCache:n,locale:o,metaOSAppHostRing:i,prewarmInfo:a,runtimeFactory:s,metaOSAppSessionId:l,metaOSAppContext:c,ecsConfigIds:u,getAppDiagnosticsInfo:er,browserId:h,referrer:g,navigationType:b};r["immersive-bizchat-eager-msal-token-fetch"]&&(0,d.YZ)(y),U("bizchat-metaOS-app.StartRenderImmersiveBizChatView","ImmersiveBizChat-StartRenderImmersiveBizChatView"),eX({SessionSettings:{ExternalDirectoryUserGuid:f?.objectId,ExternalDirectoryTenantGuid:f?.tenantId}});let S=c?.app?.host?.name==="Outlook"?"immersivebizchatOutlook":"immersivebizchat";ee("startAppV2 - begin initServiceWorkerPromise"),eH.E4.importAndExecute(window,S,"SemanticOverview",(0,P.iq)(),!0,!0),ee("startAppV2 - end initServiceWorkerPromise"),eB(w.createElement(A,{onError:e=>{Y().then(()=>{et("[App failed to start] Bootstrapper ErrorBoundary:"+(e?.message||e)),eo(!1,!1)}),ei()}},w.createElement(d.UQ,{...y})),(0,v.m)("app"),eb("immersive-bizchat-react-new-root")).then(()=>{ee("renderPromise - end");let e=document.getElementById("loadingScreen");e&&e.parentNode==document.body&&document.body.removeChild(e),setTimeout(()=>{ee("renderPromise and initServiceWorkerPromise - finish after 5 seconds")},5e3)}).catch(()=>{et("renderPromise fail"),ei()}),U("bizchat-metaOS-app.BootstrapEnd","ImmersiveBizChat-BootstrapEnd")}var eZ=(e=>(e[e.Unknown=0]="Unknown",e[e.Dogfood=1]="Dogfood",e[e.GCCModerate=2]="GCCModerate",e[e.GccHigh=3]="GccHigh",e[e.GovCloud=4]="GovCloud",e[e.GCC=5]="GCC",e[e.Prod=6]="Prod",e))(eZ||{});let eQ=["Unknown","Dogfood","GCCModerate","GccHigh","GovCloud","GCC","Prod"];(function(){try{let e=" ||| Info: JSExecutionStart - time: "+new Date().getTime();ee(e)}catch{}})(),function(){try{window.document.addEventListener("securitypolicyviolation",e=>{try{et("Blocked URI: "+e.blockedURI+", Violated Directive: "+e.violatedDirective)}catch{}})}catch{}}(),U("bizchat-metaOS-app.IndexJSStart","ImmersiveBizChat-IndexJSStart"),r.p=(0,O.x)();let eJ=function(){let e=((0,T.x)("physicalRing")||"").toLowerCase(),t=ez.filter(t=>t.toLowerCase()===e)[0]||"WW";return"SDFV2"===t?"Dogfood":t}(),e0=(()=>{let e;let t=(0,p.j)("hostName"),r=(0,p.j)("hostClientType");return e=t&&r?(0,P.mg)(t,r):"teamshub",{isPrewarm:"true"===(0,p.j)("prewarm"),isEU:"true"===(0,p.j)("isEU"),prewarmSessionId:(0,p.j)("sessionid")||(0,p.j)("sessionId"),prewarmInstanceId:(0,p.j)("prewarmid"),hostRing:(0,p.j)("hostring"),clientName:e}})();if(U("bizchat-metaOS-app.IndexJSFetchHubInfoStart","ImmersiveBizChat-IndexJSFetchHubInfoStart"),eo(),function(){try{let e=(0,T.x)("jsTimestamp");ee(" ||| Info: HTML Generated time: "+e)}catch{}}(),e0.isPrewarm)setTimeout(()=>eY(eJ,"Unknown",ec,!1,"en-us",e0?.hostRing??"ring0",e0,eN(),void 0,void 0,void 0),800);else{let e;try{e=eN()}catch{et("fail to createRuntimeFactory"),ei()}eA(ee,et,U,eJ).then(t=>{try{var r,n,i,s,l;let c,u,d,f;let h=function(){let e=((0,T.x)("environment")||"").toLowerCase();return eQ.filter(t=>t.toLowerCase()===e)[0]||"Unknown"}();if("Dogfood"===eJ&&(0,eD.JA)([{name:"fwk-sw-routingHint",isEnabled:!0}],void 0),t)c=t?.app?.host?.name,u=t?.app?.sessionId,d=t?.user?.id,f=t?.user?.tenant?.id;else{c=(0,p.j)("hostName"),u=(0,p.j)("sessionId");let e=eO(eJ);d=e?.objectId,f=e?.tenantId}f===ek&&(f=eI);let m=f===eI?"MSA":"AAD";"MSA"===m&&(d=(0,L.dg)(d)),r=c,n=void 0,i=u??"",s=d??"",l=f??"",$=r,W=eJ,o=n,V=i,G=s,K=l,ee("getAccountInfoFromHubContext finish"),function(){try{ee("url param: bO="+(0,p.j)("bO"))}catch{}}(),Promise.all([ev(eJ,d,f,eT(),(0,T.x)("scriptVer"),a,function(){let e=((0,T.x)("webServerForest")||"").substring(0,3).toUpperCase();switch(e){case"NAM":case"APC":case"EUR":case"LAM":case"JPN":return e;default:return}}(),h,m)]).then(r=>{let[n]=r;ee("getEcsFlights() finish"),U("bizchat-metaOS-app.IndexJSGetAccountInfoAndEcsEnd","ImmersiveBizChat-IndexJSGetAccountInfoAndEcsEnd"),eY(eJ,h,n.flights,n.isFromCache,a,"",e0,e,t?.app?.sessionId,t,n.configIds)}).catch(()=>{et("getEcsFlights() and createRuntimeFactory() fail"),ei()})}catch{et("unknown issue in the index.ts"),ei()}}).catch(()=>{window?.location?.href?.toLowerCase()?.indexOf("semanticoverview/m365chatsso")>=0||ei()})}},456593:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(802046);class o extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,o.prototype),t instanceof o?this.authError=t.authError:t instanceof n.lR&&(this.authError=t)}}},69088:(e,t,r)=>{"use strict";r.d(t,{Xf:()=>b,kb:()=>y,zd:()=>I,fP:()=>k});var n=r(85453),o=r(47807),i=r(359135),a=r(771262),s=r(493180),l=r(690),c=r(412145),u=r(537103),d=r(579270),f=r(456593),h=r(574221);function p(e){let t;return(t=""==e?{}:JSON.parse(e)).hasOwnProperty("access_token")||(t.access_token={}),t.access_token.xms_cc={values:["CP1"]},JSON.stringify(t)}let m=(0,c.r9)({maximumAttempts:6048e3,timeBetweenRetryInMS:()=>100}),g=(0,c.r9)({maximumAttempts:2,timeBetweenRetryInMS:()=>10,errorLogFunc:void 0,forceToQuit:e=>e?.message!==c.$l}),v=RegExp(".*Consent between first party application (.*) and first party resource");function b(e,t){return t?t.split(" ").map(t=>e+"/"+t):["HTTPS:","API:"].some(t=>e.toUpperCase().startsWith(t))||(0,a.W_)(e)?[e+"/.default"]:[e]}function y(e,t,r,i,l,f,m,v,y,I,E,_,A){let T=b(t,E),P=l?"":f?"common":"organizations",O={scopes:T,account:i,extraQueryParameters:{domain_hint:P},claims:r,prompt:I?"consent":void 0,correlationId:(0,a._R)()};if((0,h.wX)("immersive-bizchat-msal-cache-policy")&&(O.cacheLookupPolicy=n.nN.Default),((0,h.wX)("immersive-bizchat-enable-cae-graph")&&"GRAPH"==y||(0,h.wX)("immersive-bizchat-enable-cae-sydney")&&"SYDNEY"==y||(0,h.wX)("immersive-bizchat-enable-cae-spo")&&"SPO"==y)&&((0,d.Fi)({eventId:"LogInfo",detail:`Resource is ${t} - adding CP1 to xmc_cc clientCapabilities`}),O.claims=p(r)),r){if(A){m(null,null,!0),(0,s.Q5)("getTokenFromMsalInternal() - Need user interaction. Early return for parallelize prefetch scenario.",t,v);return}(0,s.Q5)("getTokenFromMsalInternal() - authChallenge exists - begin acquireTokenPopup() -",t,v,void 0,O?.correlationId),C(e,O,_).then(function(e){(0,u.T)(!1),(0,s.Q5)("getTokenFromMsalInternal() - authChallenge exists - acquireTokenPopup() succeed",t,v,void 0,O?.correlationId),m(null,e)}).catch(function(e){(0,u.T)(!1),(0,s.Q5)("getTokenFromMsalInternal() - authChallenge exists - acquireTokenPopup() fails",t,v,k(e),O?.correlationId),m(e,null)})}else{(0,s.Q5)("getTokenFromMsalInternal() - acquireTokenSilent() begin",t,v,void 0,O?.correlationId);let l=e.acquireTokenSilent(O);(0,h.wX)("immersive-bizchat-timeout-acquire-token-slient")&&(l=g(async()=>{try{return await (0,c.MK)(l,4e4)}catch(e){throw(0,s.Q5)("getTokenFromMsalInternal() - acquireTokenSilentPromise() retry with error:"+e?.message,t,v,void 0,O?.correlationId),e}}).retriableFunc()),l.then(function(e){(0,s.Q5)("getTokenFromMsalInternal() - acquireTokenSilent() succeed",t,v,void 0,O?.correlationId),m(null,e)}).catch(function(l){var u,f;if((0,s.Q5)("getTokenFromMsalInternal() - acquireTokenSilent() fail",t,v,k(l),O?.correlationId),A){m(null,null,!0),(0,s.Q5)("getTokenFromMsalInternal() - acquireTokenSilent() fail. Early return for parallelize prefetch scenario.",t,v);return}if(l&&(l?.errorCode==="no_tokens_found"||(0,h.wX)("immersive-bizchat-timeout-acquire-token-slient")&&l?.message===c.$l))(0,s.Q5)("getTokenFromMsalInternal() - call into acquireTokenSsoSilentInternal()",t,v),u=I??!1,f={account:i,extraQueryParameters:{domain_hint:P},correlationId:(0,a._R)()},(0,h.wX)("immersive-bizchat-msal-cache-policy")&&(f.cacheLookupPolicy=n.nN.Default),((0,h.wX)("immersive-bizchat-enable-cae-graph")&&"GRAPH"==y||(0,h.wX)("immersive-bizchat-enable-cae-sydney")&&"SYDNEY"==y||(0,h.wX)("immersive-bizchat-enable-cae-spo")&&"SPO"==y)&&((0,d.Fi)({eventId:"LogInfo",detail:`Resource is ${t} - adding CP1 to xmc_cc clientCapabilities`}),f.claims=p(r)),(0,s.Q5)("acquireTokenSsoSilentInternal() - allowConsentPrompt"+u,t,v,void 0,f?.correlationId),e.ssoSilent(f).then(function(e){(0,s.Q5)("acquireTokenSsoSilentInternal() - ssoSilent() succeed",t,v,void 0,f?.correlationId),m(null,e)}).catch(function(n){if((0,s.Q5)("acquireTokenSsoSilentInternal() - ssoSilent() fail",t,v,k(n),f?.correlationId),w(n,t,v)){let a;n instanceof o.CB&&(a=n.claims,(0,s.Q5)(`acquireTokenSsoSilentInternal() - get claims info after ssoSilent() - claims.length: ${a?.length}`,t,v,void 0,f?.correlationId)),(0,s.Q5)("acquireTokenSsoSilentInternal() - retry acquireTokenWithPopupInternal()",t,v,void 0,f?.correlationId),S(e,T,a??r,i,P,m,v,y,t)}else m(n,null)});else if(w(l,t,v)){let n;(0,s.Q5)("getTokenFromMsalInternal() - call into acquireTokenSsoSilentInternal()",t,v,void 0,O?.correlationId),l instanceof o.CB&&(n=l.claims,(0,s.Q5)(`getTokenFromMsalInternal() - get claims info after acquireTokenSilent() - claims.length: ${n?.length}`,t,v)),S(e,T,n??r,i,P,m,v,t,y,_)}else m(l,null)})}}function w(e,t,r){return!!e&&(e?.errorCode!=="popup_window_error"||(l.M.isMSALRefreshUiPopUpEnabled||((0,s.Q5)("shouldTryAcquireTokenPopup() - get popup_window_error error, enabled Poup",t,r),(0,i.H)(!0)),!1))}function S(e,t,r,n,o,c,f,m,g,v){let b={scopes:t,account:n,extraQueryParameters:{domain_hint:o},claims:r,correlationId:(0,a._R)()};(0,s.Q5)("acquireTokenWithPopupInternal() - acquireTokenPopup() start",m,f,void 0,b?.correlationId),((0,h.wX)("immersive-bizchat-enable-cae-graph")&&"GRAPH"==g||(0,h.wX)("immersive-bizchat-enable-cae-sydney")&&"SYDNEY"==g||(0,h.wX)("immersive-bizchat-enable-cae-spo")&&"SPO"==g)&&((0,d.Fi)({eventId:"LogInfo",detail:`Resource is ${m} - adding CP1 to xmc_cc clientCapabilities`}),b.claims=p(r)),C(e,b,v).then(function(e){(0,u.T)(!1),(0,s.Q5)("acquireTokenWithPopupInternal() - acquireTokenPopup() succeed",m,f,void 0,b?.correlationId),c(null,e)}).catch(function(e){(0,u.T)(!1),(0,s.Q5)("acquireTokenWithPopupInternal() - acquireTokenPopup() fail",m,f,k(e),b?.correlationId),e?.errorCode!=="popup_window_error"||l.M.isMSALRefreshUiPopUpEnabled||((0,s.Q5)("acquireTokenWithPopupInternal() - get popup_window_error error, enabled Poup",m,f,void 0,b?.correlationId),(0,i.H)(!0)),c(e,null)})}async function C(e,t,r){return r?Promise.reject(Error("Msal Popup shows up right now, waiting for it")):(await m(async()=>{if(l.M.isMsalAADLoginPagePopupShowUp)return Promise.reject(Error("Msal Popup shows up right now, waiting for it"))}).retriableFunc(),(0,d.Fi)({eventId:"LogInfo",detail:"updateIsMsalPopupShowUp set to true"}),(0,u.T)(!0),e.acquireTokenPopup(t))}async function I(e,t,r){return r?Promise.reject(Error("Msal Popup shows up right now, waiting for it")):(await m(async()=>{if(l.M.isMsalAADLoginPagePopupShowUp)return Promise.reject(Error("Msal Popup shows up right now, waiting for it"))}).retriableFunc(),(0,d.Fi)({eventId:"LogInfo",detail:"updateIsMsalPopupShowUp set to true"}),(0,u.T)(!0),e.loginPopup(t))}function k(e){try{if(e instanceof f.A&&e?.authError!==void 0&&(e=e.authError),e?.errorCode==="invalid_request"){let t=e?.message?.toString()?.match(v);if(t&&t?.length>=2){let r=t[1];return e.errorCode+"("+r+")"}}else if(e?.message===c.$l)return c.$l}catch{}return e?.errorCode??""}},412506:(e,t,r)=>{"use strict";let n,o;r.d(t,{UQ:()=>cA,DI:()=>cT,YZ:()=>c_});var i,a,s,l,c,u,d,f,h,p,m,g,v,b,y,w,S,C,I,k,E,_,A,T,P,O,R,x,M,N,F,L,z,D,B,U,H,q,j,$={};r.r($),r.d($,{ActionOpenUrlErrorCode:()=>a,ActionOpenUrlType:()=>i,isSupported:()=>e6,processActionOpenUrl:()=>e5,processActionSubmit:()=>e3});var W={};r.r(W),r.d(W,{ActionExecuteInvokeRequestType:()=>te,ActionExecuteResponseHandler:()=>tt,InvokeErrorCode:()=>c,InvokeResponseType:()=>l,OriginalRequestType:()=>s,SerializableActionExecuteInvokeRequest:()=>e9,authenticateAndResendRequest:()=>ti,authenticateWithOauth2:()=>tl,authenticateWithPowerPlatformConnectorPlugins:()=>tc,authenticateWithSSO:()=>ta,authenticateWithSSOAndResendRequest:()=>ts,isActionExecuteResponse:()=>e7,isInvokeError:()=>tr,isSupported:()=>tu,validateActionExecuteInvokeRequest:()=>to});var V={};r.r(V),r.d(V,{isSupported:()=>th,processActionCommand:()=>tf});var G={};r.r(G),r.d(G,{isSupported:()=>tS,openAppDetail:()=>tb,openFullStore:()=>tv,openInContextStore:()=>ty,openSpecificStore:()=>tw});var K={};r.r(K),r.d(K,{isSupported:()=>tO,notifyInstallCompleted:()=>tP,registerAppInstallationHandler:()=>tA,unregisterAppInstallationHandler:()=>tT});var X={};r.r(X),r.d(X,{isSupported:()=>ry,registerGetLogHandler:()=>rb});var Y={};r.r(Y),r.d(Y,{closeConversation:()=>rS,getChatMembers:()=>rC,isSupported:()=>rI,openConversation:()=>rw});var Z={};r.r(Z),r.d(Z,{authenticateAndResendRequest:()=>rT,authenticateWithOauth:()=>rA,authenticateWithSSO:()=>r_,authenticateWithSSOAndResendRequest:()=>rP,isSupported:()=>rO,validateInput:()=>rR});var Q={};r.r(Q),r.d(Q,{isSupported:()=>rN,processActionOpenUrl:()=>rx,processActionSubmit:()=>rM});var J={};r.r(J),r.d(J,{CloudStorageProvider:()=>p,CloudStorageProviderFileAction:()=>y,CloudStorageProviderType:()=>m,DocumentLibraryAccessType:()=>v,FileDownloadStatus:()=>b,SpecialDocumentLibraryType:()=>g,addCloudStorageFolder:()=>rL,addCloudStorageProvider:()=>r$,addCloudStorageProviderFile:()=>rV,copyMoveFiles:()=>rH,deleteCloudStorageFolder:()=>rz,deleteCloudStorageProviderFile:()=>rK,downloadCloudStorageProviderFile:()=>rX,getCloudStorageFolderContents:()=>rD,getCloudStorageFolders:()=>rF,getExternalProviders:()=>rU,getFileDownloads:()=>rq,openCloudStorageFile:()=>rB,openDownloadFolder:()=>rj,registerCloudStorageProviderContentChangeHandler:()=>rQ,registerCloudStorageProviderListChangeHandler:()=>rZ,removeCloudStorageProvider:()=>rW,renameCloudStorageProviderFile:()=>rG,uploadCloudStorageProviderFile:()=>rY});var ee={};r.r(ee),r.d(ee,{getPairedMeetingRoomInfo:()=>r0,isSupported:()=>r5,registerMeetingRoomCapabilitiesUpdateHandler:()=>r2,registerMeetingRoomStatesUpdateHandler:()=>r3,sendCommandToPairedMeetingRoom:()=>r1});var et={};r.r(et),r.d(et,{dataLayer:()=>r6,isSupported:()=>r8,telemetry:()=>r4});var er={};r.r(er),r.d(er,{isSupported:()=>r7,showNotification:()=>r9});var en={};r.r(en),r.d(en,{ControlCommand:()=>w,ErrorReason:()=>S,SessionTerminatedReason:()=>C,getCapableParticipants:()=>ne,isSupported:()=>nl,registerOnCapableParticipantsChangeHandler:()=>no,registerOnDeviceStateChangeHandler:()=>na,registerOnErrorHandler:()=>ni,registerOnSessionStatusChangeHandler:()=>ns,requestControl:()=>nt,sendControlCommand:()=>nr,terminateSession:()=>nn});var eo={};r.r(eo),r.d(eo,{isSupported:()=>nu,selectAppEntity:()=>nc});var ei={};r.r(ei),r.d(ei,{getUserJoinedTeams:()=>nh,isSupported:()=>np});var ea={};r.r(ea),r.d(ea,{getConfigSetting:()=>nm,isSupported:()=>ng,joinedTeams:()=>ei});var es={};r.r(es),r.d(es,{ChannelType:()=>I,fullTrust:()=>ea,getTeamChannels:()=>nv,isSupported:()=>ny,refreshSiteUrl:()=>nb});var el={};r.r(el),r.d(el,{EffectChangeType:()=>E,EffectFailureReason:()=>_,VideoFrameFormat:()=>k,isSupported:()=>nT,notifySelectedVideoEffectChanged:()=>nE,registerForVideoEffect:()=>n_,registerForVideoFrame:()=>nk});var ec={};r.r(ec),r.d(ec,{ErrorLevel:()=>A,frameProcessingTimeoutInMs:()=>nU,isSupported:()=>nG,notifyFatalError:()=>nX,notifySelectedVideoEffectChanged:()=>n$,registerForVideoEffect:()=>nW,registerForVideoFrame:()=>nq,updatePersonalizedEffects:()=>nV});var eu={};r.r(eu),r.d(eu,{addAndConfigure:()=>n2,getAll:()=>n3,isSupported:()=>n8,reconfigure:()=>n5,remove:()=>n4,rename:()=>n6});var ed={};r.r(ed),r.d(ed,{AppTypes:()=>T,isSupported:()=>oe,tab:()=>eu});var ef={};r.r(ef),r.d(ef,{enablePrintCapability:()=>oc,isSupported:()=>om,print:()=>ou,registerBeforeUnloadHandler:()=>oh,registerBeforeUnloadHandlerHelper:()=>op,registerOnLoadHandler:()=>od,registerOnLoadHandlerHelper:()=>of});var eh={};r.r(eh),r.d(eh,{ContainerState:()=>O,LiveShareHost:()=>oj,UserMeetingRole:()=>P,isSupported:()=>oq});var ep={};r.r(ep),r.d(ep,{isSupported:()=>oK,openAppInstallDialog:()=>oG});var em={};r.r(em),r.d(em,{hasPermission:()=>oZ,isSupported:()=>oJ,requestPermission:()=>oQ,scanBarCode:()=>oY});var eg={};r.r(eg),r.d(eg,{isSupported:()=>o3,openChat:()=>o0,openGroupChat:()=>o2});var ev={};r.r(ev),r.d(ev,{isSupported:()=>o4,read:()=>o6,write:()=>o5});var eb={};r.r(eb),r.d(eb,{chooseLocation:()=>o7,isSupported:()=>it,showLocation:()=>ie});var ey={};r.r(ey),r.d(ey,{getCurrentLocation:()=>ir,hasPermission:()=>io,isSupported:()=>ia,map:()=>eb,requestPermission:()=>ii});var ew={};r.r(ew),r.d(ew,{isSupported:()=>iu,open:()=>ic});var eS={};r.r(eS),r.d(eS,{getLocation:()=>id,isSupported:()=>ip,showLocation:()=>ih});var eC={};r.r(eC),r.d(eC,{setOptions:()=>im});var eI={};r.r(eI),r.d(eI,{CallType:()=>N,EventActionSource:()=>L,MeetingReactionType:()=>x,MeetingType:()=>M,SharingProtocol:()=>F,appShareButton:()=>eC,getAppContentStageSharingCapabilities:()=>i_,getAppContentStageSharingState:()=>iT,getAuthenticationTokenForAnonymousUser:()=>iw,getIncomingClientAudioState:()=>ig,getLiveStreamState:()=>iS,getMeetingDetails:()=>ib,getMeetingDetailsVerbose:()=>iy,joinMeeting:()=>ix,registerLiveStreamChangedHandler:()=>ik,registerMeetingReactionReceivedHandler:()=>iR,registerRaiseHandStateChangedHandler:()=>iO,registerSpeakingStateChangeHandler:()=>iP,requestAppAudioHandling:()=>iM,requestStartLiveStreaming:()=>iC,requestStopLiveStreaming:()=>iI,shareAppContentToStage:()=>iE,stopSharingAppContentToStage:()=>iA,toggleIncomingClientAudio:()=>iv,updateMicState:()=>iN});var ek={};r.r(ek),r.d(ek,{isSupported:()=>iz,openPurchaseExperience:()=>iL});var eE={};r.r(eE),r.d(eE,{composeMeeting:()=>iB,isSupported:()=>iU,openCalendarItem:()=>iD});var e_={};r.r(e_),r.d(e_,{composeMailWithHandoff:()=>iq,isSupported:()=>ij});var eA={};r.r(eA),r.d(eA,{ComposeMailType:()=>z,composeMail:()=>iV,handoff:()=>e_,isSupported:()=>iG,openMailItem:()=>iW});var eT={};r.r(eT),r.d(eT,{isSupported:()=>iY,selectPeople:()=>iK});var eP={};r.r(eP),r.d(eP,{isSupported:()=>iQ,showProfile:()=>iZ});var eO={};r.r(eO),r.d(eO,{closeSearch:()=>i6,isSupported:()=>i5,registerHandlers:()=>i2,unregisterHandlers:()=>i3});var eR={};r.r(eR),r.d(eR,{getContent:()=>i4,isSupported:()=>i8});var ex={};r.r(ex),r.d(ex,{SharingAPIMessages:()=>i9,history:()=>eR,isSupported:()=>at,shareWebContent:()=>i7});var eM={};r.r(eM),r.d(eM,{close:()=>ar,isSupported:()=>an});var eN={};r.r(eN),r.d(eN,{StageViewOpenMode:()=>D,isSupported:()=>ai,open:()=>ao,self:()=>eM});var eF={};r.r(eF),r.d(eF,{captureImages:()=>aa,isSupported:()=>al,retrieveImages:()=>as});var eL={};r.r(eL),r.d(eL,{CameraRestriction:()=>B,Source:()=>U,hasPermission:()=>af,image:()=>eF,requestPermission:()=>ah});var ez={};r.r(ez),r.d(ez,{isSupported:()=>ag,isWebStorageClearedOnUserLogOut:()=>am});var eD={};r.r(eD),r.d(eD,{CallModalities:()=>H,isSupported:()=>ab,startCall:()=>av});var eB={};r.r(eB),r.d(eB,{ExpectedFailureReason:()=>tx.ExpectedFailureReason,FailedReason:()=>tx.FailedReason,Messages:()=>tx.Messages,notifyAppLoaded:()=>ay,notifyExpectedFailure:()=>aC,notifyFailure:()=>aS,notifySuccess:()=>aw});var eU={};r.r(eU),r.d(eU,{getDragAndDropFiles:()=>aP,isSupported:()=>aR});var eH={};r.r(eH),r.d(eH,{getSettings:()=>aN,registerOnRemoveHandler:()=>az,registerOnSaveHandler:()=>aL,setSettings:()=>aF,setValidityState:()=>aM});var eq={};r.r(eq),r.d(eq,{getDefaultSizeIfNotProvided:()=>aq,startTask:()=>aB,submitTask:()=>aH,updateTask:()=>aU});var ej={};r.r(ej),r.d(ej,{CartStatus:()=>j,Intent:()=>q,addOrUpdateCartItems:()=>aY,cartVersion:()=>aK,getCart:()=>aX,isSupported:()=>aJ,removeCartItems:()=>aZ,updateCartStatus:()=>aQ});var e$={};r.r(e$),r.d(e$,{ActionObjectType:()=>t_.CO,AppId:()=>e2.l,ChannelType:()=>e0.Cu,ChildAppWindow:()=>oo,DialogDimension:()=>e0.zo,EduType:()=>t_.fw,EmailAddress:()=>or,ErrorCode:()=>t_.O4,FileOpenPreference:()=>t_.QY,FrameContexts:()=>e0.E2,HostClientType:()=>e0.WK,HostName:()=>e0.yA,LiveShareHost:()=>oj,NotificationTypes:()=>d,ParentAppWindow:()=>oi,SecondaryM365ContentIdName:()=>t_.jw,TaskModuleDimension:()=>e0.zo,TeamType:()=>e0.YV,UUID:()=>oH.k,UserSettingTypes:()=>h,UserTeamRole:()=>e0.h1,ViewerActionTypes:()=>f,app:()=>tx,appEntity:()=>eo,appInitialization:()=>eB,appInstallDialog:()=>ep,authentication:()=>tp,barCode:()=>em,calendar:()=>eE,call:()=>eD,chat:()=>eg,clipboard:()=>ev,conversations:()=>Y,copilot:()=>rk,dialog:()=>o8,enablePrintCapability:()=>ob,executeDeepLink:()=>oN,externalAppAuthentication:()=>W,externalAppAuthenticationForCEA:()=>Z,externalAppCardActions:()=>$,externalAppCardActionsForCEA:()=>Q,externalAppCommands:()=>V,files:()=>J,geoLocation:()=>ey,getAdaptiveCardSchemaVersion:()=>on,getContext:()=>ow,getMruTabInstances:()=>ox,getTabInstances:()=>oR,hostEntity:()=>ed,initialize:()=>ov,initializeWithFrameContext:()=>oL,liveShare:()=>eh,location:()=>eS,logs:()=>X,mail:()=>eA,marketplace:()=>ej,media:()=>il,meeting:()=>eI,meetingRoom:()=>ee,menus:()=>is,messageChannels:()=>et,monetization:()=>ek,navigateBack:()=>oU,navigateCrossDomain:()=>oB,navigateToTab:()=>oD,nestedAppAuth:()=>o9,notifications:()=>er,openFilePreview:()=>rv,otherAppStateChange:()=>K,pages:()=>tR,people:()=>eT,print:()=>oy,profile:()=>eP,registerAppButtonClickHandler:()=>oI,registerAppButtonHoverEnterHandler:()=>ok,registerAppButtonHoverLeaveHandler:()=>oE,registerBackButtonHandler:()=>o_,registerBeforeUnloadHandler:()=>oT,registerChangeSettingsHandler:()=>oO,registerCustomHandler:()=>rm,registerFocusEnterHandler:()=>oP,registerFullScreenHandler:()=>oC,registerOnLoadHandler:()=>oA,registerOnThemeChangeHandler:()=>oS,registerUserSettingsChangeHandler:()=>rg,remoteCamera:()=>en,returnFocus:()=>oz,search:()=>eO,secondaryBrowser:()=>ew,sendCustomEvent:()=>rp,sendCustomMessage:()=>rh,setFrameContext:()=>oF,settings:()=>eH,shareDeepLink:()=>oM,sharing:()=>ex,stageView:()=>eN,store:()=>G,tasks:()=>eq,teams:()=>es,teamsCore:()=>ef,thirdPartyCloudStorage:()=>eU,uploadCustomApp:()=>rf,version:()=>oa.r,videoEffects:()=>el,videoEffectsEx:()=>ec,visualMedia:()=>eL,webStorage:()=>ez});var eW=r(442976),eV=r(603722),eG=r(237602),eK=r(223093),eX=r(266143),eY=r(858881),eZ=r(157061),eQ=r(65999),eJ=r(383655),e0=r(89522),e1=r(70727),e2=r(633277);function e3(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.content),!e6())throw e0.qP;let r=new e2.l(e);return(0,eZ.b5)((0,eJ.N0)("v2","externalAppCardActions.processActionSubmit"),"externalAppCardActions.processActionSubmit",[r.toString(),t]).then(([e,t])=>{if(!e)throw t})}function e5(e,t,r){if((0,eQ.Zn)(e1.fA,e0.E2.content),!e6())throw e0.qP;let n=new e2.l(e);return(0,eZ.b5)((0,eJ.N0)("v2","externalAppCardActions.processActionOpenUrl"),"externalAppCardActions.processActionOpenUrl",[n.toString(),t.href,r]).then(([e,t])=>{if(e)throw e;return t})}function e6(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.externalAppCardActions)}(function(e){e.DeepLinkDialog="DeepLinkDialog",e.DeepLinkOther="DeepLinkOther",e.DeepLinkStageView="DeepLinkStageView",e.GenericUrl="GenericUrl"})(i||(i={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.INVALID_LINK="INVALID_LINK",e.NOT_SUPPORTED="NOT_SUPPORTED"}(a||(a={}));var e4=r(634362),e8=r(805234);class e9{constructor(e){this.invokeRequest=e}serialize(){return this.invokeRequest}}function e7(e){return e.responseType===l.ActionExecuteInvokeResponse&&void 0!==e.value&&void 0!==e.statusCode&&void 0!==e.type}let te="Action.Execute";(function(e){e.ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",e.QueryMessageExtensionRequest="QueryMessageExtensionRequest"})(s||(s={})),function(e){e.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",e.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(l||(l={}));class tt extends e4.w{validate(e){return e7(e)}deserialize(e){return e}}function tr(e){return"object"==typeof e&&null!==e&&Object.values(c).includes(e.errorCode)&&(void 0===e.message||"string"==typeof e.message)}function tn(e){e.requestType===s.ActionExecuteInvokeRequest?to(e):e.requestType===s.QueryMessageExtensionRequest&&function(e){if(e.commandId.length>64)throw Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(e.parameters.length>5)throw Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(let t of e.parameters){if(t.name.length>64)throw Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(t.value.length>512)throw Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}(e)}function to(e){if(e.type!==te)throw{errorCode:c.INTERNAL_ERROR,message:`Invalid action type ${e.type}. Action type must be "${te}"`};if(!(0,e8.ed)(e.data))throw{errorCode:c.INTERNAL_ERROR,message:`Invalid data type ${typeof e.data}. Data must be a primitive or a plain object.`}}function ti(e,t,r){if((0,eQ.Zn)(e1.fA,e0.E2.content),!tu())throw e0.qP;let n=new e2.l(e);return tn(r),(0,eZ.b5)((0,eJ.N0)("v2","externalAppAuthentication.authenticateAndResendRequest"),"externalAppAuthentication.authenticateAndResendRequest",[n.toString(),r,t.url.href,t.width,t.height,t.isExternal]).then(([e,t])=>{if(e&&null!=t.responseType)return t;throw t})}function ta(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.content),!tu())throw e0.qP;let r=new e2.l(e);return(0,eZ.b5)((0,eJ.N0)("v2","externalAppAuthentication.authenticateWithSSO"),"externalAppAuthentication.authenticateWithSSO",[r.toString(),t.claims,t.silent]).then(([e,t])=>{if(!e)throw t})}function ts(e,t,r){if((0,eQ.Zn)(e1.fA,e0.E2.content),!tu())throw e0.qP;let n=new e2.l(e);return tn(r),(0,eZ.b5)((0,eJ.N0)("v2","externalAppAuthentication.authenticateWithSSOAndResendRequest"),"externalAppAuthentication.authenticateWithSSOAndResendRequest",[n.toString(),r,t.claims,t.silent]).then(([e,t])=>{if(e&&null!=t.responseType)return t;throw t})}function tl(e,t,r){if((0,eQ.Zn)(e1.fA,e0.E2.content),!tu())throw e0.qP;return(0,e8.GZ)(e,Error("titleId is Invalid.")),(0,e8.GZ)(t,Error("oauthConfigId is Invalid.")),(0,eZ.b5)((0,eJ.N0)("v2","externalAppAuthentication.authenticateWithOauth2"),"externalAppAuthentication.authenticateWithOauth2",[e,t,r.width,r.height,r.isExternal]).then(([e,t])=>{if(!e)throw t})}function tc(e,t,r){if((0,eQ.Zn)(e1.fA,e0.E2.content),!tu())throw e0.qP;return(0,e8.GZ)(e,Error("titleId is Invalid.")),t&&(0,e8.wv)(t),(0,eZ.b5)((0,eJ.N0)("v2","externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins"),"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins",[e,null==t?void 0:t.toString(),null==r?void 0:r.width,null==r?void 0:r.height,null==r?void 0:r.isExternal]).then(([e,t])=>{if(!e)throw t})}function tu(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.externalAppAuthentication)}(c||(c={})).INTERNAL_ERROR="INTERNAL_ERROR";var td=r(274107);function tf(e,t,r){return(0,td.s)(this,void 0,void 0,function*(){if((0,eQ.Zn)(e1.fA,e0.E2.content),!th())throw e0.qP;let n=new e2.l(e),[o,i]=yield(0,eZ.b5)((0,eJ.N0)("v2","externalAppCommands.processActionCommand"),"externalAppCommands.processActionCommand",[n.toString(),t,r]);if(o)throw o;return i})}function th(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.externalAppCommands)}var tp=r(377255),tm=r(935940),tg=r(91349);function tv(e){return(0,td.s)(this,void 0,void 0,function*(){tC();let{size:t}=null!=e?e:{};return(0,eZ._s)("store.openFullStore",[tI(t)],(0,eJ.N0)("v2","store.openFullStore"))})}function tb(e){return(0,td.s)(this,void 0,void 0,function*(){tC();let{size:t,appId:r}=e;if(!(r instanceof e2.l))throw Error("No App Id present, but AppId needed to open AppDetail store");return(0,eZ._s)("store.openAppDetail",[tI(t),r],(0,eJ.N0)("v2","store.openAppDetail"))})}function ty(e){return(0,td.s)(this,void 0,void 0,function*(){tC();let{size:t,appCapability:r,appMetaCapabilities:n,installationScope:o,filteredOutAppIds:i}=null!=e?e:{};return(0,eZ._s)("store.openInContextStore",[tI(t),r,n,o,null==i?void 0:i.map(e=>e.toString())],(0,eJ.N0)("v2","store.openInContextStore"))})}function tw(e){return(0,td.s)(this,void 0,void 0,function*(){tC();let{size:t,collectionId:r}=e;if(void 0===r)throw Error("No Collection Id present, but CollectionId needed to open a store specific to a collection");return(0,eZ._s)("store.openSpecificStore",[tI(t),r],(0,eJ.N0)("v2","store.openSpecificStore"))})}function tS(){return(0,eQ.Zn)(e1.fA)&&!!e1.fA.supports.store}function tC(){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.sidePanel,e0.E2.meetingStage),!tS())throw e0.qP}function tI(e){if(void 0===e)return;let{width:t,height:r}=e;if(void 0!==t&&"number"==typeof t&&t<0||void 0!==r&&"number"==typeof r&&r<0)throw Error("Invalid store dialog size");return JSON.stringify(e)}var tk=r(623054),tE=r(313059),t_=r(995243);function tA(e){if(!tO())throw Error(t_.O4.NOT_SUPPORTED_ON_PLATFORM.toString());if((0,tE.h)(e))throw Error(t_.O4.INVALID_ARGUMENTS.toString());(0,tk.ik)((0,eJ.N0)("v2","otherApp.install"),"otherApp.install",e)}function tT(){if(!tO())throw Error(t_.O4.NOT_SUPPORTED_ON_PLATFORM.toString());(0,eZ.x3)((0,eJ.N0)("v2","otherApp.unregisterInstall"),"otherApp.unregisterInstall"),(0,tk.Vl)("otherApp.install")}function tP(e){if(!tO())throw Error(t_.O4.NOT_SUPPORTED_ON_PLATFORM.toString());return(0,eZ._s)("otherApp.notifyInstallCompleted",[e.toString()],(0,eJ.N0)("v2","otherApp.notifyInstallCompleted"))}function tO(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.otherAppStateChange)}var tR=r(667752),tx=r(254812),tM=r(574221),tN=r(366482);function tF(){switch((0,tN.tn)()){case"OWA":case eK.Sl:return tL.M365ChatOWA;case"Monarch":case eK.NC:return tL.M365ChatMonarch;case eK.Ah:return tL.M365ChatHarmonyWeb;case eK.EO:return tL.M365ChatHarmonyDesktop;case eK.Hz:return tL.M365ChatTeamsMetaOS;case eK.W_:return tL.M365ChatOutlookWin32;case eK.Gu:return tL.M365ChatOutlookMac;case eK.dg:return tL.M365ChatEdgeWeb;default:return tL.M365ChatOWA}}var tL=(e=>(e.M365ChatOWA="M365ChatOWA",e.M365ChatMonarch="M365ChatMonarch",e.M365ChatHarmonyWeb="M365ChatHarmonyWeb",e.M365ChatHarmonyDesktop="M365ChatHarmonyDesktop",e.M365ChatTeamsMetaOS="M365ChatTeamsMetaOS",e.M365ChatOutlookWin32="M365ChatOutlookWin32",e.M365ChatOutlookMac="M365ChatOutlookMac",e.M365ChatEdgeWeb="M365ChatEdgeWeb",e))(tL||{});function tz(e){let t=(4-e.length%4)%4,r="";for(let e=0;e<t;e++)r+="=";return atob((e+r).replace(/\-/g,"+").replace(/_/g,"/"))}function tD(e){let t=atob(e.replace(/\-/g,"+").replace(/_/g,"/"));return Uint8Array.from(t,e=>e.codePointAt(0)??0)}var tB=r(493180),tU=r(932501);let tH=(0,tU.n)({container:{display:"flex",flexDirection:"column",width:"100%",userSelect:"text"}});!function(e){e.OutlookSidepane="OutlookSidepane",e.OutlookImmersive="OutlookImmersive",e.TeamsImmersive="TeamsImmersive",e.Notebooks="Notebooks"}(u||(u={}));var tq=r(690),tj=r(579270);class t${getHostContext(){switch((0,tN.tn)()){case eK.Hz:return{hostType:u.TeamsImmersive};case tN.X9:case tN.S9:default:return{hostType:u.OutlookImmersive}}}submitHostCommands(e){e.forEach(e=>{(function(e,t){if("OnChatResponse"===e.name&&t===u.TeamsImmersive&&tq.M.enableDeeplinks){let t="https://teams.microsoft.com/l/copilot/notify?bold=true&previewText="+encodeURIComponent(String(e.args?.Response).substring(0,100));tx.openLink(t).then(()=>{(0,tj.Fi)({eventId:"Bold deeplink executed"})})}})(e,this.getHostContext()?.hostType)})}}var tW=r(174485);function tV(e){try{if(!e)return;return(0,tW.isRtlLang)(e)}catch{return}}var tG=r(491306),tK=r(788074),tX=r(471936),tY=r(488563),tZ=r(110886),tQ=r(404735),tJ=r(45228);let t0=(0,tJ.jK)("updateServiceEndpointInfra",e=>{tq.M.serviceEndpointInfra=e}),t1=(0,tJ.jK)("updateServiceEndpointRing",e=>{tq.M.serviceEndpointRing=e}),t2=(0,tJ.jK)("updateFeatureFlags",e=>{tq.M.featureFlags=e}),t3=(0,tJ.jK)("updateSydneyVariants",e=>{tq.M.sydneyVariants=e}),t5=(0,tJ.jK)("updateServiceEndpointUrl",e=>{tq.M.serviceEndpointUrl=e});var t6=r(654018);let t4=(0,tJ.jK)("updateSessionsEndpointUrl",e=>{tq.M.sessionsEndpointUrl=e}),t8=(0,tJ.jK)("updateSessionsVariants",e=>{tq.M.sessionsVariants=e}),t9="Immersive_BizChat_InternalUser_Dev_Settings";function t7(){return"Dogfood"===(0,tN.K)()||(0,tM.wX)("immersive-bizchat-settings-panel")}let re=()=>({serviceEndpointInfra:tq.M.serviceEndpointInfra,serviceEndpointRing:tq.M.serviceEndpointRing,serviceEndpointUrl:tq.M.serviceEndpointUrl,sydneyVariants:tq.M.sydneyVariants,featureFlags:tq.M.featureFlags,sessionsEndpointUrl:tq.M.sessionsEndpointUrl,sessionsVariants:tq.M.sessionsVariants}),rt=()=>{let e=re(),t={};return tM.YX.forEach(r=>{e?.featureFlags===void 0||void 0===e.featureFlags[r]?t[r]=(0,tM.mM)(r):t[r]=(e?.featureFlags&&e.featureFlags[r])??!1}),t},rr=()=>{rs()?(0,tQ.AP)(window,t9,JSON.stringify(re())):(0,eX.J2)(window,t9,JSON.stringify(re()))},rn=(e,t,r,n,o,i)=>{t0(r),t1(t),t3(e),t5(n),t4(o??""),t8(i??""),rr(),setTimeout(()=>{window.location.reload()},100)},ro=e=>{t2(e),rr(),setTimeout(()=>{window.location.reload()},100)},ri=()=>{rs()?(0,tQ.sc)(window,t9):(0,eX.X)(window,t9)},ra=()=>{try{if((0,t6.j)("bO"))return;let e=rs()?(0,tQ._S)(window,t9):(0,eX.Hd)(window,t9);if(null===e||e.length<=2)return;return JSON.parse(e)}catch{return}},rs=()=>"true"===(0,tQ._S)(window,"Immersive_BizChat_InternalUser_Dev_Settings_UseLocalStorage");var rl=r(359135),rc=r(320498),ru=r(528729),rd=r(474011);function rf(e,t){(0,eQ.Zn)(e1.fA),(0,eZ.x3)((0,eJ.N0)("v1","uploadCustomApp"),"uploadCustomApp",[e],t||(0,e8._r)())}function rh(e,t,r){(0,eQ.Zn)(e1.fA),(0,eZ.x3)((0,eJ.N0)("v1","sendCustomMessage"),e,t,r)}function rp(e,t){if((0,eQ.Zn)(e1.fA),!eZ.bm.childWindow)throw Error("The child window has not yet been initialized or is not present");(0,eZ.nq)(e,t)}function rm(e,t){(0,eQ.Zn)(e1.fA),(0,tk.ik)((0,eJ.N0)("v1","registerCustomHandler"),e,(...e)=>t.apply(this,e))}function rg(e,t){(0,eQ.Zn)(e1.fA),(0,tk.ik)((0,eJ.N0)("v1","registerUserSettingsChangeHandler"),"userSettingsChange",t,!0,[e])}function rv(e){(0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task);let t=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId,e.sizeInBytes];(0,eZ.x3)((0,eJ.N0)("v1","openFilePreview"),"openFilePreview",t)}function rb(e){if((0,tE.h)(e)||(0,eQ.Zn)(e1.fA),!(0,tE.h)(e)&&!ry())throw e0.qP;e?(0,tk.ik)((0,eJ.N0)("v1","log.request"),"log.request",()=>{let t=e();(0,eZ.x3)((0,eJ.N0)("v1","log.receive"),"log.receive",[t])}):(0,tk.Vl)("log.request")}function ry(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.logs)}function rw(e){return new Promise(t=>{if((0,eQ.Zn)(e1.fA,e0.E2.content),!rI())throw e0.qP;let r=(0,eZ.Vi)((0,eJ.N0)("v1","conversations.openConversation"),"conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&(0,tk.ik)((0,eJ.N0)("v1","conversations.registerStartConversationHandler"),"startConversation",(t,r,n,o)=>{var i;return null===(i=e.onStartConversation)||void 0===i?void 0:i.call(e,{subEntityId:t,conversationId:r,channelId:n,entityId:o})}),e.onCloseConversation&&(0,tk.ik)((0,eJ.N0)("v1","conversations.registerCloseConversationHandler"),"closeConversation",(t,r,n,o)=>{var i;return null===(i=e.onCloseConversation)||void 0===i?void 0:i.call(e,{subEntityId:t,conversationId:r,channelId:n,entityId:o})}),t(r)})}function rS(){if((0,eQ.Zn)(e1.fA,e0.E2.content),!rI())throw e0.qP;(0,eZ.x3)((0,eJ.N0)("v1","conversations.closeConversation"),"conversations.closeConversation"),(0,tk.Vl)("startConversation"),(0,tk.Vl)("closeConversation")}function rC(){return new Promise(e=>{if((0,eQ.Zn)(e1.fA),!rI())throw e0.qP;e((0,eZ.j0)((0,eJ.N0)("v1","conversations.getChatMember"),"getChatMembers"))})}function rI(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.conversations)}(function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"})(d||(d={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(f||(f={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(h||(h={}));var rk=r(829615),rE=r(231494);function r_(e,t,r){return(0,td.s)(this,void 0,void 0,function*(){if((0,eQ.Zn)(e1.fA,e0.E2.content),!rO())throw e0.qP;return rR(e,t),(0,eZ._s)("externalAppAuthenticationForCEA.authenticateWithSSO",[e,t,r.claims,r.silent],(0,eJ.N0)("v2","externalAppAuthenticationForCEA.authenticateWithSSO"),tr)})}function rA(e,t,r){return(0,td.s)(this,void 0,void 0,function*(){if((0,eQ.Zn)(e1.fA,e0.E2.content),!rO())throw e0.qP;return rR(e,t),(0,eZ._s)("externalAppAuthenticationForCEA.authenticateWithOauth",[e,t,r.url.href,r.width,r.height,r.isExternal],(0,eJ.N0)("v2","externalAppAuthenticationForCEA.authenticateWithOauth"),tr)})}function rT(e,t,r,n){return(0,td.s)(this,void 0,void 0,function*(){if((0,eQ.Zn)(e1.fA,e0.E2.content),!rO())throw e0.qP;return rR(e,t),to(n),(0,eZ.AR)("externalAppAuthenticationForCEA.authenticateAndResendRequest",[e,t,new e9(n),r.url.href,r.width,r.height,r.isExternal],new tt,(0,eJ.N0)("v2","externalAppAuthenticationForCEA.authenticateAndResendRequest"),tr)})}function rP(e,t,r,n){return(0,td.s)(this,void 0,void 0,function*(){if((0,eQ.Zn)(e1.fA,e0.E2.content),!rO())throw e0.qP;return rR(e,t),to(n),(0,eZ.AR)("externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest",[e,t,new e9(n),r.claims,r.silent],new tt,(0,eJ.N0)("v2","externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest"),tr)})}function rO(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.externalAppAuthenticationForCEA)}function rR(e,t){(0,e8.GZ)(t,Error("conversation id is not valid.")),(0,rE.kX)(e)}function rx(e,t,r){return(0,td.s)(this,void 0,void 0,function*(){if((0,eQ.Zn)(e1.fA,e0.E2.content),!rN())throw e0.qP;rR(e,t);let[n,o]=yield(0,eZ.b5)((0,eJ.N0)("v2","externalAppCardActionsForCEA.processActionOpenUrl"),"externalAppCardActionsForCEA.processActionOpenUrl",[e.toString(),t,r.href]);if(n)throw n;return o})}function rM(e,t,r){return(0,td.s)(this,void 0,void 0,function*(){if((0,eQ.Zn)(e1.fA,e0.E2.content),!rN())throw e0.qP;rR(e,t);let n=yield(0,eZ.j0)((0,eJ.N0)("v2","externalAppCardActionsForCEA.processActionSubmit"),"externalAppCardActionsForCEA.processActionSubmit",e.toString(),t,r);if(n)throw n})}function rN(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.externalAppCardActionsForCEA)}function rF(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.content),!e||0===e.length)throw Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw Error("[files.getCloudStorageFolders] Callback cannot be null");(0,eZ.x3)((0,eJ.N0)("v1","files.getCloudStorageFolders"),"files.getCloudStorageFolders",[e],t)}function rL(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.content),!e||0===e.length)throw Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw Error("[files.addCloudStorageFolder] Callback cannot be null");(0,eZ.x3)((0,eJ.N0)("v1","files.addCloudStorageFolder"),"files.addCloudStorageFolder",[e],t)}function rz(e,t,r){if((0,eQ.Zn)(e1.fA,e0.E2.content),!e)throw Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!r)throw Error("[files.deleteCloudStorageFolder] Callback cannot be null");(0,eZ.x3)((0,eJ.N0)("v1","files.deleteCloudStorageFolder"),"files.deleteCloudStorageFolder",[e,t],r)}function rD(e,t,r){if((0,eQ.Zn)(e1.fA,e0.E2.content),!e||!t)throw Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!r)throw Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");(0,eZ.x3)((0,eJ.N0)("v1","files.getCloudStorageFolderContents"),"files.getCloudStorageFolderContents",[e,t],r)}function rB(e,t,r){if((0,eQ.Zn)(e1.fA,e0.E2.content),!e||!t)throw Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw Error("[files.openCloudStorageFile] provided file is a subDirectory");(0,eZ.x3)((0,eJ.N0)("v1","files.openCloudStorageFile"),"files.openCloudStorageFile",[e,t,r])}function rU(e=!1,t){if((0,eQ.Zn)(e1.fA,e0.E2.content),!t)throw Error("[files.getExternalProviders] Callback cannot be null");(0,eZ.x3)((0,eJ.N0)("v1","files.getExternalProviders"),"files.getExternalProviders",[e],t)}function rH(e,t,r,n,o=!1,i){if((0,eQ.Zn)(e1.fA,e0.E2.content),!e||0===e.length)throw Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!t)throw Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!r)throw Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!n)throw Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!i)throw Error("[files.copyMoveFiles] callback cannot be null");(0,eZ.x3)((0,eJ.N0)("v1","files.copyMoveFiles"),"files.copyMoveFiles",[e,t,r,n,o],i)}function rq(e){if((0,eQ.Zn)(e1.fA,e0.E2.content),!e)throw Error("[files.getFileDownloads] Callback cannot be null");(0,eZ.x3)((0,eJ.N0)("v1","files.getFileDownloads"),"files.getFileDownloads",[],e)}function rj(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.content),!t)throw Error("[files.openDownloadFolder] Callback cannot be null");(0,eZ.x3)((0,eJ.N0)("v1","files.openDownloadFolder"),"files.openDownloadFolder",[e],t)}function r$(e){if((0,eQ.Zn)(e1.fA,e0.E2.content),!e)throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");(0,eZ.x3)((0,eJ.N0)("v1","files.addCloudStorageProvider"),"files.addCloudStorageProvider",[],e)}function rW(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.content),!t)throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!e||!e.content)throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");(0,eZ.x3)((0,eJ.N0)("v1","files.removeCloudStorageProvider"),"files.removeCloudStorageProvider",[e],t)}function rV(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.content),!t)throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");(0,eZ.x3)((0,eJ.N0)("v1","files.addCloudStorageProviderFile"),"files.addCloudStorageProviderFile",[e],t)}function rG(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.content),!t)throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");(0,eZ.x3)((0,eJ.N0)("v1","files.renameCloudStorageProviderFile"),"files.renameCloudStorageProviderFile",[e],t)}function rK(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.content),!t)throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");(0,eZ.x3)((0,eJ.N0)("v1","files.deleteCloudStorageProviderFile"),"files.deleteCloudStorageProviderFile",[e],t)}function rX(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.content),!t)throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");(0,eZ.x3)((0,eJ.N0)("v1","files.downloadCloudStorageProviderFile"),"files.downloadCloudStorageProviderFile",[e],t)}function rY(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.content),!t)throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!e.content.destinationFolder)throw rJ(t_.O4.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");(0,eZ.x3)((0,eJ.N0)("v1","files.uploadCloudStorageProviderFile"),"files.uploadCloudStorageProviderFile",[e],t)}function rZ(e){if((0,eQ.Zn)(e1.fA),!e)throw Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");(0,tk.ik)((0,eJ.N0)("v1","files.registerCloudStorageProviderListChangeHandler"),"files.cloudStorageProviderListChange",e)}function rQ(e){if((0,eQ.Zn)(e1.fA),!e)throw Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");(0,tk.ik)((0,eJ.N0)("v1","files.registerCloudStorageProviderContentChangeHandler"),"files.cloudStorageProviderContentChange",e)}function rJ(e,t){return{errorCode:e,message:t}}function r0(){return new Promise(e=>{if((0,eQ.Zn)(e1.fA),!r5())throw e0.qP;e((0,eZ.gV)((0,eJ.N0)("v1","meetingRoom.getPairedMeetingRoomInfo"),"meetingRoom.getPairedMeetingRoomInfo"))})}function r1(e){return new Promise(t=>{if(!e||0==e.length)throw Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if((0,eQ.Zn)(e1.fA),!r5())throw e0.qP;t((0,eZ.gV)((0,eJ.N0)("v1","meetingRoom.sendCommandToPairedMeetingRoom"),"meetingRoom.sendCommandToPairedMeetingRoom",e))})}function r2(e){if(!e)throw Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if((0,eQ.Zn)(e1.fA),!r5())throw e0.qP;(0,tk.ik)((0,eJ.N0)("v1","meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler"),"meetingRoom.meetingRoomCapabilitiesUpdate",t=>{(0,eQ.Zn)(e1.fA),e(t)})}function r3(e){if(!e)throw Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if((0,eQ.Zn)(e1.fA),!r5())throw e0.qP;(0,tk.ik)((0,eJ.N0)("v1","meetingRoom.registerMeetingRoomStatesUpdateHandler"),"meetingRoom.meetingRoomStatesUpdate",t=>{(0,eQ.Zn)(e1.fA),e(t)})}function r5(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.meetingRoom)}(function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE",e.SharePoint="SharePoint"})(p||(p={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(m||(m={})),(g||(g={})).ClassMaterials="classMaterials",(v||(v={})).Readonly="readonly",function(e){e.Downloaded="Downloaded",e.Downloading="Downloading",e.Failed="Failed"}(b||(b={})),function(e){e.Download="DOWNLOAD",e.Upload="UPLOAD",e.Delete="DELETE"}(y||(y={}));var r6=r(895212),r4=r(294826);function r8(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.messageChannels)}function r9(e){if((0,eQ.Zn)(e1.fA,e0.E2.content),!r7())throw e0.qP;(0,eZ.x3)((0,eJ.N0)("v1","notifications.showNotification"),"notifications.showNotification",[e])}function r7(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.notifications)}function ne(e){if(!e)throw Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nl())throw e0.qP;(0,eZ.x3)((0,eJ.N0)("v1","remoteCamera.getCapableParticipants"),"remoteCamera.getCapableParticipants",e)}function nt(e,t){if(!e)throw Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw Error("[remoteCamera.requestControl] Callback cannot be null");if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nl())throw e0.qP;(0,eZ.x3)((0,eJ.N0)("v1","remoteCamera.requestControl"),"remoteCamera.requestControl",[e],t)}function nr(e,t){if(!e)throw Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw Error("[remoteCamera.sendControlCommand] Callback cannot be null");if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nl())throw e0.qP;(0,eZ.x3)((0,eJ.N0)("v1","remoteCamera.sendControlCommand"),"remoteCamera.sendControlCommand",[e],t)}function nn(e){if(!e)throw Error("[remoteCamera.terminateSession] Callback cannot be null");if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nl())throw e0.qP;(0,eZ.x3)((0,eJ.N0)("v1","remoteCamera.terminateSession"),"remoteCamera.terminateSession",e)}function no(e){if(!e)throw Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nl())throw e0.qP;(0,tk.ik)((0,eJ.N0)("v1","remoteCamera.registerOnCapableParticipantsChangeHandler"),"remoteCamera.capableParticipantsChange",e)}function ni(e){if(!e)throw Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nl())throw e0.qP;(0,tk.ik)((0,eJ.N0)("v1","remoteCamera.registerOnErrorHandler"),"remoteCamera.handlerError",e)}function na(e){if(!e)throw Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nl())throw e0.qP;(0,tk.ik)((0,eJ.N0)("v1","remoteCamera.registerOnDeviceStateChangeHandler"),"remoteCamera.deviceStateChange",e)}function ns(e){if(!e)throw Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nl())throw e0.qP;(0,tk.ik)((0,eJ.N0)("v1","remoteCamera.registerOnSessionStatusChangeHandler"),"remoteCamera.sessionStatusChange",e)}function nl(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.remoteCamera)}function nc(e,t,r,n){if((0,eQ.Zn)(e1.fA,e0.E2.content),!nu())throw e0.qP;if(!e||0==e.length)throw Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!n)throw Error("[appEntity.selectAppEntity] Callback cannot be null");(0,eZ.x3)((0,eJ.N0)("v1","appEntity.selectAppEntity"),"appEntity.selectAppEntity",[e,t,r],n)}function nu(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.appEntity)}(function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"})(w||(w={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(S||(S={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(C||(C={}));var nd=r(788347),nf=r(550966);function nh(e){return new Promise(t=>{if((0,eQ.Zn)(e1.fA),!np())throw e0.qP;if((nf.Y.hostClientType===e0.WK.android||nf.Y.hostClientType===e0.WK.teamsRoomsAndroid||nf.Y.hostClientType===e0.WK.teamsPhones||nf.Y.hostClientType===e0.WK.teamsDisplays)&&!(0,eQ.wT)(nd.nj))throw Error(JSON.stringify({errorCode:t_.O4.OLD_PLATFORM}));t((0,eZ.j0)((0,eJ.N0)("v1","teams.fullTrust.joinedTeams.getUserJoinedTeams"),"getUserJoinedTeams",e))})}function np(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.teams)&&!!e1.fA.supports.teams.fullTrust&&!!e1.fA.supports.teams.fullTrust.joinedTeams}function nm(e){return new Promise(t=>{if((0,eQ.Zn)(e1.fA),!ng())throw e0.qP;t((0,eZ.j0)((0,eJ.N0)("v1","teams.fullTrust.getConfigSetting"),"getConfigSetting",e))})}function ng(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.teams)&&!!e1.fA.supports.teams.fullTrust}function nv(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.content),!ny())throw e0.qP;if(!e)throw Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw Error("[teams.getTeamChannels] Callback cannot be null");(0,eZ.x3)((0,eJ.N0)("v1","teams.getTeamChannels"),"teams.getTeamChannels",[e],t)}function nb(e,t){if((0,eQ.Zn)(e1.fA),!ny())throw e0.qP;if(!e)throw Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw Error("[teams.refreshSiteUrl] Callback cannot be null");(0,eZ.x3)((0,eJ.N0)("v1","teams.refreshSiteUrl"),"teams.refreshSiteUrl",[e],t)}function ny(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.teams)}!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(I||(I={}));class nw{static setTimeout(e,t){let r=performance.now(),n=(0,e8.Nl)();return nw.setTimeoutCallbacks[n]={callback:e,timeoutInMs:t,startedAtInMs:r},n}static clearTimeout(e){delete nw.setTimeoutCallbacks[e]}static setInterval(e,t){nw.setTimeout(function r(){e(),nw.setTimeout(r,t)},t)}static tick(){let e=performance.now(),t=[];for(let r in nw.setTimeoutCallbacks){let n=nw.setTimeoutCallbacks[r];e-n.startedAtInMs>=n.timeoutInMs&&t.push(r)}for(let e of t)nw.setTimeoutCallbacks[e].callback(),delete nw.setTimeoutCallbacks[e]}}nw.setTimeoutCallbacks={};class nS{constructor(e,t){this.reportStatisticsResult=t,this.sampleCount=0,this.distributionBins=new Uint32Array(e)}processStarts(e,t,r,n){nw.tick(),this.suitableForThisSession(e,t,r,n)||this.reportAndResetSession(this.getStatistics(),e,n,t,r),this.start()}processEnds(){let e=performance.now()-this.frameProcessingStartedAt,t=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,e)));this.distributionBins[t]+=1,this.sampleCount+=1}getStatistics(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null}start(){this.frameProcessingStartedAt=performance.now()}suitableForThisSession(e,t,r,n){return this.currentSession&&this.currentSession.effectId===e&&this.currentSession.effectParam===n&&this.currentSession.frameWidth===t&&this.currentSession.frameHeight===r}reportAndResetSession(e,t,r,n,o){e&&this.reportStatisticsResult(e),this.resetCurrentSession(this.getNextTimeout(t,this.currentSession),t,r,n,o),this.timeoutId&&nw.clearTimeout(this.timeoutId),this.timeoutId=nw.setTimeout((()=>this.reportAndResetSession(this.getStatistics(),t,r,n,o)).bind(this),this.currentSession.timeoutInMs)}resetCurrentSession(e,t,r,n,o){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:e,effectId:t,effectParam:r,frameWidth:n,frameHeight:o},this.sampleCount=0,this.distributionBins.fill(0)}getNextTimeout(e,t){return t&&t.effectId===e?Math.min(nS.maxSessionTimeoutInMs,2*t.timeoutInMs):nS.initialSessionTimeoutInMs}}nS.initialSessionTimeoutInMs=1e3,nS.maxSessionTimeoutInMs=3e4;class nC{constructor(e){this.reportPerformanceEvent=e,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new nS(nC.distributionBinSize,e=>this.reportPerformanceEvent((0,eJ.N0)("v2","videoPerformanceMonitor.performanceDataGenerated"),"video.performance.performanceDataGenerated",[e]))}startMonitorSlowFrameProcessing(){nw.setInterval(()=>{if(0===this.processedFrameCount)return;let e=this.frameProcessingTimeCost/this.processedFrameCount;e>this.frameProcessTimeLimit&&this.reportPerformanceEvent((0,eJ.N0)("v2","videoPerformanceMonitor.startMonitorSlowFrameProcessing"),"video.performance.frameProcessingSlow",[e]),this.frameProcessingTimeCost=0,this.processedFrameCount=0},nC.calculateFPSInterval)}setFrameProcessTimeLimit(e){this.frameProcessTimeLimit=e}reportApplyingVideoEffect(e,t){var r,n;(null===(r=this.applyingEffect)||void 0===r?void 0:r.effectId)===e&&(null===(n=this.applyingEffect)||void 0===n?void 0:n.effectParam)===t||(this.applyingEffect={effectId:e,effectParam:t},this.appliedEffect=void 0)}reportVideoEffectChanged(e,t){void 0===this.applyingEffect||this.applyingEffect.effectId!==e&&this.applyingEffect.effectParam!==t||(this.appliedEffect={effectId:e,effectParam:t},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)}reportStartFrameProcessing(e,t){nw.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,e,t,this.appliedEffect.effectParam))}reportFrameProcessed(){var e;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent((0,eJ.N0)("v2","videoPerformanceMonitor.reportFrameProcessed"),"video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(e=this.appliedEffect)||void 0===e?void 0:e.effectParam])))}reportGettingTextureStream(e){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=e}reportTextureStreamAcquired(){if(void 0!==this.gettingTextureStreamStartedAt){let e=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent((0,eJ.N0)("v2","videoPerformanceMonitor.reportTextureStreamAcquired"),"video.performance.textureStreamAcquired",[this.currentStreamId,e])}}}nC.distributionBinSize=1e3,nC.calculateFPSInterval=1e3;let nI=(0,e8.Du)()?void 0:new nC(eZ.x3);function nk(e){if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nT())throw e0.qP;if(!e.videoFrameHandler||!e.videoBufferHandler)throw Error("Both videoFrameHandler and videoBufferHandler must be provided");if((0,tk.ik)((0,eJ.N0)("v2","videoEffects.setFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",e=>null==nI?void 0:nI.setFrameProcessTimeLimit(e.timeLimit),!1),nP())!function(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nT()||!nP())throw e0.qP;(0,tk.ik)((0,eJ.N0)("v2","videoEffects.startVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",t=>(0,td.s)(this,void 0,void 0,function*(){let{streamId:r}=t,n=function(e,t){return r=>(0,td.s)(this,void 0,void 0,function*(){let n=r.videoFrame;null==t||t.reportStartFrameProcessing(n.codedWidth,n.codedHeight);let o=yield e(r);return null==t||t.reportFrameProcessed(),o})}(e,nI);yield nR(r,n,nA,nI)}),!1),(0,eZ.x3)((0,eJ.N0)("v2","videoEffects.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[t])}(e.videoFrameHandler,e.config);else{if(!nO())throw e0.qP;!function(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nT()||!nO())throw e0.qP;(0,tk.ik)((0,eJ.N0)("v2","videoEffects.registerForVideoBufferHandler"),"video.newVideoFrame",t=>{if(t){let r=t.timestamp;null==nI||nI.reportStartFrameProcessing(t.width,t.height),e(function(e){if("videoFrameBuffer"in e)return e;{let{data:t}=e;return Object.assign(Object.assign({},(0,td.T)(e,["data"])),{videoFrameBuffer:t})}}(t),()=>{null==nI||nI.reportFrameProcessed(),(0,eZ.x3)((0,eJ.N0)("v2","videoEffects.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[r])},nA)}},!1),(0,eZ.x3)((0,eJ.N0)("v2","videoEffects.registerForVideoFrame"),"video.registerForVideoFrame",[t])}(e.videoBufferHandler,e.config)}null==nI||nI.startMonitorSlowFrameProcessing()}function nE(e,t){if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nT())throw e0.qP;(0,eZ.x3)((0,eJ.N0)("v2","videoEffects.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t])}function n_(e){if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nT())throw e0.qP;(0,tk.ik)((0,eJ.N0)("v2","videoEffects.registerEffectParameterChangeHandler"),"video.effectParameterChange",nB(e,nI),!1),(0,eZ.x3)((0,eJ.N0)("v2","videoEffects.registerForVideoEffect"),"video.registerForVideoEffect")}function nA(e){(0,eZ.x3)((0,eJ.N0)("v2","videoEffects.notifyError"),"video.notifyError",[e])}function nT(){return(0,eQ.Zn)(e1.fA)&&!!e1.fA.supports.video&&(!!e1.fA.supports.video.mediaStream||!!e1.fA.supports.video.sharedFrame)}function nP(){var e,t,r,n,o;return(0,eQ.Zn)(e1.fA,e0.E2.sidePanel)&&!(!(null===(r=null===(t=(0,e8.cg)().chrome)||void 0===t?void 0:t.webview)||void 0===r?void 0:r.getTextureStream)||!(null===(o=null===(n=(0,e8.cg)().chrome)||void 0===n?void 0:n.webview)||void 0===o?void 0:o.registerTextureStream))&&!!(null===(e=e1.fA.supports.video)||void 0===e?void 0:e.mediaStream)}function nO(){var e;return(0,eQ.Zn)(e1.fA,e0.E2.sidePanel)&&!!(null===(e=e1.fA.supports.video)||void 0===e?void 0:e.sharedFrame)}function nR(e,t,r,n){var o,i;return(0,td.s)(this,void 0,void 0,function*(){let a=nM();(0,e8.Du)()||null===(i=null===(o=window.chrome)||void 0===o?void 0:o.webview)||void 0===i||i.registerTextureStream(e,a),nN((yield nx(e,r,n)),new nF(r,t),a.writable)})}function nx(e,t,r){return(0,td.s)(this,void 0,void 0,function*(){if((0,e8.Du)())throw e0.qP;let n=(0,e8.cg)().chrome;try{null==r||r.reportGettingTextureStream(e);let t=(yield n.webview.getTextureStream(e)).getVideoTracks();if(0===t.length)throw Error(`No video track in stream ${e}`);return null==r||r.reportTextureStreamAcquired(),t[0]}catch(r){throw t(`Failed to get video track from stream ${e}, error: ${r}`),Error(`Internal error: can't get video track from stream ${e}`)}})}function nM(){if((0,e8.Du)())throw e0.qP;let e=window.MediaStreamTrackGenerator;if(!e)throw e0.qP;return new e({kind:"video"})}function nN(e,t,r){new(0,(0,e8.cg)().MediaStreamTrackProcessor)({track:e}).readable.pipeThrough(new TransformStream(t)).pipeTo(r)}(k||(k={})).NV12="NV12",function(e){e.EffectChanged="EffectChanged",e.EffectDisabled="EffectDisabled"}(E||(E={})),function(e){e.InvalidEffectId="InvalidEffectId",e.InitializationFailure="InitializationFailure"}(_||(_={}));class nF{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.transform=(e,t)=>(0,td.s)(this,void 0,void 0,function*(){let r=e.timestamp;if(null!==r)try{let n=yield this.videoFrameHandler({videoFrame:e}),o=new VideoFrame(n,{timestamp:r});t.enqueue(o),e.close(),n.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")})}}class nL{constructor(e,t){if(this.headerBuffer=e,this.notifyError=t,this.ONE_TEXTURE_INPUT_ID=0x6f746931,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(e),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),Error(this.UNSUPPORTED_LAYOUT_ERROR)}get oneTextureLayoutId(){return this.headerDataView[0]}get version(){return this.headerDataView[1]}get frameRowOffset(){return this.headerDataView[2]}get frameFormat(){return this.headerDataView[3]}get frameWidth(){return this.headerDataView[4]}get frameHeight(){return this.headerDataView[5]}get multiStreamHeaderRowOffset(){return this.headerDataView[6]}get multiStreamCount(){return this.headerDataView[7]}}class nz{constructor(e,t){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=0x31646961,this.ATTRIBUTE_ID_MAP_STREAM_ID=0x4d444941;let r=new Uint32Array(e);for(let n=0,o=0;n<t;n++){let t=r[o++],n=new Uint8Array(e,r[o++],r[o++]);this.metadataMap.set(t,n)}}get audioInferenceResult(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}get attributes(){let e=this.metadataMap.get(this.ATTRIBUTE_ID_MAP_STREAM_ID);if(void 0===e)return;let t=new Map,r=new TextDecoder("utf-8"),n=0,o=e[0]+(e[++n]<<8)+(e[++n]<<16)+(e[++n]<<24);for(let i=0;i<o&&n<e.length-1;i++){let o=e[++n]+(e[++n]<<8)+(e[++n]<<16)+(e[++n]<<24),i=e.findIndex((e,t,r)=>0==e&&t>n),a=r.decode(e.slice(++n,i)),s=this.metadataMap.get(o);void 0!==s&&t.set(a,s),n=i+(4-(i-n)%4-1)}return t}}class nD{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.shouldDiscardAudioInferenceResult=!1,this.transform=(e,t)=>(0,td.s)(this,void 0,void 0,function*(){let r=e.timestamp;if(null!==r)try{let{videoFrame:n,metadata:{audioInferenceResult:o,attributes:i}={}}=yield this.extractVideoFrameAndMetadata(e),a=yield this.videoFrameHandler({videoFrame:n,audioInferenceResult:o,attributes:i}),s=new VideoFrame(a,{timestamp:r});t.enqueue(s),n.close(),e.close(),a.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")}),this.extractVideoFrameAndMetadata=e=>(0,td.s)(this,void 0,void 0,function*(){if((0,e8.Du)())throw e0.qP;if("NV12"!==e.format)throw this.notifyError("Unsupported video frame pixel format"),Error("Unsupported video frame pixel format");let t={x:0,y:0,width:e.codedWidth,height:2},r=new ArrayBuffer(t.width*t.height*3/2);yield e.copyTo(r,{rect:t});let n=new nL(r,this.notifyError),o={x:0,y:n.multiStreamHeaderRowOffset,width:e.codedWidth,height:e.codedHeight-n.multiStreamHeaderRowOffset},i=new ArrayBuffer(o.width*o.height*3/2);yield e.copyTo(i,{rect:o});let a=new nz(i,n.multiStreamCount);return{videoFrame:new VideoFrame(e,{timestamp:e.timestamp,visibleRect:{x:0,y:n.frameRowOffset,width:n.frameWidth,height:n.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:a.audioInferenceResult,attributes:a.attributes}}}),(0,tk.ik)((0,eJ.N0)("v2","videoEffectsUtils.transformerWithMetadata.constructor"),"video.mediaStream.audioInferenceDiscardStatusChange",({discardAudioInferenceResult:e})=>{this.shouldDiscardAudioInferenceResult=e})}}function nB(e,t){return(r,n)=>{null==t||t.reportApplyingVideoEffect(r||"",n),e(r,n).then(()=>{null==t||t.reportVideoEffectChanged(r||"",n),(0,eZ.x3)((0,eJ.N0)("v2","videoEffectsUtils.reportVideoEffectChanged"),"video.videoEffectReadiness",[!0,r,void 0,n])}).catch(e=>{let t=e in _?e:_.InitializationFailure;(0,eZ.x3)((0,eJ.N0)("v2","videoEffectsUtils.effectFailure"),"video.videoEffectReadiness",[!1,r,t,n])})}}let nU=2e3,nH=(0,e8.Du)()?void 0:new nC(eZ.x3);function nq(e){var t,r;if(!nG())throw e0.qP;if(!e.videoFrameHandler||!e.videoBufferHandler)throw Error("Both videoFrameHandler and videoBufferHandler must be provided");if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel)){if((0,tk.ik)((0,eJ.N0)("v2","videoEffectsEX.registerSetFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",e=>null==nH?void 0:nH.setFrameProcessTimeLimit(e),!1),null===(t=e1.fA.supports.video)||void 0===t?void 0:t.mediaStream)(0,tk.ik)((0,eJ.N0)("v2","videoEffectsEX.registerStartVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",t=>(0,td.s)(this,void 0,void 0,function*(){let{streamId:r,metadataInTexture:n}=t,o=nH?function(e,t){return r=>(0,td.s)(this,void 0,void 0,function*(){let n=r.videoFrame;t.reportStartFrameProcessing(n.codedWidth,n.codedHeight);let o=nj(),i=yield e(r);return o(),t.reportFrameProcessed(),i})}(e.videoFrameHandler,nH):e.videoFrameHandler;n?yield function(e,t,r,n){var o,i;return(0,td.s)(this,void 0,void 0,function*(){let a=nM();(0,e8.Du)()||null===(i=null===(o=window.chrome)||void 0===o?void 0:o.webview)||void 0===i||i.registerTextureStream(e,a),nN((yield nx(e,r,n)),new nD(r,t),a.writable)})}(r,o,nK,nH):yield nR(r,o,nK,nH)}),!1),(0,eZ.x3)((0,eJ.N0)("v2","videoEffectsEX.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[e.config]);else{if(!(null===(r=e1.fA.supports.video)||void 0===r?void 0:r.sharedFrame))throw e0.qP;(0,tk.ik)((0,eJ.N0)("v2","videoEffectsEx.registerNewVideoFrameHandler"),"video.newVideoFrame",t=>{if(t){null==nH||nH.reportStartFrameProcessing(t.width,t.height);let r=nj(),n=t.timestamp;e.videoBufferHandler((t.videoFrameBuffer=t.videoFrameBuffer||t.data,delete t.data,t),()=>{r(),null==nH||nH.reportFrameProcessed(),(0,eZ.x3)((0,eJ.N0)("v2","videoEffectsEx.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[n])},nK)}},!1),(0,eZ.x3)((0,eJ.N0)("v2","videoEffectsEx.registerForVideoFrame"),"video.registerForVideoFrame",[e.config])}null==nH||nH.startMonitorSlowFrameProcessing()}}function nj(){let e=setTimeout(()=>{nK(`Frame not processed in ${nU}ms`,A.Warn)},nU);return function(){clearTimeout(e)}}function n$(e,t,r){if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nG())throw e0.qP;(0,eZ.x3)((0,eJ.N0)("v2","videoEffectsEx.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t,r])}function nW(e){if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nG())throw e0.qP;(0,tk.ik)((0,eJ.N0)("v2","videoEffectsEx.registerEffectParamterChangeHandler"),"video.effectParameterChange",nB(e,nH),!1),(0,eZ.x3)((0,eJ.N0)("v2","videoEffectsEx.registerForVideoEffect"),"video.registerForVideoEffect")}function nV(e){if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel),!nT())throw e0.qP;(0,eZ.x3)((0,eJ.N0)("v2","videoEffectsEx.updatePersonalizedEffects"),"video.personalizedEffectsChanged",[e])}function nG(){return(0,eQ.Zn)(e1.fA),nT()}function nK(e,t=A.Warn){(0,eZ.x3)((0,eJ.N0)("v2","videoEffectsEx.notifyError"),"video.notifyError",[e,t])}function nX(e){if((0,eQ.Zn)(e1.fA),!nT())throw e0.qP;nK(e,A.Fatal)}!function(e){e.Fatal="fatal",e.Warn="warn"}(A||(A={}));class nY extends e4.w{validate(e){return"ConfigurableTab"===e.tabType}deserialize(e){return e}}class nZ{constructor(e){this.configurableTabInstance=e}serialize(){return this.configurableTabInstance}}class nQ{constructor(e){this.hostEntityId=e}serialize(){return this.hostEntityId}}class nJ extends e4.w{validate(e){return"ConfigurableTab"===e.tabType||"StaticTab"===e.tabType}deserialize(e){return e}}class n0{constructor(e){this.hostEntityTabInstance=e}serialize(){return this.hostEntityTabInstance}}class n1 extends e4.w{validate(e){return e.allTabs&&e.allTabs.forEach(e=>{}),!0}deserialize(e){return e}}function n2(e,t){if((0,eQ.Zn)(e1.fA),!n8())throw Error(`Error code: ${t_.O4.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);if(n9(e.threadId),t&&0===t.length)throw Error(`Error code: ${t_.O4.INVALID_ARGUMENTS}, message: App types cannot be an empty array`);return(0,eZ.AR)("hostEntity.tab.addAndConfigure",[new nQ(e),t],new nJ,(0,eJ.N0)("v2","hostEntity.tab.addAndConfigure"))}function n3(e){if((0,eQ.Zn)(e1.fA),!n8())throw Error(`Error code: ${t_.O4.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return n9(e.threadId),(0,eZ.AR)("hostEntity.tab.getAll",[new nQ(e)],new n1,(0,eJ.N0)("v2","hostEntity.tab.getAll"))}function n5(e,t){if((0,eQ.Zn)(e1.fA),!n8())throw Error(`Error code: ${t_.O4.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return n7(e),n9(t.threadId),(0,eZ.AR)("hostEntity.tab.reconfigure",[new nZ(e),new nQ(t)],new nY,(0,eJ.N0)("v2","hostEntity.tab.reconfigure"))}function n6(e,t){if((0,eQ.Zn)(e1.fA),!n8())throw Error(`Error code: ${t_.O4.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return n7(e),n9(t.threadId),(0,eZ.AR)("hostEntity.tab.rename",[new nZ(e),new nQ(t)],new nY,(0,eJ.N0)("v2","hostEntity.tab.rename"))}function n4(e,t){if((0,eQ.Zn)(e1.fA),!n8())throw Error(`Error code: ${t_.O4.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return n9(t.threadId),n7(e),(0,eZ.AR)("hostEntity.tab.remove",[new n0(e),new nQ(t)],new e4.c,(0,eJ.N0)("v2","hostEntity.tab.remove"))}function n8(){var e;return!!((0,eQ.Zn)(e1.fA)&&oe()&&(null===(e=e1.fA.supports.hostEntity)||void 0===e?void 0:e.tab))}function n9(e){if(!e||0==e.length)throw Error(`Error code: ${t_.O4.INVALID_ARGUMENTS}, message: ThreadId cannot be null or empty`)}function n7(e){if(!(null==e?void 0:e.internalTabInstanceId)||0===e.internalTabInstanceId.length)throw Error(`Error code: ${t_.O4.INVALID_ARGUMENTS}, message: TabId cannot be null or empty`)}function oe(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.hostEntity)}function ot(e){let t=!e||e.length<=0,r=null==e?void 0:e.indexOf("@"),n=null==e?void 0:e.indexOf(".",r);if(t||-1===r||-1===n)throw Error("Input email address does not have the correct format.")}(T||(T={})).edu="EDU";class or{constructor(e){this.val=e,ot(e)}toString(){return this.val}}function on(){return e1.fA.hostVersionsInfo?e1.fA.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}class oo{postMessage(e,t){(0,eQ.Zn)(e1.fA),(0,eZ.x3)((0,eJ.N0)("v1","appWindow.childAppWindow.postMessage"),"messageForChild",[e],t||(0,e8._r)())}addEventListener(e,t){(0,eQ.Zn)(e1.fA),"message"===e&&(0,tk.ik)((0,eJ.N0)("v1","appWindow.childAppWindow.addEventListener"),"messageForParent",t)}}class oi{static get Instance(){return this._instance||(this._instance=new this)}postMessage(e,t){(0,eQ.Zn)(e1.fA,e0.E2.task),(0,eZ.x3)((0,eJ.N0)("v1","appWindow.parentAppWindow.postMessage"),"messageForParent",[e],t||(0,e8._r)())}addEventListener(e,t){(0,eQ.Zn)(e1.fA,e0.E2.task),"message"===e&&(0,tk.ik)((0,eJ.N0)("v1","appWindow.parentAppWindow.addEventListener"),"messageForChild",t)}}var oa=r(952095),os=r(58227),ol=r(894754);function oc(){if(!nf.Y.printCapabilityEnabled){if((0,eQ.Zn)(e1.fA),!om())throw e0.qP;nf.Y.printCapabilityEnabled=!0,document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(ou(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())})}}function ou(){(0,e8.cg)().print()}function od(e){of((0,eJ.N0)("v2","teamsAPIs_registerOnLoadHandler"),e,()=>{if(!(0,tE.h)(e)&&!om())throw e0.qP})}function of(e,t,r){(0,tE.h)(t)||(0,eQ.Zn)(e1.fA),!(0,tE.h)(t)&&r&&r(),(0,tk.H0)(e,t)}function oh(e){op((0,eJ.N0)("v2","teamsAPIs_registerBeforeUnloadHandler"),e,()=>{if(!(0,tE.h)(e)&&!om())throw e0.qP})}function op(e,t,r){(0,tE.h)(t)||(0,eQ.Zn)(e1.fA),!(0,tE.h)(t)&&r&&r(),(0,tk.wT)(e,t)}function om(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.teamsCore)}var og=r(944673);function ov(e,t){(0,os.yx)((0,eJ.N0)("v1","initialize"),t).then(()=>{e&&e()})}function ob(){oc()}function oy(){ou()}function ow(e){(0,eQ.UF)(),(0,eZ.x3)((0,eJ.N0)("v1","getContext"),"getContext",t=>{t.frameContext||(t.frameContext=nf.Y.frameContext),e(t)})}function oS(e){(0,os.ef)((0,eJ.N0)("v1","registerOnThemeChangeHandlerHelper"),e)}function oC(e){(0,tk.aY)((0,eJ.N0)("v1","registerFullScreenHandler"),"fullScreenChange",e,[])}function oI(e){(0,tk.aY)((0,eJ.N0)("v1","registerAppButtonClickHandler"),"appButtonClick",e,[e0.E2.content])}function ok(e){(0,tk.aY)((0,eJ.N0)("v1","registerAppButtonHoverEnterHandler"),"appButtonHoverEnter",e,[e0.E2.content])}function oE(e){(0,tk.aY)((0,eJ.N0)("v1","registerAppButtonHoverLeaveHandler"),"appButtonHoverLeave",e,[e0.E2.content])}function o_(e){(0,og.registerBackButtonHandlerHelper)((0,eJ.N0)("v1","registerBackButtonHandler"),e)}function oA(e){of((0,eJ.N0)("v1","registerOnLoadHandler"),e)}function oT(e){op((0,eJ.N0)("v1","registerBeforeUnloadHandler"),e)}function oP(e){(0,tk.aY)((0,eJ.N0)("v1","registerFocusEnterHandler"),"focusEnter",e,[])}function oO(e){(0,tk.aY)((0,eJ.N0)("v1","registerChangeSettingsHandler"),"changeSettings",e,[e0.E2.content])}function oR(e,t){(0,eQ.Zn)(e1.fA),(0,ol.Sd)((0,eJ.N0)("v1","getTabInstances"),t).then(t=>{e(t)})}function ox(e,t){(0,eQ.Zn)(e1.fA),(0,ol.Gt)((0,eJ.N0)("v1","getMruTabInstances"),t).then(t=>{e(t)})}function oM(e){(0,ol.ex)((0,eJ.N0)("v1","shareDeepLink"),{subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function oN(e,t){(0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.sidePanel,e0.E2.settings,e0.E2.task,e0.E2.stage,e0.E2.meetingStage);let r=null!=t?t:(0,e8._r)();(0,os.Jc)((0,eJ.N0)("v1","executeDeepLink"),e).then(()=>{r(!0)}).catch(e=>{r(!1,e.message)})}function oF(e){(0,ol.Hp)((0,eJ.N0)("v1","setFrameContext"),e)}function oL(e,t,r){(0,os.yx)((0,eJ.N0)("v1","initializeWithFrameContext"),r).then(()=>t&&t()),(0,ol.Hp)((0,eJ.N0)("v1","setFrameContext"),e)}function oz(e){(0,ol.Lv)((0,eJ.N0)("v1","navigation.returnFocus"),e)}function oD(e,t){(0,eQ.Zn)(e1.fA);let r=null!=t?t:(0,e8._r)();(0,ol.K5)((0,eJ.N0)("v1","navigation.navigateToTab"),e).then(()=>{r(!0)}).catch(e=>{r(!1,e.message)})}function oB(e,t){(0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.sidePanel,e0.E2.settings,e0.E2.remove,e0.E2.task,e0.E2.stage,e0.E2.meetingStage);let r=null!=t?t:(0,e8._r)();(0,ol.Gx)((0,eJ.N0)("v1","navigation.navigateCrossDomain"),e).then(()=>{r(!0)}).catch(e=>{r(!1,e.message)})}function oU(e){(0,eQ.Zn)(e1.fA);let t=null!=e?e:(0,e8._r)();(0,ol.Gb)((0,eJ.N0)("v1","navigation.navigateBack")).then(()=>{t(!0)}).catch(e=>{t(!1,e.message)})}var oH=r(416835);function oq(){return!(!(0,eQ.Zn)(e1.fA,e0.E2.meetingStage,e0.E2.sidePanel,e0.E2.content)||!e1.fA.supports.interactive)}(function(e){e.guest="Guest",e.attendee="Attendee",e.presenter="Presenter",e.organizer="Organizer"})(P||(P={})),function(e){e.added="Added",e.alreadyExists="AlreadyExists",e.conflict="Conflict",e.notFound="NotFound"}(O||(O={}));class oj{getFluidTenantInfo(){return o$(),new Promise(e=>{e((0,eZ.gV)((0,eJ.N0)("v2","interactive.getFluidTenantInfo"),"interactive.getFluidTenantInfo"))})}getFluidToken(e){return o$(),new Promise(t=>{t((0,eZ.gV)((0,eJ.N0)("v2","interactive.getFluidToken"),"interactive.getFluidToken",e))})}getFluidContainerId(){return o$(),new Promise(e=>{e((0,eZ.gV)((0,eJ.N0)("v2","interactive.getFluidContainerId"),"interactive.getFluidContainerId"))})}setFluidContainerId(e){return o$(),new Promise(t=>{t((0,eZ.gV)((0,eJ.N0)("v2","interactive.setFluidContainerId"),"interactive.setFluidContainerId",e))})}getNtpTime(){return o$(),new Promise(e=>{e((0,eZ.gV)((0,eJ.N0)("v2","interactive.getNtpTime"),"interactive.getNtpTime"))})}registerClientId(e){return o$(),new Promise(t=>{t((0,eZ.gV)((0,eJ.N0)("v2","interactive.registerClientId"),"interactive.registerClientId",e))})}getClientRoles(e){return o$(),new Promise(t=>{t((0,eZ.gV)((0,eJ.N0)("v2","interactive.getClientRoles"),"interactive.getClientRoles",e))})}getClientInfo(e){return o$(),new Promise(t=>{t((0,eZ.gV)((0,eJ.N0)("v2","interactive.getClientInfo"),"interactive.getClientInfo",e))})}static create(){return o$(),new oj}}function o$(){if(!oq())throw Error("LiveShareHost Not supported")}let oW="users";function oV(e,t,r){if(0===e.length)throw Error("Must have at least one user when creating a chat deep link");let n=`${oW}=`+e.map(e=>encodeURIComponent(e)).join(","),o=void 0===t?"":`&topicName=${encodeURIComponent(t)}`,i=void 0===r?"":`&message=${encodeURIComponent(r)}`;return`${nd.F1}://${nd.$p}/l/chat/0/0?${n}${o}${i}`}function oG(e){return new Promise(t=>{if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.sidePanel,e0.E2.settings,e0.E2.task,e0.E2.stage,e0.E2.meetingStage),!oK())throw Error("Not supported");let r=(0,eJ.N0)("v1","appInstallDialog.openAppInstallDialog");e1.fA.isLegacyTeams?t((0,eZ.Vi)(r,"executeDeepLink",function(e){if(!e)throw Error("App ID must be set when creating an app install dialog deep link");return`${nd.F1}://${nd.$p}/l/app/${encodeURIComponent(e)}`}(e.appId))):((0,eZ.x3)(r,"appInstallDialog.openAppInstallDialog",[e]),t())})}function oK(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.appInstallDialog)}var oX=r(65311);function oY(e){return new Promise(t=>{if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!oJ())throw e0.qP;if(!(0,oX.Sr)(e))throw{errorCode:t_.O4.INVALID_ARGUMENTS};t((0,eZ.gV)((0,eJ.N0)("v2","barCode.scanBarCode"),"media.scanBarCode",e))})}function oZ(){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!oJ())throw e0.qP;let e=t_.mW.Media;return new Promise(t=>{t((0,eZ.gV)((0,eJ.N0)("v2","barCode.hasPermission"),"permissions.has",e))})}function oQ(){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!oJ())throw e0.qP;let e=t_.mW.Media;return new Promise(t=>{t((0,eZ.gV)((0,eJ.N0)("v2","barCode.requestPermission"),"permissions.request",e))})}function oJ(){return!!((0,eQ.Zn)(e1.fA)&&e1.fA.supports.barCode&&e1.fA.supports.permissions)}function o0(e){return o1((0,eJ.N0)("v2","chat.openChat"),e)}function o1(e,t){return new Promise(r=>{if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!o3())throw e0.qP;r(e1.fA.isLegacyTeams?(0,eZ.Vi)(e,"executeDeepLink",oV([t.user],void 0,t.message)):(0,eZ.Vi)(e,"chat.openChat",{members:[t.user],message:t.message}))})}function o2(e){let t=(0,eJ.N0)("v2","chat.openGroupChat");return new Promise(r=>{if(e.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===e.users.length)r(o1(t,{user:e.users[0],message:e.message}));else{if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!o3())throw e0.qP;r(e1.fA.isLegacyTeams?(0,eZ.Vi)(t,"executeDeepLink",oV(e.users,e.topic,e.message)):(0,eZ.Vi)(t,"chat.openChat",{members:e.users,message:e.message,topic:e.topic}))}})}function o3(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.chat)}function o5(e){return(0,td.s)(this,void 0,void 0,function*(){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.meetingStage,e0.E2.task,e0.E2.settings,e0.E2.stage,e0.E2.sidePanel),!o4())throw e0.qP;if(!e.type||!Object.values(t_.j5).includes(e.type))throw Error(`Blob type ${e.type} is not supported. Supported blob types are ${Object.values(t_.j5)}`);let t=yield(0,e8._T)(e),r={mimeType:e.type,content:t};return(0,eZ.gV)((0,eJ.N0)("v2","clipboard.write"),"clipboard.writeToClipboard",r)})}function o6(){return(0,td.s)(this,void 0,void 0,function*(){(0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.meetingStage,e0.E2.task,e0.E2.settings,e0.E2.stage,e0.E2.sidePanel);let e=(0,eJ.N0)("v2","clipboard.read");if(!o4())throw e0.qP;let t=yield(0,eZ.gV)(e,"clipboard.readFromClipboard");if("string"==typeof t){let e=JSON.parse(t);return(0,e8.i)(e.mimeType,e.content)}return t})}function o4(){return nf.Y.isFramelessWindow?!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.clipboard):!!((0,eQ.Zn)(e1.fA)&&navigator&&navigator.clipboard&&e1.fA.supports.clipboard)}var o8=r(226646),o9=r(34423);function o7(){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!it())throw e0.qP;return(0,eZ.gV)((0,eJ.N0)("v2","geoLocation.map.chooseLocation"),"location.getLocation",{allowChooseLocation:!0,showMap:!0})}function ie(e){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!it())throw e0.qP;if(!e)throw{errorCode:t_.O4.INVALID_ARGUMENTS};return(0,eZ.gV)((0,eJ.N0)("v2","geoLocation.showLocation"),"location.showLocation",e)}function it(){return!!((0,eQ.Zn)(e1.fA)&&e1.fA.supports.geoLocation&&e1.fA.supports.geoLocation.map&&e1.fA.supports.permissions)}function ir(){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!ia())throw e0.qP;return(0,eZ.gV)((0,eJ.N0)("v2","geoLocation.getCurrentLocation"),"location.getLocation",{allowChooseLocation:!1,showMap:!1})}function io(){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!ia())throw e0.qP;let e=t_.mW.GeoLocation;return new Promise(t=>{t((0,eZ.gV)((0,eJ.N0)("v2","geoLocation.hasPermission"),"permissions.has",e))})}function ii(){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!ia())throw e0.qP;let e=t_.mW.GeoLocation;return new Promise(t=>{t((0,eZ.gV)((0,eJ.N0)("v2","geoLocation.requestPermission"),"permissions.request",e))})}function ia(){return!!((0,eQ.Zn)(e1.fA)&&e1.fA.supports.geoLocation&&e1.fA.supports.permissions)}var is=r(50607),il=r(919607);function ic(e){if((0,eQ.Zn)(e1.fA,e0.E2.content),!iu())throw e0.qP;if(!e||!(0,e8.fG)(e))throw{errorCode:t_.O4.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return(0,eZ.gV)((0,eJ.N0)("v2","secondaryBrowser.openUrl"),"secondaryBrowser.open",e.toString())}function iu(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.secondaryBrowser)}function id(e,t){if(!t)throw Error("[location.getLocation] Callback cannot be null");if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!(0,eQ.wT)(nd.s_))throw{errorCode:t_.O4.OLD_PLATFORM};if(!e)throw{errorCode:t_.O4.INVALID_ARGUMENTS};if(!ip())throw e0.qP;(0,eZ.x3)((0,eJ.N0)("v1","location.getLocation"),"location.getLocation",[e],t)}function ih(e,t){if(!t)throw Error("[location.showLocation] Callback cannot be null");if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!(0,eQ.wT)(nd.s_))throw{errorCode:t_.O4.OLD_PLATFORM};if(!e)throw{errorCode:t_.O4.INVALID_ARGUMENTS};if(!ip())throw e0.qP;(0,eZ.x3)((0,eJ.N0)("v1","location.showLocation"),"location.showLocation",[e],t)}function ip(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.location)}function im(e){(0,eQ.Zn)(e1.fA,e0.E2.sidePanel),e.contentUrl&&new URL(e.contentUrl),(0,eZ.x3)((0,eJ.N0)("v1","meeting.appShareButton.setOptions"),"meeting.appShareButton.setOptions",[e])}function ig(e){if(!e)throw Error("[get incoming client audio state] Callback cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage),(0,eZ.x3)((0,eJ.N0)("v1","meeting.getIncomingClientAudioState"),"getIncomingClientAudioState",e)}function iv(e){if(!e)throw Error("[toggle incoming client audio] Callback cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage),(0,eZ.x3)((0,eJ.N0)("v1","meeting.toggleIncomingClientAudio"),"toggleIncomingClientAudio",e)}function ib(e){if(!e)throw Error("[get meeting details] Callback cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage,e0.E2.settings,e0.E2.content),(0,eZ.x3)((0,eJ.N0)("v1","meeting.getMeetingDetails"),"meeting.getMeetingDetails",e)}function iy(){var e,t,r;return(0,td.s)(this,void 0,void 0,function*(){let n;(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage,e0.E2.settings,e0.E2.content);try{n=yield(0,eZ.gV)((0,eJ.N0)("v2","meeting.getMeetingDetailsVerbose"),"meeting.getMeetingDetails",!0)}catch(t){throw Error(null===(e=null==t?void 0:t.errorCode)||void 0===e?void 0:e.toString())}if(((null===(t=n.details)||void 0===t?void 0:t.type)==N.GroupCall||(null===(r=n.details)||void 0===r?void 0:r.type)==N.OneOnOneCall)&&!n.details.originalCallerInfo)throw Error(t_.O4.NOT_SUPPORTED_ON_PLATFORM.toString());return n})}function iw(e){if(!e)throw Error("[get Authentication Token For AnonymousUser] Callback cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage,e0.E2.task),(0,eZ.x3)((0,eJ.N0)("v1","meeting.getAuthenticationTokenForAnonymousUser"),"meeting.getAuthenticationTokenForAnonymousUser",e)}function iS(e){if(!e)throw Error("[get live stream state] Callback cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel),(0,eZ.x3)((0,eJ.N0)("v1","meeting.getLiveStreamState"),"meeting.getLiveStreamState",e)}function iC(e,t,r){if(!e)throw Error("[request start live streaming] Callback cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel),(0,eZ.x3)((0,eJ.N0)("v1","meeting.requestStartLiveStreaming"),"meeting.requestStartLiveStreaming",[t,r],e)}function iI(e){if(!e)throw Error("[request stop live streaming] Callback cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel),(0,eZ.x3)((0,eJ.N0)("v1","meeting.requestStopLiveStreaming"),"meeting.requestStopLiveStreaming",e)}function ik(e){if(!e)throw Error("[register live stream changed handler] Handler cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel),(0,tk.ik)((0,eJ.N0)("v1","meeting.registerLiveStreamChangedHandler"),"meeting.liveStreamChanged",e)}function iE(e,t,r={sharingProtocol:F.Collaborative}){if(!e)throw Error("[share app content to stage] Callback cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage),(0,eZ.x3)((0,eJ.N0)("v1","meeting.shareAppContentToStage"),"meeting.shareAppContentToStage",[t,r],e)}function i_(e){if(!e)throw Error("[get app content stage sharing capabilities] Callback cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage),(0,eZ.x3)((0,eJ.N0)("v1","meeting.getAppContentStageSharingCapabilities"),"meeting.getAppContentStageSharingCapabilities",e)}function iA(e){if(!e)throw Error("[stop sharing app content to stage] Callback cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage),(0,eZ.x3)((0,eJ.N0)("v1","meeting.stopSharingAppContentToStage"),"meeting.stopSharingAppContentToStage",e)}function iT(e){if(!e)throw Error("[get app content stage sharing state] Callback cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage),(0,eZ.x3)((0,eJ.N0)("v1","meeting.getAppContentStageSharingState"),"meeting.getAppContentStageSharingState",e)}function iP(e){if(!e)throw Error("[registerSpeakingStateChangeHandler] Handler cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage),(0,tk.ik)((0,eJ.N0)("v1","meeting.registerSpeakingStateChangeHandler"),"meeting.speakingStateChanged",e)}function iO(e){if(!e)throw Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage),(0,tk.ik)((0,eJ.N0)("v1","meeting.registerRaiseHandStateChangedHandler"),"meeting.raiseHandStateChanged",e)}function iR(e){if(!e)throw Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage),(0,tk.ik)((0,eJ.N0)("v1","meeting.registerMeetingReactionReceivedHandler"),"meeting.meetingReactionReceived",e)}function ix(e){if(void 0===(null==e?void 0:e.joinWebUrl)||null===(null==e?void 0:e.joinWebUrl))return Promise.reject(Error("Invalid joinMeetingParams"));(0,eQ.Zn)(e1.fA);let t={joinWebUrl:e.joinWebUrl.href,source:e.source||L.Other};return(0,eZ.gV)((0,eJ.N0)("v2","meeting.joinMeeting"),"meeting.joinMeeting",t)}function iM(e,t){if(!t)throw Error("[requestAppAudioHandling] Callback response cannot be null");if(!e.micMuteStateChangedCallback)throw Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage),e.isAppHandlingAudio?function(e,t){(0,eZ.x3)((0,eJ.N0)("v1","meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],(r,n)=>{if(r&&null!=n)throw Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(r)throw Error(`[requestAppAudioHandling] Callback response - SDK error ${r.errorCode} ${r.message}`);if("boolean"!=typeof n)throw Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");(0,tk.ik)((0,eJ.N0)("v1","meeting.registerMicStateChangeHandler"),"meeting.micStateChanged",t=>(0,td.s)(this,void 0,void 0,function*(){try{let r=yield e.micMuteStateChangedCallback(t);iF(r,r.isMicMuted===t.isMicMuted?R.HostInitiated:R.AppDeclinedToChange)}catch(e){iF(t,R.AppFailedToChange)}})),(0,tk.ik)((0,eJ.N0)("v1","meeting.registerAudioDeviceSelectionChangedHandler"),"meeting.audioDeviceSelectionChanged",t=>{var r;null===(r=e.audioDeviceSelectionChangedCallback)||void 0===r||r.call(e,t)}),t(n)})}(e,t):(0,eZ.x3)((0,eJ.N0)("v1","meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],(e,r)=>{if(e&&null!=r)throw Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(e)throw Error(`[requestAppAudioHandling] Callback response - SDK error ${e.errorCode} ${e.message}`);if("boolean"!=typeof r)throw Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");(0,tk.bo)("meeting.micStateChanged")&&(0,tk.Vl)("meeting.micStateChanged"),(0,tk.bo)("meeting.audioDeviceSelectionChanged")&&(0,tk.Vl)("meeting.audioDeviceSelectionChanged"),t(r)})}function iN(e){iF(e,R.AppInitiated)}function iF(e,t){(0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage),(0,eZ.x3)((0,eJ.N0)("v1","meeting.setMicStateWithReason"),"meeting.updateMicState",[e,t])}function iL(e,t){let r,n,o="";return"function"==typeof e?(r=e,n=t,o=(0,eJ.N0)("v1","monetization.openPurchaseExperience")):(n=e,o=(0,eJ.N0)("v2","monetization.openPurchaseExperience")),(0,eQ.Zn)(e1.fA,e0.E2.content),(0,e8.rn)(()=>new Promise(e=>{if(!iz())throw e0.qP;e((0,eZ.gV)(o,"monetization.openPurchaseExperience",n))}),r)}function iz(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.monetization)}function iD(e){return new Promise(t=>{if((0,eQ.Zn)(e1.fA,e0.E2.content),!iU())throw Error("Not supported");if(!e.itemId||!e.itemId.trim())throw Error("Must supply an itemId to openCalendarItem");t((0,eZ.Vi)((0,eJ.N0)("v2","calendar.openCalendarItem"),"calendar.openCalendarItem",e))})}function iB(e){return new Promise(t=>{if((0,eQ.Zn)(e1.fA,e0.E2.content),!iU())throw Error("Not supported");let r=(0,eJ.N0)("v2","calendar.composeMeeting");t(e1.fA.isLegacyTeams?(0,eZ.Vi)(r,"executeDeepLink",function(e,t,r,n,o){let i=void 0===e?"":"attendees="+e.map(e=>encodeURIComponent(e)).join(","),a=void 0===t?"":`&startTime=${encodeURIComponent(t)}`,s=void 0===r?"":`&endTime=${encodeURIComponent(r)}`,l=void 0===n?"":`&subject=${encodeURIComponent(n)}`,c=void 0===o?"":`&content=${encodeURIComponent(o)}`;return`${nd.F1}://${nd.$p}/l/meeting/new?${i}${a}${s}${l}${c}`}(e.attendees,e.startTime,e.endTime,e.subject,e.content)):(0,eZ.Vi)(r,"calendar.composeMeeting",e))})}function iU(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.calendar)}function iH(e){e&&0!==e.length&&e.forEach(e=>{ot(e)})}function iq(e){if((0,eQ.Zn)(e1.fA,e0.E2.content),!ij())throw Error("Not supported");return function(e){if(!e.handoffId||0==e.handoffId.trim().length||""===e.handoffId.trim())throw Error("handoffId should not be null or empty string.");let t=e.composeMailParams;t.type===z.New&&(iH(t.toRecipients),iH(t.ccRecipients),iH(t.bccRecipients))}(e),(0,eZ._s)("mail.handoff.composeMail",[new i$(e)],(0,eJ.N0)("v2","mail.handoff.composeMail"))}function ij(){return!!((0,eQ.Zn)(e1.fA)&&e1.fA.supports.mail&&e1.fA.supports.mail.handoff)}(function(e){e[e.HostInitiated=0]="HostInitiated",e[e.AppInitiated=1]="AppInitiated",e[e.AppDeclinedToChange=2]="AppDeclinedToChange",e[e.AppFailedToChange=3]="AppFailedToChange"})(R||(R={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(x||(x={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(M||(M={})),function(e){e.OneOnOneCall="oneOnOneCall",e.GroupCall="groupCall"}(N||(N={})),function(e){e.Collaborative="Collaborative",e.ScreenShare="ScreenShare"}(F||(F={})),function(e){e.M365CalendarGridContextMenu="m365_calendar_grid_context_menu",e.M365CalendarGridPeek="m365_calendar_grid_peek",e.M365CalendarGridEventCardJoinButton="m365_calendar_grid_event_card_join_button",e.M365CalendarFormRibbonJoinButton="m365_calendar_form_ribbon_join_button",e.M365CalendarFormJoinTeamsMeetingButton="m365_calendar_form_join_teams_meeting_button",e.Other="other"}(L||(L={}));class i${constructor(e){this.composeMailParamsWithHandoff=e}serialize(){return this.composeMailParamsWithHandoff}}function iW(e){return new Promise(t=>{if((0,eQ.Zn)(e1.fA,e0.E2.content),!iG())throw Error("Not supported");if(!e.itemId||!e.itemId.trim())throw Error("Must supply an itemId to openMailItem");t((0,eZ.Vi)((0,eJ.N0)("v2","mail.openMailItem"),"mail.openMailItem",e))})}function iV(e){return new Promise(t=>{if((0,eQ.Zn)(e1.fA,e0.E2.content),!iG())throw Error("Not supported");t((0,eZ.Vi)((0,eJ.N0)("v2","mail.composeMail"),"mail.composeMail",e))})}function iG(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.mail)}function iK(e,t){let r,n;(0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task,e0.E2.settings);let o="";return"function"==typeof e?([r,n]=[e,t],o=(0,eJ.N0)("v1","people.selectPeople")):(n=e,o=(0,eJ.N0)("v2","people.selectPeople")),(0,e8.Tz)(iX,r,o,n)}function iX(e,t){return new Promise(r=>{if(!(0,eQ.wT)(nd.rs))throw{errorCode:t_.O4.OLD_PLATFORM};if(!(0,oX.sq)(t))throw{errorCode:t_.O4.INVALID_ARGUMENTS};if(!iY())throw e0.qP;r((0,eZ.gV)(e,"people.selectPeople",t))})}function iY(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.people)}function iZ(e){return(0,eQ.Zn)(e1.fA,e0.E2.content),new Promise(t=>{var r;let[n,o]=e?e.modality&&"string"!=typeof e.modality?[!1,"modality must be a string"]:e.targetElementBoundingRect&&"object"==typeof e.targetElementBoundingRect?e.triggerType&&"string"==typeof e.triggerType?(r=e.persona)?r.displayName&&"string"!=typeof r.displayName?[!1,"displayName must be a string"]:r.identifiers&&"object"==typeof r.identifiers?r.identifiers.AadObjectId||r.identifiers.Smtp||r.identifiers.Upn?r.identifiers.AadObjectId&&"string"!=typeof r.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:r.identifiers.Smtp&&"string"!=typeof r.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:r.identifiers.Upn&&"string"!=typeof r.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]:[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"];if(!n)throw{errorCode:t_.O4.INVALID_ARGUMENTS,message:o};let i={modality:e.modality,persona:e.persona,triggerType:e.triggerType,targetRectangle:{x:e.targetElementBoundingRect.x,y:e.targetElementBoundingRect.y,width:e.targetElementBoundingRect.width,height:e.targetElementBoundingRect.height}};t((0,eZ.gV)((0,eJ.N0)("v2","profile.showProfile"),"profile.showProfile",i))})}function iQ(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.profile)}!function(e){e.New="new",e.Reply="reply",e.ReplyAll="replyAll",e.Forward="forward"}(z||(z={}));let iJ="search.queryChange",i0="search.queryClose",i1="search.queryExecute";function i2(e,t,r){if((0,eQ.Zn)(e1.fA,e0.E2.content),!i5())throw e0.qP;(0,tk.ik)((0,eJ.N0)("v2","search.registerOnClosedHandler"),i0,e),(0,tk.ik)((0,eJ.N0)("v2","search.registerOnExecutedHandler"),i1,t),r&&(0,tk.ik)((0,eJ.N0)("v2","search.registerOnChangeHandler"),iJ,r)}function i3(){if((0,eQ.Zn)(e1.fA,e0.E2.content),!i5())throw e0.qP;(0,eZ.x3)((0,eJ.N0)("v2","search.unregisterHandlers"),"search.unregister"),(0,tk.Vl)(iJ),(0,tk.Vl)(i0),(0,tk.Vl)(i1)}function i5(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.search)}function i6(){return new Promise(e=>{if((0,eQ.Zn)(e1.fA,e0.E2.content),!i5())throw Error("Not supported");e((0,eZ.Vi)((0,eJ.N0)("v2","search.closeSearch"),"search.closeSearch"))})}function i4(){return(0,td.s)(this,void 0,void 0,function*(){if((0,eQ.Zn)(e1.fA,e0.E2.sidePanel,e0.E2.meetingStage),!i8())throw e0.qP;return yield(0,eZ.gV)((0,eJ.N0)("v2","sharing.history.getContent"),"sharing.history.getContent")})}function i8(){var e;return(0,eQ.Zn)(e1.fA)&&void 0!==(null===(e=e1.fA.supports.sharing)||void 0===e?void 0:e.history)}let i9={shareWebContent:"sharing.shareWebContent"};function i7(e,t){try{(function(e){if(!(e&&e.content&&e.content.length))throw{errorCode:t_.O4.INVALID_ARGUMENTS,message:"Shared content is missing"}})(e),function(e){if(e.content.some(e=>!e.type))throw{errorCode:t_.O4.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(e.content.some(t=>t.type!==e.content[0].type))throw{errorCode:t_.O4.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}(e),function(e){if("URL"!==e.content[0].type)throw{errorCode:t_.O4.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(e.content.some(e=>!e.url))throw{errorCode:t_.O4.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}(e)}catch(e){return(0,e8.nF)(()=>Promise.reject(e),t)}(0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.sidePanel,e0.E2.task,e0.E2.stage,e0.E2.meetingStage);let r=(0,eJ.N0)(t?"v1":"v2","sharing.shareWebContent");return(0,e8.nF)(ae,t,r,e)}function ae(e,t){return new Promise(r=>{if(!at())throw e0.qP;r((0,eZ.gV)(e,i9.shareWebContent,t))})}function at(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.sharing)}function ar(){return new Promise(e=>{if((0,eQ.Zn)(e1.fA,e0.E2.content),!an())throw e0.qP;e((0,eZ.gV)((0,eJ.N0)("v2","stageView.self.close"),"stageView.self.close"))})}function an(){var e;return(0,eQ.Zn)(e1.fA)&&void 0!==(null===(e=e1.fA.supports.stageView)||void 0===e?void 0:e.self)}function ao(e){return new Promise(t=>{if((0,eQ.Zn)(e1.fA,e0.E2.content),!ai())throw e0.qP;if(!e)throw Error("[stageView.open] Stage view params cannot be null");t((0,eZ.gV)((0,eJ.N0)("v2","stageView.open"),"stageView.open",e))})}function ai(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.stageView)}function aa(e){return(0,td.s)(this,void 0,void 0,function*(){(0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),ac(),au(e);let t=yield(0,eZ.gV)((0,eJ.N0)("v2","visualMedia.image.captureImages"),"visualMedia.image.captureImages",e);return ad(e.maxVisualMediaCount,t),t})}function as(e){return(0,td.s)(this,void 0,void 0,function*(){(0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),ac(),au(e);let t=yield(0,eZ.gV)((0,eJ.N0)("v2","visualMedia.image.retrieveImages"),"visualMedia.image.retrieveImages",e);return ad(e.maxVisualMediaCount,t),t})}function al(){return!!((0,eQ.Zn)(e1.fA)&&e1.fA.supports.visualMedia&&e1.fA.supports.visualMedia.image&&e1.fA.supports.permissions)}function ac(){if(!al())throw e0.qP}function au(e){if(!e||e.maxVisualMediaCount>10||e.maxVisualMediaCount<1)throw e0.JD}function ad(e,t){if(t.length>e)throw e0.P4}function af(){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!al())throw e0.qP;let e=t_.mW.Media;return(0,eZ.gV)((0,eJ.N0)("v2","visualMedia.hasPermission"),"permissions.has",e)}function ah(){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!al())throw e0.qP;let e=t_.mW.Media;return(0,eZ.gV)((0,eJ.N0)("v2","visualMedia.requestPermission"),"permissions.request",e)}(function(e){e.modal="modal",e.popout="popout",e.popoutWithChat="popoutWithChat"})(D||(D={})),function(e){e[e.FrontOrRear=1]="FrontOrRear",e[e.FrontOnly=2]="FrontOnly",e[e.RearOnly=3]="RearOnly"}(B||(B={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(U||(U={}));let ap=null;function am(){return(0,td.s)(this,void 0,void 0,function*(){if((0,eQ.Zn)(e1.fA),!ag())throw e0.qP;return!(!e1.fA.isLegacyTeams||nf.Y.hostClientType!==e0.WK.android&&nf.Y.hostClientType!==e0.WK.ios&&nf.Y.hostClientType!==e0.WK.ipados&&nf.Y.hostClientType!==e0.WK.visionOS||(yield function(){return(0,td.s)(this,void 0,void 0,function*(){return function(){return(0,td.s)(this,void 0,void 0,function*(){return null===ap&&(ap=(yield(0,tx.getContext)()).app.host.name),ap})}()})}())!==e0.yA.teams)||(yield(0,eZ.j0)((0,eJ.N0)("v2","webStorage.isWebStorageClearedOnUserLogOut"),"webStorage.isWebStorageClearedOnUserLogOut"))})}function ag(){return(0,eQ.Zn)(e1.fA)&&void 0!==e1.fA.supports.webStorage}function av(e){let t=(0,eJ.N0)("v2","call.startCall");return new Promise(r=>{var n;if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!ab())throw e0.qP;if(!e1.fA.isLegacyTeams)return(0,eZ.x3)(t,"call.startCall",[e],r);r((0,eZ.j0)(t,"executeDeepLink",function(e,t,r){if(0===e.length)throw Error("Must have at least one target when creating a call deep link");let n=`${oW}=`+e.map(e=>encodeURIComponent(e)).join(","),o=void 0===t?"":`&withVideo=${encodeURIComponent(t)}`,i=void 0===r?"":`&source=${encodeURIComponent(r)}`;return`${nd.F1}://${nd.$p}/l/call/0/0?${n}${o}${i}`}(e.targets,null===(n=e.requestedModalities)||void 0===n?void 0:n.includes(H.Video),e.source)).then(e=>{if(!e)throw Error(nd.H0);return e}))})}function ab(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.call)}function ay(){(0,os.Y_)((0,eJ.N0)("v1","appInitialization.notifyAppLoaded"))}function aw(){(0,eZ.x3)((0,eJ.N0)("v1","appInitialization.notifySuccess"),tx.Messages.Success,[oa.r])}function aS(e){(0,os.s_)((0,eJ.N0)("v1","appInitialization.notifyFailure"),e)}function aC(e){(0,os.S7)((0,eJ.N0)("v1","appInitialization.notifyExpectedFailure"),e)}!function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"}(H||(H={}));let aI=(0,eJ.tZ)("thirdPartyCloudStorage");class ak{constructor(e,t){this.fileType=e,this.assembleAttachment=t}}let aE=[],a_=null,aA=!0,aT=null;function aP(e,t){if(!t)throw Error("[getDragAndDropFiles] Callback cannot be null");if(e&&""!==e){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!aR())throw e0.qP;if(aT)throw aT=null,Error("getDragAndDropFiles cannot be called twice");aT=t,aA=!0,(0,eZ.x3)((0,eJ.N0)("v2","thirdPartyCloudStorage.getDragAndDropFiles"),"thirdPartyCloudStorage.getDragAndDropFiles",[e],aO)}else t([],{errorCode:t_.O4.INVALID_ARGUMENTS})}function aO(e){if(aT){if(e&&e.error)aT([],e.error),aT=null;else if(e&&e.fileChunk)try{aA||0!==e.fileChunk.chunkSequence||(aI("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),aA=!0,aT([],{errorCode:t_.O4.INTERNAL_ERROR,message:"error occurred while receiving data"}),aE=[],aT=null);let t=(0,oX.qT)(e.fileChunk,e.fileType);if(t?(a_||(a_=new ak(e.fileType,[])),a_.assembleAttachment.push(t)):(aI(`Received a null assemble attachment for when decoding chunk sequence ${e.fileChunk.chunkSequence}; not including the chunk in the assembled file.`),aT?aT([],{errorCode:t_.O4.INTERNAL_ERROR,message:"error occurred while receiving data"}):aT=null,aE=[],aT=null,aA=!0),aA=e.fileChunk.endOfFile,e.fileChunk.endOfFile&&a_){let t=(0,oX.x3)(a_.assembleAttachment,a_.fileType);if(t){let r=new File([t],e.fileName,{type:t.type});aE.push(r)}e.isLastFile&&aT&&(aT(aE,e.error),aE=[],aT=null,aA=!0),a_=null}}catch(e){aT&&(aT([],{errorCode:t_.O4.INTERNAL_ERROR,message:e}),aE=[],aT=null,aA=!0)}else aT([],{errorCode:t_.O4.INTERNAL_ERROR,message:"data received is null"}),aE=[],aT=null,aA=!0}}function aR(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.thirdPartyCloudStorage)}var ax=r(103920);function aM(e){(0,ol.kX)((0,eJ.N0)("v1","settings.setValidityState"),e)}function aN(e){(0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.settings,e0.E2.remove,e0.E2.sidePanel),(0,ol.xG)((0,eJ.N0)("v1","settings.getSettings")).then(t=>{e(t)})}function aF(e,t){(0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.settings,e0.E2.sidePanel);let r=null!=t?t:(0,e8._r)();(0,ol.je)((0,eJ.N0)("v1","settings.setSettings"),e).then(()=>{r(!0)}).catch(e=>{r(!1,e.message)})}function aL(e){(0,ax.registerOnSaveHandlerHelper)((0,eJ.N0)("v1","settings.registerOnSaveHandler"),e)}function az(e){(0,ax.registerOnRemoveHandlerHelper)((0,eJ.N0)("v1","settings.registerOnRemoveHandler"),e)}var aD=r(738834);function aB(e,t){let r=(0,eJ.N0)("v1","tasks.startTask"),n=t?e=>{var r,n;return t(null!==(r=e.err)&&void 0!==r?r:"",null!==(n=e.result)&&void 0!==n?n:"")}:void 0;return void 0===e.card&&void 0===e.url||e.card?((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.sidePanel,e0.E2.meetingStage),(0,eZ.x3)(r,"tasks.startTask",[e],t)):void 0!==e.completionBotId?(0,aD.Fr)(r,function(e){if(void 0===e.url||void 0===e.completionBotId)throw Error(`Both url ${e.url} and completionBotId ${e.completionBotId} are required for bot url dialog. At least one is undefined.`);return{url:e.url,size:{height:e.height?e.height:e0.zo.Small,width:e.width?e.width:e0.zo.Small},title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}(e),n):(0,aD.kE)(r,function(e){if(void 0===e.url)throw Error("url property of taskInfo object can't be undefined");return{url:e.url,size:{height:e.height?e.height:e0.zo.Small,width:e.width?e.width:e0.zo.Small},title:e.title,fallbackUrl:e.fallbackUrl}}(e),n),new oo}function aU(e){if(e=aq(e),Object.keys((0,td.T)(e,["width","height"])).length)throw Error("resize requires a TaskInfo argument containing only width and height");(0,aD.GQ)((0,eJ.N0)("v1","tasks.updateTask"),e)}function aH(e,t){(0,aD.g8)((0,eJ.N0)("v1","tasks.submitTask"),e,t)}function aq(e){return e.height=e.height?e.height:e0.zo.Small,e.width=e.width?e.width:e0.zo.Small,e}var aj=r(866095);function a$(e){try{return e.cartItems=function e(t){return t.map(t=>{if(t.imageURL){let e=new URL(t.imageURL);t.imageURL=e}return t.accessories&&(t.accessories=e(t.accessories)),t})}(e.cartItems),e}catch(e){throw Error("Error deserializing cart")}}let aW=e=>{try{return e.map(e=>{let{imageURL:t,accessories:r}=e,n=(0,td.T)(e,["imageURL","accessories"]),o=Object.assign({},n);return t&&(o.imageURL=t.href),r&&(o.accessories=aW(r)),o})}catch(e){throw Error("Error serializing cart items")}};function aV(e){if(!e.id)throw Error("cartItem.id must not be empty");if(!e.name)throw Error("cartItem.name must not be empty");(function(e){if("number"!=typeof e||e<0)throw Error(`price ${e} must be a number not less than 0`);if(parseFloat(e.toFixed(3))!==e)throw Error(`price ${e} must have at most 3 decimal places`)})(e.price),function(e){if("number"!=typeof e||e<=0||parseInt(e.toString())!==e)throw Error(`quantity ${e} must be an integer greater than 0`)}(e.quantity)}function aG(e){if(null!=e){if(!e)throw Error("id must not be empty");if(!1===(0,aj.A)(e))throw Error("id must be a valid UUID")}}let aK={majorVersion:1,minorVersion:1};function aX(){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!aJ())throw e0.qP;return(0,eZ.gV)((0,eJ.N0)("v2","marketplace.getCart"),"marketplace.getCart",aK).then(a$)}function aY(e){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!aJ())throw e0.qP;if(!e)throw Error("addOrUpdateCartItemsParams must be provided");return aG(null==e?void 0:e.cartId),function(e){if(!Array.isArray(e)||0===e.length)throw Error("cartItems must be a non-empty array");for(let t of e)aV(t),function(e){if(null!=e){if(!Array.isArray(e)||0===e.length)throw Error("CartItem.accessories must be a non-empty array");for(let t of e){if(t.accessories)throw Error("Item in CartItem.accessories cannot have accessories");aV(t)}}}(t.accessories)}(null==e?void 0:e.cartItems),(0,eZ.gV)((0,eJ.N0)("v2","marketplace.addOrUpdateCartItems"),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},e),{cartItems:aW(e.cartItems),cartVersion:aK})).then(a$)}function aZ(e){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!aJ())throw e0.qP;if(!e)throw Error("removeCartItemsParams must be provided");if(aG(null==e?void 0:e.cartId),!Array.isArray(null==e?void 0:e.cartItemIds)||0===(null==e?void 0:e.cartItemIds.length))throw Error("cartItemIds must be a non-empty array");return(0,eZ.gV)((0,eJ.N0)("v2","marketplace.removeCartItems"),"marketplace.removeCartItems",Object.assign(Object.assign({},e),{cartVersion:aK})).then(a$)}function aQ(e){if((0,eQ.Zn)(e1.fA,e0.E2.content,e0.E2.task),!aJ())throw e0.qP;if(!e)throw Error("updateCartStatusParams must be provided");return aG(null==e?void 0:e.cartId),function(e){if(!Object.values(j).includes(e))throw Error(`cartStatus ${e} is not valid`)}(null==e?void 0:e.cartStatus),(0,eZ.gV)((0,eJ.N0)("v2","marketplace.updateCartStatus"),"marketplace.updateCartStatus",Object.assign(Object.assign({},e),{cartVersion:aK})).then(a$)}function aJ(){return!(!(0,eQ.Zn)(e1.fA)||!e1.fA.supports.marketplace)}(function(e){e.TACAdminUser="TACAdminUser",e.TeamsAdminUser="TeamsAdminUser",e.TeamsEndUser="TeamsEndUser"})(q||(q={})),function(e){e.Open="Open",e.Processing="Processing",e.Processed="Processed",e.Closed="Closed",e.Error="Error"}(j||(j={}));let a0={},a1=!1,a2=3,a3=()=>{0===Object.keys(a0).length&&(0,tM.wX)("immersive-bizchat-m365-chat-action-callbacks-metaos")&&!a1&&a2-- >0&&(a1=!0,(0,tj.Fi)({eventId:"LogInfo",detail:`M365 Chat Action Callbacks Initialization, remaining initialization retries: ${a2+1}`}),((0,tG.wb)()?rd.E:ru.E)().then(e=>{a0=e({appSdk:e$}),a1=!1,(0,tj.Fi)({eventId:"LogInfo",detail:"M365 Chat Action Callbacks Initialized"})}).catch(e=>{a1=!1,(0,tj.Fi)({eventId:"LogError",detail:`M365 Chat Action Callbacks Initialization Failed, remaining initialization retries: ${a2}`,errorMessage:e.message}),a3()}))},a5=()=>a0;var a6=r(748527);function a4(e){a7(e)}function a8(e){let t=e;try{let r=JSON.parse(e);r?.launchOptionPayload&&(t=r.launchOptionPayload,(0,tj.Fi)({eventId:"HandIn.LaunchOptionsUpdate",detail:"Parsed encoded launchOptionPayload from launchSettings JSON"}))}catch(e){}try{let e;return(0,tM.wX)("immersive-bizchat-enable-gzip-decompression")?((0,tj.Fi)({eventId:"HandIn.LaunchOptionsUpdate",detail:"Using gzip decompression to decode launch option from url"}),e=JSON.parse(new TextDecoder().decode(a6.Ay.inflate(tD(t))))):e=JSON.parse(new TextDecoder().decode(tD(t))),e.hasUsedPrompt=!1,e}catch(e){(0,tj.Fi)({eventId:"HandIn.LaunchOptionsError",errorMessage:`Error decoding launch option from url: ${e.message}`})}}let a9=(0,tJ.jK)("updateLaunchOptionPromptData",e=>{tq.M.launchOptionPrompt={promptData:e,setHasUsedPrompt:a4}}),a7=(0,tJ.jK)("updateLaunchOptionHasUsedPrompt",e=>{tq.M.launchOptionPrompt?.promptData&&(tq.M.launchOptionPrompt.promptData.hasUsedPrompt=e)});var se=r(923161),st=r(717208),sr=r(412145),sn=r(243034),so=r(859645);function si(e,t,r){rh(e,[t],r)}let sa=RegExp("=\\S{1,2}(1[.][.0-9]*)"),ss=RegExp("https://[a-zA-Z0-9-\\.]+/midgard/"),sl="https://res-1.cdn.office.net/midgard/",sc="https://res.cdn.office.net/midgard/",su=RegExp(".*_(.*)_.*"),sd="",sf=(0,sr.r9)({maximumAttempts:4,timeBetweenRetryInMS:()=>100}),sh=(0,sr.r9)({maximumAttempts:3,timeBetweenRetryInMS:()=>200});function sp(){n||(sm(),n=setInterval(sm,9e5))}function sm(){let e=1;sf(async()=>{try{let t=await sg(e);await sn.vw.importAndExecute(void 0,t),(0,tj.Fi)({eventId:"LogInfo",detail:`sendInstallMessageWithManifest(): sendIntallMessageWithManifestRetry succeed at the ${e++} try`})}catch(t){throw(0,tj.Fi)({eventId:"LogInfo",detail:`sendInstallMessageWithManifest(): sendIntallMessageWithManifestRetry fails at the ${e++} try`}),t}}).retriableFunc(),(0,tM.wX)("immersive-bizchat-sw-verify-cache")&&setTimeout(sw,18e4)}async function sg(e){let t=await sv();t||(0,tj.Fi)({eventId:"LogInfo",detail:"fetchAdditionalManifestUrls(): manifest is emtpy"}),(0,tj.Fi)({eventId:"LogInfo",detail:`fetchAdditionalManifestUrls(): get OWA manifest version: ${(t.cacheVersion??"").indexOf("refs")>=0?"PR branch":t.cacheVersion}`});try{var r,n;let e;return(0,tM.wX)("immersive-bizchat-servicedelivery-manifest-emergency-shutdown")||t?.cacheVersion?.indexOf("1.")!==0||t?.staticFiles?.length!==0?await sy(t):((0,tj.Fi)({eventId:"LogInfo",detail:`parseAndFetchServiceDeliveryResourceCatalog(): get OWA manifest version: ${t?.cacheVersion}`}),t?.cacheVersion)?[(r=t.cacheVersion,`https://res.cdn.office.net/midgard/${r}/copilotresourcecatalog.json`),(n=t.cacheVersion,e=`https://res.cdn.office.net/midgard/${n}/m365chatloaderresourcecatalog.json`,(0,tG.wb)()&&(e=`https://res.cdn.office.net/midgard/${n}/m365blazeloaderresourcecatalog.json`),e)]:[]}catch(t){if(e>=3)return;throw t}}async function sv(e){let t=await (0,st.h)(`${window.location.origin}/semanticoverview/immersivebizchatcache.manifest?manifestVersion=2`+(e?"&version="+e:""),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","X-AnchorMailbox":`OID:${tq.M.accountInfo?.objectId}@${tq.M.accountInfo?.tenantId}`}}),r=t.status.toString();(0,tj.Fi)({eventId:"LogInfo",detail:`fetchOwaManifestFile(): fetch immersivebizchatcache.manifest status code: ${r}`});let n=await t.json();return(0,tj.Fi)({eventId:"LogInfo",detail:`fetchOwaManifestFile(): is next-OwaVersion changed: ${sd!==n.cacheVersion&&""!==sd}`}),(0,tN.tn)()===eK.dg&&sd!==n.cacheVersion&&""!==sd&&si("onAppVersionChanged",n.cacheVersion),sd=n.cacheVersion??"",n}async function sb(e){let t=await (0,st.h)(e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}),r=t.status.toString();return(0,tj.Fi)({eventId:"LogInfo",detail:`fetch1JsResourceCatalogFile(): fetch 1Js resource catalog status code: ${r}`}),await t.json()}async function sy(e){var t;let r,n;let o=e?.staticFiles?.find(e=>e.indexOf("semanticoverviewindex")>=0);if(!o)throw(0,tj.Fi)({eventId:"LogInfo",detail:"parseAndFetchM365ChatLoaderResourceCatalog(): fail to get semanticoverviewindex"}),Error("parseAndFetchM365ChatLoaderResourceCatalog(): fail to get semanticoverviewindex");let i=await (0,st.h)(o,{method:"GET"});(0,tj.Fi)({eventId:"LogInfo",detail:`parseAndFetchM365ChatLoaderResourceCatalog(): fetch semanticoverviewindexJs status code: ${i?.status?.toString()}`});let a=await i.text(),s=a,l=s?.indexOf("m365-chat.loader-imported");for(;!r&&l>=0;){let e=s.substring(l,l+100);if(r=e?.match(sa)?.[1]){(0,tj.Fi)({eventId:"LogInfo",detail:`parseAndFetchM365ChatLoaderResourceCatalog(): cdnVersion: ${r}`});break}s=s.substring(l+10,s.length),l=s?.indexOf("m365-chat.loader-imported")}if(!r)throw(0,tM.wX)("immersive-bizchat-block-pr-build")&&(0,so.P5)("fail to parse the 1JS cdnVersion from the semanticoverviewindex.js file"),Error("parseAndFetchM365ChatLoaderResourceCatalog(): fail to get cdnVersion");return t=r,n=sl,(0,tM.wX)("immersive-bizchat-use-weighted-endpoints")&&(n=sc),(0,tM.wX)("immersive-bizchat-parse-cdn-version")&&(n=function(e){let t;let r='midgard/"',n=e?.indexOf(r),o=(0,tM.wX)("immersive-bizchat-use-weighted-endpoints")?sc:sl;for(;!t&&n>=0;){let o=e.substring(Math.max(0,n-60),n+r.length);if(t=o?.match(ss)?.[0]){(0,tj.Fi)({eventId:"LogInfo",detail:`parseAndFetchM365ChatLoaderResourceCatalog(): cdnUrl: ${t}`});break}e=e.substring(n+r.length,e.length),n=e?.indexOf(r)}return(0,tM.wX)("immersive-bizchat-block-pr-build")&&!t&&(0,so.P5)("fail to parse the 1JS url from the semanticoverviewindex.js file"),t||o}(a)),[(0,tG.wb)()?n+`${t}/m365blazeloaderresourcecatalog.json`:n+`${t}/m365chatloaderresourcecatalog.json`]}async function sw(){try{let e="owahub"===tq.M.clientType||"macoutlookhub"===tq.M.clientType||"monarchhub"===tq.M.clientType?"immersivebizchatOutlook":"immersivebizchat",t=await window.caches.keys();if(0>t.indexOf("root_active")){(0,tj.Fi)({eventId:"LogInfo",detail:"verifySwCache: fail to find root_active"});return}let r=await window.caches.open("root_active");if(!(await r.keys()).find(t=>t.url==="https://active/"+e)){(0,tj.Fi)({eventId:"LogInfo",detail:"verifySwCache: fail to find version request in root_active"});return}let n=await (await r.match("https://active/"+e))?.text();if(!n){(0,tj.Fi)({eventId:"LogInfo",detail:"verifySwCache: fail to find version in root_active"});return}let o=sd,i=n.match(su)?.[1];if(!i){(0,tj.Fi)({eventId:"LogInfo",detail:"verifySwCache: fail to parse the owa version in root_active"});return}let a=await sh(()=>sv(i)).retriableFunc();if(!a?.staticFiles){(0,tj.Fi)({eventId:"LogInfo",detail:"verifySwCache: fail to get owaManifest"});return}let s=(await sh(()=>sy(a)).retriableFunc())?.[0],l=await sh(()=>sb(s)).retriableFunc();if(!l?.staticFiles){(0,tj.Fi)({eventId:"LogInfo",detail:"verifySwCache: fail to get 1JS resource Catalog"});return}let c=await window.caches.open(n),u=(await c.matchAll()).map(e=>e.url);(0,tj.Fi)({eventId:"LogInfo",detail:`verifySwCache: total cached file count in sw: ${u?.length}`});let d=0;for(let e of a.staticFiles){let t=!1;for(let r of u)if(r.indexOf(e)>=0){t=!0;break}!t&&d++}let f=0,h=0;for(let e of l.staticFiles){let t=!1;if(e.indexOf(".LICENSE.txt")>=0){h++;continue}for(let r of u)if(r.indexOf(e)>=0){t=!0;break}!t&&f++}let p=void 0!==u.find(e=>e.indexOf("/hosted/semanticoverview")>=0);(0,tj.Fi)({eventId:"LogInfo",detail:`verifySwCache: isOwaVersionChanged:${o!==a?.cacheVersion}, isHtmlInCached:${p}, totalOwaStaticFiles:${a.staticFiles.length}, missedOwaFiles:${d}, total1JsStaticFiles:${l.staticFiles.length}, missed1JsFiles:${f}, ignored1JsFiles:${h}, totalFilesinSw:${u.length}`})}catch{(0,tj.Fi)({eventId:"LogInfo",detail:"verifySwCache: fail to verify sw cache, unknown exception"})}}var sS=r(295806),sC=r(484275);function sI(e,t,r){return rA(new e2.l(e),t,r)}function sk(e,t,r){return r_(new e2.l(e),t,r)}function sE(e,t,r,n){return rT(new e2.l(e),t,r,n)}function s_(e,t,r,n){return rP(new e2.l(e),t,r,n)}function sA(e,t,r){return rx(new e2.l(e),t,r)}function sT(e,t,r){return rM(new e2.l(e),t,r)}let sP=eY.dn,sO=!1,sR=(0,eG.P)(e=>{var t;let r=tH(),n=new t$;eV.useEffect(()=>{tq.M.prewarmInfo?.isPrewarm||((0,tM.wX)("immersive-bizchat-eager-msal-token-fetch")||(0,tY.$N)().then(()=>(0,tj.Fi)({eventId:"Prefetch all token finished"})),(0,tB.fh)(tq.M.serviceEndpointInfra,tq.M.serviceEndpointRing),(0,tB.Ut)(),(0,tB.ST)(),(0,tj.Fi)({eventId:"LogInfo",detail:"ChatViewRenderEnd"}),(0,tB.Qk)(f?.version,f?.cdnVersion,e.isFlightsFromCache),(0,tB.xF)((0,rc.Fh)()),a3())},[]);let[o,i]=eV.useState(),[a,s]=eV.useState(),[l,c]=eV.useState({appGetContext:rc.vF,appOpenLink:rc.o3,processActionOpenUrl:e5,processActionSubmit:e3,authenticateAndResendRequest:ti,authenticateWithSSOAndResendRequest:ts,authenticateWithOauth2:tl,authenticateWithPowerPlatformConnectorPlugins:tc,processActionCommand:tf,authenticateWithOAuthForCEA:sI,authenticateWithSSOForCEA:sk,authenticateWithOAuthAndResendRequestForCEA:sE,authenticateWithSSOAndResendRequestForCEA:s_,processActionOpenUrlForCEA:sA,processActionSubmitForCEA:sT,requestPermission:rc.xe,authenticate:tp.authenticate,openURLBasedDialog:tm.open,openAdaptiveCardBasedDialog:tg.open,openInContextStore:ty,registerAppInstallationHandler:tA,unregisterAppInstallationHandler:tT,openAppDetail:tb});eV.useEffect(()=>{tq.M.prewarmInfo?.isPrewarm||(rc.xq()?.then(e=>{if(e.page?.subPageId){let t=a8(e.page.subPageId);t?.scenario!==void 0&&t?.version!==void 0&&(a9(t),tj.Fi({eventId:"HandIn.LaunchOptionsStart",detail:`V2 Prompt. Got Prompt Handin LaunchOption from url. Scenario: ${t.scenario}; Source: ${t.properties.promptSource}; Version: ${t.version}; ClickTimestamp: ${t.properties.clickTimestamp};`}))}}),sx().then(e=>{if(e?.type&&e?.text){if((0,tM.wX)("immersive-bizchat-enable-handin-prompt-from-launch-url")){let{type:t,text:r,source:n,shouldSubmit:o,clickTimestamp:i}=e;s({type:t,text:r,source:n,shouldSubmit:o}),(0,tj.Fi)({eventId:"HandIn.LaunchOptionsStart",detail:`Got Prompt Handin LaunchOption from url. Type: ${t}, Source: ${n}, ShouldSubmit: ${o}, ClickTimestamp: ${i}`})}else"plaintext"===e.type.toLowerCase()&&(i(e.text),(0,tj.Fi)({eventId:"HandIn.LaunchOptionsStart",detail:"Got query text LaunchOption from url, not for Prompt HandIn"}))}}))},[]);let[u,d]=eV.useState();eV.useEffect(()=>{tq.M.prewarmInfo?.isPrewarm||sM().then(e=>{e&&d({fileId:e.fileId,driveId:e.driveId,actionId:e.actionId})})},[]),tq.M.prewarmInfo?.isPrewarm||(0,tG.Zl)();let f=eV.useMemo(()=>{let t={tokenProviders:{augloop:()=>(0,tY.hU)(),substrate:()=>(0,tY.K4)(),sydney:()=>(0,tY.CM)(),tenantFeedback:()=>(0,tY.cJ)(),loki:()=>(0,tY.$6)(),feed:()=>(0,tY.Co)(),spo:(0,tY.Q5)(),mos:()=>(0,tY.Ne)(),oboToken:tY.Cb,aeaToken:()=>(0,tY.ZS)(),amsToken:()=>(0,tY.pf)(),graph:()=>(0,tY.eZ)(),gcs:()=>(0,tY.by)(),powerAutomate:()=>(0,tY.RT)(),powerPlatform:e=>(0,tY.Cw)(e),apiHub:()=>(0,tY.Fo)(),apiSkype:()=>(0,tY.EG)(),designer:()=>(0,tY.Jz)(),apiUrlp:()=>(0,tY.xf)(),ocps:()=>(0,tY.lE)(),pushChannel:()=>(0,tY.PE)(),mss:()=>(0,tY.dS)(),copilotStudio:e=>(0,tY.gV)(e),bap:e=>(0,tY.Xq)(e),teams:()=>(0,tY.Ku)(),mruPlusPlus:()=>(0,tY.iy)(),trouter:e=>(0,tY.BA)(e),onenote:()=>(0,tY.o4)(),safeLinks:e=>(0,tY.EY)(e)},getChatLogger:tj.r7,getLoggerProperties:tX.IH,locale:tq.M.locale,isRTL:(0,tM.wX)("immersive-bizchat-enable-rtl")?tV(tq.M.locale):void 0,isFeatureEnabled:e=>(0,tM.mM)(e),ecsConfigIds:tq.M.ecsConfigIds,entitySettings:{enableEntityAnnotations:(0,tM.wX)("immersive-bizchat-entities"),enableHeroCards:(0,tM.wX)("immersive-bizchat-entities-hero"),enableHoverCards:(0,tM.wX)("immersive-bizchat-entities-hover"),enablePeopleHeroCard:(0,tM.wX)("immersive-bizchat-entities-hero-people"),enablePeopleHoverCard:(0,tM.wX)("immersive-bizchat-entities-hover-people"),enableEventHeroCard:(0,tM.wX)("immersive-bizchat-entities-hero-event"),enableEventHeroActions:(0,tM.wX)("immersive-bizchat-entities-hero-event-actions"),enableEventHoverCard:(0,tM.wX)("immersive-bizchat-entities-hover-event"),enableEventHoverActions:(0,tM.wX)("immersive-bizchat-entities-hover-event-actions"),enableExternalHoverCard:(0,tM.wX)("immersive-bizchat-entities-hover-external"),enableFileHeroCard:(0,tM.wX)("immersive-bizchat-entities-hero-file"),enableFileHoverCard:(0,tM.wX)("immersive-bizchat-entities-hover-file"),enableFilePreviewThumbnail:(0,tM.wX)("immersive-bizchat-entities-file-preview-thumbnail"),enableExternalMessageExtensionHoverCard:(0,tM.wX)("immersive-bizchat-entities-message-extensions"),disableEntityRendering:(0,tM.wX)("immersive-bizchat-entities-disable-rendering"),enableStreamHeroCard:(0,tM.wX)("immersive-bizchat-entities-hero-stream"),enableContextualPrompts:(0,tM.wX)("immersive-bizchat-entities-contextualprompts"),enableFileHoverPreviewThumbnail:(0,tM.wX)("immersive-bizchat-entities-file-hover-preview-thumbnail"),enableContextualPromptsOnHeroCard:(0,tM.wX)("immersive-bizchat-entities-contextual-prompts-on-hero-card"),enableExternalAPIPluginHoverCard:(0,tM.wX)("immersive-bizchat-entities-external-api-plugin")},hostAppData:{tryThesePromptsData:{data:tq.M.tryThesePromptsData,useFallback:tq.M.useFallbackTTP},handInData:{fileId:u?.fileId??void 0,deviceId:u?.driveId??void 0,actionId:u?.actionId??void 0},launchOptionPromptData:a??void 0,sessionHistoryData:{rawSessionList:tq.M.rawSessionList,filteredSessionList:tq.M.filteredSessionList,syncState:tq.M.sessionsSyncState,prefetchTraceId:tq.M.sessionsTraceId,prefetchStatus:tq.M.sessionsPrefetchStatus},extensionsData:{gptList:tq.M.extensionsList,prefetchTraceId:tq.M.extensionsTraceId,prefetchStatus:tq.M.extensionsPrefetchStatus,isCopilotExtensibilityDisabled:tq.M.isCopilotExtensibilityDisabled}}};return e.runtimeFactory?e.runtimeFactory(t):((0,tj.Fi)({eventId:"LogInfo",detail:"No runtimeFactory provided. Creating default runtime"}),(0,eY.oE)({...t,preload:(0,tM.wX)("immersive-bizchat-perf-preload-runtime"),allowUrlOverrides:t7()||(0,tM.wX)("immersive-bizchat-allow-url-override")}))},[e.runtimeFactory,tq.M.locale,tq.M.tryThesePromptsData,tq.M.useFallbackTTP,u,a,tq.M.rawSessionList,tq.M.filteredSessionList,tq.M.sessionsSyncState,tq.M.sessionsTraceId,tq.M.sessionsPrefetchStatus,tq.M.extensionsPrefetchStatus,tq.M.ecsConfigIds,tq.M.isCopilotExtensibilityDisabled]),h=(0,tN.tn)()===eK.Hz,p=h&&(0,tM.wX)("immersive-bizchat-esc-return-focus-to-teams"),m=eV.useMemo(()=>p?()=>{tR.returnFocus(!1)}:void 0,[p]),g=(0,sC.useStorageLicenseEnabledCheck)();if(eV.useEffect(()=>{tq.M.prewarmInfo?.isPrewarm&&(0,tB.nE)()},[]),tq.M.prewarmInfo?.isPrewarm)return eV.createElement("div",null);let v=eV.createElement(sP,{value:f},tq.M.eligibility?eV.createElement(eY.WB,{appearance:(0,tN.tn)()===eK.dg?"singlecol":"m365",sourceName:(0,tN.tn)(),scenarioName:(0,tN.tn)(),queryText:o,zeroPromptVersion:(0,tM.wX)("immersive-bizchat-try-these-prompts-sept06")?"sept06-demo":(0,tM.wX)("immersive-bizchat-proactive-carousel-card")?"1.0-carousel":"threeprompt",feedbackClientName:tF(),serviceEndpointRing:tq.M.serviceEndpointRing||void 0,serviceEndpointInfra:tq.M.serviceEndpointInfra||void 0,serviceEndpointUrl:(t=tq.M.serviceEndpointUrl,(0,tM.wX)("immersive-bizchat-gpt-demo-tenant")?"https://turingbot.sdf-test-18.substrate-turing-turingbot.eastus-sdf.cosmic-ppe.office.net/turingbot/ChatHub":(0,tM.wX)("immersive-bizchat-testhotfix-sydney-url")?"https://turingbot.sdf-test-hotfix.substrate-turing-turingbot.centralus-sdf.cosmic-ppe.office.net/SecuredChatHub":t||void 0),sessionsEndpointUrl:tq.M.sessionsEndpointUrl,sessionsVariants:tq.M.sessionsVariants,clientPlatform:tq.M?.clientType,accountInfo:tq.M?.accountInfo,disableLocalStorage:!0,isHeaderCopilotIconDisabled:!0,isDarkMode:e.isDarkMode??!1,clientCorrelationId:tq.M.clientCorrelationId,appTheme:tq.M.themeContext,metaOsSdk:l,launchOptionPrompt:tq.M.launchOptionPrompt,fetchM365ChatLicenseStatus:void 0,enableChatCIQ:(0,tM.wX)("immersive-bizchat-ciq-chat-entities"),enableEmailCIQ:(0,tM.wX)("immersive-bizchat-ciq-email-entities"),enableTopicCIQ:(0,tM.wX)("immersive-bizchat-ciq-topic-entities"),enableTopicECC:(0,tM.wX)("immersive-bizchat-ciq-topic-ecc"),enableHandoffButtons:!0,enableHybridWorkflow:(0,tM.wX)("immersive-bizchat-ciq-hybrid-workflows"),enableStreamingCursor:(0,tM.wX)("immersive-bizchat-streaming-cursor"),hostCommunication:n,onInputRenderFinished:sN,onAppRenderSuccess:sN,enable3PExtensibility:(0,tM.wX)("immersive-bizchat-3p-extensibility"),enable3PExtensibilityForOwa:(0,tM.wX)("immersive-bizchat-3p-extensibility-owa"),enable3PExtensibilityForTeams:(0,tM.wX)("immersive-bizchat-3p-extensibility-teams"),enable3PExtensibilityForOffice:(0,tM.wX)("immersive-bizchat-3p-extensibility-office"),enableMorePluginsForOwa:(0,tM.wX)("immersive-bizchat-3p-more-plugins-owa"),enableMorePluginsForTeams:(0,tM.wX)("immersive-bizchat-3p-more-plugins-teams"),enableMorePluginsForOffice:(0,tM.wX)("immersive-bizchat-3p-more-plugins-office"),enablePluginsSearchForOwa:(0,tM.wX)("immersive-bizchat-3p-plugins-search-owa"),enablePluginsSearchForTeams:(0,tM.wX)("immersive-bizchat-3p-plugins-search-teams"),enablePluginsSearchForOffice:(0,tM.wX)("immersive-bizchat-3p-plugins-search-office"),enableManagePluginsForOwa:(0,tM.wX)("immersive-bizchat-3p-manage-plugins-owa"),enableManagePluginsForTeams:(0,tM.wX)("immersive-bizchat-3p-manage-plugins-teams"),enableManagePluginsForOffice:(0,tM.wX)("immersive-bizchat-3p-manage-plugins-office"),enableStoreFrontPluginsForOwa:(0,tM.wX)("immersive-bizchat-3p-store-front-plugins-owa"),enableStoreFrontPluginsForTeams:(0,tM.wX)("immersive-bizchat-3p-store-front-plugins-teams"),enableStoreFrontPluginsForOffice:(0,tM.wX)("immersive-bizchat-3p-store-front-plugins-office"),enableFlyoutPreviewForTeams:(0,tM.wX)("immersive-bizchat-3p-flyout-preview-teams"),enableUserSettings:(0,tM.wX)("immersive-bizchat-3p-flyout-user-settings"),enableTeachingUXForPluginManagement:(0,tM.wX)("immersive-bizchat-plugin-flyout-fre"),enablePluginFlyoutV2:(0,tM.wX)("immersive-bizchat-plugin-flyout-v2"),enable3PPlugins:(0,tM.wX)("immersive-bizchat-3p-plugins"),enablePPDVPlugins:(0,tM.wX)("immersive-bizchat-ppdv-plugins"),feedbackPolicies:tq.M.feedbackPolicies?.policies,sydneyVariants:function(){let e=tq.M.sydneyVariants?[tq.M.sydneyVariants]:[];(0,tM.wX)("immersive-bizchat-handoff-sydney-outlookmailto")&&e.push("feature.OutlookComposeMailto"),(0,tM.wX)("immersive-bizchat-handoff-sydney-outlooksplitbutton")&&e.push("feature.OutlookComposeSplitButton");let t=[...new Set(e)].join(",");return(0,tj.Fi)({eventId:"SydneyVariants:",dynamicEventPart:`${t}`}),t}(),sydneyOptionsSets:function(){let e=[];if((0,tM.wX)("immersive-bizchat-avalon-endpoint")){e.push("enterprise_flux_web","enterprise_flux_work","enable_request_response_interstitials"),(0,tM.wX)("immersive-bizchat-enable-spark-text")&&e.push("enterprise_flux_spark"),(0,tM.wX)("immersive-bizchat-image-v1-option-set")?e.push("enterprise_flux_image_v1"):(0,tM.wX)("immersive-bizchat-image-option-set")&&e.push("enterprise_flux_image"),(0,tM.wX)("immersive-bizchat-image-v2-option-set")&&e.push("enterprise_flux_image_v2");let t=(0,tM.wX)("immersive-bizchat-enable-toolbox-for-teams"),r=(0,tM.wX)("immersive-bizchat-enable-toolbox-with-multi-turn-support-for-teams");t&&e.push("enterprise_toolbox_with_skdsstore"),r&&e.push("enterprise_toolbox_with_skdsstore_v2"),(0,tM.wX)("immersive-bizchat-enable-search-msg-ext-via-toolbox")&&(e.push("enterprise_toolbox_with_skdsstore_search_message_extensions"),(0,tM.wX)("immersive-bizchat-enable-msg-ext-auth-skill")&&e.push("enable_ME_auth_interstitial")),(0,tM.wX)("immersive-bizchat-enable-plugins-as-declarative-agents")&&e.push("skdsstorethirdparty"),(0,tM.wX)("immersive-bizchat-enable-client-skill")&&((0,tM.wX)("immersive-bizchat-enable-action-msg-ext-skill")&&e.push("teams_action_message_extensions_enable"),(0,tM.wX)("immersive-bizchat-enable-confirmation-dialog-skill")&&e.push("enable_confirmation_interstitial"),(0,tM.wX)("immersive-bizchat-enable-api-plugins-auth-skill")&&e.push("enable_plugin_auth_interstitial")),(0,tM.wX)("immersive-bizchat-enable-handoff-response-action-processing")&&e.push("enable_response_action_processing"),(0,tM.wX)("immersive-bizchat-source-attributions-avalon")&&(0,tM.wX)("immersive-bizchat-entities-message-extensions")&&e.push("teams_search_me_annotation_card_json_enable")}else(0,tM.wX)("immersive-bizchat-analytics-skill")&&e.push("enterprise_flux_analytics"),(0,tM.wX)("immersive-bizchat-handoff-buttons")&&e.push("enterprise_flux_handoff_outlook_compose"),(0,tM.wX)("immersive-bizchat-enable-calendar-handoff")&&e.push("enterprise_flux_handoff_calendar_scheduling");(0,tM.wX)("immersive-bizchat-toolbox-with-skdsstore")&&e.push("enterprise_toolbox_with_skdsstore"),(0,tM.wX)("immersive-bizchat-enable-loop-handoff")&&e.push("enterprise_flux_handoff_loop"),(0,tM.wX)("immersive-bizchat-enable-gpt4o-model-reasoning")&&e.push("enterprise_flux_work_0125"),(0,tM.wX)("immersive-bizchat-enable-gpt4o-model-responding")&&e.push("enterprise_responding_gpt4o");let t=e.join(",");return(0,tj.Fi)({eventId:"SydneyOptionsSets:",dynamicEventPart:`${t}`}),t}(),enableResponsiveExpandedECC:(0,tM.wX)("immersive-bizchat-responsive-expanded-ecc"),sessionId:tq.M.sessionID,disable3STokenInSydneyRequest:!0,enableStayOnTop:(0,tM.wX)("immersive-bizchat-stay-on-top"),enableSensitivityLabel:(0,tM.wX)("immersive-bizchat-sensitivity-label"),enabledSydneyScenarioProp:!0,enableCIQRefresh:(0,tM.wX)("immersive-bizchat-ciq-refresh"),enableNewFileTidbits:(0,tM.wX)("immersive-bizchat-enable-new-file-tidbits"),enableSydneyPromptIdProp:(0,tM.wX)("immersive-bizchat-enable-sydney-prompt-id-prop"),enableShowSydneyLatency:(0,tM.wX)("immersive-bizchat-show-sydney-latency-metrics"),enablePeopleQueryAnnotationV2:(0,tM.wX)("immersive-bizchat-ciq-people-entity-id-v2"),enableAutomate:(0,tM.wX)("immersive-bizchat-automate"),enablePromptSaving:(0,tM.wX)("immersive-bizchat-prompt-saving"),enablePromptEditing:(0,tM.wX)("immersive-bizchat-prompt-editing"),enablePromptSharing:(0,tM.wX)("immersive-bizchat-prompt-sharing"),enablePromptSharingDialog:(0,tM.wX)("immersive-bizchat-prompt-sharing-dialog"),enablePromptSavingHydratedEntities:(0,tM.wX)("immersive-bizchat-prompt-saving-hydrated-entities"),enableGradientPlaceholder:(0,tM.wX)("immersive-bizchat-enable-gradient-placeholder"),enableSourceAttributionsInAvalon:(0,tM.wX)("immersive-bizchat-source-attributions-avalon"),enableTtpPrefetch:(0,tM.wX)("immersive-bizchat-enable-ttp-prefetch"),enableWebToggleFre:(0,tM.wX)("immersive-bizchat-web-toggle-fre"),enableWebToggleFreAlwaysShown:(0,tM.wX)("immersive-bizchat-web-toggle-fre-always-shown"),enableSendConvIdForNewChat:(0,tM.wX)("immersive-bizchat-send-conv-id-for-new-chat")&&!(0,tM.wX)("immersive-bizchat-avalon-endpoint"),...(0,tM.wX)("immersive-bizchat-chathub-connection-timeout-30s")?{sydneyConnectionTimeout:3e4}:{},...(0,tM.wX)("immersive-bizchat-remove-limit-input-text-char-count")?{charCountLimit:1/0}:(0,tM.wX)("immersive-bizchat-limit-input-text-char-count-128000")?{charCountLimit:128e3}:(0,tM.wX)("immersive-bizchat-limit-input-text-char-count-16000")?{charCountLimit:16e3}:(0,tM.wX)("immersive-bizchat-limit-input-text-char-count-4000")?{charCountLimit:4e3}:(0,tM.wX)("immersive-bizchat-limit-input-text-char-count-2000")?{charCountLimit:2e3}:{},enableLogPromptId:(0,tM.wX)("immersive-bizchat-enable-log-prompt-id"),fetchPuid:tK.Iq,...(0,tM.wX)("immersive-bizchat-ciq-oa-result-timeout-7-and-half-seconds")?{ciqOAResultsTimeout:7500}:{},enablePinnedSessions:(0,tM.wX)("immersive-bizchat-sessions-pin"),enableTopicsReference:(0,tM.wX)("immersive-bizchat-topics-reference"),enableRestrictedSearchTesting:(0,tM.wX)("immersive-bizchat-enable-restricted-search-testing"),focusOnLoadSignal:h?tq.M.hostUserClickTime:void 0,focusOnLoadTarget:h?tq.M.focusOnLoad:void 0,onEscKeyDown:m,enableSearchBar:(0,tM.wX)("immersive-bizchat-enable-searchbar"),enablePlannerHandoff:(0,tM.wX)("immersive-bizchat-enable-planner-handoff"),enableGPT:(0,tM.wX)("immersive-bizchat-avalon-endpoint")&&(0,tM.wX)("immersive-bizchat-gpt"),enableGPTInDemoTenant:(0,tM.wX)("immersive-bizchat-avalon-endpoint")&&(0,tM.wX)("immersive-bizchat-gpt-demo-tenant"),enableSettings:t7(),hostScriptVersion:(0,eK.Oo)(),storedFeatureFlags:rt(),flightingConfiguration:(0,tM.Zb)(),updateSydneySettingsInCache:rn,updateFeatureFlagsInCache:ro,cleanSettingsInCache:ri,enablePromptRingTag:(0,tM.wX)("immersive-bizchat-prompt-ring-tag"),enableHandInPromptFromLaunchUrl:(0,tM.wX)("immersive-bizchat-enable-handin-prompt-from-launch-url"),enableBingAnswer:(0,tM.wX)("immersive-bizchat-enable-bing-answer"),enabelCIQBootstrapV2:(0,tM.wX)("immersive-bizchat-ciq-bootstrap-v2"),enableWebTogglePluginExt:(0,tM.wX)("immersive-bizchat-enable-web-toggle-by-default"),enableTelemetryIds:(0,tM.wX)("immersive-bizchat-sydney-telemetry-ids"),enableSydneyResponseUnpackV2:(0,tM.wX)("immersive-bizchat-sydney-response-unpack-v2"),enableSydneyStreamThrottle:(0,tM.wX)("immersive-bizchat-sydney-throttle-streaming"),enableSydneyTrafficTypeProp:(0,tM.wX)("immersive-bizchat-sydney-traffic-type"),ocpsPolicies:tq.M.ocpsPolicies,enableLatencyUX:(0,tM.wX)("immersive-bizchat-latency-ux-cards"),getChatActionCallbacks:a5,eligibilityInformation:tq.M.eligibility,enableEditorStateRefresh:(0,tM.wX)("immersive-bizchat-enable-editor-state-refresh"),enableSydneyWarmupOnInput:(0,tM.wX)("immersive-bizchat-enable-sydney-warmup-on-input"),appLoadTime:tq.M.appLoadTime,isStorageLicenseEnabled:g,enableCDPLogging:(0,tM.wX)("immersive-bizchat-enable-cdp-logging"),sendCustomMessage:si,latestConversationId:tq.M.latestConversationId,contextualChat:tq.M.contextualChat,fetchM365ChatStorageLicenseStatus:se.u}):eV.createElement(eV.Fragment,null),eV.createElement(eY.u,{isDarkMode:"dark"===tq.M.themeContext,tryFetchOneMsalToken:tY.kJ,updateIsPopUpEnabled:sF,isPopUpEnabled:tq.M.isMSALRefreshUiPopUpEnabled,setMsalFirstRequestCompleted:sS.ID,setMsalFirstRequestFinished:sS.Hl}));return eV.createElement("div",{className:r.container},v)},"BlazeView");async function sx(){try{let e=await (0,rc.xq)();if(e?.page?.subPageId){let t;return(0,tM.wX)("immersive-bizchat-enable-handin-prompt-from-launch-url")?(0,tM.wX)("immersive-bizchat-enable-gzip-decompression")?((0,tj.Fi)({eventId:"HandIn.LaunchOptionsUpdate",detail:"Using gzip decompression to decode launch option from url"}),t=JSON.parse(new TextDecoder().decode(a6.Ay.inflate(tD(e.page.subPageId))))):((0,tj.Fi)({eventId:"HandIn.LaunchOptionsUpdate",detail:"Using base64UrlDecodeToBytes to decode launch option from url"}),t=JSON.parse(new TextDecoder().decode(tD(e.page.subPageId)))):t=JSON.parse(tz(e.page.subPageId)),t}}catch(e){(0,tj.Fi)({eventId:"HandIn.LaunchOptionsError",errorMessage:`Error decoding launch option from url: ${e.message}`})}}async function sM(){try{let e=await (0,rc.xq)(),t=e?.actionInfo;if(t){let e,r;let n=t.actionId;if(n?.toLowerCase()!=="summarize")return;if((0,tj.Fi)({eventId:"HandIn.DataStart",detail:`Got ActionId from app.Context. ActionId: ${n?.toLowerCase()}`}),t.actionObjects&&t.actionObjects.length>0){let o=t.actionObjects[0];if(!o)return(0,tj.Fi)({eventId:"HandIn.DataError",detail:`ActionId: ${n?.toLowerCase()}`,errorMessage:"actionObject is undefined in app.Context"}),{actionId:n,fileId:e,driveId:r};e=o.itemId;let i=o.secondaryId;r=i.name===t_.jw.DriveId?i.value:void 0,r?.trim()&&e?.trim()||(0,tj.Fi)({eventId:"HandIn.DataError",detail:`ActionId: ${n?.toLowerCase()}`,errorMessage:"driveid or fileId are invalid in app.Context"})}return{actionId:n,fileId:e,driveId:r}}}catch(e){(0,tj.Fi)({eventId:"HandIn.DataError",errorMessage:`Error getting HandInData from app.Context: ${e.message}`})}}function sN(){try{if(sO)return;(0,tj.Fi)({eventId:"ChatInput render finished."}),tx.notifySuccess(),(0,tG.oB)(),sp(),(0,so.fF)(),(0,tG.ip)(),(0,tG.Eq)(),(0,tG.yD)(),(0,tG.tM)(),(0,tG.xz)(),(0,tG.p$)(),(0,so.Ue)(),(0,eX.X)(window,tZ.H7),(0,tM.wX)("immersive-bizchat-delay-low-priority-tasks")&&cT(),((0,tM.wX)("immersive-bizchat-puid-sydney")||(0,tM.wX)("immersive-bizchat-delay-low-priority-tasks"))&&(0,tK.Oz)(),sO=!0}catch{(0,tj.Fi)({eventId:"notifySuccess fail"})}}function sF(e){(0,tj.Fi)({eventId:"LogInfo",detail:"ChatView: Poup "+(e?"enabled":"disabled"),message:new Date().getTime()}),(0,rl.H)(e)}var sL=r(467439);let sz=sL.dn,sD=!1,sB=(0,eG.P)(e=>{var t;let r=tH(),n=new t$;eV.useEffect(()=>{tq.M.prewarmInfo?.isPrewarm||((0,tM.wX)("immersive-bizchat-eager-msal-token-fetch")||(0,tY.$N)().then(()=>(0,tj.Fi)({eventId:"Prefetch all token finished"})),(0,tB.fh)(tq.M.serviceEndpointInfra,tq.M.serviceEndpointRing),(0,tB.Ut)(),(0,tB.ST)(),(0,tj.Fi)({eventId:"LogInfo",detail:"ChatViewRenderEnd"}),(0,tB.Qk)(f?.version,f?.cdnVersion,e.isFlightsFromCache),(0,tB.xF)((0,rc.Fh)()),a3())},[]);let[o,i]=eV.useState(),[a,s]=eV.useState(),[l,c]=eV.useState({appGetContext:rc.vF,appOpenLink:rc.o3,processActionOpenUrl:e5,processActionSubmit:e3,authenticateAndResendRequest:ti,authenticateWithSSOAndResendRequest:ts,authenticateWithOauth2:tl,authenticateWithPowerPlatformConnectorPlugins:tc,processActionCommand:tf,authenticateWithOAuthForCEA:sI,authenticateWithSSOForCEA:sk,authenticateWithOAuthAndResendRequestForCEA:sE,authenticateWithSSOAndResendRequestForCEA:s_,processActionOpenUrlForCEA:sA,processActionSubmitForCEA:sT,requestPermission:rc.xe,authenticate:tp.authenticate,openURLBasedDialog:tm.open,openAdaptiveCardBasedDialog:tg.open,openInContextStore:ty,registerAppInstallationHandler:tA,unregisterAppInstallationHandler:tT,openAppDetail:tb});eV.useEffect(()=>{tq.M.prewarmInfo?.isPrewarm||(rc.xq()?.then(e=>{if(e.page?.subPageId){let t=a8(e.page.subPageId);t?.scenario!==void 0&&t?.version!==void 0&&(a9(t),tj.Fi({eventId:"HandIn.LaunchOptionsStart",detail:`V2 Prompt. Got Prompt Handin LaunchOption from url. Scenario: ${t.scenario}; Source: ${t.properties.promptSource}; Version: ${t.version}; ClickTimestamp: ${t.properties.clickTimestamp};`}))}}),sU().then(e=>{if(e?.type&&e?.text){if((0,tM.wX)("immersive-bizchat-enable-handin-prompt-from-launch-url")){let{type:t,text:r,source:n,shouldSubmit:o,clickTimestamp:i}=e;s({type:t,text:r,source:n,shouldSubmit:o}),(0,tj.Fi)({eventId:"HandIn.LaunchOptionsStart",detail:`Got Prompt Handin LaunchOption from url. Type: ${t}, Source: ${n}, ShouldSubmit: ${o}, ClickTimestamp: ${i}`})}else"plaintext"===e.type.toLowerCase()&&(i(e.text),(0,tj.Fi)({eventId:"HandIn.LaunchOptionsStart",detail:"Got query text LaunchOption from url, not for Prompt HandIn"}))}}))},[]);let[u,d]=eV.useState();eV.useEffect(()=>{tq.M.prewarmInfo?.isPrewarm||sH().then(e=>{e&&d({fileId:e.fileId,driveId:e.driveId,actionId:e.actionId})})},[]),tq.M.prewarmInfo?.isPrewarm||(0,tG.Zl)();let f=eV.useMemo(()=>{let t={tokenProviders:{augloop:()=>(0,tY.hU)(),substrate:()=>(0,tY.K4)(),sydney:()=>(0,tY.CM)(),tenantFeedback:()=>(0,tY.cJ)(),loki:()=>(0,tY.$6)(),feed:()=>(0,tY.Co)(),spo:(0,tY.Q5)(),mos:()=>(0,tY.Ne)(),oboToken:tY.Cb,aeaToken:()=>(0,tY.ZS)(),amsToken:()=>(0,tY.pf)(),graph:()=>(0,tY.eZ)(),gcs:()=>(0,tY.by)(),powerAutomate:()=>(0,tY.RT)(),powerPlatform:e=>(0,tY.Cw)(e),apiHub:()=>(0,tY.Fo)(),apiSkype:()=>(0,tY.EG)(),designer:()=>(0,tY.Jz)(),apiUrlp:()=>(0,tY.xf)(),ocps:()=>(0,tY.lE)(),pushChannel:()=>(0,tY.PE)(),mss:()=>(0,tY.dS)(),copilotStudio:e=>(0,tY.gV)(e),bap:e=>(0,tY.Xq)(e),teams:()=>(0,tY.Ku)(),mruPlusPlus:()=>(0,tY.iy)(),trouter:e=>(0,tY.BA)(e),onenote:()=>(0,tY.o4)(),safeLinks:e=>(0,tY.EY)(e)},getChatLogger:tj.r7,getLoggerProperties:tX.IH,locale:tq.M.locale,isRTL:(0,tM.wX)("immersive-bizchat-enable-rtl")?tV(tq.M.locale):void 0,isFeatureEnabled:e=>(0,tM.mM)(e),ecsConfigIds:tq.M.ecsConfigIds,entitySettings:{enableEntityAnnotations:(0,tM.wX)("immersive-bizchat-entities"),enableHeroCards:(0,tM.wX)("immersive-bizchat-entities-hero"),enableHoverCards:(0,tM.wX)("immersive-bizchat-entities-hover"),enablePeopleHeroCard:(0,tM.wX)("immersive-bizchat-entities-hero-people"),enablePeopleHoverCard:(0,tM.wX)("immersive-bizchat-entities-hover-people"),enableEventHeroCard:(0,tM.wX)("immersive-bizchat-entities-hero-event"),enableEventHeroActions:(0,tM.wX)("immersive-bizchat-entities-hero-event-actions"),enableEventHoverCard:(0,tM.wX)("immersive-bizchat-entities-hover-event"),enableEventHoverActions:(0,tM.wX)("immersive-bizchat-entities-hover-event-actions"),enableExternalHoverCard:(0,tM.wX)("immersive-bizchat-entities-hover-external"),enableFileHeroCard:(0,tM.wX)("immersive-bizchat-entities-hero-file"),enableFileHoverCard:(0,tM.wX)("immersive-bizchat-entities-hover-file"),enableFilePreviewThumbnail:(0,tM.wX)("immersive-bizchat-entities-file-preview-thumbnail"),enableExternalMessageExtensionHoverCard:(0,tM.wX)("immersive-bizchat-entities-message-extensions"),disableEntityRendering:(0,tM.wX)("immersive-bizchat-entities-disable-rendering"),enableStreamHeroCard:(0,tM.wX)("immersive-bizchat-entities-hero-stream"),enableContextualPrompts:(0,tM.wX)("immersive-bizchat-entities-contextualprompts"),enableFileHoverPreviewThumbnail:(0,tM.wX)("immersive-bizchat-entities-file-hover-preview-thumbnail"),enableContextualPromptsOnHeroCard:(0,tM.wX)("immersive-bizchat-entities-contextual-prompts-on-hero-card"),enableExternalAPIPluginHoverCard:(0,tM.wX)("immersive-bizchat-entities-external-api-plugin")},hostAppData:{tryThesePromptsData:{data:tq.M.tryThesePromptsData,useFallback:tq.M.useFallbackTTP},handInData:{fileId:u?.fileId??void 0,deviceId:u?.driveId??void 0,actionId:u?.actionId??void 0},launchOptionPromptData:a??void 0,sessionHistoryData:{rawSessionList:tq.M.rawSessionList,filteredSessionList:tq.M.filteredSessionList,syncState:tq.M.sessionsSyncState,prefetchTraceId:tq.M.sessionsTraceId,prefetchStatus:tq.M.sessionsPrefetchStatus},extensionsData:{gptList:tq.M.extensionsList,prefetchTraceId:tq.M.extensionsTraceId,prefetchStatus:tq.M.extensionsPrefetchStatus,isCopilotExtensibilityDisabled:tq.M.isCopilotExtensibilityDisabled}}};return e.runtimeFactory?e.runtimeFactory(t):((0,tj.Fi)({eventId:"LogInfo",detail:"No runtimeFactory provided. Creating default runtime"}),(0,sL.oE)({...t,preload:(0,tM.wX)("immersive-bizchat-perf-preload-runtime"),allowUrlOverrides:t7()||(0,tM.wX)("immersive-bizchat-allow-url-override")}))},[e.runtimeFactory,tq.M.locale,tq.M.tryThesePromptsData,tq.M.useFallbackTTP,u,a,tq.M.rawSessionList,tq.M.filteredSessionList,tq.M.sessionsSyncState,tq.M.sessionsTraceId,tq.M.sessionsPrefetchStatus,tq.M.extensionsPrefetchStatus,tq.M.ecsConfigIds,tq.M.isCopilotExtensibilityDisabled]),h=(0,tN.tn)()===eK.Hz,p=h&&(0,tM.wX)("immersive-bizchat-esc-return-focus-to-teams"),m=eV.useMemo(()=>p?()=>{tR.returnFocus(!1)}:void 0,[p]),g=(0,sC.useStorageLicenseEnabledCheck)();if(eV.useEffect(()=>{tq.M.prewarmInfo?.isPrewarm&&(0,tB.nE)()},[]),tq.M.prewarmInfo?.isPrewarm)return eV.createElement("div",null);let v=eV.createElement(sz,{value:f},tq.M.eligibility?eV.createElement(sL.WB,{appearance:(0,tN.tn)()===eK.dg?"singlecol":"m365",sourceName:(0,tN.tn)(),scenarioName:(0,tN.tn)(),queryText:o,zeroPromptVersion:(0,tM.wX)("immersive-bizchat-try-these-prompts-sept06")?"sept06-demo":(0,tM.wX)("immersive-bizchat-proactive-carousel-card")?"1.0-carousel":"threeprompt",feedbackClientName:tF(),serviceEndpointRing:tq.M.serviceEndpointRing||void 0,serviceEndpointInfra:tq.M.serviceEndpointInfra||void 0,serviceEndpointUrl:(t=tq.M.serviceEndpointUrl,(0,tM.wX)("immersive-bizchat-gpt-demo-tenant")?"https://turingbot.sdf-test-18.substrate-turing-turingbot.eastus-sdf.cosmic-ppe.office.net/turingbot/ChatHub":(0,tM.wX)("immersive-bizchat-testhotfix-sydney-url")?"https://turingbot.sdf-test-hotfix.substrate-turing-turingbot.centralus-sdf.cosmic-ppe.office.net/SecuredChatHub":t||void 0),sessionsEndpointUrl:tq.M.sessionsEndpointUrl,sessionsVariants:tq.M.sessionsVariants,clientPlatform:tq.M?.clientType,accountInfo:tq.M?.accountInfo,disableLocalStorage:!0,isHeaderCopilotIconDisabled:!0,isDarkMode:e.isDarkMode??!1,clientCorrelationId:tq.M.clientCorrelationId,appTheme:tq.M.themeContext,metaOsSdk:l,launchOptionPrompt:tq.M.launchOptionPrompt,fetchM365ChatLicenseStatus:void 0,enableChatCIQ:(0,tM.wX)("immersive-bizchat-ciq-chat-entities"),enableEmailCIQ:(0,tM.wX)("immersive-bizchat-ciq-email-entities"),enableTopicCIQ:(0,tM.wX)("immersive-bizchat-ciq-topic-entities"),enableTopicECC:(0,tM.wX)("immersive-bizchat-ciq-topic-ecc"),enableHandoffButtons:!0,enableHybridWorkflow:(0,tM.wX)("immersive-bizchat-ciq-hybrid-workflows"),enableStreamingCursor:(0,tM.wX)("immersive-bizchat-streaming-cursor"),hostCommunication:n,onInputRenderFinished:sq,onAppRenderSuccess:sq,enable3PExtensibility:(0,tM.wX)("immersive-bizchat-3p-extensibility"),enable3PExtensibilityForOwa:(0,tM.wX)("immersive-bizchat-3p-extensibility-owa"),enable3PExtensibilityForTeams:(0,tM.wX)("immersive-bizchat-3p-extensibility-teams"),enable3PExtensibilityForOffice:(0,tM.wX)("immersive-bizchat-3p-extensibility-office"),enableMorePluginsForOwa:(0,tM.wX)("immersive-bizchat-3p-more-plugins-owa"),enableMorePluginsForTeams:(0,tM.wX)("immersive-bizchat-3p-more-plugins-teams"),enableMorePluginsForOffice:(0,tM.wX)("immersive-bizchat-3p-more-plugins-office"),enablePluginsSearchForOwa:(0,tM.wX)("immersive-bizchat-3p-plugins-search-owa"),enablePluginsSearchForTeams:(0,tM.wX)("immersive-bizchat-3p-plugins-search-teams"),enablePluginsSearchForOffice:(0,tM.wX)("immersive-bizchat-3p-plugins-search-office"),enableManagePluginsForOwa:(0,tM.wX)("immersive-bizchat-3p-manage-plugins-owa"),enableManagePluginsForTeams:(0,tM.wX)("immersive-bizchat-3p-manage-plugins-teams"),enableManagePluginsForOffice:(0,tM.wX)("immersive-bizchat-3p-manage-plugins-office"),enableStoreFrontPluginsForOwa:(0,tM.wX)("immersive-bizchat-3p-store-front-plugins-owa"),enableStoreFrontPluginsForTeams:(0,tM.wX)("immersive-bizchat-3p-store-front-plugins-teams"),enableStoreFrontPluginsForOffice:(0,tM.wX)("immersive-bizchat-3p-store-front-plugins-office"),enableFlyoutPreviewForTeams:(0,tM.wX)("immersive-bizchat-3p-flyout-preview-teams"),enableUserSettings:(0,tM.wX)("immersive-bizchat-3p-flyout-user-settings"),enableTeachingUXForPluginManagement:(0,tM.wX)("immersive-bizchat-plugin-flyout-fre"),enablePluginFlyoutV2:(0,tM.wX)("immersive-bizchat-plugin-flyout-v2"),enable3PPlugins:(0,tM.wX)("immersive-bizchat-3p-plugins"),enablePPDVPlugins:(0,tM.wX)("immersive-bizchat-ppdv-plugins"),feedbackPolicies:tq.M.feedbackPolicies?.policies,sydneyVariants:function(){let e=tq.M.sydneyVariants?[tq.M.sydneyVariants]:[];(0,tM.wX)("immersive-bizchat-handoff-sydney-outlookmailto")&&e.push("feature.OutlookComposeMailto"),(0,tM.wX)("immersive-bizchat-handoff-sydney-outlooksplitbutton")&&e.push("feature.OutlookComposeSplitButton");let t=[...new Set(e)].join(",");return(0,tj.Fi)({eventId:"SydneyVariants:",dynamicEventPart:`${t}`}),t}(),sydneyOptionsSets:function(){let e=[];if((0,tM.wX)("immersive-bizchat-avalon-endpoint")){e.push("enterprise_flux_web","enterprise_flux_work","enable_request_response_interstitials"),(0,tM.wX)("immersive-bizchat-enable-spark-text")&&e.push("enterprise_flux_spark"),(0,tM.wX)("immersive-bizchat-image-v1-option-set")?e.push("enterprise_flux_image_v1"):(0,tM.wX)("immersive-bizchat-image-option-set")&&e.push("enterprise_flux_image"),(0,tM.wX)("immersive-bizchat-image-v2-option-set")&&e.push("enterprise_flux_image_v2");let t=(0,tM.wX)("immersive-bizchat-enable-toolbox-for-teams"),r=(0,tM.wX)("immersive-bizchat-enable-toolbox-with-multi-turn-support-for-teams");t&&e.push("enterprise_toolbox_with_skdsstore"),r&&e.push("enterprise_toolbox_with_skdsstore_v2"),(0,tM.wX)("immersive-bizchat-enable-search-msg-ext-via-toolbox")&&(e.push("enterprise_toolbox_with_skdsstore_search_message_extensions"),(0,tM.wX)("immersive-bizchat-enable-msg-ext-auth-skill")&&e.push("enable_ME_auth_interstitial")),(0,tM.wX)("immersive-bizchat-enable-plugins-as-declarative-agents")&&e.push("skdsstorethirdparty"),(0,tM.wX)("immersive-bizchat-enable-client-skill")&&((0,tM.wX)("immersive-bizchat-enable-action-msg-ext-skill")&&e.push("teams_action_message_extensions_enable"),(0,tM.wX)("immersive-bizchat-enable-confirmation-dialog-skill")&&e.push("enable_confirmation_interstitial"),(0,tM.wX)("immersive-bizchat-enable-api-plugins-auth-skill")&&e.push("enable_plugin_auth_interstitial"),(0,tM.wX)("immersive-bizchat-enable-ppc-auth-skill")&&e.push("enable_ppc_auth_interstitial")),(0,tM.wX)("immersive-bizchat-enable-handoff-response-action-processing")&&e.push("enable_response_action_processing"),(0,tM.wX)("immersive-bizchat-source-attributions-avalon")&&(0,tM.wX)("immersive-bizchat-entities-message-extensions")&&e.push("teams_search_me_annotation_card_json_enable")}else(0,tM.wX)("immersive-bizchat-analytics-skill")&&e.push("enterprise_flux_analytics"),(0,tM.wX)("immersive-bizchat-handoff-buttons")&&e.push("enterprise_flux_handoff_outlook_compose"),(0,tM.wX)("immersive-bizchat-enable-calendar-handoff")&&e.push("enterprise_flux_handoff_calendar_scheduling");(0,tM.wX)("immersive-bizchat-toolbox-with-skdsstore")&&e.push("enterprise_toolbox_with_skdsstore"),(0,tM.wX)("immersive-bizchat-enable-loop-handoff")&&e.push("enterprise_flux_handoff_loop"),(0,tM.wX)("immersive-bizchat-enable-gpt4o-model-reasoning")&&e.push("enterprise_flux_work_0125"),(0,tM.wX)("immersive-bizchat-enable-gpt4o-model-responding")&&e.push("enterprise_responding_gpt4o");let t=e.join(",");return(0,tj.Fi)({eventId:"SydneyOptionsSets:",dynamicEventPart:`${t}`}),t}(),enableResponsiveExpandedECC:(0,tM.wX)("immersive-bizchat-responsive-expanded-ecc"),sessionId:tq.M.sessionID,disable3STokenInSydneyRequest:!0,enableStayOnTop:(0,tM.wX)("immersive-bizchat-stay-on-top"),enableSensitivityLabel:(0,tM.wX)("immersive-bizchat-sensitivity-label"),enabledSydneyScenarioProp:!0,enableCIQRefresh:(0,tM.wX)("immersive-bizchat-ciq-refresh"),enableNewFileTidbits:(0,tM.wX)("immersive-bizchat-enable-new-file-tidbits"),enableSydneyPromptIdProp:(0,tM.wX)("immersive-bizchat-enable-sydney-prompt-id-prop"),enableShowSydneyLatency:(0,tM.wX)("immersive-bizchat-show-sydney-latency-metrics"),enablePeopleQueryAnnotationV2:(0,tM.wX)("immersive-bizchat-ciq-people-entity-id-v2"),enableAutomate:(0,tM.wX)("immersive-bizchat-automate"),enablePromptSaving:(0,tM.wX)("immersive-bizchat-prompt-saving"),enablePromptEditing:(0,tM.wX)("immersive-bizchat-prompt-editing"),enablePromptSharing:(0,tM.wX)("immersive-bizchat-prompt-sharing"),enablePromptSharingDialog:(0,tM.wX)("immersive-bizchat-prompt-sharing-dialog"),enablePromptSavingHydratedEntities:(0,tM.wX)("immersive-bizchat-prompt-saving-hydrated-entities"),enableGradientPlaceholder:(0,tM.wX)("immersive-bizchat-enable-gradient-placeholder"),enableSourceAttributionsInAvalon:(0,tM.wX)("immersive-bizchat-source-attributions-avalon"),enableTtpPrefetch:(0,tM.wX)("immersive-bizchat-enable-ttp-prefetch"),enableWebToggleFre:(0,tM.wX)("immersive-bizchat-web-toggle-fre"),enableWebToggleFreAlwaysShown:(0,tM.wX)("immersive-bizchat-web-toggle-fre-always-shown"),enableSendConvIdForNewChat:(0,tM.wX)("immersive-bizchat-send-conv-id-for-new-chat")&&!(0,tM.wX)("immersive-bizchat-avalon-endpoint"),...(0,tM.wX)("immersive-bizchat-chathub-connection-timeout-30s")?{sydneyConnectionTimeout:3e4}:{},...(0,tM.wX)("immersive-bizchat-remove-limit-input-text-char-count")?{charCountLimit:1/0}:(0,tM.wX)("immersive-bizchat-limit-input-text-char-count-128000")?{charCountLimit:128e3}:(0,tM.wX)("immersive-bizchat-limit-input-text-char-count-16000")?{charCountLimit:16e3}:(0,tM.wX)("immersive-bizchat-limit-input-text-char-count-4000")?{charCountLimit:4e3}:(0,tM.wX)("immersive-bizchat-limit-input-text-char-count-2000")?{charCountLimit:2e3}:{},enableLogPromptId:(0,tM.wX)("immersive-bizchat-enable-log-prompt-id"),fetchPuid:tK.Iq,...(0,tM.wX)("immersive-bizchat-ciq-oa-result-timeout-7-and-half-seconds")?{ciqOAResultsTimeout:7500}:{},enablePinnedSessions:(0,tM.wX)("immersive-bizchat-sessions-pin"),enableTopicsReference:(0,tM.wX)("immersive-bizchat-topics-reference"),enableRestrictedSearchTesting:(0,tM.wX)("immersive-bizchat-enable-restricted-search-testing"),focusOnLoadSignal:h?tq.M.hostUserClickTime:void 0,focusOnLoadTarget:h?tq.M.focusOnLoad:void 0,onEscKeyDown:m,enableSearchBar:(0,tM.wX)("immersive-bizchat-enable-searchbar"),enablePlannerHandoff:(0,tM.wX)("immersive-bizchat-enable-planner-handoff"),enableGPT:(0,tM.wX)("immersive-bizchat-avalon-endpoint")&&(0,tM.wX)("immersive-bizchat-gpt"),enableGPTInDemoTenant:(0,tM.wX)("immersive-bizchat-avalon-endpoint")&&(0,tM.wX)("immersive-bizchat-gpt-demo-tenant"),enableSettings:t7(),hostScriptVersion:(0,eK.Oo)(),storedFeatureFlags:rt(),flightingConfiguration:(0,tM.Zb)(),updateSydneySettingsInCache:rn,updateFeatureFlagsInCache:ro,cleanSettingsInCache:ri,enablePromptRingTag:(0,tM.wX)("immersive-bizchat-prompt-ring-tag"),enableHandInPromptFromLaunchUrl:(0,tM.wX)("immersive-bizchat-enable-handin-prompt-from-launch-url"),enableBingAnswer:(0,tM.wX)("immersive-bizchat-enable-bing-answer"),enabelCIQBootstrapV2:(0,tM.wX)("immersive-bizchat-ciq-bootstrap-v2"),enableWebTogglePluginExt:(0,tM.wX)("immersive-bizchat-enable-web-toggle-by-default"),enableTelemetryIds:(0,tM.wX)("immersive-bizchat-sydney-telemetry-ids"),enableSydneyResponseUnpackV2:(0,tM.wX)("immersive-bizchat-sydney-response-unpack-v2"),enableSydneyStreamThrottle:(0,tM.wX)("immersive-bizchat-sydney-throttle-streaming"),enableSydneyTrafficTypeProp:(0,tM.wX)("immersive-bizchat-sydney-traffic-type"),ocpsPolicies:tq.M.ocpsPolicies,enableLatencyUX:(0,tM.wX)("immersive-bizchat-latency-ux-cards"),getChatActionCallbacks:a5,eligibilityInformation:tq.M.eligibility,enableEditorStateRefresh:(0,tM.wX)("immersive-bizchat-enable-editor-state-refresh"),enableSydneyWarmupOnInput:(0,tM.wX)("immersive-bizchat-enable-sydney-warmup-on-input"),appLoadTime:tq.M.appLoadTime,isStorageLicenseEnabled:g,enableCDPLogging:(0,tM.wX)("immersive-bizchat-enable-cdp-logging"),sendCustomMessage:si,latestConversationId:tq.M.latestConversationId,contextualChat:tq.M.contextualChat,fetchM365ChatStorageLicenseStatus:se.u}):eV.createElement(eV.Fragment,null),eV.createElement(sL.u,{isDarkMode:"dark"===tq.M.themeContext,tryFetchOneMsalToken:tY.kJ,updateIsPopUpEnabled:sj,isPopUpEnabled:tq.M.isMSALRefreshUiPopUpEnabled,setMsalFirstRequestCompleted:sS.ID,setMsalFirstRequestFinished:sS.Hl}));return eV.createElement("div",{className:r.container},v)},"ChatView");async function sU(){try{let e=await (0,rc.xq)();if(e?.page?.subPageId){let t;return(0,tM.wX)("immersive-bizchat-enable-handin-prompt-from-launch-url")?(0,tM.wX)("immersive-bizchat-enable-gzip-decompression")?((0,tj.Fi)({eventId:"HandIn.LaunchOptionsUpdate",detail:"Using gzip decompression to decode launch option from url"}),t=JSON.parse(new TextDecoder().decode(a6.Ay.inflate(tD(e.page.subPageId))))):((0,tj.Fi)({eventId:"HandIn.LaunchOptionsUpdate",detail:"Using base64UrlDecodeToBytes to decode launch option from url"}),t=JSON.parse(new TextDecoder().decode(tD(e.page.subPageId)))):t=JSON.parse(tz(e.page.subPageId)),t}}catch(e){(0,tj.Fi)({eventId:"HandIn.LaunchOptionsError",errorMessage:`Error decoding launch option from url: ${e.message}`})}}async function sH(){try{let e=await (0,rc.xq)(),t=e?.actionInfo;if(t){let e,r;let n=t.actionId;if(n?.toLowerCase()!=="summarize")return;if((0,tj.Fi)({eventId:"HandIn.DataStart",detail:`Got ActionId from app.Context. ActionId: ${n?.toLowerCase()}`}),t.actionObjects&&t.actionObjects.length>0){let o=t.actionObjects[0];if(!o)return(0,tj.Fi)({eventId:"HandIn.DataError",detail:`ActionId: ${n?.toLowerCase()}`,errorMessage:"actionObject is undefined in app.Context"}),{actionId:n,fileId:e,driveId:r};e=o.itemId;let i=o.secondaryId;r=i.name===t_.jw.DriveId?i.value:void 0,r?.trim()&&e?.trim()||(0,tj.Fi)({eventId:"HandIn.DataError",detail:`ActionId: ${n?.toLowerCase()}`,errorMessage:"driveid or fileId are invalid in app.Context"})}return{actionId:n,fileId:e,driveId:r}}}catch(e){(0,tj.Fi)({eventId:"HandIn.DataError",errorMessage:`Error getting HandInData from app.Context: ${e.message}`})}}function sq(){try{if(sD)return;(0,tj.Fi)({eventId:"ChatInput render finished."}),tx.notifySuccess(),(0,tG.oB)(),sp(),(0,so.fF)(),(0,tG.ip)(),(0,tG.Eq)(),(0,tG.yD)(),(0,tG.tM)(),(0,tG.xz)(),(0,tG.p$)(),(0,so.Ue)(),(0,eX.X)(window,tZ.H7),(0,tM.wX)("immersive-bizchat-delay-low-priority-tasks")&&cT(),((0,tM.wX)("immersive-bizchat-puid-sydney")||(0,tM.wX)("immersive-bizchat-delay-low-priority-tasks"))&&(0,tK.Oz)(),sD=!0}catch{(0,tj.Fi)({eventId:"notifySuccess fail"})}}function sj(e){(0,tj.Fi)({eventId:"LogInfo",detail:"ChatView: Poup "+(e?"enabled":"disabled"),message:new Date().getTime()}),(0,rl.H)(e)}var s$=r(450565),sW=r(703025),sV=r(655411);function sG(e,t){var r,n;return!!((null==e?void 0:null===(r=e.ownerDocument)||void 0===r?void 0:r.defaultView)&&e instanceof e.ownerDocument.defaultView[null!==(n=null==t?void 0:t.constructorName)&&void 0!==n?n:"HTMLElement"])}var sK="undefined"!=typeof WeakRef,sX=class{constructor(e){sK&&"object"==typeof e?this._weakRef=new WeakRef(e):this._instance=e}deref(){var e,t;let r;return this._weakRef?(r=null==(e=this._weakRef)?void 0:e.deref())||delete this._weakRef:(null==(t=null==(r=this._instance)?void 0:r.isDisposed)?void 0:t.call(r))&&delete this._instance,r}},sY="keyborg:focusin",sZ=!1,sQ=0,sJ=class{constructor(e,t){this._isNavigatingWithKeyboard_DO_NOT_USE=!1,this._onFocusIn=e=>{if(this._isMouseOrTouchUsedTimer||this.isNavigatingWithKeyboard)return;let t=e.detail;t.relatedTarget&&!t.isFocusedProgrammatically&&void 0!==t.isFocusedProgrammatically&&(this.isNavigatingWithKeyboard=!0)},this._onMouseDown=e=>{0!==e.buttons&&(0!==e.clientX||0!==e.clientY||0!==e.screenX||0!==e.screenY)&&this._onMouseOrTouch()},this._onMouseOrTouch=()=>{let e=this._win;e&&(this._isMouseOrTouchUsedTimer&&e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=e.setTimeout(()=>{delete this._isMouseOrTouchUsedTimer},1e3)),this.isNavigatingWithKeyboard=!1},this._onKeyDown=e=>{this.isNavigatingWithKeyboard?this._shouldDismissKeyboardNavigation(e)&&this._scheduleDismiss():this._shouldTriggerKeyboardNavigation(e)&&(this.isNavigatingWithKeyboard=!0)},this.id="c"+ ++sQ,this._win=e;let r=e.document;if(t){let e=t.triggerKeys,r=t.dismissKeys;(null==e?void 0:e.length)&&(this._triggerKeys=new Set(e)),(null==r?void 0:r.length)&&(this._dismissKeys=new Set(r))}r.addEventListener(sY,this._onFocusIn,!0),r.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),r.addEventListener("touchstart",this._onMouseOrTouch,!0),r.addEventListener("touchend",this._onMouseOrTouch,!0),r.addEventListener("touchcancel",this._onMouseOrTouch,!0),function(e){sZ||(sZ=function(e){let t=e.HTMLElement,r=t.prototype.focus,n=!1;return t.prototype.focus=function(){n=!0},e.document.createElement("button").focus(),t.prototype.focus=r,n}(e));let t=e.HTMLElement.prototype.focus;if(t.__keyborgNativeFocus)return;e.HTMLElement.prototype.focus=s;let r=new Set,n=e=>{let t=e.target;if(!t)return;let r=new CustomEvent("keyborg:focusout",{cancelable:!0,bubbles:!0,composed:!0,detail:{originalEvent:e}});t.dispatchEvent(r)},o=e=>{let t=e.target;if(!t)return;let a=e.composedPath()[0],s=new Set;for(;a;)a.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(s.add(a),a=a.host):a=a.parentNode;for(let e of r){let t=e.deref();t&&s.has(t)||(r.delete(e),t&&(t.removeEventListener("focusin",o,!0),t.removeEventListener("focusout",n,!0)))}i(t,e.relatedTarget||void 0)},i=(e,t,i)=>{var s;let l=e.shadowRoot;if(l){for(let e of r)if(e.deref()===l)return;l.addEventListener("focusin",o,!0),l.addEventListener("focusout",n,!0),r.add(new sX(l));return}let c={relatedTarget:t,originalEvent:i},u=new CustomEvent(sY,{cancelable:!0,bubbles:!0,composed:!0,detail:c});u.details=c,(sZ||a.lastFocusedProgrammatically)&&(c.isFocusedProgrammatically=e===(null==(s=a.lastFocusedProgrammatically)?void 0:s.deref()),a.lastFocusedProgrammatically=void 0),e.dispatchEvent(u)},a=e.__keyborgData={focusInHandler:o,focusOutHandler:n,shadowTargets:r};function s(){let r=e.__keyborgData;return r&&(r.lastFocusedProgrammatically=new sX(this)),t.apply(this,arguments)}e.document.addEventListener("focusin",e.__keyborgData.focusInHandler,!0),e.document.addEventListener("focusout",e.__keyborgData.focusOutHandler,!0);let l=e.document.activeElement;for(;l&&l.shadowRoot;)i(l),l=l.shadowRoot.activeElement;s.__keyborgNativeFocus=t}(e)}get isNavigatingWithKeyboard(){return this._isNavigatingWithKeyboard_DO_NOT_USE}set isNavigatingWithKeyboard(e){this._isNavigatingWithKeyboard_DO_NOT_USE!==e&&(this._isNavigatingWithKeyboard_DO_NOT_USE=e,this.update())}dispose(){let e=this._win;if(e){this._isMouseOrTouchUsedTimer&&(e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=void 0),this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0),function(e){let t=e.HTMLElement.prototype,r=t.focus.__keyborgNativeFocus,n=e.__keyborgData;if(n){for(let t of(e.document.removeEventListener("focusin",n.focusInHandler,!0),e.document.removeEventListener("focusout",n.focusOutHandler,!0),n.shadowTargets)){let e=t.deref();e&&(e.removeEventListener("focusin",n.focusInHandler,!0),e.removeEventListener("focusout",n.focusOutHandler,!0))}n.shadowTargets.clear(),delete e.__keyborgData}r&&(t.focus=r)}(e);let t=e.document;t.removeEventListener(sY,this._onFocusIn,!0),t.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener("touchstart",this._onMouseOrTouch,!0),t.removeEventListener("touchend",this._onMouseOrTouch,!0),t.removeEventListener("touchcancel",this._onMouseOrTouch,!0),delete this._win}}isDisposed(){return!!this._win}update(){var e,t;let r=null==(t=null==(e=this._win)?void 0:e.__keyborg)?void 0:t.refs;if(r)for(let e of Object.keys(r))s0.update(r[e],this.isNavigatingWithKeyboard)}_shouldTriggerKeyboardNavigation(e){var t;if("Tab"===e.key)return!0;let r=null==(t=this._win)?void 0:t.document.activeElement,n=!this._triggerKeys||this._triggerKeys.has(e.keyCode),o=r&&("INPUT"===r.tagName||"TEXTAREA"===r.tagName||r.isContentEditable);return n&&!o}_shouldDismissKeyboardNavigation(e){var t;return null==(t=this._dismissKeys)?void 0:t.has(e.keyCode)}_scheduleDismiss(){let e=this._win;if(e){this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0);let t=e.document.activeElement;this._dismissTimer=e.setTimeout(()=>{this._dismissTimer=void 0;let r=e.document.activeElement;t&&r&&t===r&&(this.isNavigatingWithKeyboard=!1)},500)}}},s0=class e{constructor(e,t){this._cb=[],this._id="k"+ ++sQ,this._win=e;let r=e.__keyborg;r?(this._core=r.core,r.refs[this._id]=this):(this._core=new sJ(e,t),e.__keyborg={core:this._core,refs:{[this._id]:this}})}static create(t,r){return new e(t,r)}static dispose(e){e.dispose()}static update(e,t){e._cb.forEach(e=>e(t))}dispose(){var e;let t=null==(e=this._win)?void 0:e.__keyborg;(null==t?void 0:t.refs[this._id])&&(delete t.refs[this._id],0===Object.keys(t.refs).length&&(t.core.dispose(),delete this._win.__keyborg)),this._cb=[],delete this._core,delete this._win}isNavigatingWithKeyboard(){var e;return!!(null==(e=this._core)?void 0:e.isNavigatingWithKeyboard)}subscribe(e){this._cb.push(e)}unsubscribe(e){let t=this._cb.indexOf(e);t>=0&&this._cb.splice(t,1)}setVal(e){this._core&&(this._core.isNavigatingWithKeyboard=e)}};let s1="data-fui-focus-visible";var s2=r(202801),s3=r(166159),s5=r(838665),s6=r(422275);let s4=(...e)=>{let t={};for(let r of e)for(let e of Array.isArray(r)?r:Object.keys(r))t[e]=1;return t},s8=s4(["onAuxClick","onAnimationEnd","onAnimationStart","onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),s9=s4(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),s7=s4(["itemID","itemProp","itemRef","itemScope","itemType"]),le=s4(s9,s8,s7),lt=s4(le,["form"]),lr=s4(le,["height","loop","muted","preload","src","width"]),ln=s4(lr,["poster"]),lo=s4(le,["start"]),li=s4(le,["value"]),la=s4(le,["download","href","hrefLang","media","rel","target","type"]),ls=s4(le,["dateTime"]),ll=s4(le,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),lc=s4(ll,["accept","alt","autoCorrect","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),lu=s4(ll,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),ld=s4(ll,["form","multiple","required"]),lf=s4(le,["selected","value"]),lh=s4(le,["cellPadding","cellSpacing"]),lp=s4(le,["colSpan","rowSpan","scope"]),lm=s4(le,["colSpan","headers","rowSpan","scope"]),lg=s4(le,["span"]),lv=s4(le,["span"]),lb=s4(le,["disabled","form"]),ly=s4(le,["acceptCharset","action","encType","encType","method","noValidate","target"]),lw=s4(le,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),lS=s4(le,["alt","crossOrigin","height","src","srcSet","useMap","width"]),lC=s4(le,["open","onCancel","onClose"]),lI={label:lt,audio:lr,video:ln,ol:lo,li:li,a:la,button:ll,input:lc,textarea:lu,select:ld,option:lf,table:lh,tr:le,th:lp,td:lm,colGroup:lg,col:lv,fieldset:lb,form:ly,iframe:lw,img:lS,time:ls,dialog:lC},lk=(e,t,r)=>{var n;return function(e,t,r){let n=e&&lI[e]||le;return n.as=1,function(e,t,r){let n=Array.isArray(t),o={};for(let i of Object.keys(e))(!n&&t[i]||n&&t.indexOf(i)>=0||0===i.indexOf("data-")||0===i.indexOf("aria-"))&&(!r||(null==r?void 0:r.indexOf(i))===-1)&&(o[i]=e[i]);return o}(t,n,r)}(null!==(n=t.as)&&void 0!==n?n:e,t,r)};var lE=r(564188);let l_={},lA={},lT=(e,t)=>{var r;let n=(0,sV.Y)(),o=eV.useContext(s5.D),i=(0,s2.Pv)(),a=eV.useContext(s3.k7)||l_,{applyStylesToPortals:s=!0,customStyleHooks_unstable:l,dir:c=n.dir,targetDocument:u=n.targetDocument,theme:d,overrides_unstable:f={}}=e,h=lP(o,d),p=lP(i,f),m=lP(a,l),g=(0,sW.J)(),{styleTagId:v,rule:b}=(0,lE.V)({theme:h,targetDocument:u,rendererAttributes:null!==(r=g.styleElementAttributes)&&void 0!==r?r:lA});return{applyStylesToPortals:s,customStyleHooks_unstable:m,dir:c,targetDocument:u,theme:h,overrides_unstable:p,themeClassName:v,components:{root:"div"},root:s6.Gk(lk("div",{...e,dir:c,ref:function(...e){let t=eV.useCallback(r=>{for(let n of(t.current=r,e))"function"==typeof n?n(r):n&&(n.current=r)},[...e]);return t}(t,function(e={}){var t;let r=(0,sV.Y)(),n=eV.useRef(null),o=null!==(t=e.targetDocument)&&void 0!==t?t:r.targetDocument;return eV.useEffect(()=>{if((null==o?void 0:o.defaultView)&&n.current)return function(e,t){if(function e(t){return!!t&&(!!t.focusVisible||e(null==t?void 0:t.parentElement))}(e))return()=>void 0;let r={current:void 0},n=s0.create(t,void 0);function o(e){n.isNavigatingWithKeyboard()&&sG(e)&&(r.current=e,e.setAttribute(s1,""))}function i(){r.current&&(r.current.removeAttribute(s1),r.current=void 0)}n.subscribe(e=>{e||i()});let a=e=>{i(),o(e.composedPath()[0])},s=t=>{(!t.relatedTarget||sG(t.relatedTarget)&&!e.contains(t.relatedTarget))&&i()};return e.addEventListener(sY,a),e.addEventListener("focusout",s),e.focusVisible=!0,e.contains(t.document.activeElement)&&o(t.document.activeElement),()=>{i(),e.removeEventListener(sY,a),e.removeEventListener("focusout",s),delete e.focusVisible,s0.dispose(n)}}(n.current,o.defaultView)},[n,o]),n}({targetDocument:u}))}),{elementType:"div"}),serverStyleProps:{cssRule:b,attributes:{...g.styleElementAttributes,id:v}}}};function lP(e,t){return e&&t?{...e,...t}:e||t}var lO=r(154832),lR=r(402087);let lx=eV.forwardRef((e,t)=>{let r=lT(e,t);(0,lO.K)(r);let n=(0,lR.r)(r);return(0,s$.t)(r,n)});lx.displayName="FluentProvider";var lM=r(988622),lN=r(395417),lF=r(958063);let lL={10:"#16152B",20:"#1E1D40",30:"#27265C",40:"#2E2E78",50:"#353696",60:"#3B3FB2",70:"#3E45C9",80:"#464FEB",90:"#515EF5",100:"#7385FF",110:"#8295FF",120:"#96A6FF",130:"#B0BEFF",140:"#CCD6FF",150:"#CCD6FF",160:"#E0E7FF"},lz=(0,lN.a)(lL),lD=(0,lF.W)(lL);var lB=r(31791);let lU=(0,tU.n)({container:{width:"100%",height:"100%",...lB.shorthands.overflow("hidden"),display:"flex",flexDirection:"column",alignItems:"center"},wrapper:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",filter:"blur(0)",...lB.shorthands.transition("filter","0.4s","ease-in-out")}});var lH=r(432884),lq=r(921902),lj=r(297483);let l$=lq.TQ.reduce((e,t)=>{let r=t.slice(0,1).toUpperCase()+t.slice(1);return Object.assign(e,{[`colorPalette${r}Background1`]:lH.mY,[`colorPalette${r}Background2`]:lH.mY,[`colorPalette${r}Background3`]:lH.Fn,[`colorPalette${r}Foreground1`]:lH.Fn,[`colorPalette${r}Foreground2`]:lH.Fn,[`colorPalette${r}Foreground3`]:lH.Fn,[`colorPalette${r}BorderActive`]:lH.Si,[`colorPalette${r}Border1`]:lH.Fn,[`colorPalette${r}Border2`]:lH.Fn})},{});l$.colorPaletteRedForegroundInverted=lH.Fn,l$.colorPaletteGreenForegroundInverted=lH.Fn,l$.colorPaletteYellowForegroundInverted=lH.Fn;let lW=lq.dt.reduce((e,t)=>{let r=t.slice(0,1).toUpperCase()+t.slice(1);return Object.assign(e,{[`colorPalette${r}Background2`]:lH.mY,[`colorPalette${r}Foreground2`]:lH.Fn,[`colorPalette${r}BorderActive`]:lH.Si})},{}),lV={...l$,...lW},lG=Object.entries(lj.s).reduce((e,[t,r])=>{let n=t.slice(0,1).toUpperCase()+t.slice(1);return Object.assign(e,{[`colorStatus${n}Background1`]:lH.mY,[`colorStatus${n}Background2`]:lH.mY,[`colorStatus${n}Background3`]:lH.Fn,[`colorStatus${n}Foreground1`]:lH.Fn,[`colorStatus${n}Foreground2`]:lH.Fn,[`colorStatus${n}Foreground3`]:lH.Fn,[`colorStatus${n}BorderActive`]:lH.Si,[`colorStatus${n}ForegroundInverted`]:lH.Fn,[`colorStatus${n}Border1`]:lH.Fn,[`colorStatus${n}Border2`]:lH.Fn})},{});lG.colorStatusDangerBackground3Hover=lH.Si,lG.colorStatusDangerBackground3Pressed=lH.Si;let lK=()=>({colorNeutralForeground1:lH.Fn,colorNeutralForeground1Hover:lH.fo,colorNeutralForeground1Pressed:lH.fo,colorNeutralForeground1Selected:lH.fo,colorNeutralForeground2:lH.Fn,colorNeutralForeground2Hover:lH.fo,colorNeutralForeground2Pressed:lH.fo,colorNeutralForeground2Selected:lH.fo,colorNeutralForeground2BrandHover:lH.fo,colorNeutralForeground2BrandPressed:lH.fo,colorNeutralForeground2BrandSelected:lH.fo,colorNeutralForeground3:lH.Fn,colorNeutralForeground3Hover:lH.fo,colorNeutralForeground3Pressed:lH.fo,colorNeutralForeground3Selected:lH.fo,colorNeutralForeground3BrandHover:lH.fo,colorNeutralForeground3BrandPressed:lH.fo,colorNeutralForeground3BrandSelected:lH.fo,colorNeutralForeground4:lH.Fn,colorNeutralForegroundDisabled:lH.m4,colorNeutralForegroundInvertedDisabled:lH.m4,colorBrandForegroundLink:lH.aJ,colorBrandForegroundLinkHover:lH.aJ,colorBrandForegroundLinkPressed:lH.aJ,colorBrandForegroundLinkSelected:lH.aJ,colorNeutralForeground2Link:lH.aJ,colorNeutralForeground2LinkHover:lH.aJ,colorNeutralForeground2LinkPressed:lH.aJ,colorNeutralForeground2LinkSelected:lH.aJ,colorCompoundBrandForeground1:lH.Si,colorCompoundBrandForeground1Hover:lH.Si,colorCompoundBrandForeground1Pressed:lH.Si,colorBrandForeground1:lH.Fn,colorBrandForeground2:lH.Fn,colorBrandForeground2Hover:lH.Fn,colorBrandForeground2Pressed:lH.Fn,colorNeutralForeground1Static:lH.mY,colorNeutralForegroundStaticInverted:lH.Fn,colorNeutralForegroundInverted:lH.fo,colorNeutralForegroundInvertedHover:lH.fo,colorNeutralForegroundInvertedPressed:lH.fo,colorNeutralForegroundInvertedSelected:lH.fo,colorNeutralForegroundInverted2:lH.Fn,colorNeutralForegroundOnBrand:lH.p1,colorNeutralForegroundInvertedLink:lH.aJ,colorNeutralForegroundInvertedLinkHover:lH.aJ,colorNeutralForegroundInvertedLinkPressed:lH.aJ,colorNeutralForegroundInvertedLinkSelected:lH.aJ,colorBrandForegroundInverted:lH.Fn,colorBrandForegroundInvertedHover:lH.fo,colorBrandForegroundInvertedPressed:lH.fo,colorBrandForegroundOnLight:lH.p1,colorBrandForegroundOnLightHover:lH.fo,colorBrandForegroundOnLightPressed:lH.fo,colorBrandForegroundOnLightSelected:lH.fo,colorNeutralBackground1:lH.mY,colorNeutralBackground1Hover:lH.Si,colorNeutralBackground1Pressed:lH.Si,colorNeutralBackground1Selected:lH.Si,colorNeutralBackground2:lH.mY,colorNeutralBackground2Hover:lH.Si,colorNeutralBackground2Pressed:lH.Si,colorNeutralBackground2Selected:lH.Si,colorNeutralBackground3:lH.mY,colorNeutralBackground3Hover:lH.Si,colorNeutralBackground3Pressed:lH.Si,colorNeutralBackground3Selected:lH.Si,colorNeutralBackground4:lH.mY,colorNeutralBackground4Hover:lH.Si,colorNeutralBackground4Pressed:lH.Si,colorNeutralBackground4Selected:lH.Si,colorNeutralBackground5:lH.mY,colorNeutralBackground5Hover:lH.Si,colorNeutralBackground5Pressed:lH.Si,colorNeutralBackground5Selected:lH.Si,colorNeutralBackground6:lH.mY,colorNeutralBackgroundInverted:lH.mY,colorNeutralBackgroundStatic:lH.mY,colorNeutralBackgroundAlpha:lH.mY,colorNeutralBackgroundAlpha2:lH.mY,colorSubtleBackground:"transparent",colorSubtleBackgroundHover:lH.Si,colorSubtleBackgroundPressed:lH.Si,colorSubtleBackgroundSelected:lH.Si,colorSubtleBackgroundLightAlphaHover:lH.Si,colorSubtleBackgroundLightAlphaPressed:lH.Si,colorSubtleBackgroundLightAlphaSelected:lH.Si,colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:lH.Si,colorSubtleBackgroundInvertedPressed:lH.Si,colorSubtleBackgroundInvertedSelected:lH.Si,colorTransparentBackground:"transparent",colorTransparentBackgroundHover:lH.Si,colorTransparentBackgroundPressed:lH.Si,colorTransparentBackgroundSelected:lH.Si,colorNeutralBackgroundDisabled:lH.mY,colorNeutralBackgroundInvertedDisabled:lH.mY,colorNeutralStencil1:lH.Fn,colorNeutralStencil2:lH.Fn,colorNeutralStencil1Alpha:lH.Fn,colorNeutralStencil2Alpha:lH.Fn,colorBackgroundOverlay:lH.Q1[50],colorScrollbarOverlay:lH.p6,colorBrandBackground:lH.p6,colorBrandBackgroundHover:lH.Si,colorBrandBackgroundPressed:lH.Si,colorBrandBackgroundSelected:lH.Si,colorCompoundBrandBackground:lH.Si,colorCompoundBrandBackgroundHover:lH.Si,colorCompoundBrandBackgroundPressed:lH.Si,colorBrandBackgroundStatic:lH.mY,colorBrandBackground2:lH.mY,colorBrandBackground2Hover:lH.mY,colorBrandBackground2Pressed:lH.mY,colorBrandBackground3Static:lH.mY,colorBrandBackground4Static:lH.mY,colorBrandBackgroundInverted:lH.p6,colorBrandBackgroundInvertedHover:lH.Si,colorBrandBackgroundInvertedPressed:lH.Si,colorBrandBackgroundInvertedSelected:lH.Si,colorNeutralCardBackground:lH.mY,colorNeutralCardBackgroundHover:lH.Si,colorNeutralCardBackgroundPressed:lH.Si,colorNeutralCardBackgroundSelected:lH.Si,colorNeutralCardBackgroundDisabled:lH.mY,colorNeutralStrokeAccessible:lH.Fn,colorNeutralStrokeAccessibleHover:lH.Si,colorNeutralStrokeAccessiblePressed:lH.Si,colorNeutralStrokeAccessibleSelected:lH.Si,colorNeutralStroke1:lH.Fn,colorNeutralStroke1Hover:lH.Si,colorNeutralStroke1Pressed:lH.Si,colorNeutralStroke1Selected:lH.Si,colorNeutralStroke2:lH.Fn,colorNeutralStroke3:lH.Fn,colorNeutralStrokeSubtle:lH.Fn,colorNeutralStrokeOnBrand:lH.mY,colorNeutralStrokeOnBrand2:lH.Fn,colorNeutralStrokeOnBrand2Hover:lH.Fn,colorNeutralStrokeOnBrand2Pressed:lH.Fn,colorNeutralStrokeOnBrand2Selected:lH.Fn,colorBrandStroke1:lH.Fn,colorBrandStroke2:lH.Fn,colorBrandStroke2Hover:lH.Si,colorBrandStroke2Pressed:lH.Si,colorBrandStroke2Contrast:lH.mY,colorCompoundBrandStroke:lH.Si,colorCompoundBrandStrokeHover:lH.Si,colorCompoundBrandStrokePressed:lH.Si,colorNeutralStrokeDisabled:lH.m4,colorNeutralStrokeInvertedDisabled:lH.m4,colorTransparentStroke:lH.Fn,colorTransparentStrokeInteractive:lH.Si,colorTransparentStrokeDisabled:lH.m4,colorNeutralStrokeAlpha:lH.Fn,colorNeutralStrokeAlpha2:lH.mY,colorStrokeFocus1:lH.mY,colorStrokeFocus2:lH.Si,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"});var lX=r(733108),lY=r(72012),lZ=r(57817),lQ=r(869611),lJ=r(512431),l0=r(514820),l1=r(52358);let l2={...lY.aI,fontFamilyBase:'-apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, "Apple Color Emoji", "Segoe UI Emoji", sans-serif'},l3={...(()=>{let e=lK();return{...lX.V,...lY.GR,...lY.lm,...lY.aI,...lY.NM,...lZ.k,...l1.b,...l1.F,...lJ.S,...l0.L,...e,...lV,...lG,...(0,lQ.t)(e.colorNeutralShadowAmbient,e.colorNeutralShadowKey),...(0,lQ.t)(e.colorBrandShadowAmbient,e.colorBrandShadowKey,"Brand")}})(),...l2};var l5=r(278545);let l6=e=>({colorNeutralForeground1:lH.ON,colorNeutralForeground1Hover:lH.ON,colorNeutralForeground1Pressed:lH.ON,colorNeutralForeground1Selected:lH.ON,colorNeutralForeground2:lH.Oh[84],colorNeutralForeground2Hover:lH.ON,colorNeutralForeground2Pressed:lH.ON,colorNeutralForeground2Selected:lH.ON,colorNeutralForeground2BrandHover:e[100],colorNeutralForeground2BrandPressed:e[90],colorNeutralForeground2BrandSelected:e[100],colorNeutralForeground3:lH.Oh[68],colorNeutralForeground3Hover:lH.Oh[84],colorNeutralForeground3Pressed:lH.Oh[84],colorNeutralForeground3Selected:lH.Oh[84],colorNeutralForeground3BrandHover:e[100],colorNeutralForeground3BrandPressed:e[90],colorNeutralForeground3BrandSelected:e[100],colorNeutralForeground4:lH.Oh[60],colorNeutralForegroundDisabled:lH.Oh[36],colorNeutralForegroundInvertedDisabled:lH.c8[40],colorBrandForegroundLink:e[100],colorBrandForegroundLinkHover:e[110],colorBrandForegroundLinkPressed:e[90],colorBrandForegroundLinkSelected:e[100],colorNeutralForeground2Link:lH.Oh[84],colorNeutralForeground2LinkHover:lH.ON,colorNeutralForeground2LinkPressed:lH.ON,colorNeutralForeground2LinkSelected:lH.ON,colorCompoundBrandForeground1:e[100],colorCompoundBrandForeground1Hover:e[110],colorCompoundBrandForeground1Pressed:e[90],colorBrandForeground1:e[100],colorBrandForeground2:e[120],colorBrandForeground2Hover:e[130],colorBrandForeground2Pressed:e[160],colorNeutralForeground1Static:lH.Oh[14],colorNeutralForegroundStaticInverted:lH.ON,colorNeutralForegroundInverted:lH.Oh[14],colorNeutralForegroundInvertedHover:lH.Oh[14],colorNeutralForegroundInvertedPressed:lH.Oh[14],colorNeutralForegroundInvertedSelected:lH.Oh[14],colorNeutralForegroundInverted2:lH.Oh[14],colorNeutralForegroundOnBrand:lH.ON,colorNeutralForegroundInvertedLink:lH.ON,colorNeutralForegroundInvertedLinkHover:lH.ON,colorNeutralForegroundInvertedLinkPressed:lH.ON,colorNeutralForegroundInvertedLinkSelected:lH.ON,colorBrandForegroundInverted:e[80],colorBrandForegroundInvertedHover:e[70],colorBrandForegroundInvertedPressed:e[60],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:lH.Oh[16],colorNeutralBackground1Hover:lH.Oh[24],colorNeutralBackground1Pressed:lH.Oh[12],colorNeutralBackground1Selected:lH.Oh[22],colorNeutralBackground2:lH.Oh[14],colorNeutralBackground2Hover:lH.Oh[22],colorNeutralBackground2Pressed:lH.Oh[10],colorNeutralBackground2Selected:lH.Oh[20],colorNeutralBackground3:lH.Oh[12],colorNeutralBackground3Hover:lH.Oh[20],colorNeutralBackground3Pressed:lH.Oh[8],colorNeutralBackground3Selected:lH.Oh[18],colorNeutralBackground4:lH.Oh[8],colorNeutralBackground4Hover:lH.Oh[16],colorNeutralBackground4Pressed:lH.Oh[4],colorNeutralBackground4Selected:lH.Oh[14],colorNeutralBackground5:lH.Oh[4],colorNeutralBackground5Hover:lH.Oh[12],colorNeutralBackground5Pressed:lH.Ql,colorNeutralBackground5Selected:lH.Oh[10],colorNeutralBackground6:lH.Oh[20],colorNeutralBackgroundInverted:lH.ON,colorNeutralBackgroundStatic:lH.Oh[24],colorNeutralBackgroundAlpha:lH.ti[50],colorNeutralBackgroundAlpha2:lH.Z1[70],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:lH.Oh[22],colorSubtleBackgroundPressed:lH.Oh[18],colorSubtleBackgroundSelected:lH.Oh[20],colorSubtleBackgroundLightAlphaHover:lH.Xv[80],colorSubtleBackgroundLightAlphaPressed:lH.Xv[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:lH.Q1[10],colorSubtleBackgroundInvertedPressed:lH.Q1[30],colorSubtleBackgroundInvertedSelected:lH.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:lH.Oh[8],colorNeutralBackgroundInvertedDisabled:lH.c8[10],colorNeutralStencil1:lH.Oh[34],colorNeutralStencil2:lH.Oh[20],colorNeutralStencil1Alpha:lH.c8[10],colorNeutralStencil2Alpha:lH.c8[5],colorBackgroundOverlay:lH.Q1[50],colorScrollbarOverlay:lH.c8[60],colorBrandBackground:e[70],colorBrandBackgroundHover:e[80],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[100],colorCompoundBrandBackgroundHover:e[110],colorCompoundBrandBackgroundPressed:e[90],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[20],colorBrandBackground2Hover:e[40],colorBrandBackground2Pressed:e[10],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:lH.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:lH.Oh[20],colorNeutralCardBackgroundHover:lH.Oh[24],colorNeutralCardBackgroundPressed:lH.Oh[18],colorNeutralCardBackgroundSelected:lH.Oh[22],colorNeutralCardBackgroundDisabled:lH.Oh[8],colorNeutralStrokeAccessible:lH.Oh[68],colorNeutralStrokeAccessibleHover:lH.Oh[74],colorNeutralStrokeAccessiblePressed:lH.Oh[70],colorNeutralStrokeAccessibleSelected:e[100],colorNeutralStroke1:lH.Oh[40],colorNeutralStroke1Hover:lH.Oh[46],colorNeutralStroke1Pressed:lH.Oh[42],colorNeutralStroke1Selected:lH.Oh[44],colorNeutralStroke2:lH.Oh[32],colorNeutralStroke3:lH.Oh[24],colorNeutralStrokeSubtle:lH.Oh[4],colorNeutralStrokeOnBrand:lH.Oh[16],colorNeutralStrokeOnBrand2:lH.ON,colorNeutralStrokeOnBrand2Hover:lH.ON,colorNeutralStrokeOnBrand2Pressed:lH.ON,colorNeutralStrokeOnBrand2Selected:lH.ON,colorBrandStroke1:e[100],colorBrandStroke2:e[50],colorBrandStroke2Hover:e[50],colorBrandStroke2Pressed:e[30],colorBrandStroke2Contrast:e[50],colorCompoundBrandStroke:e[90],colorCompoundBrandStrokeHover:e[100],colorCompoundBrandStrokePressed:e[80],colorNeutralStrokeDisabled:lH.Oh[26],colorNeutralStrokeInvertedDisabled:lH.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:lH.c8[10],colorNeutralStrokeAlpha2:lH.c8[20],colorStrokeFocus1:lH.Ql,colorStrokeFocus2:lH.ON,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}),l4={10:"#2b2b40",20:"#2f2f4a",30:"#333357",40:"#383966",50:"#3d3e78",60:"#444791",70:"#4f52b2",80:"#5b5fc7",90:"#7579eb",100:"#7f85f5",110:"#9299f7",120:"#aab1fa",130:"#b6bcfa",140:"#c5cbfa",150:"#dce0fa",160:"#e8ebfa"},l8={...(e=>{let t=l6(e);return{...lX.V,...lY.GR,...lY.lm,...lY.aI,...lY.NM,...lZ.k,...l1.b,...l1.F,...lJ.S,...l0.L,...t,...l5.h,...l5.m,...(0,lQ.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...(0,lQ.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}})(l4),...l2},l9={...(0,lN.a)(l4),...l2},l7=(0,tJ.jK)("updateThemeContext",e=>{tq.M.themeContext=e}),ce=(0,tJ.jK)("updateLatestConversationId",e=>{tq.M.latestConversationId=e}),ct=(0,tJ.jK)("updateContextualChatMutator",e=>{tq.M.contextualChat=e}),cr={width:"100%",height:"100%",overflowY:"auto",display:"flex",flexDirection:"column",alignItems:"center"},cn=(0,eG.P)(({runtimeFactory:e,isFlightsFromCache:t})=>{let r=co(tq.M.themeContext);eV.useEffect(()=>{if(!tq.M.prewarmInfo?.isPrewarm){let e=async()=>{l7((await (0,rc.xq)()).app.theme)};tx.isInitialized()&&(e(),tx.registerOnThemeChangeHandler((e=tq.M.themeContext)=>{(0,tj.Fi)({eventId:"LogInfo",detail:`Theme Context: ${e}`}),l7(e)})),(0,tj.Fi)({eventId:"onLoadMainView-Finish"})}},[tq.M.themeContext]),eV.useEffect(()=>{tq.M.prewarmInfo?.isPrewarm||(0,tj.Fi)({eventId:"onLoadMainView-Start"})},[]),eV.useEffect(()=>{(0,tN.tn)()===eK.dg&&(rm("reloadConversation",e=>(ce(e),[])),rm("contextualChatChanged",e=>(ct(e),[])))},[]),(0,tM.wX)("immersive-bizchat-enable-windowevent-logging")&&window.addEventListener("error",e=>{(0,tj.Fi)({eventId:"Error",detail:"WindowEvent Error:"+function(e){try{var t=e.match("(http|ws)[s]?://.*?/([a-zA-Z-_]+).*$");if(t&&t.length>1){(0,tj.Fi)({eventId:"LogInfo",detail:"WindowEvent Error: extracting only base url from error message"});var r=new URL(t[0]).hostname;return e.replace(t[0],r)}}catch(e){return(0,tj.Fi)({eventId:"LogInfo",detail:"WindowEvent Error: Failed parse and remove UserInfo"}),""}return e}(e.message)})});let n=lU();return eV.createElement(lx,{theme:r,style:cr},eV.createElement("div",{className:n.container},eV.createElement("div",{className:n.wrapper},(0,tG.wb)()?eV.createElement(sR,{isDarkMode:"dark"===tq.M.themeContext,runtimeFactory:e,isFlightsFromCache:t}):eV.createElement(sB,{isDarkMode:"dark"===tq.M.themeContext,runtimeFactory:e,isFlightsFromCache:t}))))},"MainView"),co=e=>{let t=(0,lM.d)("dark"===e),r=(0,tN.tn)(),n=t;if("contrast"===e)return l3;switch(r){case eK.Ah:case eK.EO:n="dark"===e?lD:lz;break;case eK.Hz:n="dark"===e?l8:l9}return n},ci=(0,tJ.jK)("updateMetaOSAppIds",(e,t,r)=>{tq.M.metaOSAppSessionId=e??"",tq.M.metaOSAppHostSessionId=t??"",tq.M.metaOSAppLaunchId=r??""}),ca=(0,tJ.jK)("updateClientType",e=>{tq.M.clientType=e}),cs=(0,tJ.jK)("updateEcsConfigIds",e=>{tq.M.ecsConfigIds=e}),cl=(0,tJ.jK)("updateIsSessionStartInBackground",e=>{tq.M.isSessionStartInBackground=e}),cc=(0,tJ.jK)("updateEnableDeeplinks",e=>{if(e)try{let t=JSON.parse(e);tq.M.enableDeeplinks=!!t?.hostSettings?.enableDeeplinks}catch(e){tq.M.enableDeeplinks=!1}else tq.M.enableDeeplinks=!1;(0,tj.Fi)({eventId:"set enableDeeplinks to",dynamicEventPart:tq.M.enableDeeplinks?"true":"false"})}),cu=(0,tJ.jK)("updateFocusOnLoad",(e,t=0)=>{let{focusOnLoad:r,hostUserClickTime:n}=tq.M;if(e)try{let r=JSON.parse(e);tq.M.focusOnLoad=r?.hostSettings?.focusOnLoad,tq.M.hostUserClickTime=t}catch(e){tq.M.focusOnLoad="",tq.M.hostUserClickTime=0}else tq.M.focusOnLoad="",tq.M.hostUserClickTime=0;(r!==tq.M.focusOnLoad||n!==tq.M.hostUserClickTime)&&(0,tj.Fi)({eventId:"UXDiagnostic",detail:`Set focusOnLoad: ${tq.M.focusOnLoad} hostUserClickTime: ${tq.M.hostUserClickTime}`})});var cd=r(873209);let cf=(0,tJ.jK)("updateAccountInfo",e=>{if(e){let t={...e,fetchUserName:cd.K};tq.M.accountInfo=t}}),ch=(0,tJ.jK)("updateIsEuropeUser",e=>{tq.M.isEuropeUser=e,tq.M.accountInfo={...tq.M.accountInfo,isEu:2===e||3!==e&&void 0}}),cp=(0,tJ.jK)("updateMetaOSAppContext",e=>{tq.M.metaOSAppContext=e}),cm=(0,tJ.jK)("updateBrowserId",e=>{tq.M.browserId=e??""}),cg=(0,tJ.jK)("updateReferrer",e=>{tq.M.referrer=e??""}),cv=(0,tJ.jK)("updateNavigationType",e=>{tq.M.navigationType=e??""}),cb="cafe",cy=(0,tJ.jK)("updateLocale",e=>{tq.M.locale=e}),cw=(0,tJ.jK)("updateMetaOSAppHostRing",e=>{tq.M.metaOSAppHostRing=e??""}),cS=(0,tJ.jK)("updatePrewarmInfo",e=>{e&&(tq.M.prewarmInfo=e)});var cC=r(340828),cI=r(38303);let ck="ImmersiveBizChat-ReloadedSession",cE=!1,c_=e=>{let t=ra(),r=(0,tM.cM)(function(e){if(!e)return;let t={};for(let[r,n]of Object.entries(e))t[r]=n;return t}(e.ecsFlights),t?.featureFlags);if(r&&r["immersive-bizchat-settings-panel"]){let e=function(e){for(let[t,r]of new URLSearchParams(window.location.search))if(t.toLowerCase()===e.toLowerCase())return r.split(",").reduce((e,t)=>{let r=!0;return 0===t.indexOf("-")&&(r=!1,t=t.slice(1,t.length)),{...e,[t]:r}},{});return{}}("M365ChatFeatures");r=(0,tM.cM)(r,e)}t&&r&&(r["immersive-bizchat-avalon-endpoint"]?t.serviceEndpointInfra="avalon":"avalon"===t.serviceEndpointInfra&&(t.serviceEndpointInfra=cb));let n=t?.serviceEndpointInfra??"",o=t?.serviceEndpointRing??"",i=t?.serviceEndpointUrl??"",a=t?.sydneyVariants??"",s=t?.sessionsEndpointUrl??"",l=t?.sessionsVariants??"";t2(r),cs(e.ecsConfigIds),t0(n),t1(o),t5(i),t3(a),t4(s),t8(l),cf(e.accountInfo),cy(e.locale),cw(e.metaOSAppHostRing),ci(e?.metaOSAppSessionId,void 0,void 0),cp(e?.metaOSAppContext),ca(e.metaOSAppContext?.app?.host?.clientType),cS(e.prewarmInfo),(0,tM.wX)("immersive-bizchat-reorder-steps")||cO(e.prewarmInfo?.isPrewarm),cR(e?.metaOSAppContext),cm(e.browserId),cg(e.referrer),cv(e.navigationType),(0,tM.wX)("immersive-bizchat-reorder-steps")&&cO(e.prewarmInfo?.isPrewarm)},cA=(0,eG.P)(e=>{(0,tG.IO)(),(0,tG.F6)();let t=(0,tN.tn)();if((0,eV.useEffect)(()=>{e.ecsFlights?.["immersive-bizchat-eager-msal-token-fetch"]||c_(e)},[]),!tq.M.accountInfo||!tq.M.locale)return eV.createElement(eV.Fragment,null);if(!tq.M.prewarmInfo?.isPrewarm&&!(0,eK.hz)()&&!(0,tM.wX)("immersive-bizchat-mos-gulp")&&!(0,tM.wX)("immersive-bizchat-standalone"))return(0,tj.Fi)({eventId:"Required features not enabled"}),eV.createElement(eV.Fragment,null);if(!tq.M.prewarmInfo?.isPrewarm&&!cE)try{cE=!0,(0,tB.wt)(e.getAppDiagnosticsInfo),(0,tB.Py)(),(0,tB.RN)(),tx.isInitialized()&&tx.notifyAppLoaded(),t===eK.Hz&&(0,tM.wX)("immersive-bizchat-enable-copilot-cache-reload")&&(0,rc.xq)().then(e=>{e?.page?.isBackgroundLoad?(cl(!0),(0,tj.Fi)({eventId:"LogInfo",detail:"Current app session started in background"})):(0,tj.Fi)({eventId:"LogInfo",detail:"Current app session started manually by user"})}),(0,tM.wX)("immersive-bizchat-delay-low-priority-tasks")?(0,tj.Fi)({eventId:"LogInfo",detail:"Delaying low priority tasks"}):cT(),(t===eK.Hz||(0,tM.wX)("immersive-bizchat-enable-non-teams-caching"))&&tq.M.enableDeeplinks&&tx.openLink("https://teams.microsoft.com/l/copilot/notify?bold=false").then(()=>{(0,tj.Fi)({eventId:"Unbold deeplink executed."})})}catch(e){try{tx.notifyFailure({reason:tx.FailedReason.Other,message:String(e)})}catch{}(0,tj.Fi)({eventId:"notifySucess() failed"}),tj.r7().logCopilotErrorEvent?.({eventId:eW.v.UncaughtError,errorMessage:"notifySuccess() failed",clientCorrelationId:tq.M.clientCorrelationId})}return eV.createElement(cn,{runtimeFactory:e.runtimeFactory,isFlightsFromCache:e.isFlightsFromCache})},"ImmersiveBizChatView");function cT(){let e=(0,tN.tn)();(e===eK.Hz||(0,tM.wX)("immersive-bizchat-enable-non-teams-caching"))&&(0,rc.xq)().then(t=>{t?.page?.isMultiWindow===!1&&(od(()=>{(0,tj.Fi)({detail:"Cached page load started.",eventId:"LogInfo"}),(0,tM.wX)("immersive-bizchat-enable-cache-remove-dom")&&document.dispatchEvent(new CustomEvent("bizchat-uncache")),e==eK.Hz&&(0,tM.wX)("immersive-bizchat-enable-copilot-cache-reload")&&null!=o&&((0,tM.wX)("immersive-bizchat-enable-copilot-cache-reload_ten_seconds")?Date.now()-o>1e4:Date.now()-o>36e5)?((0,tj.Fi)({eventId:"LogInfo",detail:"App was cached more than 60 minutes ago, reloading app."}),(0,eX.J2)(window,ck,t?.app?.sessionId),window.location.reload()):tx.notifySuccess().finally(cP),(0,tM.wX)("immersive-bizchat-enable-teams-theme-cache")&&((0,rc.vF)().then(e=>{l7(e.app.theme)}),tx.registerOnThemeChangeHandler((e=tq.M.themeContext)=>{(0,tj.Fi)({eventId:"LogInfo",detail:`Cached Theme Context: ${e}`}),l7(e)}));try{(0,tM.wX)("immersive-bizchat-teams-focus-on-load-hack")&&tx.isInitialized()&&rc.vF()?.then(e=>{cu(e.page?.subPageId,e.app?.userClickTime)}).catch(e=>{tj.Fi({eventId:"UXDiagnostic",message:`Error on updateFocusOnLoad in registerOnLoadHandler function: ${e}`})})}catch(e){(0,tj.Fi)({eventId:"UXDiagnostic",message:`Error on updateFocusOnLoad in registerOnLoadHandler function: ${e}`})}tx.isInitialized()&&rc.vF()?.then(e=>{if(e.page?.subPageId){let t=a8(e.page.subPageId);t?.scenario!==void 0&&t?.version!==void 0&&(a9(t),tj.Fi({eventId:"HandIn.LaunchOptionsStart",detail:`V2 Prompt. Got Prompt Handin LaunchOption from url with Teams app caching. Scenario: ${t.scenario}; Source: ${t.properties.promptSource}; Version: ${t.version}; ClickTimestamp: ${t.properties.clickTimestamp};`}))}}),tq.M.enableDeeplinks&&tx.openLink("https://teams.microsoft.com/l/copilot/notify?bold=false").then(()=>{(0,tj.Fi)({eventId:"Unbold deeplink executed."})}),(0,tj.Fi)({eventId:"Cached page load successful."})}),oh(t=>((0,tM.wX)("immersive-bizchat-stop-token-request-tabcache")&&((0,tj.Fi)({detail:"unload Copilot app and the Copilt app get cached.",eventId:"LogInfo"}),(0,cI.f)(!0)),(0,tM.wX)("immersive-bizchat-enable-cache-remove-dom")&&document.dispatchEvent(new CustomEvent("bizchat-cache")),e==eK.Hz&&(0,tM.wX)("immersive-bizchat-enable-copilot-cache-reload")&&(o=Date.now()),t(),!0)))}).catch(e=>{(0,tj.Fi)({eventId:"LogInfo",detail:"Failed to set up caching callback",errorMessage:String(e)})})}function cP(){(0,cC.unblockTokenRequests)()}let cO=e=>{e?cx(tq.M.prewarmInfo?.isEU?2:3,!0):((0,tM.wX)("immersive-bizchat-enable-copilot-cache-reload")&&((0,eX.Hd)(window,ck)===tq.M.metaOSAppSessionId&&(0,tj.Fi)({eventId:"LogInfo",detail:"Copilot app has been reloaded from app side."}),(0,eX.X)(window,ck)),(0,tY.Mj)(),(0,tK._m)().then(e=>cx(e,!1)),(0,tM.wX)("immersive-bizchat-puid-sydney")||(0,tM.wX)("immersive-bizchat-delay-low-priority-tasks")||(0,tK.Oz)(),function(){let e=function(){let e=(0,tM.wX)("immersive-bizchat-avalon-endpoint")?"avalon":cb,t=(0,tM.wX)("immersive-bizchat-sydney-sdf-endpoint")?"sdf":function(e){let t=(0,tN.K)();if("cortana"!==e)return"default";switch(t){case"Dogfood":case"Microsoft":return"msit";default:return"prod"}}(e);return{serviceEndpointInfra:e,serviceEndpointRing:t}}();""!==tq.M.serviceEndpointInfra&&tq.M.serviceEndpointInfra||t0(e.serviceEndpointInfra),""!==tq.M.serviceEndpointRing&&tq.M.serviceEndpointRing||t1(e.serviceEndpointRing)}(),function(){try{window.document.addEventListener("securitypolicyviolation",e=>{(0,tB.xG)(e.blockedURI,e.violatedDirective)})}catch{}}(),function(){try{if((0,eX.Hd)(window,"ImmersiveBizChat-LoggedInitCSP"))return;(0,eX.J2)(window,"ImmersiveBizChat-LoggedInitCSP","true");let e=(0,eX.Hd)(window,"ImmersiveBizChat-CSPRecord");e&&e.split(" | ").forEach(e=>{(0,tB.xG)(e,"")}),(0,eX.X)(window,"ImmersiveBizChat-CSPRecord")}catch{}}())},cR=e=>{try{(0,tM.wX)("immersive-bizchat-context-appsessionid")?(ci(e?.app?.sessionId,e?.app?.host?.sessionId,e?.app?.appLaunchId),cc(e?.page?.subPageId),cu(e?.page?.subPageId,e?.app?.userClickTime)):tx.isInitialized()&&rc.xq()?.then(e=>{ci(e?.app?.sessionId,e?.app?.host?.sessionId,e?.app?.appLaunchId),tB.Gz(),cc(e.page?.subPageId),cu(e.page?.subPageId,e.app?.userClickTime)})}catch{}};function cx(e,t){ch(e),t||(0,tj.Fi)({eventId:"LogInfo",detail:"updateIsEurope in store "+e})}},446623:(e,t,r)=>{"use strict";r.d(t,{o:()=>i});var n=r(574221),o=r(579270);async function i(e,t=3,r=500,a=5e3){if((0,n.wX)("immersive-bizchat-enable-perf-lazy-chunks-owa-with-retry"))try{return(await e.importWithRetry(void 0,{maximumAttempts:t,timeBetweenRetryInMS:r,timeoutInMS:a}))()}catch{return(0,o.Fi)({eventId:"Error",detail:`Error importing ${e.getName()} function with retry`}),Promise.resolve(!1)}else try{return(await e.import())()}catch{return(0,o.Fi)({eventId:"Error",detail:`Error importing ${e.getName()} function`}),Promise.resolve(!1)}}},110886:(e,t,r)=>{"use strict";r.d(t,{$B:()=>k,$E:()=>E,$h:()=>L,Ae:()=>n,BL:()=>T,C$:()=>U,DL:()=>v,Eu:()=>H,F1:()=>O,GO:()=>x,H7:()=>X,Je:()=>h,L6:()=>W,O2:()=>d,OI:()=>G,Ov:()=>o,Pm:()=>M,Qo:()=>V,RB:()=>l,Sk:()=>c,US:()=>C,V5:()=>_,WG:()=>K,XH:()=>B,Xe:()=>m,Xt:()=>a,Y6:()=>i,aC:()=>A,bD:()=>s,c0:()=>z,c3:()=>q,cX:()=>f,dX:()=>$,d_:()=>F,dv:()=>I,eq:()=>u,hp:()=>j,ji:()=>D,kA:()=>w,nE:()=>p,pH:()=>y,r6:()=>R,rz:()=>P,s_:()=>S,tW:()=>N,uo:()=>b,z9:()=>g});let n="ImmersiveBizChat",o="b9ca843e44b8476c9a96a1266888de2b-aab6b9df-8829-428a-ad9b-53a8f12a0f6b-7987",i="91e6bb9f0cc74e2d8c7f29478edfb940-0177707a-c79c-405a-802e-05ed1b85896a-6986",a="7228d455927649bd90b3b56c4560f618-b0748df8-48fe-4c8d-939d-09b04499f6a2-7715",s="immersive_bizchat",l="97b95bb4-1288-4abe-9994-12491026a736",c="https://substrate.office.com/search",u="https://substrate.office.com/sydney",d="https://substrate.office.com/sydney/v2",f="083b36c3-2702-4850-972a-42894c3c6437",h="https://augloop.office.com/v2",p="https://substrate.office.com/tenantfeedback",m="https://substrate.office.com",g="https://titles.prod.mos.microsoft.com",v="https://loki.delve.office.com/",b="https://service.flow.microsoft.com",y="https://api.powerplatform.com",w="https://api.preprod.powerplatform.com",S="https://api.test.powerplatform.com",C="https://api.spaces.skype.com",I="https://apihub.azure.com",k="https://outlook.office365.com/connectors",E="https://clients.config.office.net",_="https://clients.config.gcc.office.net",A="https://graph.microsoft.com",T="https://gcs.office.com",P="https://designerappservice.officeapps.live.com",O="https://urlp-v2.asm.skype.com",R="https://ic3.teams.office.com",x="https://ic3-consumers.teams.office.com",M="https://pushchannel.1drv.ms",N="https://www.bing.com",F="bb893c22-978d-4cd4-a6f7-bb6cc0d6e6ce",L="596c4f3d-a27d-4bcb-a587-3dd6571cc4a9",z="96ff4394-9197-43aa-b393-6a41652e21f8",D="a522f059-bb65-47c0-8934-7db6e5286414",B="https://api.bap.microsoft.com",U="https://teams.microsoft.com",H="https://api.office.net",q="https://learningtools.onenote.com",j="a75e09c5-9ed5-4004-82d5-4a44c9fd7052",$="https://safelinks.protection.office365.com",W="https://dataservice.o365filtering.com",V="M365.Access",G="72f988bf-86f1-41af-91ab-2d7cd011db47",K=()=>Date.now()+36e4,X="Immersive_BizChat_App_Loading_Retry_Count"},873209:(e,t,r)=>{"use strict";r.d(t,{J:()=>d,K:()=>f});var n=r(690),o=r(233654),i=r(488563),a=r(579270),s=r(486353),l=r.n(s),c=r(295806),u=r(574221);function d(){return function(e,...t){let r="";for(let a=0;;){var n=e.indexOf("{",a),o=e.indexOf("}",a);if(n<0&&o<0){r+=e.slice(a);break}if(o>0&&(o<n||n<0)){r+=e.slice(a,o+1),a=o+2;continue}if(r+=e.slice(a,n),"{"===e.charAt(a=n+1)){r+="{",a++;continue}if(o<0)break;var i=t[parseInt(e.substring(a,o),10)];null!=i&&(r+=function(e){try{return e.toLocaleString("en-US")}catch(t){if("RangeError"===t.name)return e.toLocaleString();return e.toString()}}(i)),a=o+1}return r}("OID:{0}@{1}",n.M?.accountInfo?.objectId,n.M?.accountInfo?.tenantId)}let f=async()=>{let e;if(e=(0,u.wX)("immersive-bizchat-puid-sydney")?await (0,i.CM)():await (0,c.N8)((0,o.$z)()))try{return l()(e).name}catch(e){(0,a.Fi)({eventId:"Error",errorMessage:`Fetch MetaOsHub Token - Error: ${e.message}`});return}}},340828:(e,t,r)=>{"use strict";let n,o;r.r(t),r.d(t,{fetchAccessToken:()=>iU,fetchAccessTokenV2:()=>iH,fetchFTAToken:()=>ij,fetchMSALAccessTokenHelper:()=>iq,getHubToken:()=>i$,setMsalFirstRequestCompleted:()=>iV,setMsalFirstRequestFinished:()=>iG,unblockTokenRequests:()=>iQ});var i,a=r(412145),s=r(233654),l=r(579270),c=r(574221),u=r(841304);!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(i||(i={}));class d{constructor(e,t,r){this.level=i.Info;let n=e||d.createDefaultLoggerOptions();this.localCallback=n.loggerCallback||(()=>{}),this.piiLoggingEnabled=n.piiLoggingEnabled||!1,this.level="number"==typeof n.logLevel?n.logLevel:i.Info,this.correlationId=n.correlationId||u.YM.EMPTY_STRING,this.packageName=t||u.YM.EMPTY_STRING,this.packageVersion=r||u.YM.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:i.Info}}clone(e,t,r){return new d({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;let r=new Date().toUTCString(),n=`[${r}] : [${t.correlationId||this.correlationId||""}]`,o=`${n} : ${this.packageName}@${this.packageVersion} : ${i[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,o,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:i.Error,containsPii:!1,correlationId:t||u.YM.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:i.Error,containsPii:!0,correlationId:t||u.YM.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:i.Warning,containsPii:!1,correlationId:t||u.YM.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:i.Warning,containsPii:!0,correlationId:t||u.YM.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:i.Info,containsPii:!1,correlationId:t||u.YM.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:i.Info,containsPii:!0,correlationId:t||u.YM.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:i.Verbose,containsPii:!1,correlationId:t||u.YM.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:i.Verbose,containsPii:!0,correlationId:t||u.YM.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:i.Trace,containsPii:!1,correlationId:t||u.YM.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:i.Trace,containsPii:!0,correlationId:t||u.YM.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}let f={AAD:"AAD",OIDC:"OIDC"},h={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net"};var p=r(802046);let m="client_info_decoding_error",g="client_info_empty_error",v="token_parsing_error",b="null_or_empty_token",y="endpoints_resolution_error",w="network_error",S="openid_config_error",C="hash_not_deserialized",I="invalid_state",k="state_mismatch",E="state_not_found",_="nonce_mismatch",A="auth_time_not_found",T="max_age_transpired",P="multiple_matching_tokens",O="multiple_matching_accounts",R="multiple_matching_appMetadata",x="request_cannot_be_made",M="cannot_remove_empty_scope",N="cannot_append_scopeset",F="empty_input_scopeset",L="device_code_polling_cancelled",z="device_code_expired",D="device_code_unknown_error",B="no_account_in_silent_request",U="invalid_cache_record",H="invalid_cache_environment",q="no_account_found",j="no_crypto_object",$="unexpected_credential_type",W="invalid_assertion",V="invalid_client_credential",G="token_refresh_required",K="user_timeout_reached",X="token_claims_cnf_required_for_signedjwt",Y="authorization_code_missing_from_server_response",Z="binding_key_not_removed",Q="end_session_endpoint_not_supported",J="key_id_missing",ee="no_network_connectivity",et="user_canceled",er="missing_tenant_id_error",en="method_not_implemented",eo="nested_app_auth_bridge_disabled",ei={[m]:"The client info could not be parsed/decoded correctly",[g]:"The client info was empty",[v]:"Token cannot be parsed",[b]:"The token is null or empty",[y]:"Endpoints cannot be resolved",[w]:"Network request failed",[S]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[C]:"The hash parameters could not be deserialized",[I]:"State was not the expected format",[k]:"State mismatch error",[E]:"State not found",[_]:"Nonce mismatch error",[A]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[T]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[P]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[O]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[R]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[x]:"Token request cannot be made without authorization code or refresh token.",[M]:"Cannot remove null or empty scope from ScopeSet",[N]:"Cannot append ScopeSet",[F]:"Empty input ScopeSet cannot be processed",[L]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[z]:"Device code is expired.",[D]:"Device code stopped polling for unknown reasons.",[B]:"Please pass an account object, silent flow is not supported without account information",[U]:"Cache record object was null or undefined.",[H]:"Invalid environment when attempting to create cache entry",[q]:"No account found in cache for given key.",[j]:"No crypto object detected.",[$]:"Unexpected credential type.",[W]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[V]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[G]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[K]:"User defined timeout for device code polling reached",[X]:"Cannot generate a POP jwt if the token_claims are not populated",[Y]:"Server response does not contain an authorization code to proceed",[Z]:"Could not remove the credential's binding key from storage.",[Q]:"The provided authority does not support logout",[J]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[ee]:"No network connectivity. Check your internet connection.",[et]:"User cancelled the flow.",[er]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[en]:"This method has not been implemented",[eo]:"The nested app auth bridge is disabled"};ei[m],ei[g],ei[v],ei[b],ei[y],ei[w],ei[S],ei[C],ei[I],ei[k],ei[E],ei[_],ei[A],ei[T],ei[P],ei[O],ei[R],ei[x],ei[M],ei[N],ei[F],ei[L],ei[z],ei[D],ei[B],ei[U],ei[H],ei[q],ei[j],ei[$],ei[W],ei[V],ei[G],ei[K],ei[X],ei[Y],ei[Z],ei[Q],ei[J],ei[ee],ei[et],ei[er],ei[eo];class ea extends p.lR{constructor(e,t){super(e,t?`${ei[e]}: ${t}`:ei[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,ea.prototype)}}function es(e,t){return new ea(e,t)}let el={createNewGuid:()=>{throw es(en)},base64Decode:()=>{throw es(en)},base64Encode:()=>{throw es(en)},base64UrlEncode:()=>{throw es(en)},encodeKid:()=>{throw es(en)},async getPublicKeyThumbprint(){throw es(en)},async removeTokenBindingKey(){throw es(en)},async clearKeystore(){throw es(en)},async signJwt(){throw es(en)},async hashString(){throw es(en)}},ec="@azure/msal-common",eu="15.2.0";function ed(e,t){let r=function(e){if(!e)throw es(b);let t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw es(v);return t[2]}(e);try{let e=t(r);return JSON.parse(e)}catch(e){throw es(v)}}function ef(e,t){if(0===t||Date.now()-3e5>e+t)throw es(T)}function eh(){return Math.round(new Date().getTime()/1e3)}function ep(e,t){let r=Number(e)||0;return eh()+t>r}function em(e){return Number(e)>eh()}function eg(e){return[[e.homeAccountId,e.environment].join(u.LR.CACHE_KEY_SEPARATOR).toLowerCase(),function(e){let t=e.credentialType===u.aG.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(u.LR.CACHE_KEY_SEPARATOR).toLowerCase()}(e),(e.target||"").toLowerCase(),(e.requestedClaimsHash||"").toLowerCase(),e.tokenType&&e.tokenType.toLowerCase()!==u.IO.BEARER.toLowerCase()?e.tokenType.toLowerCase():""].join(u.LR.CACHE_KEY_SEPARATOR).toLowerCase()}function ev(e,t,r,n,o){return{credentialType:u.aG.ID_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r,realm:o}}function eb(e,t,r,n,o,i,a,s,l,c,d,f,h,p,m){let g={homeAccountId:e,credentialType:u.aG.ACCESS_TOKEN,secret:r,cachedAt:eh().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:t,clientId:n,realm:o,target:i,tokenType:d||u.IO.BEARER};if(f&&(g.userAssertionHash=f),c&&(g.refreshOn=c.toString()),p&&(g.requestedClaims=p,g.requestedClaimsHash=m),g.tokenType?.toLowerCase()!==u.IO.BEARER.toLowerCase())switch(g.credentialType=u.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME,g.tokenType){case u.IO.POP:let v=ed(r,l);if(!v?.cnf?.kid)throw es(X);g.keyId=v.cnf.kid;break;case u.IO.SSH:g.keyId=h}return g}function ey(e,t,r,n,o,i,a){let s={credentialType:u.aG.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r};return i&&(s.userAssertionHash=i),o&&(s.familyId=o),a&&(s.expiresOn=a.toString()),s}function ew(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function eS(){return eh()+u.u0.REFRESH_TIME_SECONDS}function eC(e,t,r){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=r,e.jwks_uri=t.jwks_uri}function eI(e,t,r){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=r}function ek(e){return e.expiresAt<=eh()}let eE="redirect_uri_empty",e_="claims_request_parsing_error",eA="authority_uri_insecure",eT="url_parse_error",eP="empty_url_error",eO="empty_input_scopes_error",eR="invalid_prompt_value",ex="invalid_claims",eM="token_request_empty",eN="logout_request_empty",eF="invalid_code_challenge_method",eL="pkce_params_missing",ez="invalid_cloud_discovery_metadata",eD="invalid_authority_metadata",eB="untrusted_authority",eU="missing_ssh_jwk",eH="missing_ssh_kid",eq="missing_nonce_authentication_header",ej="invalid_authentication_header",e$="cannot_set_OIDCOptions",eW="cannot_allow_platform_broker",eV="authority_mismatch",eG={[eE]:"A redirect URI is required for all calls, and none has been set.",[e_]:"Could not parse the given claims request object.",[eA]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[eT]:"URL could not be parsed into appropriate segments.",[eP]:"URL was empty or null.",[eO]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[eR]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[ex]:"Given claims parameter must be a stringified JSON object.",[eM]:"Token request was empty and not found in cache.",[eN]:"The logout request was null or undefined.",[eF]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[eL]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[ez]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[eD]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[eB]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[eU]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[eH]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[eq]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[ej]:"Invalid authentication header provided",[e$]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[eW]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[eV]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};eG[eE],eG[e_],eG[eA],eG[eT],eG[eP],eG[eO],eG[eR],eG[ex],eG[eM],eG[eN],eG[eF],eG[eL],eG[ez],eG[eD],eG[eB],eG[eU],eG[eH],eG[eq],eG[ej],eG[e$],eG[eW],eG[eV];class eK extends p.lR{constructor(e){super(e,eG[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,eK.prototype)}}function eX(e){return new eK(e)}class eY{static isEmptyObj(e){if(e)try{let t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){let t={},r=e.split("&"),n=e=>decodeURIComponent(e.replace(/\+/g," "));return r.forEach(e=>{if(e.trim()){let[r,o]=e.split(/=(.+)/g,2);r&&o&&(t[n(r)]=n(o))}}),t}static trimArrayEntries(e){return e.map(e=>e.trim())}static removeEmptyStringsFromArray(e){return e.filter(e=>!!e)}static jsonParseHelper(e){try{return JSON.parse(e)}catch(e){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class eZ{constructor(e){let t=e?eY.trimArrayEntries([...e]):[],r=t?eY.removeEmptyStringsFromArray(t):[];if(!r||!r.length)throw eX(eO);this.scopes=new Set,r.forEach(e=>this.scopes.add(e))}static fromString(e){return new eZ((e||u.YM.EMPTY_STRING).split(" "))}static createSearchScopes(e){let t=new eZ(e);return t.containsOnlyOIDCScopes()?t.removeScope(u.YM.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){let t=new eZ(this.printScopesLowerCase().split(" "));return!!e&&t.scopes.has(e.toLowerCase())}containsScopeSet(e){return!!e&&!(e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every(e=>this.containsScope(e))}containsOnlyOIDCScopes(){let e=0;return u._A.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(e=>this.appendScope(e))}catch(e){throw es(N)}}removeScope(e){if(!e)throw es(M);this.scopes.delete(e.trim())}removeOIDCScopes(){u._A.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw es(F);let t=new Set;return e.scopes.forEach(e=>t.add(e.toLowerCase())),this.scopes.forEach(e=>t.add(e.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw es(F);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();let t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r}getScopeCount(){return this.scopes.size}asArray(){let e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):u.YM.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function eQ(e,t){if(!e)throw es(g);try{let r=t(e);return JSON.parse(r)}catch(e){throw es(m)}}function eJ(e){if(!e)throw es(m);let t=e.split(u.LR.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?u.YM.EMPTY_STRING:t[1]}}function e0(e,t){return!!e&&!!t&&e===t.split(".")[1]}function e1(e,t,r,n){if(!n)return{tenantId:r,localAccountId:t,isHomeTenant:e0(r,e)};{let{oid:t,sub:r,tid:o,name:i,tfp:a,acr:s}=n,l=o||a||s||"";return{tenantId:l,localAccountId:t||r||"",name:i,isHomeTenant:e0(l,e)}}}function e2(e,t,r,n){let o=e;if(t){let{isHomeTenant:r,...n}=t;o={...e,...n}}if(r){let{isHomeTenant:t,...i}=e1(e.homeAccountId,e.localAccountId,e.tenantId,r);o={...o,...i,idTokenClaims:r,idToken:n}}return o}let e3={Default:0,Adfs:1,Dsts:2,Ciam:3};function e5(e){return e&&(e.tid||e.tfp||e.acr)||null}class e6{generateAccountId(){return[this.homeAccountId,this.environment].join(u.LR.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return e6.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){let t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(u.LR.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,r){let n;let o=new e6;t.authorityType===e3.Adfs?o.authorityType=u.Qd.ADFS_ACCOUNT_TYPE:t.protocolMode===f.AAD?o.authorityType=u.Qd.MSSTS_ACCOUNT_TYPE:o.authorityType=u.Qd.GENERIC_ACCOUNT_TYPE,e.clientInfo&&r&&(n=eQ(e.clientInfo,r)),o.clientInfo=e.clientInfo,o.homeAccountId=e.homeAccountId,o.nativeAccountId=e.nativeAccountId;let i=e.environment||t&&t.getPreferredCache();if(!i)throw es(H);o.environment=i,o.realm=n?.utid||e5(e.idTokenClaims)||"",o.localAccountId=n?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";let a=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,s=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(o.username=a||s||"",o.name=e.idTokenClaims?.name||"",o.cloudGraphHostName=e.cloudGraphHostName,o.msGraphHost=e.msGraphHost,e.tenantProfiles)o.tenantProfiles=e.tenantProfiles;else{let t=e1(e.homeAccountId,o.localAccountId,o.realm,e.idTokenClaims);o.tenantProfiles=[t]}return o}static createFromAccountInfo(e,t,r){let n=new e6;return n.authorityType=e.authorityType||u.Qd.GENERIC_ACCOUNT_TYPE,n.homeAccountId=e.homeAccountId,n.localAccountId=e.localAccountId,n.nativeAccountId=e.nativeAccountId,n.realm=e.tenantId,n.environment=e.environment,n.username=e.username,n.name=e.name,n.cloudGraphHostName=t,n.msGraphHost=r,n.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),n}static generateHomeAccountId(e,t,r,n,o){if(!(t===e3.Adfs||t===e3.Dsts)){if(e)try{let t=eQ(e,n.base64Decode);if(t.uid&&t.utid)return`${t.uid}.${t.utid}`}catch(e){}r.warning("No client info in response")}return o?.sub||""}static isAccountEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let n=!0;if(r){let r=e.idTokenClaims||{},o=t.idTokenClaims||{};n=r.iat===o.iat&&r.nonce===o.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n}}function e4(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function e8(e){if(!e||0>e.indexOf("="))return null;try{let t=e4(e),r=Object.fromEntries(new URLSearchParams(t));if(r.code||r.error||r.error_description||r.state)return r}catch(e){throw es(C)}return null}class e9{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw eX(eP);e.includes("#")||(this._urlString=e9.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return eY.endsWith(t,"?")?t=t.slice(0,-1):eY.endsWith(t,"?/")&&(t=t.slice(0,-2)),eY.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(e){throw eX(eT)}if(!e.HostNameAndPort||!e.PathSegments)throw eX(eT);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw eX(eA)}static appendQueryString(e,t){return t?0>e.indexOf("?")?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return e9.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){let t=this.getUrlComponents(),r=t.PathSegments;return e&&0!==r.length&&(r[0]===u.v2.COMMON||r[0]===u.v2.ORGANIZATIONS)&&(r[0]=e),e9.constructAuthorityUriFromObject(t)}getUrlComponents(){let e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw eX(eT);let r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter(e=>e&&e.length>0),r.PathSegments=n,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){let t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw eX(eT);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===u.YM.FORWARD_SLASH){let r=new e9(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new e9(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!e8(e)}}let e7={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},te=e7.endpointMetadata,tt=e7.instanceDiscoveryMetadata,tr=new Set;function tn(e,t,r,n){if(n?.trace(`getAliasesFromMetadata called with source: ${r}`),e&&t){let o=to(t,e);if(o)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),o.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}function to(e,t){for(let r=0;r<e.length;r++){let n=e[r];if(n.aliases.includes(t))return n}return null}tt.metadata.forEach(e=>{e.aliases.forEach(e=>{tr.add(e)})});let ti="cache_quota_exceeded",ta="cache_error_unknown",ts={[ti]:"Exceeded cache storage capacity.",[ta]:"Unexpected error occurred when using cache storage."};class tl extends Error{constructor(e,t){let r=t||(ts[e]?ts[e]:ts[ta]);super(`${e}: ${r}`),Object.setPrototypeOf(this,tl.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}class tc{constructor(e,t,r,n){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(ec,eu),this.staticAuthorityOptions=n}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){let t=this.getAllAccounts(e);return t.length>1?t.sort(e=>e.idTokenClaims?-1:1)[0]:1===t.length?t[0]:null}getBaseAccountInfo(e){let t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap(e=>this.getTenantProfilesFromAccountEntity(e,t?.tenantId,t))}getTenantedAccountInfoByFilter(e,t,r,n){let o;if(n&&!this.tenantProfileMatchesFilter(r,n))return null;let i=this.getIdToken(e,t,r.tenantId);return i&&(o=ed(i.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(o,n))?null:e2(e,r,o,i?.secret)}getTenantProfilesFromAccountEntity(e,t,r){let n=e.getAccountInfo(),o=n.tenantProfiles||new Map,i=this.getTokenKeys();if(t){let e=o.get(t);if(!e)return[];o=new Map([[t,e]])}let a=[];return o.forEach(e=>{let t=this.getTenantedAccountInfoByFilter(n,i,e,r);t&&a.push(t)}),a}tenantProfileMatchesFilter(e,t){return(!t.localAccountId||!!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId))&&(!t.name||e.name===t.name)&&(void 0===t.isHomeTenant||e.isHomeTenant===t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!t||(!t.localAccountId||!!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))&&(!t.loginHint||!!this.matchLoginHintFromTokenClaims(e,t.loginHint))&&(!t.username||!!this.matchUsername(e.preferred_username,t.username))&&(!t.name||!!this.matchName(e,t.name))&&(!t.sid||!!this.matchSid(e,t.sid))}async saveCacheRecord(e,t,r){if(!e)throw es(U);try{e.account&&await this.setAccount(e.account,t),e.idToken&&r?.idToken!==!1&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&r?.accessToken!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&r?.refreshToken!==!1&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(e){if(this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),e instanceof Error){if(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e.message}`,t),"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota"))throw this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",t),new tl(ti);throw new tl(e.name,e.message)}throw this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${e}`,t),new tl(ta)}}async saveAccessToken(e,t){let r={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),o=eZ.fromString(e.target),i=[];n.accessToken.forEach(e=>{if(!this.accessTokenKeyMatchesFilter(e,r,!1))return;let t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,r)&&eZ.fromString(t.target).intersectingScopeSets(o)&&i.push(this.removeAccessToken(e))}),await Promise.all(i),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e){let t=this.getAccountKeys(),r=[];return t.forEach(t=>{if(!this.isAccountKey(t,e.homeAccountId))return;let n=this.getAccount(t,this.commonLogger);if(!n||e.homeAccountId&&!this.matchHomeAccountId(n,e.homeAccountId)||e.username&&!this.matchUsername(n.username,e.username)||e.environment&&!this.matchEnvironment(n,e.environment)||e.realm&&!this.matchRealm(n,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(n,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(n,e.authorityType))return;let o={localAccountId:e?.localAccountId,name:e?.name},i=n.tenantProfiles?.filter(e=>this.tenantProfileMatchesFilter(e,o));i&&0===i.length||r.push(n)}),r}isAccountKey(e,t,r){return!(e.split(u.LR.CACHE_KEY_SEPARATOR).length<3)&&(!t||!!e.toLowerCase().includes(t.toLowerCase()))&&(!r||!!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(u.LR.CACHE_KEY_SEPARATOR).length<6)return!1;let t=e.toLowerCase();if(-1===t.indexOf(u.aG.ID_TOKEN.toLowerCase())&&-1===t.indexOf(u.aG.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(u.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(u.aG.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(u.aG.REFRESH_TOKEN.toLowerCase())>-1){let e=`${u.aG.REFRESH_TOKEN}${u.LR.CACHE_KEY_SEPARATOR}${this.clientId}${u.LR.CACHE_KEY_SEPARATOR}`,r=`${u.aG.REFRESH_TOKEN}${u.LR.CACHE_KEY_SEPARATOR}${u.hB}${u.LR.CACHE_KEY_SEPARATOR}`;if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(r.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){return(!t.clientId||!!this.matchClientId(e,t.clientId))&&(!t.userAssertionHash||!!this.matchUserAssertionHash(e,t.userAssertionHash))&&("string"!=typeof t.homeAccountId||!!this.matchHomeAccountId(e,t.homeAccountId))&&(!t.environment||!!this.matchEnvironment(e,t.environment))&&(!t.realm||!!this.matchRealm(e,t.realm))&&(!t.credentialType||!!this.matchCredentialType(e,t.credentialType))&&(!t.familyId||!!this.matchFamilyId(e,t.familyId))&&(!t.target||!!this.matchTarget(e,t.target))&&(!t.requestedClaimsHash&&!e.requestedClaimsHash||e.requestedClaimsHash===t.requestedClaimsHash)&&(e.credentialType!==u.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME||(!t.tokenType||!!this.matchTokenType(e,t.tokenType))&&(t.tokenType!==u.IO.SSH||!t.keyId||!!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){let t=this.getKeys(),r={};return t.forEach(t=>{if(!this.isAppMetadata(t))return;let n=this.getAppMetadata(t);n&&(!e.environment||this.matchEnvironment(n,e.environment))&&(!e.clientId||this.matchClientId(n,e.clientId))&&(r[t]=n)}),r}getAuthorityMetadataByAlias(e){let t=this.getAuthorityMetadataKeys(),r=null;return t.forEach(t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;let n=this.getAuthorityMetadata(t);n&&-1!==n.aliases.indexOf(e)&&(r=n)}),r}async removeAllAccounts(){let e=this.getAccountKeys(),t=[];e.forEach(e=>{t.push(this.removeAccount(e))}),await Promise.all(t)}async removeAccount(e){let t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){let t=this.getTokenKeys(),r=e.generateAccountId(),n=[];t.idToken.forEach(e=>{0===e.indexOf(r)&&this.removeIdToken(e)}),t.accessToken.forEach(e=>{0===e.indexOf(r)&&n.push(this.removeAccessToken(e))}),t.refreshToken.forEach(e=>{0===e.indexOf(r)&&this.removeRefreshToken(e)}),await Promise.all(n)}async removeAccessToken(e){let t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===u.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===u.IO.POP){let e=t.keyId;if(e)try{await this.cryptoImpl.removeTokenBindingKey(e)}catch(e){throw es(Z)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach(e=>{this.isAppMetadata(e)&&this.removeItem(e)}),!0}readAccountFromCache(e){let t=e6.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getIdToken called");let i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:u.aG.ID_TOKEN,clientId:this.clientId,realm:r},a=this.getIdTokensByFilter(i,t),s=a.size;if(s<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(s>1){let t=a;if(!r){let r=new Map;a.forEach((t,n)=>{t.realm===e.tenantId&&r.set(n,t)});let n=r.size;if(n<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(1===n)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),r.values().next().value;t=r}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),t.forEach((e,t)=>{this.removeIdToken(t)}),n&&o&&n.addFields({multiMatchedID:a.size},o),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t){let r=t&&t.idToken||this.getTokenKeys().idToken,n=new Map;return r.forEach(t=>{if(!this.idTokenKeyMatchesFilter(t,{clientId:this.clientId,...e}))return;let r=this.getIdTokenCredential(t);r&&this.credentialMatchesFilter(r,e)&&n.set(t,r)}),n}idTokenKeyMatchesFilter(e,t){let r=e.toLowerCase();return(!t.clientId||-1!==r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,r,n,o,i){this.commonLogger.trace("CacheManager - getAccessToken called");let a=eZ.createSearchScopes(t.scopes),s=t.authenticationScheme||u.IO.BEARER,l=s&&s.toLowerCase()!==u.IO.BEARER.toLowerCase()?u.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME:u.aG.ACCESS_TOKEN,c={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:l,clientId:this.clientId,realm:n||e.tenantId,target:a,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},d=r&&r.accessToken||this.getTokenKeys().accessToken,f=[];d.forEach(e=>{if(this.accessTokenKeyMatchesFilter(e,c,!0)){let t=this.getAccessTokenCredential(e);t&&this.credentialMatchesFilter(t,c)&&f.push(t)}});let h=f.length;return h<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):h>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),f.forEach(e=>{this.removeAccessToken(eg(e))}),o&&i&&o.addFields({multiMatchedAT:f.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),f[0])}accessTokenKeyMatchesFilter(e,t,r){let n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase())||t.realm&&-1===n.indexOf(t.realm.toLowerCase())||t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){let e=t.target.asArray();for(let t=0;t<e.length;t++){if(r&&!n.includes(e[t].toLowerCase()))return!1;if(!r&&n.includes(e[t].toLowerCase()))break}}return!0}getAccessTokensByFilter(e){let t=this.getTokenKeys(),r=[];return t.accessToken.forEach(t=>{if(!this.accessTokenKeyMatchesFilter(t,e,!0))return;let n=this.getAccessTokenCredential(t);n&&this.credentialMatchesFilter(n,e)&&r.push(n)}),r}getRefreshToken(e,t,r,n,o){this.commonLogger.trace("CacheManager - getRefreshToken called");let i=t?u.hB:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:u.aG.REFRESH_TOKEN,clientId:this.clientId,familyId:i},s=r&&r.refreshToken||this.getTokenKeys().refreshToken,l=[];s.forEach(e=>{if(this.refreshTokenKeyMatchesFilter(e,a)){let t=this.getRefreshTokenCredential(e);t&&this.credentialMatchesFilter(t,a)&&l.push(t)}});let c=l.length;return c<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(c>1&&n&&o&&n.addFields({multiMatchedRT:c},o),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,t){let r=e.toLowerCase();return(!t.familyId||-1!==r.indexOf(t.familyId.toLowerCase()))&&(!!t.familyId||!t.clientId||-1!==r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase()))}readAppMetadataFromCache(e){let t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map(e=>r[e]),o=n.length;if(o<1)return null;if(o>1)throw es(R);return n[0]}isAppMetadataFOCI(e){let t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===u.hB)}matchHomeAccountId(e,t){return!!("string"==typeof e.homeAccountId&&t===e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return!(t.toLowerCase()!==e.name?.toLowerCase())}matchUsername(e,t){return!!(e&&"string"==typeof e&&t?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){let r=function(e,t){let r;let n=e.canonicalAuthority;if(n){let o=new e9(n).getUrlComponents().HostNameAndPort;r=tn(o,e.cloudDiscoveryMetadata?.metadata,u.E_.CONFIG,t)||tn(o,tt.metadata,u.E_.HARDCODED_VALUES,t)||e.knownAuthorities}return r||[]}(this.staticAuthorityOptions,this.commonLogger);if(r.includes(t)&&r.includes(e.environment))return!0}let r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){return!(e.realm?.toLowerCase()!==t.toLowerCase())}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return(e.credentialType===u.aG.ACCESS_TOKEN||e.credentialType===u.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME)&&!!e.target&&eZ.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return -1!==e.indexOf(u.GU)}isAuthorityMetadata(e){return -1!==e.indexOf(u.u0.CACHE_KEY)}generateAuthorityMetadataCacheKey(e){return`${u.u0.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(let r in t)e[r]=t[r];return e}}class tu extends tc{async setAccount(){throw es(en)}getAccount(){throw es(en)}async setIdTokenCredential(){throw es(en)}getIdTokenCredential(){throw es(en)}async setAccessTokenCredential(){throw es(en)}getAccessTokenCredential(){throw es(en)}async setRefreshTokenCredential(){throw es(en)}getRefreshTokenCredential(){throw es(en)}setAppMetadata(){throw es(en)}getAppMetadata(){throw es(en)}setServerTelemetry(){throw es(en)}getServerTelemetry(){throw es(en)}setAuthorityMetadata(){throw es(en)}getAuthorityMetadata(){throw es(en)}getAuthorityMetadataKeys(){throw es(en)}setThrottlingCache(){throw es(en)}getThrottlingCache(){throw es(en)}removeItem(){throw es(en)}getKeys(){throw es(en)}getAccountKeys(){throw es(en)}getTokenKeys(){throw es(en)}}let td={tokenRenewalOffsetSeconds:u.F0,preventCorsPreflight:!1},tf={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:i.Info,correlationId:u.YM.EMPTY_STRING},th={claimsBasedCachingEnabled:!1},tp={async sendGetRequestAsync(){throw es(en)},async sendPostRequestAsync(){throw es(en)}},tm={sku:u.YM.SKU,version:eu,cpu:u.YM.EMPTY_STRING,os:u.YM.EMPTY_STRING},tg={clientSecret:u.YM.EMPTY_STRING,clientAssertion:void 0},tv={azureCloudInstance:h.None,tenant:`${u.YM.DEFAULT_COMMON_TENANT}`},tb={application:{appName:"",appVersion:""}};function ty(e){return e.authOptions.authority.options.protocolMode===f.OIDC}let tw={sendGetRequestAsync:()=>Promise.reject(es(en)),sendPostRequestAsync:()=>Promise.reject(es(en))},tS={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt"},tC=new Map([[tS.AcquireTokenByCode,"ATByCode"],[tS.AcquireTokenByRefreshToken,"ATByRT"],[tS.AcquireTokenSilent,"ATS"],[tS.AcquireTokenSilentAsync,"ATSAsync"],[tS.AcquireTokenPopup,"ATPopup"],[tS.AcquireTokenRedirect,"ATRedirect"],[tS.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[tS.CryptoOptsSignJwt,"CryptoSignJwt"],[tS.SilentCacheClientAcquireToken,"SltCacheClientAT"],[tS.SilentIframeClientAcquireToken,"SltIframeClientAT"],[tS.SilentRefreshClientAcquireToken,"SltRClientAT"],[tS.SsoSilent,"SsoSlt"],[tS.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[tS.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[tS.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[tS.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[tS.NetworkClientSendPostRequestAsync,"NetClientSendPost"],[tS.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[tS.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[tS.BrokerHandhshake,"BrokerHandshake"],[tS.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[tS.AcquireTokenByBroker,"ATByBroker"],[tS.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[tS.RefreshTokenClientAcquireToken,"RTClientAT"],[tS.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[tS.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[tS.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[tS.AcquireTokenFromCache,"ATFromCache"],[tS.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[tS.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[tS.AcquireTokenBySilentIframe,"ATBySltIframe"],[tS.InitializeBaseRequest,"InitBaseReq"],[tS.InitializeSilentRequest,"InitSltReq"],[tS.InitializeClientApplication,"InitClientApplication"],[tS.InitializeCache,"InitCache"],[tS.ImportExistingCache,"importCache"],[tS.SetUserData,"setUserData"],[tS.LocalStorageUpdated,"localStorageUpdated"],[tS.SilentIframeClientTokenHelper,"SIClientTHelper"],[tS.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[tS.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[tS.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[tS.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[tS.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[tS.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[tS.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[tS.StandardInteractionClientInitializeAuthorizationCodeRequest,"StdIntClientInitAuthCodeReq"],[tS.GetAuthCodeUrl,"GetAuthCodeUrl"],[tS.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[tS.HandleCodeResponse,"HandleCodeResp"],[tS.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[tS.AuthClientAcquireToken,"AuthClientAT"],[tS.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[tS.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[tS.AuthClientCreateQueryString,"AuthClientCreateQueryStr"],[tS.PopTokenGenerateCnf,"PopTGenCnf"],[tS.PopTokenGenerateKid,"PopTGenKid"],[tS.HandleServerTokenResponse,"HandleServerTRes"],[tS.DeserializeResponse,"DeserializeRes"],[tS.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[tS.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[tS.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[tS.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[tS.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[tS.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[tS.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[tS.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[tS.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[tS.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[tS.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[tS.AcquireTokenByCodeAsync,"ATByCodeAsync"],[tS.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[tS.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[tS.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[tS.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[tS.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[tS.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[tS.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[tS.NativeGenerateAuthResult,"NtvGenAuthRes"],[tS.RemoveHiddenIframe,"RemoveHiddenIframe"],[tS.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[tS.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[tS.GeneratePkceCodes,"GenPkceCodes"],[tS.GenerateCodeVerifier,"GenCodeVerifier"],[tS.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[tS.Sha256Digest,"Sha256Digest"],[tS.GetRandomValues,"GetRandomValues"],[tS.GenerateHKDF,"genHKDF"],[tS.GenerateBaseKey,"genBaseKey"],[tS.Base64Decode,"b64Decode"],[tS.UrlEncodeArr,"urlEncArr"],[tS.Encrypt,"encrypt"],[tS.Decrypt,"decrypt"]]),tI={InProgress:1,Completed:2},tk=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT","unencryptedCacheCount","encryptedCacheExpiredCount"]);class tE{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class t_{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:tI.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new tE}}startPerformanceMeasurement(){return new tE}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}var tA=r(85453);class tT{navigateInternal(e,t){return tT.defaultNavigateWindow(e,t)}navigateExternal(e,t){return tT.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(e=>{setTimeout(()=>{e(!0)},t.timeout)})}}class tP extends p.lR{constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,tP.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}let tO="pkce_not_created",tR="crypto_nonexistent",tx="empty_navigate_uri",tM="hash_empty_error",tN="no_state_in_hash",tF="hash_does_not_contain_known_properties",tL="unable_to_parse_state",tz="state_interaction_type_mismatch",tD="interaction_in_progress",tB="popup_window_error",tU="empty_window_error",tH="user_cancelled",tq="monitor_popup_timeout",tj="monitor_window_timeout",t$="redirect_in_iframe",tW="block_iframe_reload",tV="block_nested_popups",tG="iframe_closed_prematurely",tK="silent_logout_unsupported",tX="no_account_error",tY="silent_prompt_value_error",tZ="no_token_request_cache_error",tQ="unable_to_parse_token_request_cache_error",tJ="no_cached_authority_error",t0="auth_request_not_set_error",t1="invalid_cache_type",t2="non_browser_environment",t3="database_not_open",t5="no_network_connectivity",t6="post_request_failed",t4="get_request_failed",t8="failed_to_parse_response",t9="unable_to_load_token",t7="crypto_key_not_found",re="auth_code_required",rt="auth_code_or_nativeAccountId_required",rr="spa_code_and_nativeAccountId_present",rn="database_unavailable",ro="unable_to_acquire_token_from_native_platform",ri="native_handshake_timeout",ra="native_extension_not_installed",rs="native_connection_not_established",rl="uninitialized_public_client_application",rc="native_prompt_not_supported",ru="invalid_base64_string",rd="invalid_pop_token_request",rf="failed_to_build_headers",rh="failed_to_parse_headers",rp="For more visit: aka.ms/msaljs/browser-errors",rm={[tO]:"The PKCE code challenge and verifier could not be generated.",[tR]:"The crypto object or function is not available.",[tx]:"Navigation URI is empty. Please check stack trace for more info.",[tM]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${rp}`,[tN]:"Hash does not contain state. Please verify that the request originated from msal.",[tF]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${rp}`,[tL]:"Unable to parse state. Please verify that the request originated from msal.",[tz]:"Hash contains state but the interaction type does not match the caller.",[tD]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${rp}`,[tB]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[tU]:"window.open returned null or undefined window object.",[tH]:"User cancelled the flow.",[tq]:`Token acquisition in popup failed due to timeout.  ${rp}`,[tj]:`Token acquisition in iframe failed due to timeout.  ${rp}`,[t$]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[tW]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${rp}`,[tV]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[tG]:"The iframe being monitored was closed prematurely.",[tK]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[tX]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[tY]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[tZ]:"No token request found in cache.",[tQ]:"The cached token request could not be parsed.",[tJ]:"No cached authority found.",[t0]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[t1]:"Invalid cache type",[t2]:"Login and token requests are not supported in non-browser environments.",[t3]:"Database is not open!",[t5]:"No network connectivity. Check your internet connection.",[t6]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[t4]:"Network request failed. Please check the network trace to determine root cause.",[t8]:"Failed to parse network response. Check network trace.",[t9]:"Error loading token to cache.",[t7]:"Cryptographic Key or Keypair not found in browser storage.",[re]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[rt]:"An authorization code or nativeAccountId must be provided to this flow.",[rr]:"Request cannot contain both spa code and native account id.",[rn]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[ro]:`Unable to acquire token from native platform.  ${rp}`,[ri]:"Timed out while attempting to establish connection to browser extension",[ra]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[rs]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${rp}`,[rl]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${rp}`,[rc]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[ru]:"Invalid base64 encoded string.",[rd]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[rf]:"Failed to build request headers object.",[rh]:"Failed to parse response headers"};rm[tO],rm[tR],rm[tx],rm[tM],rm[tN],rm[tF],rm[tL],rm[tz],rm[tD],rm[tB],rm[tU],rm[tH],rm[tq],rm[tj],rm[t$],rm[tW],rm[tV],rm[tG],rm[tK],rm[tX],rm[tY],rm[tZ],rm[tQ],rm[tJ],rm[t0],rm[t1],rm[t2],rm[t3],rm[t5],rm[t6],rm[t4],rm[t8],rm[t9],rm[t7],rm[re],rm[rt],rm[rr],rm[rn],rm[ro],rm[ri],rm[ra],rm[rs],rm[rl],rm[rc],rm[ru],rm[rd];class rg extends p.lR{constructor(e,t){super(e,rm[e],t),Object.setPrototypeOf(this,rg.prototype),this.name="BrowserAuthError"}}function rv(e,t){return new rg(e,t)}class rb{async sendGetRequestAsync(e,t){let r;let n={},o=0,i=ry(t);try{r=await fetch(e,{method:tA.CC.GET,headers:i})}catch(e){throw rv(window.navigator.onLine?t4:t5)}n=rw(r.headers);try{return o=r.status,{headers:n,body:await r.json(),status:o}}catch(e){throw new tP(rv(t8),o,n)}}async sendPostRequestAsync(e,t){let r;let n=t&&t.body||"",o=ry(t),i=0,a={};try{r=await fetch(e,{method:tA.CC.POST,headers:o,body:n})}catch(e){throw rv(window.navigator.onLine?t6:t5)}a=rw(r.headers);try{return i=r.status,{headers:a,body:await r.json(),status:i}}catch(e){throw new tP(rv(t8),i,a)}}}function ry(e){try{let t=new Headers;if(!(e&&e.headers))return t;let r=e.headers;return Object.entries(r).forEach(([e,r])=>{t.append(e,r)}),t}catch(e){throw rv(rf)}}function rw(e){try{let t={};return e.forEach((e,r)=>{t[r]=e}),t}catch(e){throw rv(rh)}}function rS(e){return encodeURIComponent(rI(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function rC(e){return rk(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function rI(e){return rk(new TextEncoder().encode(e))}function rk(e){return btoa(Array.from(e,e=>String.fromCodePoint(e)).join(""))}function rE(e){return new TextDecoder().decode(r_(e))}function r_(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw rv(ru)}let r=atob(t);return Uint8Array.from(r,e=>e.codePointAt(0)||0)}let rA="AES-GCM",rT="HKDF",rP="SHA-256",rO=new Uint8Array([1,0,1]),rR="0123456789abcdef",rx=new Uint32Array(1),rM="encrypt",rN="decrypt",rF={name:"RSASSA-PKCS1-v1_5",hash:rP,modulusLength:2048,publicExponent:rO};async function rL(e,t,r){t?.addQueueMeasurement(tS.Sha256Digest,r);let n=new TextEncoder().encode(e);return window.crypto.subtle.digest(rP,n)}function rz(e){return window.crypto.getRandomValues(e)}function rD(){return window.crypto.getRandomValues(rx),rx[0]}function rB(){let e=Date.now(),t=1024*rD()+(1023&rD()),r=new Uint8Array(16),n=Math.trunc(t/0x40000000),o=t&0x40000000-1,i=rD();r[0]=e/0x10000000000,r[1]=e/0x100000000,r[2]=e/0x1000000,r[3]=e/65536,r[4]=e/256,r[5]=e,r[6]=112|n>>>8,r[7]=n,r[8]=128|o>>>24,r[9]=o>>>16,r[10]=o>>>8,r[11]=o,r[12]=i>>>24,r[13]=i>>>16,r[14]=i>>>8,r[15]=i;let a="";for(let e=0;e<r.length;e++)a+=rR.charAt(r[e]>>>4),a+=rR.charAt(15&r[e]),(3===e||5===e||7===e||9===e)&&(a+="-");return a}async function rU(e,t){return window.crypto.subtle.generateKey(rF,e,t)}async function rH(e){return window.crypto.subtle.exportKey(tA.jb,e)}async function rq(e,t,r){return window.crypto.subtle.importKey(tA.jb,e,rF,t,r)}async function rj(e,t){return window.crypto.subtle.sign(rF,e,t)}async function r$(){let e=await window.crypto.subtle.generateKey({name:rA,length:256},!0,[rM,rN]);return window.crypto.subtle.exportKey("raw",e)}async function rW(e){return window.crypto.subtle.importKey("raw",e,rT,!1,["deriveKey"])}async function rV(e,t,r){return window.crypto.subtle.deriveKey({name:rT,salt:t,hash:rP,info:new TextEncoder().encode(r)},e,{name:rA,length:256},!1,[rM,rN])}async function rG(e,t,r){let n=new TextEncoder().encode(t),o=window.crypto.getRandomValues(new Uint8Array(16)),i=await rV(e,o,r),a=await window.crypto.subtle.encrypt({name:rA,iv:new Uint8Array(12)},i,n);return{data:rC(new Uint8Array(a)),nonce:rC(o)}}async function rK(e,t,r,n){let o=r_(n),i=await rV(e,r_(t),r),a=await window.crypto.subtle.decrypt({name:rA,iv:new Uint8Array(12)},i,o);return new TextDecoder().decode(a)}async function rX(e){return rC(new Uint8Array(await rL(e)))}let rY="storage_not_supported",rZ="stubbed_public_client_application_called",rQ="in_mem_redirect_unavailable",rJ={[rY]:"Given storage configuration option was not supported.",[rZ]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[rQ]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};rJ[rY],rJ[rZ],rJ[rQ];class r0 extends p.lR{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,r0.prototype)}}function r1(e){return new r0(e,rJ[e])}function r2(){return window.parent!==window}function r3(){return"undefined"!=typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function r5(){if("undefined"==typeof window)throw rv(t2)}function r6(e){if(!e)throw rv(rl)}function r4(e){r5(),function(){if(e9.hashContainsKnownProperties(window.location.hash)&&r2())throw rv(tW)}(),function(){if("undefined"!=typeof window&&window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(`${tA.Q1.POPUP_NAME_PREFIX}.`))throw rv(tV)}(),r6(e)}function r8(e,t){if(r4(e),function(e){if(r2()&&!e)throw rv(t$)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===tA.Al.MemoryStorage&&!t.cache.storeAuthStateInCookie)throw r1(rQ)}function r9(e){let t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout(()=>{try{document.head.removeChild(t)}catch{}},1e4)}let r7="@azure/msal-browser",ne="4.4.0";class nt{static loggerCallback(e,t){switch(e){case i.Error:case i.Info:case i.Verbose:case i.Warning:default:return}}constructor(e){let t;this.browserEnvironment="undefined"!=typeof window,this.config=function({auth:e,cache:t,system:r,telemetry:n},o){let a={clientId:u.YM.EMPTY_STRING,authority:`${u.YM.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:u.YM.EMPTY_STRING,authorityMetadata:u.YM.EMPTY_STRING,redirectUri:"undefined"!=typeof window?r3():"",postLogoutRedirectUri:u.YM.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:f.AAD,OIDCOptions:{serverResponseType:u.zL.FRAGMENT,defaultScopes:[u.YM.OPENID_SCOPE,u.YM.PROFILE_SCOPE,u.YM.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:h.None,tenant:u.YM.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},s={cacheLocation:tA.Al.SessionStorage,temporaryCacheLocation:tA.Al.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!t&&t.cacheLocation===tA.Al.LocalStorage,claimsBasedCachingEnabled:!1},l={loggerCallback:()=>{},logLevel:i.Info,piiLoggingEnabled:!1},c={...{...td,loggerOptions:l,networkClient:o?new rb:tw,navigationClient:new tT,loadFrameTimeout:0,windowHashTimeout:r?.loadFrameTimeout||6e4,iframeHashTimeout:r?.loadFrameTimeout||1e4,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:r?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:tA.Q1.DEFAULT_POLL_INTERVAL_MS},...r,loggerOptions:r?.loggerOptions||l},p={application:{appName:u.YM.EMPTY_STRING,appVersion:u.YM.EMPTY_STRING},client:new t_};if(e?.protocolMode!==f.OIDC&&e?.OIDCOptions&&new d(c.loggerOptions).warning(JSON.stringify(eX(e$))),e?.protocolMode&&e.protocolMode!==f.AAD&&c?.allowPlatformBroker)throw eX(eW);return{auth:{...a,...e,OIDCOptions:{...a.OIDCOptions,...e?.OIDCOptions}},cache:{...s,...t},system:c,telemetry:{...p,...n}}}(e,this.browserEnvironment);try{t=window[tA.Al.SessionStorage]}catch(e){}let r=t?.getItem(tA.L$),n=t?.getItem(tA.P3)?.toLowerCase(),o="true"===n||"false"!==n&&void 0,a={...this.config.system.loggerOptions},s=r&&Object.keys(i).includes(r)?i[r]:void 0;s&&(a.loggerCallback=nt.loggerCallback,a.logLevel=s),void 0!==o&&(a.piiLoggingEnabled=o),this.logger=new d(a,r7,ne),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class nr extends nt{getModuleName(){return nr.MODULE_NAME}getId(){return nr.ID}async initialize(){return this.available="undefined"!=typeof window,this.available}}nr.MODULE_NAME="",nr.ID="StandardOperatingContext";let nn="missing_kid_error",no="missing_alg_error",ni={[nn]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[no]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class na extends p.lR{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,na.prototype)}}function ns(e){return new na(e,ni[e])}class nl{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw ns(nn);if(!e.alg)throw ns(no);return JSON.stringify(new nl({typ:e.typ||u.Lz.Pop,kid:e.kid,alg:e.alg}))}}class nc{constructor(){this.dbName=tA.$u,this.version=tA.G8,this.tableName=tA.WJ,this.dbOpen=!1}async open(){return new Promise((e,t)=>{let r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",e=>{e.target.result.createObjectStore(this.tableName)}),r.addEventListener("success",t=>{this.db=t.target.result,this.dbOpen=!0,e()}),r.addEventListener("error",()=>t(rv(rn)))})}closeConnection(){let e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(rv(t3));let n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);n.addEventListener("success",e=>{this.closeConnection(),t(e.target.result)}),n.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((r,n)=>{if(!this.db)return n(rv(t3));let o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);o.addEventListener("success",()=>{this.closeConnection(),r()}),o.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(rv(t3));let n=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);n.addEventListener("success",()=>{this.closeConnection(),t()}),n.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(rv(t3));let r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();r.addEventListener("success",t=>{this.closeConnection(),e(t.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),t(e)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(rv(t3));let n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);n.addEventListener("success",e=>{this.closeConnection(),t(1===e.target.result)}),n.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{let r=window.indexedDB.deleteDatabase(tA.$u),n=setTimeout(()=>t(!1),200);r.addEventListener("success",()=>(clearTimeout(n),e(!0))),r.addEventListener("blocked",()=>(clearTimeout(n),e(!0))),r.addEventListener("error",()=>(clearTimeout(n),t(!1)))})}}class nu{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){let e=[];return this.cache.forEach((t,r)=>{e.push(r)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}class nd{constructor(e){this.inMemoryCache=new nu,this.indexedDBCache=new nc,this.logger=e}handleDatabaseAccessError(e){if(e instanceof rg&&e.errorCode===rn)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){let t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(e){this.handleDatabaseAccessError(e)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(e){this.handleDatabaseAccessError(e)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(e){this.handleDatabaseAccessError(e)}}async getKeys(){let e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(e){this.handleDatabaseAccessError(e)}return e}async containsKey(e){let t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(e){this.handleDatabaseAccessError(e)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");let e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class nf{constructor(e,t,r){this.logger=e,function(e){if(!window)throw rv(t2);if(!window.crypto)throw rv(tR);if(!e&&!window.crypto.subtle)throw rv(tR,"crypto_subtle_undefined")}(r??!1),this.cache=new nd(this.logger),this.performanceClient=t}createNewGuid(){return rB()}base64Encode(e){return rI(e)}base64Decode(e){return rE(e)}base64UrlEncode(e){return rS(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){let t=this.performanceClient?.startMeasurement(tS.CryptoOptsGetPublicKeyThumbprint,e.correlationId),r=await rU(nf.EXTRACTABLE,nf.POP_KEY_USAGES),n=await rH(r.publicKey),o=nh({e:n.e,kty:n.kty,n:n.n}),i=await this.hashString(o),a=await rH(r.privateKey),s=await rq(a,!1,["sign"]);return await this.cache.setItem(i,{privateKey:s,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),i}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,r,n){let o=this.performanceClient?.startMeasurement(tS.CryptoOptsSignJwt,n),i=await this.cache.getItem(t);if(!i)throw rv(t7);let a=await rH(i.publicKey),s=nh(a),l=rS(JSON.stringify({kid:t})),c=rS(nl.getShrHeaderString({...r?.header,alg:a.alg,kid:l}));e.cnf={jwk:JSON.parse(s)};let u=rS(JSON.stringify(e)),d=`${c}.${u}`,f=new TextEncoder().encode(d),h=rC(new Uint8Array(await rj(i.privateKey,f))),p=`${d}.${h}`;return o&&o.end({success:!0}),p}async hashString(e){return rX(e)}}function nh(e){return JSON.stringify(e,Object.keys(e).sort())}nf.POP_KEY_USAGES=["sign","verify"],nf.EXTRACTABLE=!0;let np=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);let a=n?.startMeasurement(t,o);o&&n?.incrementFields({[t+"CallCount"]:1},o);try{let n=e(...i);return a?.end({success:!0}),r.trace(`Returning result from ${t}`),n}catch(e){r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e}},nm=(e,t,r,n,o)=>(...i)=>{r.trace(`Executing function ${t}`);let a=n?.startMeasurement(t,o);return o&&n?.incrementFields({[t+"CallCount"]:1},o),n?.setPreQueueTime(t,o),e(...i).then(e=>(r.trace(`Returning result from ${t}`),a?.end({success:!0}),e)).catch(e=>{r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw a?.end({success:!1},e),e})};class ng{constructor(e,t,r,n){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=n}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(tS.RegionDiscoveryDetectRegion,this.correlationId);let r=e;if(r)t.region_source=u.jZ.ENVIRONMENT_VARIABLE;else{let e=ng.IMDS_OPTIONS;try{let n=await nm(this.getRegionFromIMDS.bind(this),tS.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(u.YM.IMDS_VERSION,e);if(n.status===u.Kk.httpSuccess&&(r=n.body,t.region_source=u.jZ.IMDS),n.status===u.Kk.httpBadRequest){let n=await nm(this.getCurrentVersion.bind(this),tS.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source=u.jZ.FAILED_AUTO_DETECTION,null;let o=await nm(this.getRegionFromIMDS.bind(this),tS.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(n,e);o.status===u.Kk.httpSuccess&&(r=o.body,t.region_source=u.jZ.IMDS)}}catch(e){return t.region_source=u.jZ.FAILED_AUTO_DETECTION,null}}return r||(t.region_source=u.jZ.FAILED_AUTO_DETECTION),r||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(tS.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${u.YM.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,u.YM.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(tS.RegionDiscoveryGetCurrentVersion,this.correlationId);try{let t=await this.networkInterface.sendGetRequestAsync(`${u.YM.IMDS_ENDPOINT}?format=json`,e);if(t.status===u.Kk.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0)return t.body["newest-versions"][0];return null}catch(e){return null}}}ng.IMDS_OPTIONS={headers:{Metadata:"true"}};class nv{constructor(e,t,r,n,o,i,a,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=a,this.correlationId=i,this.managedIdentity=s||!1,this.regionDiscovery=new ng(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(u.YM.CIAM_AUTH_URL))return e3.Ciam;let t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case u.YM.ADFS:return e3.Adfs;case u.YM.DSTS:return e3.Dsts}return e3.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new e9(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw es(y)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw es(y)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw es(y)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw es(Q);return this.replacePath(this.metadata.end_session_endpoint)}throw es(y)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw es(y)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw es(y)}canReplaceTenant(e){return 1===e.PathSegments.length&&!nv.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===e3.Default&&this.protocolMode===f.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e,r=new e9(this.metadata.canonical_authority).getUrlComponents(),n=r.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((e,o)=>{let i=n[o];if(0===o&&this.canReplaceTenant(r)){let e=new e9(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose(`Replacing tenant domain name ${i} with id ${e}`),i=e)}e!==i&&(t=t.replace(`/${i}/`,`/${e}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){let e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===e3.Adfs||this.protocolMode!==f.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(tS.AuthorityResolveEndpointsAsync,this.correlationId);let e=this.getCurrentMetadataEntity(),t=await nm(this.updateCloudDiscoveryMetadata.bind(this),tS.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);let r=await nm(this.updateEndpointMetadata.bind(this),tS.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:eS(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==u.E_.CACHE&&r?.source!==u.E_.CACHE&&(e.expiresAt=eS(),e.canonical_authority=this.canonicalAuthority);let n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(tS.AuthorityUpdateEndpointMetadata,this.correlationId);let t=this.updateEndpointMetadataFromLocalSources(e);if(t)return t.source===u.E_.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata&&(eC(e,await nm(this.updateMetadataWithRegionalInformation.bind(this),tS.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata),!1),e.canonical_authority=this.canonicalAuthority),t.source;let r=await nm(this.getEndpointMetadataFromNetwork.bind(this),tS.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(r=await nm(this.updateMetadataWithRegionalInformation.bind(this),tS.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r)),eC(e,r,!0),u.E_.NETWORK;throw es(S,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),eC(e,t,!1),{source:u.E_.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let t=this.getEndpointMetadataFromHardcodedValues();if(t)return eC(e,t,!1),{source:u.E_.HARDCODED_VALUES,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}let r=ek(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:u.E_.CACHE}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new e9(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw eX(eD)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(tS.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);let e=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${e}`);try{var t;let r=await this.networkInterface.sendGetRequestAsync(e,{});if((t=r.body).hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("jwks_uri"))return r.body;return this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null}catch(e){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${e}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in te?te[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(tS.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);let t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==u.YM.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=u._2.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,nv.replaceWithRegionalInformation(e,t);let r=await nm(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),tS.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(r)return this.regionDiscoveryMetadata.region_outcome=u._2.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=r,nv.replaceWithRegionalInformation(e,r);this.regionDiscoveryMetadata.region_outcome=u._2.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(tS.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);let t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;let r=await nm(this.getCloudDiscoveryMetadataFromNetwork.bind(this),tS.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return eI(e,r,!0),u.E_.NETWORK;throw eX(eB)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||u.YM.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||u.YM.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||u.YM.NOT_APPLICABLE}`);let t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),eI(e,t,!1),u.E_.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{var r;let t=(r=this.hostnameAndPort,to(tt.metadata,r));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),eI(e,t,!1),u.E_.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}let n=ek(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),u.E_.CACHE):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===e3.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),nv.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");let e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=to(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),eX(ez)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),nv.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(tS.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);let e=`${u.YM.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t=null;try{var r,n;let o,i;let a=await this.networkInterface.sendGetRequestAsync(e,{});if((r=a.body).hasOwnProperty("tenant_discovery_endpoint")&&r.hasOwnProperty("metadata"))i=(o=a.body).metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${o.tenant_discovery_endpoint}`);else{if(!((n=a.body).hasOwnProperty("error")&&n.hasOwnProperty("error_description")))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${a.status}`),(o=a.body).error===u.YM.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${o.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${o.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),i=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),t=to(i,this.hostnameAndPort)}catch(e){return e instanceof p.lR?this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${e.errorCode}
Error Description: ${e.errorMessage}`):this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${e.name}
Error Description: ${e.message}`),null}return t||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),t=nv.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),t}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(e=>e&&e9.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==h.None){let e=t.tenant?t.tenant:u.YM.DEFAULT_COMMON_TENANT;r=`${t.azureCloudInstance}/${e}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return u.YM.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw es(y)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return tr.has(e)}static isPublicCloudAuthority(e){return u.YM.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){let n=new e9(e);n.validateAsUri();let o=n.getUrlComponents(),i=`${t}.${o.HostNameAndPort}`;this.isPublicCloudAuthority(o.HostNameAndPort)&&(i=`${t}.${u.YM.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);let a=e9.constructAuthorityUriFromObject({...n.getUrlComponents(),HostNameAndPort:i}).urlString;return r?`${a}?${r}`:a}static replaceWithRegionalInformation(e,t){let r={...e};return r.authorization_endpoint=nv.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=nv.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=nv.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e,r=new e9(e).getUrlComponents();if(0===r.PathSegments.length&&r.HostNameAndPort.endsWith(u.YM.CIAM_AUTH_URL)){let e=r.HostNameAndPort.split(".")[0];t=`${t}${e}${u.YM.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}function nb(e){return e.endsWith(u.YM.FORWARD_SLASH)?e:`${e}${u.YM.FORWARD_SLASH}`}function ny(e){let t;let r=e.cloudDiscoveryMetadata;if(r)try{t=JSON.parse(r)}catch(e){throw eX(ez)}return{canonicalAuthority:e.authority?nb(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:t}}nv.reservedTenantDomains=new Set(["{tenant}","{tenantid}",u.v2.COMMON,u.v2.CONSUMERS,u.v2.ORGANIZATIONS]);var nw=r(47807),nS=r(454023);class nC{static setRequestState(e,t,r){let n=nC.generateLibraryState(e,r);return t?`${n}${u.YM.RESOURCE_DELIM}${t}`:n}static generateLibraryState(e,t){if(!e)throw es(j);let r={id:e.createNewGuid()};t&&(r.meta=t);let n=JSON.stringify(r);return e.base64Encode(n)}static parseRequestState(e,t){if(!e)throw es(j);if(!t)throw es(I);try{let r=t.split(u.YM.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(u.YM.RESOURCE_DELIM):u.YM.EMPTY_STRING,i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:o||u.YM.EMPTY_STRING,libraryState:a}}catch(e){throw es(I)}}}let nI={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"},nk={Lax:"Lax",None:"None"};class nE{initialize(){return Promise.resolve()}getItem(e){let t=`${encodeURIComponent(e)}`,r=document.cookie.split(";");for(let e=0;e<r.length;e++){let[n,...o]=decodeURIComponent(r[e]).trim().split("="),i=o.join("=");if(n===t)return i}return""}getUserData(){throw es(en)}setItem(e,t,r,n=!0,o=nk.Lax){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${o};`;if(r){let e=new Date(new Date().getTime()+864e5*r).toUTCString();i+=`expires=${e};`}(n||o===nk.None)&&(i+="Secure;"),document.cookie=i}async setUserData(){return Promise.reject(es(en))}removeItem(e){this.setItem(e,"",-1)}getKeys(){let e=document.cookie.split(";"),t=[];return e.forEach(e=>{let r=decodeURIComponent(e).trim().split("=");t.push(r[0])}),t}containsKey(e){return this.getKeys().includes(e)}}function n_(e){let t=e.getItem(tA.dh.ACCOUNT_KEYS);return t?JSON.parse(t):[]}function nA(e,t){let r=t.getItem(`${tA.dh.TOKEN_KEYS}.${e}`);if(r){let e=JSON.parse(r);if(e&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e}return{idToken:[],accessToken:[],refreshToken:[]}}let nT="msal.cache.encryption";class nP{constructor(e,t,r){if(!window.localStorage)throw r1(rY);this.memoryStorage=new nu,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=r,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}async initialize(e){this.initialized=!0;let t=new nE,r=t.getItem(nT),n={key:"",id:""};if(r)try{n=JSON.parse(r)}catch(e){}if(n.key&&n.id){let t=np(r_,tS.Base64Decode,this.logger,this.performanceClient,e)(n.key);this.encryptionCookie={id:n.id,key:await nm(rW,tS.GenerateHKDF,this.logger,this.performanceClient,e)(t)},await nm(this.importExistingCache.bind(this),tS.ImportExistingCache,this.logger,this.performanceClient,e)(e)}else{this.clear();let r=rB(),n=await nm(r$,tS.GenerateBaseKey,this.logger,this.performanceClient,e)(),o=np(rC,tS.UrlEncodeArr,this.logger,this.performanceClient,e)(new Uint8Array(n));this.encryptionCookie={id:r,key:await nm(rW,tS.GenerateHKDF,this.logger,this.performanceClient,e)(n)},t.setItem(nT,JSON.stringify({id:r,key:o}),0,!0,nk.None)}this.broadcast.addEventListener("message",this.updateCache.bind(this))}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw rv(rl);return this.memoryStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,r){if(!this.initialized||!this.encryptionCookie)throw rv(rl);let{data:n,nonce:o}=await nm(rG,tS.Encrypt,this.logger,this.performanceClient,r)(this.encryptionCookie.key,t,this.getContext(e)),i={id:this.encryptionCookie.id,nonce:o,data:n};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(i)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),n_(this).forEach(e=>this.removeItem(e));let e=nA(this.clientId,this);e.idToken.forEach(e=>this.removeItem(e)),e.accessToken.forEach(e=>this.removeItem(e)),e.refreshToken.forEach(e=>this.removeItem(e)),this.getKeys().forEach(e=>{(e.startsWith(u.YM.CACHE_PREFIX)||-1!==e.indexOf(this.clientId))&&this.removeItem(e)})}async importExistingCache(e){if(!this.encryptionCookie)return;let t=n_(this);t=await this.importArray(t,e),this.setItem(tA.dh.ACCOUNT_KEYS,JSON.stringify(t));let r=nA(this.clientId,this);r.idToken=await this.importArray(r.idToken,e),r.accessToken=await this.importArray(r.accessToken,e),r.refreshToken=await this.importArray(r.refreshToken,e),this.setItem(`${tA.dh.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(r))}async getItemFromEncryptedCache(e,t){let r;if(!this.encryptionCookie)return null;let n=this.getItem(e);if(!n)return null;try{r=JSON.parse(n)}catch(e){return null}return r.id&&r.nonce&&r.data?r.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):nm(rK,tS.Decrypt,this.logger,this.performanceClient,t)(this.encryptionCookie.key,r.nonce,this.getContext(e),r.data):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),null)}async importArray(e,t){let r=[],n=[];return e.forEach(e=>{let o=this.getItemFromEncryptedCache(e,t).then(t=>{t?(this.memoryStorage.setItem(e,t),r.push(e)):this.removeItem(e)});n.push(o)}),await Promise.all(n),r}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");let t=this.performanceClient.startMeasurement(tS.LocalStorageUpdated);t.add({isBackground:!0});let{key:r,value:n,context:o}=e.data;if(!r){this.logger.error("Broadcast event missing key"),t.end({success:!1,errorCode:"noKey"});return}if(o&&o!==this.clientId){this.logger.trace(`Ignoring broadcast event from clientId: ${o}`),t.end({success:!1,errorCode:"contextMismatch"});return}n?(this.memoryStorage.setItem(r,n),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(r),this.logger.verbose("Removed item from internal cache")),t.end({success:!0})}}class nO{constructor(){if(!window.sessionStorage)throw r1(rY)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}function nR(e,t){if(!t)return null;try{return nC.parseRequestState(e,t).libraryState.meta}catch(e){throw es(I)}}let nx={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};class nM extends tc{constructor(e,t,r,n,o,i,a){super(e,r,n,a),this.cacheConfig=t,this.logger=n,this.internalStorage=new nu,this.browserStorage=nN(e,t.cacheLocation,n,o),this.temporaryCacheStorage=nN(e,t.temporaryCacheLocation,n,o),this.cookieStorage=new nE,this.performanceClient=o,this.eventHandler=i}async initialize(e){await this.browserStorage.initialize(e)}validateAndParseJson(e){try{let t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}}getAccount(e){this.logger.trace("BrowserCacheManager.getAccount called");let t=this.browserStorage.getUserData(e);if(!t)return this.removeAccountKeyFromMap(e),null;let r=this.validateAndParseJson(t);return r&&e6.isAccountEntity(r)?tc.toObject(new e6,r):(this.removeAccountKeyFromMap(e),null)}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");let r=e.generateAccountKey();await nm(this.browserStorage.setUserData.bind(this.browserStorage),tS.SetUserData,this.logger,this.performanceClient)(r,JSON.stringify(e),t);let n=this.addAccountKeyToMap(r);this.cacheConfig.cacheLocation===tA.Al.LocalStorage&&n&&this.eventHandler.emitEvent(nx.ACCOUNT_ADDED,void 0,e.getAccountInfo())}getAccountKeys(){return n_(this.browserStorage)}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);let t=this.getAccountKeys();return -1===t.indexOf(e)?(t.push(e),this.browserStorage.setItem(tA.dh.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);let t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.browserStorage.setItem(tA.dh.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}async removeAccountContext(e){await super.removeAccountContext(e),this.cacheConfig.cacheLocation===tA.Al.LocalStorage&&this.eventHandler.emitEvent(nx.ACCOUNT_REMOVED,void 0,e.getAccountInfo())}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,u.aG.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,u.aG.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,u.aG.REFRESH_TOKEN)}getTokenKeys(){return nA(this.clientId,this.browserStorage)}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");let r=this.getTokenKeys();switch(t){case u.aG.ID_TOKEN:-1===r.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case u.aG.ACCESS_TOKEN:-1===r.accessToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case u.aG.REFRESH_TOKEN:-1===r.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),es($)}this.browserStorage.setItem(`${tA.dh.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(r))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");let r=this.getTokenKeys();switch(t){case u.aG.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);let n=r.idToken.indexOf(e);n>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(n,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case u.aG.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);let o=r.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case u.aG.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);let i=r.refreshToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),es($)}this.browserStorage.setItem(`${tA.dh.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(r))}getIdTokenCredential(e){let t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,u.aG.ID_TOKEN),null;let r=this.validateAndParseJson(t);return r&&r&&ew(r)&&r.hasOwnProperty("realm")&&r.credentialType===u.aG.ID_TOKEN?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,u.aG.ID_TOKEN),null)}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");let r=eg(e);await nm(this.browserStorage.setUserData.bind(this.browserStorage),tS.SetUserData,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,u.aG.ID_TOKEN)}getAccessTokenCredential(e){let t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,u.aG.ACCESS_TOKEN),null;let r=this.validateAndParseJson(t);return r&&r&&ew(r)&&r.hasOwnProperty("realm")&&r.hasOwnProperty("target")&&(r.credentialType===u.aG.ACCESS_TOKEN||r.credentialType===u.aG.ACCESS_TOKEN_WITH_AUTH_SCHEME)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,u.aG.ACCESS_TOKEN),null)}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");let r=eg(e);await nm(this.browserStorage.setUserData.bind(this.browserStorage),tS.SetUserData,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,u.aG.ACCESS_TOKEN)}getRefreshTokenCredential(e){let t=this.browserStorage.getUserData(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,u.aG.REFRESH_TOKEN),null;let r=this.validateAndParseJson(t);return r&&r&&ew(r)&&r.credentialType===u.aG.REFRESH_TOKEN?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,u.aG.REFRESH_TOKEN),null)}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");let r=eg(e);await nm(this.browserStorage.setUserData.bind(this.browserStorage),tS.SetUserData,this.logger,this.performanceClient)(r,JSON.stringify(e),t),this.addTokenKey(r,u.aG.REFRESH_TOKEN)}getAppMetadata(e){let t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;let r=this.validateAndParseJson(t);return r&&r&&0===e.indexOf(u.GU)&&r.hasOwnProperty("clientId")&&r.hasOwnProperty("environment")?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");let t=function({environment:e,clientId:t}){return[u.GU,e,t].join(u.LR.CACHE_KEY_SEPARATOR).toLowerCase()}(e);this.browserStorage.setItem(t,JSON.stringify(e))}getServerTelemetry(e){let t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;let r=this.validateAndParseJson(t);return r&&function(e,t){let r=0===e.indexOf(u.gT.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n}(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.browserStorage.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){let t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;let r=this.validateAndParseJson(t);return r&&r&&0===e.indexOf(u.u0.CACHE_KEY)&&r.hasOwnProperty("aliases")&&r.hasOwnProperty("preferred_cache")&&r.hasOwnProperty("preferred_network")&&r.hasOwnProperty("canonical_authority")&&r.hasOwnProperty("authorization_endpoint")&&r.hasOwnProperty("token_endpoint")&&r.hasOwnProperty("issuer")&&r.hasOwnProperty("aliasesFromNetwork")&&r.hasOwnProperty("endpointsFromNetwork")&&r.hasOwnProperty("expiresAt")&&r.hasOwnProperty("jwks_uri")?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(e=>this.isAuthorityMetadata(e))}setWrapperMetadata(e,t){this.internalStorage.setItem(tA.H3.WRAPPER_SKU,e),this.internalStorage.setItem(tA.H3.WRAPPER_VER,t)}getWrapperMetadata(){return[this.internalStorage.getItem(tA.H3.WRAPPER_SKU)||u.YM.EMPTY_STRING,this.internalStorage.getItem(tA.H3.WRAPPER_VER)||u.YM.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){let e=this.generateCacheKey(u.Gd.ACTIVE_ACCOUNT_FILTERS),t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;let r=this.validateAndParseJson(t);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){let t=this.generateCacheKey(u.Gd.ACTIVE_ACCOUNT_FILTERS);if(e){this.logger.verbose("setActiveAccount: Active account set");let r={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(r))}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t);this.eventHandler.emitEvent(nx.ACTIVE_ACCOUNT_CHANGED)}getThrottlingCache(e){let t,r;let n=this.browserStorage.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;let o=this.validateAndParseJson(n);return o&&(t=!1,e&&(t=0===e.indexOf(u.Xw.THROTTLING_PREFIX)),r=!0,o&&(r=o.hasOwnProperty("throttleTime")),t&&r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),o):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.browserStorage.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){let r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){let e=this.cookieStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}let n=this.temporaryCacheStorage.getItem(r);if(!n){if(this.cacheConfig.cacheLocation===tA.Al.LocalStorage){let e=this.browserStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),n}setTemporaryCache(e,t,r){let n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(n,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach(e=>{(-1!==e.indexOf(u.YM.CACHE_PREFIX)||-1!==e.indexOf(this.clientId))&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(-1!==e.indexOf(u.YM.CACHE_PREFIX)||-1!==e.indexOf(this.clientId))&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(tS.ClearTokensAndKeysWithClaims,t);let r=this.getTokenKeys(),n=[];r.accessToken.forEach(e=>{let t=this.getAccessTokenCredential(e);t?.requestedClaimsHash&&e.includes(t.requestedClaimsHash.toLowerCase())&&n.push(this.removeAccessToken(e))}),await Promise.all(n),n.length>0&&this.logger.warning(`${n.length} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):eY.startsWith(e,u.YM.CACHE_PREFIX)?e:`${u.YM.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){let{libraryState:{id:t}}=nC.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${tA._p.AUTHORITY}.${t}`)}generateNonceKey(e){let{libraryState:{id:t}}=nC.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${tA._p.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){let{libraryState:{id:t}}=nC.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${tA._p.REQUEST_STATE}.${t}`)}getCachedAuthority(e){let t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;let n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)}updateCacheEntries(e,t,r,n,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");let i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);let a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);let s=this.generateAuthorityKey(e);if(this.setTemporaryCache(s,r,!1),o){let e={credential:o.homeAccountId,type:nI.HOME_ACCOUNT_ID};this.setTemporaryCache(tA._p.CCS_CREDENTIAL,JSON.stringify(e),!0)}else if(n){let e={credential:n,type:nI.UPN};this.setTemporaryCache(tA._p.CCS_CREDENTIAL,JSON.stringify(e),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{-1!==t.indexOf(e)&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(tA._p.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(tA._p.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(tA._p.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(tA._p.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(tA._p.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(tA._p.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){let t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r||u.YM.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(-1===t.indexOf(tA._p.REQUEST_STATE))return;let r=this.temporaryCacheStorage.getItem(t);if(!r)return;let n=nR(this.cryptoImpl,r);n&&n.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r))}),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");let t=rI(JSON.stringify(e));this.setTemporaryCache(tA._p.REQUEST_PARAMS,t,!0)}getCachedRequest(e){let t;this.logger.trace("BrowserCacheManager.getCachedRequest called");let r=this.getTemporaryCache(tA._p.REQUEST_PARAMS,!0);if(!r)throw rv(tZ);try{t=JSON.parse(rE(r))}catch(e){throw this.logger.errorPii(`Attempted to parse: ${r}`),this.logger.error(`Parsing cached token request threw with error: ${e}`),rv(tQ)}if(this.removeTemporaryItem(this.generateCacheKey(tA._p.REQUEST_PARAMS)),!t.authority){let r=this.generateAuthorityKey(e),n=this.getTemporaryCache(r);if(!n)throw rv(tJ);t.authority=n}return t}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");let e=this.getTemporaryCache(tA._p.NATIVE_REQUEST,!0);return e?this.validateAndParseJson(e)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null):(this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null)}isInteractionInProgress(e){let t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){let e=`${u.YM.CACHE_PREFIX}.${tA._p.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){let t=`${u.YM.CACHE_PREFIX}.${tA._p.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw rv(tD);this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeTemporaryItem(t)}async hydrateCache(e,t){let r;let n=ev(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);t.claims&&(r=await this.cryptoImpl.hashString(t.claims));let o=eb(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,rE,void 0,e.tokenType,void 0,t.sshKid,t.claims,r);return this.saveCacheRecord({idToken:n,accessToken:o},e.correlationId)}async saveCacheRecord(e,t,r){try{await super.saveCacheRecord(e,t,r)}catch(e){if(e instanceof tl&&this.performanceClient&&t)try{let e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(e){}throw e}}}function nN(e,t,r,n){try{switch(t){case tA.Al.LocalStorage:return new nP(e,r,n);case tA.Al.SessionStorage:return new nO;case tA.Al.MemoryStorage:}}catch(e){r.error(e)}return new nu}let nF=(e,t,r,n)=>new nM(e,{cacheLocation:tA.Al.MemoryStorage,temporaryCacheLocation:tA.Al.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},el,t,r,n);function nL(e,t,r,n){return e.verbose("getAllAccounts called"),r?t.getAllAccounts(n):[]}function nz(e,t,r){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;let n=r.getAccountInfoFilteredBy(e);return n?(t.verbose("getAccount: Account matching provided filter found, returning"),n):(t.verbose("getAccount: No matching account found, returning null"),null)}function nD(e,t,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;let n=r.getAccountInfoFilteredBy({username:e});return n?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),n):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}function nB(e,t,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;let n=r.getAccountInfoFilteredBy({homeAccountId:e});return n?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),n):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function nU(e,t,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;let n=r.getAccountInfoFilteredBy({localAccountId:e});return n?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),n):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function nH(e,t){t.setActiveAccount(e)}function nq(e){return e.getActiveAccount()}class nj{constructor(e){this.eventCallbacks=new Map,this.logger=e||new d({}),this.broadcastChannel=new BroadcastChannel("msal.broadcast.event"),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,r){if("undefined"!=typeof window){let n=r||rB();return this.eventCallbacks.has(n)?(this.logger.error(`Event callback with id: ${n} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(n,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${n}`),n)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,r,n){let o={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};switch(e){case nx.ACCOUNT_ADDED:case nx.ACCOUNT_REMOVED:case nx.ACTIVE_ACCOUNT_CHANGED:this.broadcastChannel.postMessage(o);break;default:this.invokeCallbacks(o)}}invokeCallbacks(e){this.eventCallbacks.forEach(([t,r],n)=>{(0===r.length||r.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${n}: ${e.eventType}`),t.apply(null,[e]))})}invokeCrossTabCallbacks(e){let t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel.removeEventListener("message",this.invokeCrossTabCallbacks)}}class n$ extends p.lR{constructor(e,t,r,n,o){super(e,t,r),this.name="ServerError",this.errorNo=n,this.status=o,Object.setPrototypeOf(this,n$.prototype)}}class nW{static generateThrottlingStorageKey(e){return`${u.Xw.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t){let r=nW.generateThrottlingStorageKey(t),n=e.getThrottlingCache(r);if(n){if(n.throttleTime<Date.now()){e.removeItem(r);return}throw new n$(n.errorCodes?.join(" ")||u.YM.EMPTY_STRING,n.errorMessage,n.subError)}}static postProcess(e,t,r){if(nW.checkResponseStatus(r)||nW.checkResponseForRetryAfter(r)){let n={throttleTime:nW.calculateThrottleTime(parseInt(r.headers[u.OK.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(nW.generateThrottlingStorageKey(t),n)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&e.headers.hasOwnProperty(u.OK.RETRY_AFTER)&&(e.status<200||e.status>=300)}static calculateThrottleTime(e){let t=Date.now()/1e3;return Math.floor(1e3*Math.min(t+((e<=0?0:e)||u.Xw.DEFAULT_THROTTLE_TIME_SECONDS),t+u.Xw.DEFAULT_MAX_THROTTLE_TIME_SECONDS))}static removeThrottle(e,t,r,n){let o={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},i=this.generateThrottlingStorageKey(o);e.removeItem(i)}}let nV="client_id",nG="redirect_uri",nK="response_type",nX="token_type",nY="req_cnf",nZ="return_spa_code",nQ="brk_client_id",nJ="brk_redirect_uri";class n0{static validateRedirectUri(e){if(!e)throw eX(eE)}static validatePrompt(e){let t=[];for(let e in u._M)t.push(u._M[e]);if(0>t.indexOf(e))throw eX(eR)}static validateClaims(e){try{JSON.parse(e)}catch(e){throw eX(ex)}}static validateCodeChallengeParams(e,t){if(e&&t)this.validateCodeChallengeMethod(t);else throw eX(eL)}static validateCodeChallengeMethod(e){if(0>[u.iF.PLAIN,u.iF.S256].indexOf(e))throw eX(eF)}}class n1{constructor(e,t){this.parameters=new Map,this.performanceClient=t,this.correlationId=e}addResponseTypeCode(){this.parameters.set(nK,encodeURIComponent(u.YM.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(nK,encodeURIComponent(`${u.YM.TOKEN_RESPONSE_TYPE} ${u.YM.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set("response_mode",encodeURIComponent(e||u.p.QUERY))}addNativeBroker(){this.parameters.set("nativebroker",encodeURIComponent("1"))}addScopes(e,t=!0,r=u.aZ){!t||r.includes("openid")||e.includes("openid")||r.push("openid");let n=new eZ(t?[...e||[],...r]:e||[]);this.parameters.set("scope",encodeURIComponent(n.printScopes()))}addClientId(e){this.parameters.set(nV,encodeURIComponent(e))}addRedirectUri(e){n0.validateRedirectUri(e),this.parameters.set(nG,encodeURIComponent(e))}addPostLogoutRedirectUri(e){n0.validateRedirectUri(e),this.parameters.set("post_logout_redirect_uri",encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set("id_token_hint",encodeURIComponent(e))}addDomainHint(e){this.parameters.set("domain_hint",encodeURIComponent(e))}addLoginHint(e){this.parameters.set("login_hint",encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(u.OK.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(u.OK.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set("sid",encodeURIComponent(e))}addClaims(e,t){let r=this.addClientCapabilitiesToClaims(e,t);n0.validateClaims(r),this.parameters.set("claims",encodeURIComponent(r))}addCorrelationId(e){this.parameters.set("client-request-id",encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set("x-client-SKU",e.sku),this.parameters.set("x-client-VER",e.version),e.os&&this.parameters.set("x-client-OS",e.os),e.cpu&&this.parameters.set("x-client-CPU",e.cpu)}addApplicationTelemetry(e){e?.appName&&this.parameters.set("x-app-name",e.appName),e?.appVersion&&this.parameters.set("x-app-ver",e.appVersion)}addPrompt(e){n0.validatePrompt(e),this.parameters.set("prompt",encodeURIComponent(e))}addState(e){e&&this.parameters.set("state",encodeURIComponent(e))}addNonce(e){this.parameters.set("nonce",encodeURIComponent(e))}addCodeChallengeParams(e,t){if(n0.validateCodeChallengeParams(e,t),e&&t)this.parameters.set("code_challenge",encodeURIComponent(e)),this.parameters.set("code_challenge_method",encodeURIComponent(t));else throw eX(eL)}addAuthorizationCode(e){this.parameters.set("code",encodeURIComponent(e))}addDeviceCode(e){this.parameters.set("device_code",encodeURIComponent(e))}addRefreshToken(e){this.parameters.set("refresh_token",encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set("code_verifier",encodeURIComponent(e))}addClientSecret(e){this.parameters.set("client_secret",encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set("client_assertion",encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set("client_assertion_type",encodeURIComponent(e))}addOboAssertion(e){this.parameters.set("assertion",encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set("requested_token_use",encodeURIComponent(e))}addGrantType(e){this.parameters.set("grant_type",encodeURIComponent(e))}addClientInfo(){this.parameters.set(u.JR,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([e,t])=>{!this.parameters.has(e)&&t&&this.parameters.set(e,t)})}addClientCapabilitiesToClaims(e,t){let r;if(e)try{r=JSON.parse(e)}catch(e){throw eX(ex)}else r={};return t&&t.length>0&&(r.hasOwnProperty(u.Fq.ACCESS_TOKEN)||(r[u.Fq.ACCESS_TOKEN]={}),r[u.Fq.ACCESS_TOKEN][u.Fq.XMS_CC]={values:t}),JSON.stringify(r)}addUsername(e){this.parameters.set(u.Tq.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(u.Tq.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(nX,u.IO.POP),this.parameters.set(nY,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(nX,u.IO.SSH),this.parameters.set(nY,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set("x-client-current-telemetry",e.generateCurrentRequestHeaderValue()),this.parameters.set("x-client-last-telemetry",e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set("x-ms-lib-capability",u.Xw.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set("logout_hint",encodeURIComponent(e))}addBrokerParameters(e){let t={};t[nQ]=e.brokerClientId,t[nJ]=e.brokerRedirectUri,this.addExtraQueryParameters(t)}createQueryString(){let e=[];return this.parameters.forEach((t,r)=>{e.push(`${r}=${t}`)}),function(e,t,r){if(!t)return;let n=e.get(nV);n&&e.has(nQ)&&r?.addFields({embeddedClientId:n,embeddedRedirectUri:e.get(nG)},t)}(this.parameters,this.correlationId,this.performanceClient),e.join("&")}}async function n2(e,t,r,n,o,i,a){a?.addQueueMeasurement(tS.AuthorityFactoryCreateDiscoveredInstance,i);let s=nv.transformCIAMAuthority(nb(e)),l=new nv(s,t,r,n,o,i,a);try{return await nm(l.resolveEndpointsAsync.bind(l),tS.AuthorityResolveEndpointsAsync,o,a,i)(),l}catch(e){throw es(y)}}class n3{constructor(e,t){this.config=function({authOptions:e,systemOptions:t,loggerOptions:r,cacheOptions:n,storageInterface:o,networkInterface:i,cryptoInterface:a,clientCredentials:s,libraryInfo:l,telemetry:c,serverTelemetryManager:u,persistencePlugin:f,serializableCache:h}){let p={...tf,...r};return{authOptions:{clientCapabilities:[],azureCloudOptions:tv,skipAuthorityMetadataCache:!1,instanceAware:!1,...e},systemOptions:{...td,...t},loggerOptions:p,cacheOptions:{...th,...n},storageInterface:o||new tu(e.clientId,el,new d(p)),networkInterface:i||tp,cryptoInterface:a||el,clientCredentials:s||tg,libraryInfo:{...tm,...l},telemetry:{...tb,...c},serverTelemetryManager:u||null,persistencePlugin:f||null,serializableCache:h||null}}(e),this.logger=new d(this.config.loggerOptions,ec,eu),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){let t={};if(t[u.OK.CONTENT_TYPE]=u.YM.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case nI.HOME_ACCOUNT_ID:try{let r=eJ(e.credential);t[u.OK.CCS_HEADER]=`Oid:${r.uid}@${r.utid}`}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case nI.UPN:t[u.OK.CCS_HEADER]=`UPN: ${e.credential}`}return t}async executePostToTokenEndpoint(e,t,r,n,o,i){i&&this.performanceClient?.addQueueMeasurement(i,o);let a=await this.sendPostRequest(n,e,{body:t,headers:r},o);return this.config.serverTelemetryManager&&a.status<500&&429!==a.status&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,r,n){let o;nW.preProcess(this.cacheManager,e);try{let e=(o=await nm(this.networkClient.sendPostRequestAsync.bind(this.networkClient),tS.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,n)(t,r)).headers||{};this.performanceClient?.addFields({refreshTokenSize:o.body.refresh_token?.length||0,httpVerToken:e[u.OK.X_MS_HTTP_VERSION]||"",requestId:e[u.OK.X_MS_REQUEST_ID]||""},n)}catch(e){if(e instanceof tP){let t=e.responseHeaders;throw t&&this.performanceClient?.addFields({httpVerToken:t[u.OK.X_MS_HTTP_VERSION]||"",requestId:t[u.OK.X_MS_REQUEST_ID]||"",contentTypeHeader:t[u.OK.CONTENT_TYPE]||void 0,contentLengthHeader:t[u.OK.CONTENT_LENGTH]||void 0,httpStatus:e.httpStatus},n),e.error}if(e instanceof p.lR)throw e;throw es(w)}return nW.postProcess(this.cacheManager,e,o),o}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(tS.UpdateTokenEndpointAuthority,t);let r=`https://${e}/${this.authority.tenant}/`,n=await n2(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=n}createTokenQueryParameters(e){let t=new n1(e.correlationId,this.performanceClient);return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.addCorrelationId(e.correlationId),t.createQueryString()}}let n5={SW:"sw"};class n6{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(tS.PopTokenGenerateCnf,e.correlationId);let r=await nm(this.generateKid.bind(this),tS.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),n=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:n}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(tS.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:n5.SW}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,n){let{resourceRequestMethod:o,resourceRequestUri:i,shrClaims:a,shrNonce:s,shrOptions:l}=r,c=i?new e9(i):void 0,u=c?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:eh(),m:o?.toUpperCase(),u:u?.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:a||void 0,...n},t,l,r.correlationId)}}class n4{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class n8{constructor(e,t,r,n,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}validateServerAuthorizationCodeResponse(e,t){let r,n;if(!e.state||!t)throw e.state?es(E,"Cached State"):es(E,"Server State");try{r=decodeURIComponent(e.state)}catch(t){throw es(I,e.state)}try{n=decodeURIComponent(t)}catch(t){throw es(I,e.state)}if(r!==n)throw es(k);if(e.error||e.error_description||e.suberror){let t=function(e){let t="code=",r=e.error_uri?.lastIndexOf(t);return r&&r>=0?e.error_uri?.substring(r+t.length):void 0}(e);if((0,nw.a)(e.error,e.error_description,e.suberror))throw new nw.CB(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new n$(e.error||"",e.error_description,e.suberror,t)}}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){let r=`Error(s): ${e.error_codes||u.YM.NOT_AVAILABLE} - Timestamp: ${e.timestamp||u.YM.NOT_AVAILABLE} - Description: ${e.error_description||u.YM.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||u.YM.NOT_AVAILABLE} - Trace ID: ${e.trace_id||u.YM.NOT_AVAILABLE}`,n=e.error_codes?.length?e.error_codes[0]:void 0,o=new n$(e.error,r,e.suberror,n,e.status);if(t&&e.status&&e.status>=u.t3.SERVER_ERROR_RANGE_START&&e.status<=u.t3.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${o}`);return}if(t&&e.status&&e.status>=u.t3.CLIENT_ERROR_RANGE_START&&e.status<=u.t3.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${o}`);return}if((0,nw.a)(e.error,e.error_description,e.suberror))throw new nw.CB(e.error,e.error_description,e.suberror,e.timestamp||u.YM.EMPTY_STRING,e.trace_id||u.YM.EMPTY_STRING,e.correlation_id||u.YM.EMPTY_STRING,e.claims||u.YM.EMPTY_STRING,n);throw o}}async handleServerTokenResponse(e,t,r,n,o,i,a,s,l){let c,d,f;if(this.performanceClient?.addQueueMeasurement(tS.HandleServerTokenResponse,e.correlation_id),e.id_token){if(c=ed(e.id_token||u.YM.EMPTY_STRING,this.cryptoObj.base64Decode),o&&o.nonce&&c.nonce!==o.nonce)throw es(_);if(n.maxAge||0===n.maxAge){let e=c.auth_time;if(!e)throw es(A);ef(e,n.maxAge)}}this.homeAccountIdentifier=e6.generateHomeAccountId(e.client_info||u.YM.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,c),o&&o.state&&(d=nC.parseRequestState(this.cryptoObj,o.state)),e.key_id=e.key_id||n.sshKid||void 0;let h=this.generateCacheRecord(e,t,r,n,c,i,o);try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new n4(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(f)),a&&!s&&h.account){let e=h.account.generateAccountKey();if(!this.cacheStorage.getAccount(e))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await n8.generateAuthenticationResult(this.cryptoObj,t,h,!1,n,c,d,void 0,l)}await this.cacheStorage.saveCacheRecord(h,n.correlationId,n.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&f&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(f))}return n8.generateAuthenticationResult(this.cryptoObj,t,h,!1,n,c,d,e,l)}generateCacheRecord(e,t,r,n,o,i,a){let s,l;let c=t.getPreferredCache();if(!c)throw es(H);let u=e5(o);e.id_token&&o&&(s=ev(this.homeAccountIdentifier,c,e.id_token,this.clientId,u||""),l=n9(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o,e.client_info,c,u,a,void 0,this.logger));let d=null;if(e.access_token){let o=e.scope?eZ.fromString(e.scope):new eZ(n.scopes||[]),a=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,s=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,l=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,f=r+a;d=eb(this.homeAccountIdentifier,c,e.access_token,this.clientId,u||t.tenant||"",o.printScopes(),f,f+s,this.cryptoObj.base64Decode,l&&l>0?r+l:void 0,e.token_type,i,e.key_id,n.claims,n.requestedClaimsHash)}let f=null;if(e.refresh_token){let t;e.refresh_token_expires_in&&(t=r+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)),f=ey(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,i,t)}let h=null;return e.foci&&(h={clientId:this.clientId,environment:c,familyId:e.foci}),{account:l,idToken:s,accessToken:d,refreshToken:f,appMetadata:h}}static async generateAuthenticationResult(e,t,r,n,o,i,a,s,l){let c,d,f=u.YM.EMPTY_STRING,h=[],p=null,m=u.YM.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType!==u.IO.POP||o.popKid)f=r.accessToken.secret;else{let t=new n6(e),{secret:n,keyId:i}=r.accessToken;if(!i)throw es(J);f=await t.signPopToken(n,i,o)}h=eZ.fromString(r.accessToken.target).asArray(),p=new Date(1e3*Number(r.accessToken.expiresOn)),c=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),r.accessToken.refreshOn&&(d=new Date(1e3*Number(r.accessToken.refreshOn)))}r.appMetadata&&(m=r.appMetadata.familyId===u.hB?u.hB:"");let g=i?.oid||i?.sub||"",v=i?.tid||"";s?.spa_accountid&&r.account&&(r.account.nativeAccountId=s?.spa_accountid);let b=r.account?e2(r.account.getAccountInfo(),void 0,i,r.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:g,tenantId:v,scopes:h,account:b,idToken:r?.idToken?.secret||"",idTokenClaims:i||{},accessToken:f,fromCache:n,expiresOn:p,extExpiresOn:c,refreshOn:d,correlationId:o.correlationId,requestId:l||u.YM.EMPTY_STRING,familyId:m,tokenType:r.accessToken?.tokenType||u.YM.EMPTY_STRING,state:a?a.userRequestState:u.YM.EMPTY_STRING,cloudGraphHostName:r.account?.cloudGraphHostName||u.YM.EMPTY_STRING,msGraphHost:r.account?.msGraphHost||u.YM.EMPTY_STRING,code:s?.spa_code,fromNativeBroker:!1}}}function n9(e,t,r,n,o,i,a,s,l,c,u){u?.verbose("setCachedAccount called");let d=e.getAccountKeys().find(e=>e.startsWith(r)),f=null;d&&(f=e.getAccount(d));let h=f||e6.createAccount({homeAccountId:r,idTokenClaims:o,clientInfo:i,environment:a,cloudGraphHostName:l?.cloud_graph_host_name,msGraphHost:l?.msgraph_host,nativeAccountId:c},t,n),p=h.tenantProfiles||[],m=s||h.realm;if(m&&!p.find(e=>e.tenantId===m)){let e=e1(r,h.localAccountId,m,o);p.push(e)}return h.tenantProfiles=p,h}async function n7(e,t,r){return"string"==typeof e?e:e({clientId:t,tokenEndpoint:r})}class oe extends n3{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async getAuthCodeUrl(e){this.performanceClient?.addQueueMeasurement(tS.GetAuthCodeUrl,e.correlationId);let t=await nm(this.createAuthCodeUrlQueryString.bind(this),tS.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return e9.appendQueryString(this.authority.authorizationEndpoint,t)}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(tS.AuthClientAcquireToken,e.correlationId),!e.code)throw es(x);let r=eh(),n=await nm(this.executeTokenRequest.bind(this),tS.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=n.headers?.[u.OK.X_MS_REQUEST_ID],i=new n8(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return i.validateTokenResponse(n.body),nm(i.handleServerTokenResponse.bind(i),tS.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,r,e,t,void 0,void 0,void 0,o)}handleFragmentResponse(e,t){if(new n8(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw es(Y);return e}getLogoutUri(e){if(!e)throw eX(eN);let t=this.createLogoutUrlQueryString(e);return e9.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){let r;this.performanceClient?.addQueueMeasurement(tS.AuthClientExecuteTokenRequest,t.correlationId);let n=this.createTokenQueryParameters(t),o=e9.appendQueryString(e.tokenEndpoint,n),i=await nm(this.createTokenRequestBody.bind(this),tS.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);if(t.clientInfo)try{let e=eQ(t.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${e.uid}${u.LR.CLIENT_INFO_SEPARATOR}${e.utid}`,type:nI.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}let a=this.createTokenRequestHeaders(r||t.ccsCredential),s={clientId:t.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return nm(this.executePostToTokenEndpoint.bind(this),tS.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(o,i,a,s,t.correlationId,tS.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){let t;this.performanceClient?.addQueueMeasurement(tS.AuthClientCreateTokenRequestBody,e.correlationId);let r=new n1(e.correlationId,this.performanceClient);if(r.addClientId(e.embeddedClientId||e.tokenBodyParameters?.[nV]||this.config.authOptions.clientId),this.includeRedirectUri?r.addRedirectUri(e.redirectUri):n0.validateRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,this.oidcDefaultScopes),r.addAuthorizationCode(e.code),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!ty(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&r.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let t=this.config.clientCredentials.clientAssertion;r.addClientAssertion(await n7(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(t.assertionType)}if(r.addGrantType(u.$x.AUTHORIZATION_CODE_GRANT),r.addClientInfo(),e.authenticationScheme===u.IO.POP){let t;let n=new n6(this.cryptoUtils,this.performanceClient);t=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await nm(n.generateCnf.bind(n),tS.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(t)}else if(e.authenticationScheme===u.IO.SSH){if(e.sshJwk)r.addSshJwk(e.sshJwk);else throw eX(eU)}if((!eY.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{let r=eQ(e.clientInfo,this.cryptoUtils.base64Decode);t={credential:`${r.uid}${u.LR.CLIENT_INFO_SEPARATOR}${r.utid}`,type:nI.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else t=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&t)switch(t.type){case nI.HOME_ACCOUNT_ID:try{let e=eJ(t.credential);r.addCcsOid(e)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case nI.UPN:r.addCcsUpn(t.credential)}return e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[nZ]||r.addExtraQueryParameters({[nZ]:"1"}),r.createQueryString()}async createAuthCodeUrlQueryString(e){let t=e.correlationId||this.config.cryptoInterface.createNewGuid();this.performanceClient?.addQueueMeasurement(tS.AuthClientCreateQueryString,t);let r=new n1(t,this.performanceClient);r.addClientId(e.embeddedClientId||e.extraQueryParameters?.[nV]||this.config.authOptions.clientId);let n=[...e.scopes||[],...e.extraScopesToConsent||[]];if(r.addScopes(n,!0,this.oidcDefaultScopes),r.addRedirectUri(e.redirectUri),r.addCorrelationId(t),r.addResponseMode(e.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),ty(this.config)||r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&r.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&r.addPrompt(e.prompt),e.domainHint&&(r.addDomainHint(e.domainHint),this.performanceClient?.addFields({domainHintFromRequest:!0},t)),this.performanceClient?.addFields({prompt:e.prompt},t),e.prompt!==u._M.SELECT_ACCOUNT){if(e.sid&&e.prompt===u._M.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(e.sid),this.performanceClient?.addFields({sidFromRequest:!0},t);else if(e.account){let n=this.extractAccountSid(e.account),o=this.extractLoginHint(e.account);if(o&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),o=null),o){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(o),this.performanceClient?.addFields({loginHintFromClaim:!0},t);try{let t=eJ(e.account.homeAccountId);r.addCcsOid(t)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(n&&e.prompt===u._M.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(n),this.performanceClient?.addFields({sidFromClaim:!0},t);try{let t=eJ(e.account.homeAccountId);r.addCcsOid(t)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint),this.performanceClient?.addFields({loginHintFromRequest:!0},t);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(e.account.username),this.performanceClient?.addFields({loginHintFromUpn:!0},t);try{let t=eJ(e.account.homeAccountId);r.addCcsOid(t)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint),this.performanceClient?.addFields({loginHintFromRequest:!0},t))}else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&r.addNonce(e.nonce),e.state&&r.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),this.addExtraQueryParams(e,r),e.platformBroker&&(r.addNativeBroker(),e.authenticationScheme===u.IO.POP)){let t;let n=new n6(this.cryptoUtils);t=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await nm(n.generateCnf.bind(n),tS.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(t)}return r.createQueryString()}createLogoutUrlQueryString(e){let t=new n1(e.correlationId,this.performanceClient);return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){return e.idTokenClaims?.sid||null}extractLoginHint(e){return e.idTokenClaims?.login_hint||null}}class ot{constructor(e,t){this.cacheOutcome=u.Rv.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||u.YM.EMPTY_STRING,this.wrapperVer=e.wrapperVer||u.YM.EMPTY_STRING,this.telemetryCacheKey=u.gT.CACHE_KEY+u.LR.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){let e=`${this.apiId}${u.gT.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r?.length&&t.push(`broker_error=${r}`);let n=t.join(u.gT.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(u.gT.VALUE_SEPARATOR);return[u.gT.SCHEMA_VERSION,o,n].join(u.gT.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){let e=this.getLastRequests(),t=ot.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(u.gT.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(u.gT.VALUE_SEPARATOR),o=e.errors.length,i=t<o?u.gT.OVERFLOW_TRUE:u.gT.OVERFLOW_FALSE,a=[o,i].join(u.gT.VALUE_SEPARATOR);return[u.gT.SCHEMA_VERSION,e.cacheHits,r,n,a].join(u.gT.CATEGORY_SEPARATOR)}cacheFailedRequest(e){let t=this.getLastRequests();t.errors.length>=u.gT.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof p.lR?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(u.gT.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){let e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){let e=this.getLastRequests(),t=ot.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{let r={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}}static maxErrorsToSend(e){let t;let r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){let o=e.failedRequests[2*t]||u.YM.EMPTY_STRING,i=e.failedRequests[2*t+1]||u.YM.EMPTY_STRING,a=e.errors[t]||u.YM.EMPTY_STRING;if((n+=o.toString().length+i.toString().length+a.length+3)<u.gT.MAX_LAST_HEADER_BYTES)r+=1;else break}return r}getRegionDiscoveryFields(){let e=[];return e.push(this.regionUsed||u.YM.EMPTY_STRING),e.push(this.regionSource||u.YM.EMPTY_STRING),e.push(this.regionOutcome||u.YM.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){let t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){let e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return function(e){let{skus:t,libraryName:r,libraryVersion:n,extensionName:o,extensionVersion:i}=e,a=new Map([[0,[r,n]],[2,[o,i]]]),s=[];if(t?.length){if((s=t.split(",")).length<4)return t}else s=Array.from({length:4},()=>"|");return a.forEach((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&function(e){let{skuArr:t,index:r,skuName:n,skuVersion:o}=e;r>=t.length||(t[r]=[n,o].join("|"))}({skuArr:s,index:t,skuName:e[0],skuVersion:e[1]})}),s.join(",")}(e)}}class or{constructor(e,t,r,n,o,i,a,s,l){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.nativeMessageHandler=s,this.correlationId=l||rB(),this.logger=n.clone(tA.Q1.MSAL_SKU,ne,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e){if(e){e6.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(e6.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(e){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch(e){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");let t=e||this.config.auth.redirectUri;return e9.getAbsoluteUrl(t,r3())}initializeServerTelemetryManager(e,t){return this.logger.verbose("initializeServerTelemetryManager called"),new ot({clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]},this.browserStorage)}async getDiscoveredAuthority(e){let{account:t}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(tS.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);let n={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.requestAuthority||this.config.auth.authority,i=r?.length?"true"===r:this.config.auth.instanceAware,a=t&&i?this.config.auth.authority.replace(e9.getDomainFromUrl(o),t.environment):o,s=nv.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),l=await nm(n2,tS.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,n,this.logger,this.correlationId,this.performanceClient);if(t&&!l.isAlias(t.environment))throw eX(eV);return l}}async function on(e,t,r){e.addQueueMeasurement(tS.GeneratePkceCodes,r);let n=np(oo,tS.GenerateCodeVerifier,t,e,r)(e,t,r),o=await nm(oi,tS.GenerateCodeChallengeFromVerifier,t,e,r)(n,e,t,r);return{verifier:n,challenge:o}}function oo(e,t,r){try{let n=new Uint8Array(32);return np(rz,tS.GetRandomValues,t,e,r)(n),rC(n)}catch(e){throw rv(tO)}}async function oi(e,t,r,n){t.addQueueMeasurement(tS.GenerateCodeChallengeFromVerifier,n);try{let o=await nm(rL,tS.Sha256Digest,r,t,n)(e,t,n);return rC(new Uint8Array(o))}catch(e){throw rv(tO)}}async function oa(e,t,r,n){r.addQueueMeasurement(tS.InitializeBaseRequest,e.correlationId);let o=e.authority||t.auth.authority,i=[...e&&e.scopes||[]],a={...e,correlationId:e.correlationId,authority:o,scopes:i};if(a.authenticationScheme){if(a.authenticationScheme===u.IO.SSH){if(!e.sshJwk)throw eX(eU);if(!e.sshKid)throw eX(eH)}n.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}else a.authenticationScheme=u.IO.BEARER,n.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!eY.isEmptyObj(e.claims)&&(a.requestedClaimsHash=await rX(e.claims)),a}async function os(e,t,r,n,o){n.addQueueMeasurement(tS.InitializeSilentRequest,e.correlationId);let i=await nm(oa,tS.InitializeBaseRequest,o,n,e.correlationId)(e,r,n,o);return{...e,...i,account:t,forceRefresh:e.forceRefresh||!1}}class ol extends or{async initializeAuthorizationCodeRequest(e,t){this.performanceClient.addQueueMeasurement(tS.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);let r=t||await nm(on,tS.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),n={...e,redirectUri:e.redirectUri,code:u.YM.EMPTY_STRING,codeVerifier:r.verifier};return e.codeChallenge=r.challenge,e.codeChallengeMethod=u.YM.S256_CODE_CHALLENGE_METHOD,n}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);let t={correlationId:this.correlationId||rB(),...e};if(e){if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){let r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set")}else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=e9.getAbsoluteUrl(e.postLogoutRedirectUri,r3())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=e9.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,r3())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=e9.getAbsoluteUrl(r3(),r3())),t}getLogoutHintFromIdTokenClaims(e){let t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){return this.performanceClient.addQueueMeasurement(tS.StandardInteractionClientCreateAuthCodeClient,this.correlationId),new oe(await nm(this.getClientConfiguration.bind(this),tS.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e),this.performanceClient)}async getClientConfiguration(e){let{serverTelemetryManager:t,requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:o,account:i}=e;this.performanceClient.addQueueMeasurement(tS.StandardInteractionClientGetClientConfiguration,this.correlationId);let a=await nm(this.getDiscoveredAuthority.bind(this),tS.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:o,account:i}),s=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:tA.Q1.MSAL_SKU,version:ne,cpu:u.YM.EMPTY_STRING,os:u.YM.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(tS.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);let r=this.getRedirectUri(e.redirectUri),n=nC.setRequestState(this.browserCrypto,e&&e.state||u.YM.EMPTY_STRING,{interactionType:t}),o={...await nm(oa,tS.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:n,nonce:e.nonce||rB(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return o;let i=e.account||this.browserStorage.getActiveAccount();return i&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${i.homeAccountId}`,this.correlationId),o.account=i),o}}var oc=r(465488);let ou="user_switch",od={[ou]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class of extends p.lR{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,of.prototype),this.name="NativeAuthError",this.ext=r}}function oh(e){return!!e.ext&&!!e.ext.status&&("PERSISTENT_ERROR"===e.ext.status||"DISABLED"===e.ext.status)||!!e.ext&&!!e.ext.error&&-0x7ffb78ff===e.ext.error||"ContentError"===e.errorCode}function op(e,t,r){if(r&&r.status)switch(r.status){case"ACCOUNT_UNAVAILABLE":return(0,nw.IE)(nS.B);case"USER_INTERACTION_REQUIRED":return new nw.CB(e,t);case"USER_CANCEL":return rv(tH);case"NO_NETWORK":return rv(t5)}return new of(e,od[e]||t,r)}class om extends n3{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(tS.SilentFlowClientAcquireCachedToken,e.correlationId);let t=u.Rv.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!eY.isEmptyObj(e.claims))throw this.setCacheOutcome(u.Rv.FORCE_REFRESH_OR_CLAIMS,e.correlationId),es(G);if(!e.account)throw es(B);let r=e.account.tenantId||function(e){let t=new e9(e).getUrlComponents(),r=t.PathSegments.slice(-1)[0]?.toLowerCase();switch(r){case u.v2.COMMON:case u.v2.ORGANIZATIONS:case u.v2.CONSUMERS:return;default:return r}}(e.authority),n=this.cacheManager.getTokenKeys(),o=this.cacheManager.getAccessToken(e.account,e,n,r,this.performanceClient,e.correlationId);if(o){if(em(o.cachedAt)||ep(o.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(u.Rv.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),es(G);o.refreshOn&&ep(o.refreshOn,0)&&(t=u.Rv.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(u.Rv.NO_CACHED_ACCESS_TOKEN,e.correlationId),es(G);let i=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account),accessToken:o,idToken:this.cacheManager.getIdToken(e.account,n,r,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(i)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await nm(this.generateResultFromCacheRecord.bind(this),tS.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==u.Rv.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){let r;if(this.performanceClient?.addQueueMeasurement(tS.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId),e.idToken&&(r=ed(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){let e=r?.auth_time;if(!e)throw es(A);ef(e,t.maxAge)}return n8.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class og extends ol{async acquireToken(e){this.performanceClient.addQueueMeasurement(tS.SilentCacheClientAcquireToken,e.correlationId);let t=this.initializeServerTelemetryManager(tA.sA.acquireTokenSilent_silentFlow),r=new om(await nm(this.getClientConfiguration.bind(this),tS.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),this.performanceClient);this.logger.verbose("Silent auth client created");try{let t=(await nm(r.acquireCachedToken.bind(r),tS.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(e){throw e instanceof rg&&e.errorCode===t7&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),e}}logout(e){this.logger.verbose("logoutRedirect called");let t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}}class ov extends or{constructor(e,t,r,n,o,i,a,s,l,c,u,d){super(e,t,r,n,o,i,s,l,d),this.apiId=a,this.accountId=c,this.nativeMessageHandler=l,this.nativeStorageManager=u,this.silentCacheClient=new og(e,this.nativeStorageManager,r,n,o,i,s,l,d);let f=this.nativeMessageHandler.getExtensionId()===tA.JD.PREFERRED_EXTENSION_ID?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=ot.makeExtraSkuString({libraryName:tA.Q1.MSAL_SKU,libraryVersion:ne,extensionName:f,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,"x-client-xtra-sku":this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(tS.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");let t=this.performanceClient.startMeasurement(tS.NativeInteractionClientAcquireToken,e.correlationId),r=eh(),n=this.initializeServerTelemetryManager(this.apiId);try{let o=await this.initializeNativeRequest(e);try{let e=await this.acquireTokensFromCache(this.accountId,o);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(e){this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}let{...i}=o,a={method:tA.Ct.GetToken,request:i},s=await this.nativeMessageHandler.sendMessage(a),l=this.validateNativeResponse(s);return await this.handleNativeResponse(l,o,r).then(e=>(t.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),n.clearNativeBrokerErrorCode(),e)).catch(e=>{throw t.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e})}catch(e){throw e instanceof of&&n.setNativeBrokerErrorCode(e.errorCode),e}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:eZ.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),es(q);let r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!r)throw es(q);try{let e=this.createSilentCacheRequest(t,r),n=await this.silentCacheClient.acquireToken(e),o={...r,idTokenClaims:n?.idTokenClaims,idToken:n?.idToken};return{...n,account:o}}catch(e){throw e}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");let{...r}=e;delete r.onRedirectNavigate;let n=await this.initializeNativeRequest(r),o={method:tA.Ct.GetToken,request:n};try{let e=await this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(e)}catch(e){if(e instanceof of&&(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(e.errorCode),oh(e)))throw e}this.browserStorage.setTemporaryCache(tA._p.NATIVE_REQUEST,JSON.stringify(n),!0);let i={apiId:tA.sA.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(a,i)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;let r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;let{prompt:n,...o}=r;n&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(tA._p.NATIVE_REQUEST));let i={method:tA.Ct.GetToken,request:o},a=eh();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");let e=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(e);let t=this.handleNativeResponse(e,o,a);this.browserStorage.setInteractionInProgress(!1);let r=await t;return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),r}catch(e){throw this.browserStorage.setInteractionInProgress(!1),e}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");let n=ed(e.id_token,rE),o=this.createHomeAccountIdentifier(e,n);if(o!==this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId})?.homeAccountId&&e.account.id!==t.accountId)throw op(ou);let i=await this.getDiscoveredAuthority({requestAuthority:t.authority}),a=n9(this.browserStorage,i,o,rE,n,e.client_info,void 0,n.tid,void 0,e.account.id,this.logger),s=await this.generateAuthenticationResult(e,t,n,a,i.canonicalAuthority,r);return await this.cacheAccount(a),await this.cacheNativeTokens(e,t,o,n,e.access_token,s.tenantId,r),s}createHomeAccountIdentifier(e,t){return e6.generateHomeAccountId(e.client_info||u.YM.EMPTY_STRING,e3.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?eZ.fromString(e.scope):eZ.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType!==u.IO.POP||!t.signPopToken)return e.access_token;{if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;let r=new n6(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw es(J);return r.signPopToken(e.access_token,t.keyId,n)}}async generateAuthenticationResult(e,t,r,n,o,i){let a=this.addTelemetryFromNativeResponse(e),s=e.scope?eZ.fromString(e.scope):eZ.fromString(t.scope),l=e.account.properties||{},c=l.UID||r.oid||r.sub||u.YM.EMPTY_STRING,d=l.TenantId||r.tid||u.YM.EMPTY_STRING,f=e2(n.getAccountInfo(),void 0,r,e.id_token);f.nativeAccountId!==e.account.id&&(f.nativeAccountId=e.account.id);let h=await this.generatePopAccessToken(e,t),p=t.tokenType===u.IO.POP?u.IO.POP:u.IO.BEARER;return{authority:o,uniqueId:c,tenantId:d,scopes:s.asArray(),account:f,idToken:e.id_token,idTokenClaims:r,accessToken:h,fromCache:!!a&&this.isResponseFromCache(a),expiresOn:new Date(1e3*Number(i+e.expires_in)),tokenType:p,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e).catch(e=>{this.logger.error(`Error occurred while removing account context from browser storage. ${e}`)})}cacheNativeTokens(e,t,r,n,o,i,a){let s=ev(r,t.authority,e.id_token||"",t.clientId,n.tid||""),l=t.tokenType===u.IO.POP?u.YM.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,c=this.generateScopes(e,t),d=eb(r,t.authority,o,t.clientId,n.tid||i,c.printScopes(),a+l,0,rE,void 0,t.tokenType,void 0,t.keyId);return this.nativeStorageManager.saveCacheRecord({idToken:s,accessToken:d},this.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){let t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw(0,p.pz)(oc.W,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");let t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});let r=new e9(t);r.validateAsUri();let{scopes:n,...o}=e,i=new eZ(n||[]);i.appendScopes(u.aZ);let a={...o,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:(()=>{switch(this.apiId){case tA.sA.ssoSilent:case tA.sA.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),u._M.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case u._M.NONE:case u._M.CONSENT:case u._M.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),rv(rc)}})(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(a.signPopToken&&e.popKid)throw rv(rd);if(this.handleExtraBrokerParams(a),a.extraParameters=a.extraParameters||{},a.extraParameters.telemetry=tA.JD.MATS_TELEMETRY,e.authenticationScheme===u.IO.POP){let t;let r={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},n=new n6(this.browserCrypto);if(a.keyId)t=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:a.keyId})),a.signPopToken=!1;else{let o=await nm(n.generateCnf.bind(n),tS.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(r,this.logger);t=o.reqCnfString,a.keyId=o.kid,a.signPopToken=!0}a.reqCnf=t}return this.addRequestSKUs(a),a}handleExtraBrokerParams(e){let t=e.extraParameters&&e.extraParameters.hasOwnProperty(nQ)&&e.extraParameters.hasOwnProperty(nJ)&&e.extraParameters.hasOwnProperty(nV);if(!e.embeddedClientId&&!t)return;let r="",n=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[nJ],r=e.extraParameters[nV]),e.extraParameters={child_client_id:r,child_redirect_uri:n},this.performanceClient?.addFields({embeddedClientId:r,embeddedRedirectUri:n},e.correlationId)}}class ob{constructor(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(tS.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");let t={channel:tA.JD.CHANNEL_ID,extensionId:this.extensionId,responseId:rB(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise((e,r)=>{this.resolvers.set(t.responseId,{resolve:e,reject:r})})}static async createProvider(e,t,r){e.trace("NativeMessageHandler - createProvider called.");try{let n=new ob(e,t,r,tA.JD.PREFERRED_EXTENSION_ID);return await n.sendHandshakeRequest(),n}catch(o){let n=new ob(e,t,r);return await n.sendHandshakeRequest(),n}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);let e={channel:tA.JD.CHANNEL_ID,extensionId:this.extensionId,responseId:rB(),body:{method:tA.Ct.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(rv(ri)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;let t=e.data;if(t.channel&&t.channel===tA.JD.CHANNEL_ID&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===tA.Ct.HandshakeRequest){let e=this.handshakeResolvers.get(t.responseId);if(!e){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(rv(ra))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");let t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{let e=t.body.method;if(e===tA.Ct.Response){if(!r)return;let e=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(e)}`),"Success"!==e.status)r.reject(op(e.code,e.description,e.ext));else if(e.result)e.result.code&&e.result.description?r.reject(op(e.result.code,e.result.description,e.result.ext)):r.resolve(e.result);else throw(0,p.pz)(oc.W,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(e===tA.Ct.HandshakeResponse){if(!n){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${t}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(t):n&&n.reject(t)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isPlatformBrokerAvailable(e,t,r,n){if(t.trace("isPlatformBrokerAvailable called"),!e.system.allowPlatformBroker)return t.trace("isPlatformBrokerAvailable: allowPlatformBroker is not enabled, returning false"),!1;if(!r)return t.trace("isPlatformBrokerAvailable: Platform extension provider is not initialized, returning false"),!1;if(n)switch(n){case u.IO.BEARER:case u.IO.POP:t.trace("isPlatformBrokerAvailable: authenticationScheme is supported, returning true");break;default:return t.trace("isPlatformBrokerAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}class oy{constructor(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}async handleCodeResponse(e,t){let r;this.performanceClient.addQueueMeasurement(tS.HandleCodeResponse,t.correlationId);try{r=this.authModule.handleFragmentResponse(e,t.state)}catch(e){if(e instanceof n$&&e.subError===tH)throw rv(tH);throw e}return nm(this.handleCodeResponseFromServer.bind(this),tS.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t,r=!0){if(this.performanceClient.addQueueMeasurement(tS.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await nm(this.authModule.updateAuthority.bind(this.authModule),tS.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{let e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await nm(this.authModule.acquireToken.bind(this.authModule),tS.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:nI.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:nI.UPN}:null}}function ow(e,t,r){let n=e8(e);if(!n){if(e4(e))throw r.error(`A ${t} is present in the iframe but it does not contain known properties. It's likely that the ${t} has been replaced by code running on the redirectUri page.`),r.errorPii(`The ${t} detected is: ${e}`),rv(tF);throw r.error(`The request has returned to the redirectUri but a ${t} is not present. It's likely that the ${t} has been removed or the page has been redirected by code running on the redirectUri page.`),rv(tM)}return n}class oS extends ol{constructor(e,t,r,n,o,i,a,s,l,c){super(e,t,r,n,o,i,a,l,c),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=s}acquireToken(e,t){try{let r={popupName:this.generatePopupName(e.scopes||u.aZ,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};if(this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r,t);return this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(e,r,t)}catch(e){return Promise.reject(e)}}logout(e){try{this.logger.verbose("logoutPopup called");let t=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},n=e&&e.authority,o=e&&e.mainWindowRedirectUri;if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,n,o);return this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(t,r,n,o)}catch(e){return Promise.reject(e)}}async acquireTokenPopupAsync(e,t,r){this.logger.verbose("acquireTokenPopupAsync called");let n=this.initializeServerTelemetryManager(tA.sA.acquireTokenPopup),o=await nm(this.initializeAuthorizationRequest.bind(this),tS.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,tA.X8.Popup);t.popup&&r9(o.authority);try{let i;let a=await nm(this.initializeAuthorizationCodeRequest.bind(this),tS.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(o,r),s=await nm(this.createAuthCodeClient.bind(this),tS.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:o.authority,requestAzureCloudOptions:o.azureCloudOptions,requestExtraQueryParameters:o.extraQueryParameters,account:o.account}),l=ob.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);l&&(i=this.performanceClient.startMeasurement(tS.FetchAccountIdWithNativeBroker,e.correlationId));let c=await s.getAuthCodeUrl({...o,platformBroker:l}),u=new oy(s,this.browserStorage,a,this.logger,this.performanceClient),d=this.initiateAuthRequest(c,t);this.eventHandler.emitEvent(nx.POPUP_OPENED,tA.X8.Popup,{popupWindow:d},null);let f=await this.monitorPopupForHash(d,t.popupWindowParent),h=np(ow,tS.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(f,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(nW.removeThrottle(this.browserStorage,this.config.auth.clientId,a),h.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),i&&i.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw rv(rs);let e=new ov(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tA.sA.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,h.accountId,this.nativeStorage,o.correlationId),{userRequestState:t}=nC.parseRequestState(this.browserCrypto,o.state);return await e.acquireToken({...o,state:t,prompt:void 0})}return await u.handleCodeResponse(h,o)}catch(e){throw t.popup?.close(),e instanceof p.lR&&(e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e)),e}}async logoutPopupAsync(e,t,r,n){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(nx.LOGOUT_START,tA.X8.Popup,e);let o=this.initializeServerTelemetryManager(tA.sA.logoutPopup);try{await this.clearCacheOnLogout(e.account);let i=await nm(this.createAuthCodeClient.bind(this),tS.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:o,requestAuthority:r,account:e.account||void 0});try{i.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&i.authority.protocolMode===f.OIDC){if(this.browserStorage.removeAccount(e.account?.homeAccountId),this.eventHandler.emitEvent(nx.LOGOUT_SUCCESS,tA.X8.Popup,e),n){let e={apiId:tA.sA.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=e9.getAbsoluteUrl(n,r3());await this.navigationClient.navigateInternal(t,e)}t.popup?.close();return}}let a=i.getLogoutUri(e);this.eventHandler.emitEvent(nx.LOGOUT_SUCCESS,tA.X8.Popup,e);let s=this.openPopup(a,t);if(this.eventHandler.emitEvent(nx.POPUP_OPENED,tA.X8.Popup,{popupWindow:s},null),await this.monitorPopupForHash(s,t.popupWindowParent).catch(()=>{}),n){let e={apiId:tA.sA.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=e9.getAbsoluteUrl(n,r3());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${t}`),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(e){throw t.popup?.close(),e instanceof p.lR&&(e.setCorrelationId(this.correlationId),o.cacheFailedRequest(e)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(nx.LOGOUT_FAILURE,tA.X8.Popup,null,e),this.eventHandler.emitEvent(nx.LOGOUT_END,tA.X8.Popup),e}this.eventHandler.emitEvent(nx.LOGOUT_END,tA.X8.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),rv(tx)}monitorPopupForHash(e,t){return new Promise((t,r)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");let n=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(n),r(rv(tH));return}let o="";try{o=e.location.href}catch(e){}if(!o||"about:blank"===o)return;clearInterval(n);let i="",a=this.config.auth.OIDCOptions.serverResponseType;e&&(i=a===u.zL.QUERY?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(i)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,t)),!r)throw rv(tU);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.setInteractionInProgress(!1),rv(tB)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:r,popupWindowParent:n}){let o=n.screenLeft?n.screenLeft:n.screenX,i=n.screenTop?n.screenTop:n.screenY,a=n.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=n.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=r.popupSize?.width,c=r.popupSize?.height,u=r.popupPosition?.top,d=r.popupPosition?.left;return(!l||l<0||l>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),l=tA.Q1.POPUP_WIDTH),(!c||c<0||c>s)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),c=tA.Q1.POPUP_HEIGHT),(!u||u<0||u>s)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,s/2-tA.Q1.POPUP_HEIGHT/2+i)),(!d||d<0||d>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),d=Math.max(0,a/2-tA.Q1.POPUP_WIDTH/2+o)),n.open(e,t,`width=${l}, height=${c}, top=${u}, left=${d}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(tA.X8.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${tA.Q1.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){let t=e.account&&e.account.homeAccountId;return`${tA.Q1.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}class oC{constructor(e,t,r,n,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=o}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(tA._p.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(tA._p.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);let r={apiId:tA.sA.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if("function"==typeof t.onRedirectNavigate){if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1!==t.onRedirectNavigate(e)){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await t.navigationClient.navigateExternal(e,r);return}this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await t.navigationClient.navigateExternal(e,r);return}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),rv(tx)}async handleCodeResponse(e,t){let r;this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);let n=this.browserStorage.generateStateKey(t),o=this.browserStorage.getTemporaryCache(n);if(!o)throw es(E,"Cached State");try{r=this.authModule.handleFragmentResponse(e,o)}catch(e){if(e instanceof n$&&e.subError===tH)throw rv(tH);throw e}let i=this.browserStorage.generateNonceKey(o),a=this.browserStorage.getTemporaryCache(i);if(this.authCodeRequest.code=r.code,r.cloud_instance_host_name&&await nm(this.authModule.updateAuthority.bind(this.authModule),tS.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(r.cloud_instance_host_name,this.authCodeRequest.correlationId),r.nonce=a||void 0,r.state=o,r.client_info)this.authCodeRequest.clientInfo=r.client_info;else{let e=this.checkCcsCredentials();e&&(this.authCodeRequest.ccsCredential=e)}let s=await this.authModule.acquireToken(this.authCodeRequest,r);return this.browserStorage.cleanRequestByState(t),s}checkCcsCredentials(){let e=this.browserStorage.getTemporaryCache(tA._p.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}class oI extends ol{constructor(e,t,r,n,o,i,a,s,l,c){super(e,t,r,n,o,i,a,l,c),this.nativeStorage=s}async acquireToken(e){let t=await nm(this.initializeAuthorizationRequest.bind(this),tS.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,tA.X8.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);let r=this.initializeServerTelemetryManager(tA.sA.acquireTokenRedirect),n=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(nx.RESTORE_FROM_BFCACHE,tA.X8.Redirect))};try{let o=await nm(this.initializeAuthorizationCodeRequest.bind(this),tS.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),i=await nm(this.createAuthCodeClient.bind(this),tS.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),a=new oC(i,this.browserStorage,o,this.logger,this.performanceClient),s=await i.getAuthCodeUrl({...t,platformBroker:ob.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),l=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${l}`),window.addEventListener("pageshow",n),await a.initiateAuthRequest(s,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:l,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(e){throw e instanceof p.lR&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),window.removeEventListener("pageshow",n),this.browserStorage.cleanRequestByState(t.state),e}}async handleRedirectPromise(e="",t){let r=this.initializeServerTelemetryManager(tA.sA.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;let[n,o]=this.getRedirectResponse(e||"");if(!n)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(tA.X8.Redirect),"back_forward"!==function(){if("undefined"==typeof window||void 0===window.performance||"function"!=typeof window.performance.getEntriesByType)return;let e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return t?.type}()?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;let i=this.browserStorage.getTemporaryCache(tA._p.ORIGIN_URI,!0)||u.YM.EMPTY_STRING,a=e9.removeHashFromUrl(i),s=e9.removeHashFromUrl(window.location.href);if(a===s&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),i.indexOf("#")>-1&&function(e){let t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(i),await this.handleResponse(n,r);if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(n,r);if(!r2()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(tA._p.URL_HASH,o,!0);let e={apiId:tA.sA.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},t=!0;if(i&&"null"!==i)this.logger.verbose(`Navigating to loginRequestUrl: ${i}`),t=await this.navigationClient.navigateInternal(i,e);else{let r=function(){let e=new e9(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}();this.browserStorage.setTemporaryCache(tA._p.ORIGIN_URI,r,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),t=await this.navigationClient.navigateInternal(r,e)}if(!t)return await this.handleResponse(n,r)}return null}catch(e){throw e instanceof p.lR&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),this.browserStorage.cleanRequestByInteractionType(tA.X8.Redirect),e}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===u.zL.QUERY?window.location.search:window.location.hash);let r=e8(t);if(r){var n;try{!function(e,t,r){if(!e.state)throw rv(tN);let n=nR(t,e.state);if(!n)throw rv(tL);if(n.interactionType!==r)throw rv(tz)}(r,this.browserCrypto,tA.X8.Redirect)}catch(e){return e instanceof p.lR&&this.logger.error(`Interaction type validation failed due to ${e.errorCode}: ${e.errorMessage}`),[null,""]}return(n=window).location.hash="","function"==typeof n.history.replaceState&&n.history.replaceState(null,"",`${n.location.origin}${n.location.pathname}${n.location.search}`),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}let o=this.browserStorage.getTemporaryCache(tA._p.URL_HASH,!0);return(this.browserStorage.removeItem(this.browserStorage.generateCacheKey(tA._p.URL_HASH)),o&&(r=e8(o)))?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,o]):[null,""]}async handleResponse(e,t){let r=e.state;if(!r)throw rv(tN);let n=this.browserStorage.getCachedRequest(r);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw rv(rs);let t=new ov(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tA.sA.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,n.correlationId),{userRequestState:o}=nC.parseRequestState(this.browserCrypto,r);return t.acquireToken({...n,state:o,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(r)})}let o=this.browserStorage.getCachedAuthority(r);if(!o)throw rv(tJ);let i=await nm(this.createAuthCodeClient.bind(this),tS.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:o});return nW.removeThrottle(this.browserStorage,this.config.auth.clientId,n),new oC(i,this.browserStorage,n,this.logger,this.performanceClient).handleCodeResponse(e,r)}async logout(e){this.logger.verbose("logoutRedirect called");let t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(tA.sA.logout);try{this.eventHandler.emitEvent(nx.LOGOUT_START,tA.X8.Redirect,e),await this.clearCacheOnLogout(t.account);let n={apiId:tA.sA.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=await nm(this.createAuthCodeClient.bind(this),tS.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(o.authority.protocolMode===f.OIDC)try{o.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId){this.browserStorage.removeAccount(t.account?.homeAccountId),this.eventHandler.emitEvent(nx.LOGOUT_SUCCESS,tA.X8.Redirect,t);return}}let i=o.getLogoutUri(t);if(this.eventHandler.emitEvent(nx.LOGOUT_SUCCESS,tA.X8.Redirect,t),e&&"function"==typeof e.onRedirectNavigate){let t=e.onRedirectNavigate(i);if(!1!==t){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(i,n);return}this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(i,n);return}}catch(e){throw e instanceof p.lR&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),this.eventHandler.emitEvent(nx.LOGOUT_FAILURE,tA.X8.Redirect,null,e),this.eventHandler.emitEvent(nx.LOGOUT_END,tA.X8.Redirect),e}this.eventHandler.emitEvent(nx.LOGOUT_END,tA.X8.Redirect)}getRedirectStartPage(e){let t=e||window.location.href;return e9.getAbsoluteUrl(t,r3())}}async function ok(e,t,r,n,o){if(t.addQueueMeasurement(tS.SilentHandlerInitiateAuthRequest,n),!e)throw r.info("Navigate url is empty"),rv(tx);return o?nm(o_,tS.SilentHandlerLoadFrame,r,t,n)(e,o,t,n):np(oA,tS.SilentHandlerLoadFrameSync,r,t,n)(e)}async function oE(e,t,r,n,o,i,a){return n.addQueueMeasurement(tS.SilentHandlerMonitorIframeForHash,i),new Promise((n,i)=>{t<1e4&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (10000ms). This may result in timeouts.`);let s=window.setTimeout(()=>{window.clearInterval(l),i(rv(tj))},t),l=window.setInterval(()=>{let t="",r=e.contentWindow;try{t=r?r.location.href:""}catch(e){}if(!t||"about:blank"===t)return;let o="";r&&(o=a===u.zL.QUERY?r.location.search:r.location.hash),window.clearTimeout(s),window.clearInterval(l),n(o)},r)}).finally(()=>{np(oP,tS.RemoveHiddenIframe,o,n,i)(e)})}function o_(e,t,r,n){return r.addQueueMeasurement(tS.SilentHandlerLoadFrame,n),new Promise((r,n)=>{let o=oT();window.setTimeout(()=>{if(!o){n("Unable to load iframe");return}o.src=e,r(o)},t)})}function oA(e){let t=oT();return t.src=e,t}function oT(){let e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function oP(e){document.body===e.parentNode&&document.body.removeChild(e)}class oO extends ol{constructor(e,t,r,n,o,i,a,s,l,c,u){super(e,t,r,n,o,i,s,c,u),this.apiId=a,this.nativeStorage=l}async acquireToken(e){let t;this.performanceClient.addQueueMeasurement(tS.SilentIframeClientAcquireToken,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");let r={...e};r.prompt?r.prompt!==u._M.NONE&&r.prompt!==u._M.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${r.prompt} with ${u._M.NONE}`),r.prompt=u._M.NONE):r.prompt=u._M.NONE;let n=await nm(this.initializeAuthorizationRequest.bind(this),tS.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(r,tA.X8.Silent);r9(n.authority);let o=this.initializeServerTelemetryManager(this.apiId);try{return t=await nm(this.createAuthCodeClient.bind(this),tS.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:o,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),await nm(this.silentTokenHelper.bind(this),tS.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(t,n)}catch(i){if(i instanceof p.lR&&(i.setCorrelationId(this.correlationId),o.cacheFailedRequest(i)),!t||!(i instanceof p.lR)||i.errorCode!==tA.Q1.INVALID_GRANT_ERROR)throw i;this.performanceClient.addFields({retryError:i.errorCode},this.correlationId);let n=await nm(this.initializeAuthorizationRequest.bind(this),tS.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(r,tA.X8.Silent);return await nm(this.silentTokenHelper.bind(this),tS.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(t,n)}}logout(){return Promise.reject(rv(tK))}async silentTokenHelper(e,t){let r=t.correlationId;this.performanceClient.addQueueMeasurement(tS.SilentIframeClientTokenHelper,r);let n=await nm(this.initializeAuthorizationCodeRequest.bind(this),tS.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,r)(t),o=await nm(e.getAuthCodeUrl.bind(e),tS.GetAuthCodeUrl,this.logger,this.performanceClient,r)({...t,platformBroker:ob.isPlatformBrokerAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),i=new oy(e,this.browserStorage,n,this.logger,this.performanceClient),a=await nm(ok,tS.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(o,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),s=this.config.auth.OIDCOptions.serverResponseType,l=await nm(oE,tS.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,s),c=np(ow,tS.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(l,s,this.logger);if(c.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw rv(rs);let e=new ov(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,c.accountId,this.browserStorage,r),{userRequestState:n}=nC.parseRequestState(this.browserCrypto,t.state);return nm(e.acquireToken.bind(e),tS.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,r)({...t,state:n,prompt:t.prompt||u._M.NONE})}return nm(i.handleCodeResponse.bind(i),tS.HandleCodeResponse,this.logger,this.performanceClient,r)(c,t)}}class oR extends n3{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(tS.RefreshTokenClientAcquireToken,e.correlationId);let t=eh(),r=await nm(this.executeTokenRequest.bind(this),tS.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),n=r.headers?.[u.OK.X_MS_REQUEST_ID],o=new n8(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(r.body),nm(o.handleServerTokenResponse.bind(o),tS.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,n)}async acquireTokenByRefreshToken(e){if(!e)throw eX(eM);if(this.performanceClient?.addQueueMeasurement(tS.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw es(B);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await nm(this.acquireTokenWithCachedRefreshToken.bind(this),tS.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(r){let e=r instanceof nw.CB&&r.errorCode===nS.oF,t=r instanceof n$&&r.errorCode===u.I.INVALID_GRANT_ERROR&&r.subError===u.I.CLIENT_MISMATCH_ERROR;if(e||t);else throw r}return nm(this.acquireTokenWithCachedRefreshToken.bind(this),tS.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(tS.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);let r=np(this.cacheManager.getRefreshToken.bind(this.cacheManager),tS.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!r)throw(0,nw.IE)(nS.oF);if(r.expiresOn&&ep(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),(0,nw.IE)(nS.AG);let n={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||u.IO.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:nI.HOME_ACCOUNT_ID}};try{return await nm(this.acquireToken.bind(this),tS.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(n)}catch(t){if(t instanceof nw.CB&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(r.expiresOn)},e.correlationId),t.subError===nS.j9)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");let e=eg(r);this.cacheManager.removeRefreshToken(e)}throw t}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(tS.RefreshTokenClientExecuteTokenRequest,e.correlationId);let r=this.createTokenQueryParameters(e),n=e9.appendQueryString(t.tokenEndpoint,r),o=await nm(this.createTokenRequestBody.bind(this),tS.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),i=this.createTokenRequestHeaders(e.ccsCredential),a={clientId:e.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return nm(this.executePostToTokenEndpoint.bind(this),tS.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(n,o,i,a,e.correlationId,tS.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(tS.RefreshTokenClientCreateTokenRequestBody,e.correlationId);let t=new n1(e.correlationId,this.performanceClient);if(t.addClientId(e.embeddedClientId||e.tokenBodyParameters?.[nV]||this.config.authOptions.clientId),e.redirectUri&&t.addRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),t.addGrantType(u.$x.REFRESH_TOKEN_GRANT),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!ty(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let r=this.config.clientCredentials.clientAssertion;t.addClientAssertion(await n7(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(r.assertionType)}if(e.authenticationScheme===u.IO.POP){let r;let n=new n6(this.cryptoUtils,this.performanceClient);r=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await nm(n.generateCnf.bind(n),tS.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(r)}else if(e.authenticationScheme===u.IO.SSH){if(e.sshJwk)t.addSshJwk(e.sshJwk);else throw eX(eU)}if((!eY.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case nI.HOME_ACCOUNT_ID:try{let r=eJ(e.ccsCredential.credential);t.addCcsOid(r)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case nI.UPN:t.addCcsUpn(e.ccsCredential.credential)}return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),t.createQueryString()}}class ox extends ol{async acquireToken(e){this.performanceClient.addQueueMeasurement(tS.SilentRefreshClientAcquireToken,e.correlationId);let t=await nm(oa,tS.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...t};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));let n=this.initializeServerTelemetryManager(tA.sA.acquireTokenSilent_silentFlow),o=await this.createRefreshTokenClient({serverTelemetryManager:n,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return nm(o.acquireTokenByRefreshToken.bind(o),tS.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(r).catch(e=>{throw e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e),e})}logout(){return Promise.reject(rv(tK))}async createRefreshTokenClient(e){return new oR(await nm(this.getClientConfiguration.bind(this),tS.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),this.performanceClient)}}class oM{constructor(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}async loadExternalTokens(e,t,r){if(!this.isBrowserEnvironment)throw rv(t2);let n=e.correlationId||rB(),o=t.id_token?ed(t.id_token,rE):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new nv(nv.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||rB()):void 0,s=await this.loadAccount(e,r.clientInfo||t.client_info||"",n,o,a),l=await this.loadIdToken(t,s.homeAccountId,s.environment,s.realm,n),c=await this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,r,n),u=await this.loadRefreshToken(t,s.homeAccountId,s.environment,n);return this.generateAuthenticationResult(e,{account:s,idToken:l,accessToken:c,refreshToken:u},o,a)}async loadAccount(e,t,r,n,o){if(this.logger.verbose("TokenCache - loading account"),e.account){let t=e6.createFromAccountInfo(e.account);return await this.storage.setAccount(t,r),t}if(!o||!t&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),rv(t9);let i=e6.generateHomeAccountId(t,o.authorityType,this.logger,this.cryptoObj,n),a=n?.tid,s=n9(this.storage,o,i,rE,n,t,o.hostnameAndPort,a,void 0,void 0,this.logger);return await this.storage.setAccount(s,r),s}async loadIdToken(e,t,r,n,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");let i=ev(t,r,e.id_token,this.config.auth.clientId,n);return await this.storage.setIdTokenCredential(i,o),i}async loadAccessToken(e,t,r,n,o,i,a){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");let s=t.scope?eZ.fromString(t.scope):new eZ(e.scopes),l=i.expiresOn||t.expires_in+new Date().getTime()/1e3,c=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+new Date().getTime()/1e3,u=eb(r,n,t.access_token,this.config.auth.clientId,o,s.printScopes(),l,c,rE);return await this.storage.setAccessTokenCredential(u,a),u}async loadRefreshToken(e,t,r,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");let o=ey(t,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(o,n),o}generateAuthenticationResult(e,t,r,n){let o,i="",a=[],s=null;t?.accessToken&&(i=t.accessToken.secret,a=eZ.fromString(t.accessToken.target).asArray(),s=new Date(1e3*Number(t.accessToken.expiresOn)),o=new Date(1e3*Number(t.accessToken.extendedExpiresOn)));let l=t.account;return{authority:n?n.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:a,account:l.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:r||{},accessToken:i,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:o,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:l.cloudGraphHostName||"",msGraphHost:l.msGraphHost||"",fromNativeBroker:!1}}}class oN extends oe{constructor(e){super(e),this.includeRedirectUri=!1}}class oF extends ol{constructor(e,t,r,n,o,i,a,s,l,c){super(e,t,r,n,o,i,s,l,c),this.apiId=a}async acquireToken(e){if(!e.code)throw rv(re);let t=await nm(this.initializeAuthorizationRequest.bind(this),tS.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,tA.X8.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{let n={...t,code:e.code},o=await nm(this.getClientConfiguration.bind(this),tS.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),i=new oN(o);this.logger.verbose("Auth code client created");let a=new oy(i,this.browserStorage,n,this.logger,this.performanceClient);return await nm(a.handleCodeResponseFromServer.bind(a),tS.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(e){throw e instanceof p.lR&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),e}}logout(){return Promise.reject(rv(tK))}}function oL(e){let t=e?.idTokenClaims;return t?.tfp||t?.acr?"B2C":t?.tid?t?.tid==="9188040d-6c67-4c5b-b112-36a304b66dad"?"MSA":"AAD":void 0}function oz(e,t){try{r4(e)}catch(e){throw t.end({success:!1},e),e}}class oD{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new nf(this.logger,this.performanceClient):el,this.eventHandler=new nj(this.logger),this.browserStorage=this.isBrowserEnvironment?new nM(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,ny(this.config.auth)):nF(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler);let t={cacheLocation:tA.Al.MemoryStorage,temporaryCacheLocation:tA.Al.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new nM(this.config.auth.clientId,t,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new oM(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){let r=new oD(e);return await r.initialize(t),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(nx.INITIALIZE_END);return}let t=e?.correlationId||this.getRequestCorrelationId(),r=this.config.system.allowPlatformBroker,n=this.performanceClient.startMeasurement(tS.InitializeClientApplication,t);if(this.eventHandler.emitEvent(nx.INITIALIZE_START),await nm(this.browserStorage.initialize.bind(this.browserStorage),tS.InitializeCache,this.logger,this.performanceClient,t)(t),r)try{this.nativeExtensionProvider=await ob.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(e){this.logger.verbose(e)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await nm(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),tS.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t),this.initialized=!0,this.eventHandler.emitEvent(nx.INITIALIZE_END),n.end({allowPlatformBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),r6(this.initialized),this.isBrowserEnvironment){let t=e||"",r=this.redirectResponse.get(t);return void 0===r?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){let t;let r=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),o=n&&ob.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,i=o?n?.correlationId:this.browserStorage.getTemporaryCache(tA._p.CORRELATION_ID,!0)||"",a=this.performanceClient.startMeasurement(tS.AcquireTokenRedirect,i);if(this.eventHandler.emitEvent(nx.HANDLE_REDIRECT_START,tA.X8.Redirect),o&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");let e=new ov(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tA.sA.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);t=nm(e.handleRedirectPromise.bind(e),tS.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(this.performanceClient,a.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");let r=this.createRedirectClient(i);t=nm(r.handleRedirectPromise.bind(r),tS.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(e,a)}return t.then(e=>(e?(r.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(nx.LOGIN_SUCCESS,tA.X8.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_SUCCESS,tA.X8.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),a.end({success:!0,accountType:oL(e.account)})):a.event.errorCode?a.end({success:!1}):a.discard(),this.eventHandler.emitEvent(nx.HANDLE_REDIRECT_END,tA.X8.Redirect),e)).catch(e=>{throw r.length>0?this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_FAILURE,tA.X8.Redirect,null,e):this.eventHandler.emitEvent(nx.LOGIN_FAILURE,tA.X8.Redirect,null,e),this.eventHandler.emitEvent(nx.HANDLE_REDIRECT_END,tA.X8.Redirect),a.end({success:!1},e),e})}async acquireTokenRedirect(e){let t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);let r=this.performanceClient.startMeasurement(tS.AcquireTokenPreRedirect,t);r.add({accountType:oL(e.account),scenarioId:e.scenarioId});let n=e.onRedirectNavigate;if(n)e.onRedirectNavigate=e=>{let t="function"==typeof n?n(e):void 0;return!1!==t?r.end({success:!0}):r.discard(),t};else{let e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{let n="function"==typeof e?e(t):void 0;return!1!==n?r.end({success:!0}):r.discard(),n}}let o=this.getAllAccounts().length>0;try{let n;return r8(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),o?this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_START,tA.X8.Redirect,e):this.eventHandler.emitEvent(nx.LOGIN_START,tA.X8.Redirect,e),n=this.nativeExtensionProvider&&this.canUsePlatformBroker(e)?new ov(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tA.sA.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,r).catch(r=>{if(r instanceof of&&oh(r))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(r instanceof nw.CB)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),r}):this.createRedirectClient(t).acquireToken(e),await n}catch(e){throw r.end({success:!1},e),o?this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_FAILURE,tA.X8.Redirect,null,e):this.eventHandler.emitEvent(nx.LOGIN_FAILURE,tA.X8.Redirect,null,e),e}}acquireTokenPopup(e){let t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(tS.AcquireTokenPopup,t);r.add({scenarioId:e.scenarioId,accountType:oL(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),oz(this.initialized,r),this.browserStorage.setInteractionInProgress(!0)}catch(e){return Promise.reject(e)}let n=this.getAllAccounts();n.length>0?this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_START,tA.X8.Popup,e):this.eventHandler.emitEvent(nx.LOGIN_START,tA.X8.Popup,e);let o=this.getPreGeneratedPkceCodes(t);return(this.canUsePlatformBroker(e)?this.acquireTokenNative({...e,correlationId:t},tA.sA.acquireTokenPopup).then(e=>(this.browserStorage.setInteractionInProgress(!1),r.end({success:!0,isNativeBroker:!0,accountType:oL(e.account)}),e)).catch(r=>{if(r instanceof of&&oh(r))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e,o);if(r instanceof nw.CB)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e,o);throw this.browserStorage.setInteractionInProgress(!1),r}):this.createPopupClient(t).acquireToken(e,o)).then(e=>(n.length<this.getAllAccounts().length?this.eventHandler.emitEvent(nx.LOGIN_SUCCESS,tA.X8.Popup,e):this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_SUCCESS,tA.X8.Popup,e),r.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:oL(e.account)}),e)).catch(e=>(n.length>0?this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_FAILURE,tA.X8.Popup,null,e):this.eventHandler.emitEvent(nx.LOGIN_FAILURE,tA.X8.Popup,null,e),r.end({success:!1},e),Promise.reject(e))).finally(()=>this.config.system.asyncPopups&&this.preGeneratePkceCodes(t))}trackPageVisibilityWithMeasurement(){let e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){let t=this.getRequestCorrelationId(e),r={...e,prompt:e.prompt,correlationId:t};return this.ssoSilentMeasurement=this.performanceClient.startMeasurement(tS.SsoSilent,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:oL(e.account)}),oz(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(nx.SSO_SILENT_START,tA.X8.Silent,r),(this.canUsePlatformBroker(r)?this.acquireTokenNative(r,tA.sA.ssoSilent).catch(e=>{if(e instanceof of&&oh(e))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(r.correlationId).acquireToken(r);throw e}):this.createSilentIframeClient(r.correlationId).acquireToken(r)).then(e=>(this.eventHandler.emitEvent(nx.SSO_SILENT_SUCCESS,tA.X8.Silent,e),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:oL(e.account)}),e)).catch(e=>{throw this.eventHandler.emitEvent(nx.SSO_SILENT_FAILURE,tA.X8.Silent,null,e),this.ssoSilentMeasurement?.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){let t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);let r=this.performanceClient.startMeasurement(tS.AcquireTokenByCode,t);oz(this.initialized,r),this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_BY_CODE_START,tA.X8.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw rv(rr);if(e.code){let n=e.code,o=this.hybridAuthCodeResponses.get(n);return o?(this.logger.verbose("Existing acquireTokenByCode request found",t),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(e=>(this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_BY_CODE_SUCCESS,tA.X8.Silent,e),this.hybridAuthCodeResponses.delete(n),r.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:oL(e.account)}),e)).catch(e=>{throw this.hybridAuthCodeResponses.delete(n),this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_BY_CODE_FAILURE,tA.X8.Silent,null,e),r.end({success:!1},e),e}),this.hybridAuthCodeResponses.set(n,o)),await o}if(e.nativeAccountId){if(this.canUsePlatformBroker(e,e.nativeAccountId)){let n=await this.acquireTokenNative({...e,correlationId:t},tA.sA.acquireTokenByCode,e.nativeAccountId).catch(e=>{throw e instanceof of&&oh(e)&&(this.nativeExtensionProvider=void 0),e});return r.end({accountType:oL(n.account),success:!0}),n}throw rv(ro)}throw rv(rt)}catch(e){throw this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_BY_CODE_FAILURE,tA.X8.Silent,null,e),r.end({success:!1},e),e}}async acquireTokenByCodeAsync(e){this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(tS.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);let t=this.createSilentAuthCodeClient(e.correlationId);return await t.acquireToken(e).then(e=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker}),e)).catch(e=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(tS.AcquireTokenFromCache,e.correlationId),t){case tA.nN.Default:case tA.nN.AccessToken:case tA.nN.AccessTokenAndRefreshToken:let r=this.createSilentCacheClient(e.correlationId);return nm(r.acquireToken.bind(r),tS.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw es(G)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(tS.AcquireTokenByRefreshToken,e.correlationId),t){case tA.nN.Default:case tA.nN.AccessTokenAndRefreshToken:case tA.nN.RefreshToken:case tA.nN.RefreshTokenAndNetwork:let r=this.createSilentRefreshClient(e.correlationId);return nm(r.acquireToken.bind(r),tS.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw es(G)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(tS.AcquireTokenBySilentIframe,e.correlationId);let t=this.createSilentIframeClient(e.correlationId);return nm(t.acquireToken.bind(t),tS.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){let t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){let t=this.getRequestCorrelationId(e);return r8(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{let t=this.getRequestCorrelationId(e);return r4(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(e){return Promise.reject(e)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}let t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return nL(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return nz(e,this.logger,this.browserStorage)}getAccountByUsername(e){return nD(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return nB(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return nU(e,this.logger,this.browserStorage)}setActiveAccount(e){nH(e,this.browserStorage)}getActiveAccount(){return nq(this.browserStorage)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");let r=e6.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return(await this.browserStorage.setAccount(r,e.correlationId),e.fromNativeBroker)?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,r){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw rv(rs);return new ov(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!ob.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isPlatformBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case u._M.NONE:case u._M.CONSENT:case u._M.LOGIN:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!!(t||this.getNativeAccountId(e))||(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1)}getNativeAccountId(e){let t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new oS(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new oI(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new oO(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tA.sA.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new og(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new ox(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new oF(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tA.sA.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return r5(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){if(this.config.cache.cacheLocation!==tA.Al.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.subscribeCrossTab()}disableAccountStorageEvents(){if(this.config.cache.cacheLocation!==tA.Al.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.unsubscribeCrossTab()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?rB():u.YM.EMPTY_STRING}async loginRedirect(e){let t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||tA.uq})}loginPopup(e){let t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||tA.uq})}async acquireTokenSilent(e){let t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(tS.AcquireTokenSilent,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),oz(this.initialized,r),this.logger.verbose("acquireTokenSilent called",t);let n=e.account||this.getActiveAccount();if(!n)throw rv(tX);r.add({accountType:oL(n)});let o=JSON.stringify({clientId:this.config.auth.clientId,authority:e.authority||u.YM.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:n.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions}),i=this.activeSilentTokenRequests.get(o);if(void 0!==i)return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.discard(),{...await i,state:e.state};{this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);let i=nm(this.acquireTokenSilentAsync.bind(this),tS.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)({...e,correlationId:t},n).then(t=>(this.activeSilentTokenRequests.delete(o),r.end({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),t)).catch(e=>{throw this.activeSilentTokenRequests.delete(o),r.end({success:!1},e),e});return this.activeSilentTokenRequests.set(o,i),{...await i,state:e.state}}}async acquireTokenSilentAsync(e,t){let r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(tS.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_START,tA.X8.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);let n=await nm(os,tS.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),o=e.cacheLookupPolicy||tA.nN.Default;return this.acquireTokenSilentNoIframe(n,o).catch(async e=>{if(function(e,t){let r=!(e instanceof nw.CB&&e.subError!==nS.j9),n=e.errorCode===tA.Q1.INVALID_GRANT_ERROR||e.errorCode===G,o=r&&n||e.errorCode===nS.oF||e.errorCode===nS.AG,i=tA.JE.includes(t);return o&&i}(e,o)){if(this.activeIframeRequest){if(o===tA.nN.Skip)return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",n.correlationId),nm(this.acquireTokenBySilentIframe.bind(this),tS.AcquireTokenBySilentIframe,this.logger,this.performanceClient,n.correlationId)(n);{let[t,r]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${r}`,n.correlationId);let i=this.performanceClient.startMeasurement(tS.AwaitConcurrentIframe,n.correlationId);i.add({awaitIframeCorrelationId:r});let a=await t;if(i.end({success:a}),a)return this.logger.verbose(`Parallel iframe request with correlationId: ${r} succeeded. Retrying cache and/or RT redemption`,n.correlationId),this.acquireTokenSilentNoIframe(n,o);throw this.logger.info(`Iframe request with correlationId: ${r} failed. Interaction is required.`),e}}{let e;return this.activeIframeRequest=[new Promise(t=>{e=t}),n.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",n.correlationId),nm(this.acquireTokenBySilentIframe.bind(this),tS.AcquireTokenBySilentIframe,this.logger,this.performanceClient,n.correlationId)(n).then(t=>(e(!0),t)).catch(t=>{throw e(!1),t}).finally(()=>{this.activeIframeRequest=void 0})}}throw e}).then(t=>(this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_SUCCESS,tA.X8.Silent,t),e.correlationId&&this.performanceClient.addFields({fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker},e.correlationId),t)).catch(e=>{throw this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_FAILURE,tA.X8.Silent,null,e),e}).finally(()=>{document.removeEventListener("visibilitychange",r)})}async acquireTokenSilentNoIframe(e,t){return ob.isPlatformBrokerAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,tA.sA.acquireTokenSilent_silentFlow).catch(async e=>{if(e instanceof of&&oh(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,es(G);throw e})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),nm(this.acquireTokenFromCache.bind(this),tS.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(r=>{if(t===tA.nN.AccessToken)throw r;return this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_NETWORK_START,tA.X8.Silent,e),nm(this.acquireTokenByRefreshToken.bind(this),tS.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await nm(on,tS.GeneratePkceCodes,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");let t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose(`${t?"Found":"Did not find"} pre-generated PKCE codes`),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}}async function oB(e,t){let r=new nr(e);return await r.initialize(),oD.createController(r,t)}let oU={UserInteractionRequired:"USER_INTERACTION_REQUIRED",UserCancel:"USER_CANCEL",NoNetwork:"NO_NETWORK",TransientError:"TRANSIENT_ERROR",PersistentError:"PERSISTENT_ERROR",Disabled:"DISABLED",AccountUnavailable:"ACCOUNT_UNAVAILABLE",NestedAppAuthUnavailable:"NESTED_APP_AUTH_UNAVAILABLE"};class oH{constructor(e,t,r,n){this.clientId=e,this.clientCapabilities=t,this.crypto=r,this.logger=n}toNaaTokenRequest(e){let t;t=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters));let r=e.correlationId||this.crypto.createNewGuid(),n=new n1(r).addClientCapabilitiesToClaims(e.claims,this.clientCapabilities),o=e.scopes||u.aZ;return{platformBrokerId:e.account?.homeAccountId,clientId:this.clientId,authority:e.authority,scope:o.join(" "),correlationId:r,claims:eY.isEmptyObj(n)?void 0:n,state:e.state,authenticationScheme:e.authenticationScheme||u.IO.BEARER,extraParameters:t}}fromNaaTokenResponse(e,t,r){if(!t.token.id_token||!t.token.access_token)throw es(b);let n=new Date((r+(t.token.expires_in||0))*1e3),o=ed(t.token.id_token,this.crypto.base64Decode),i=this.fromNaaAccountInfo(t.account,t.token.id_token,o),a=t.token.scope||e.scope;return{authority:t.token.authority||i.environment,uniqueId:i.localAccountId,tenantId:i.tenantId,scopes:a.split(" "),account:i,idToken:t.token.id_token,idTokenClaims:o,accessToken:t.token.access_token,fromCache:!1,expiresOn:n,tokenType:e.authenticationScheme||u.IO.BEARER,correlationId:e.correlationId,extExpiresOn:n,state:e.state}}fromNaaAccountInfo(e,t,r){let n=r||e.idTokenClaims,o=e.localAccountId||n?.oid||n?.sub||"",i=e.tenantId||n?.tid||"",a=e.homeAccountId||`${o}.${i}`,s=e.username||n?.preferred_username||"",l=e.name||n?.name,c=new Map,u=e1(a,o,i,n);return c.set(i,u),{homeAccountId:a,environment:e.environment,tenantId:i,username:s,localAccountId:o,name:l,idToken:t,idTokenClaims:n,tenantProfiles:c}}fromBridgeError(e){if(void 0===e.status)return new p.lR("unknown_error","An unknown error occurred");switch(e.status){case oU.UserCancel:return new ea(et);case oU.NoNetwork:return new ea(ee);case oU.AccountUnavailable:return new ea(q);case oU.Disabled:return new ea(eo);case oU.NestedAppAuthUnavailable:return new ea(e.code||eo,e.description);case oU.TransientError:case oU.PersistentError:return new n$(e.code,e.description);case oU.UserInteractionRequired:return new nw.CB(e.code,e.description);default:return new p.lR(e.code,e.description)}}toAuthenticationResultFromCache(e,t,r,n,o){if(!t||!r)throw es(b);let i=ed(t.secret,this.crypto.base64Decode),a=r.target||n.scopes.join(" ");return{authority:r.environment||e.environment,uniqueId:e.localAccountId,tenantId:e.tenantId,scopes:a.split(" "),account:e,idToken:t.secret,idTokenClaims:i||{},accessToken:r.secret,fromCache:!0,expiresOn:new Date(1e3*Number(r.expiresOn)),tokenType:n.authenticationScheme||u.IO.BEARER,correlationId:o,extExpiresOn:new Date(1e3*Number(r.extendedExpiresOn)),state:n.state}}}let oq={unsupportedMethod:{code:"unsupported_method",desc:"This method is not supported in nested app environment."}};class oj extends p.lR{constructor(e,t){super(e,t),Object.setPrototypeOf(this,oj.prototype),this.name="NestedAppAuthError"}static createUnsupportedError(){return new oj(oq.unsupportedMethod.code,oq.unsupportedMethod.desc)}}class o${constructor(e){this.operatingContext=e;let t=this.operatingContext.getBridgeProxy();if(void 0!==t)this.bridgeProxy=t;else throw Error("unexpected: bridgeProxy is undefined");this.config=e.getConfig(),this.logger=this.operatingContext.getLogger(),this.performanceClient=this.config.telemetry.client,this.browserCrypto=e.isBrowserEnvironment()?new nf(this.logger,this.performanceClient,!0):el,this.eventHandler=new nj(this.logger),this.browserStorage=this.operatingContext.isBrowserEnvironment()?new nM(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,ny(this.config.auth)):nF(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler),this.nestedAppAuthAdapter=new oH(this.config.auth.clientId,this.config.auth.clientCapabilities,this.browserCrypto,this.logger);let r=this.bridgeProxy.getAccountContext();this.currentAccountContext=r||null}static async createController(e){return Promise.resolve(new o$(e))}async initialize(e){let t=e?.correlationId||rB();return await this.browserStorage.initialize(t),Promise.resolve()}ensureValidRequest(e){return e?.correlationId?e:{...e,correlationId:this.browserCrypto.createNewGuid()}}async acquireTokenInteractive(e){let t=this.ensureValidRequest(e);this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_START,tA.X8.Popup,t);let r=this.performanceClient.startMeasurement(tS.AcquireTokenPopup,t.correlationId);r?.add({nestedAppAuthRequest:!0});try{let n=this.nestedAppAuthAdapter.toNaaTokenRequest(t),o=eh(),i=await this.bridgeProxy.getTokenInteractive(n),a={...this.nestedAppAuthAdapter.fromNaaTokenResponse(n,i,o)};return await this.hydrateCache(a,e),this.currentAccountContext={homeAccountId:a.account.homeAccountId,environment:a.account.environment,tenantId:a.account.tenantId},this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_SUCCESS,tA.X8.Popup,a),r.add({accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length}),r.end({success:!0,requestId:a.requestId}),a}catch(t){let e=t instanceof p.lR?t:this.nestedAppAuthAdapter.fromBridgeError(t);throw this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_FAILURE,tA.X8.Popup,null,t),r.end({success:!1},t),e}}async acquireTokenSilentInternal(e){let t=this.ensureValidRequest(e);this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_START,tA.X8.Silent,t);let r=await this.acquireTokenFromCache(t);if(r)return this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_SUCCESS,tA.X8.Silent,r),r;let n=this.performanceClient.startMeasurement(tS.SsoSilent,t.correlationId);n?.increment({visibilityChangeCount:0}),n?.add({nestedAppAuthRequest:!0});try{let r=this.nestedAppAuthAdapter.toNaaTokenRequest(t),o=eh(),i=await this.bridgeProxy.getTokenSilent(r),a=this.nestedAppAuthAdapter.fromNaaTokenResponse(r,i,o);return await this.hydrateCache(a,e),this.currentAccountContext={homeAccountId:a.account.homeAccountId,environment:a.account.environment,tenantId:a.account.tenantId},this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_SUCCESS,tA.X8.Silent,a),n?.add({accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length}),n?.end({success:!0,requestId:a.requestId}),a}catch(t){let e=t instanceof p.lR?t:this.nestedAppAuthAdapter.fromBridgeError(t);throw this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_FAILURE,tA.X8.Silent,null,t),n?.end({success:!1},t),e}}async acquireTokenFromCache(e){let t=this.performanceClient.startMeasurement(tS.AcquireTokenSilent,e.correlationId);if(t?.add({nestedAppAuthRequest:!0}),e.claims)return this.logger.verbose("Claims are present in the request, skipping cache lookup"),null;if(e.forceRefresh)return this.logger.verbose("forceRefresh is set to true, skipping cache lookup"),null;let r=null;switch(e.cacheLookupPolicy||(e.cacheLookupPolicy=tA.nN.Default),e.cacheLookupPolicy){case tA.nN.Default:case tA.nN.AccessToken:case tA.nN.AccessTokenAndRefreshToken:r=await this.acquireTokenFromCacheInternal(e);break;default:return null}return r?(this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_SUCCESS,tA.X8.Silent,r),t?.add({accessTokenSize:r?.accessToken.length,idTokenSize:r?.idToken.length}),t?.end({success:!0}),r):(this.logger.error("Cached tokens are not found for the account, proceeding with silent token request."),this.eventHandler.emitEvent(nx.ACQUIRE_TOKEN_FAILURE,tA.X8.Silent,null),t?.end({success:!1}),null)}async acquireTokenFromCacheInternal(e){let t=this.bridgeProxy.getAccountContext()||this.currentAccountContext,r=null;if(t&&(r=nz(t,this.logger,this.browserStorage)),!r)return this.logger.verbose("No active account found, falling back to the host"),Promise.resolve(null);this.logger.verbose("active account found, attempting to acquire token silently");let n={...e,correlationId:e.correlationId||this.browserCrypto.createNewGuid(),authority:e.authority||r.environment,scopes:e.scopes?.length?e.scopes:[...u.aZ]},o=this.browserStorage.getTokenKeys(),i=this.browserStorage.getAccessToken(r,n,o,r.tenantId,this.performanceClient,n.correlationId);if(!i)return this.logger.verbose("No cached access token found"),Promise.resolve(null);if(em(i.cachedAt)||ep(i.expiresOn,this.config.system.tokenRenewalOffsetSeconds))return this.logger.verbose("Cached access token has expired"),Promise.resolve(null);let a=this.browserStorage.getIdToken(r,o,r.tenantId,this.performanceClient,n.correlationId);return a?this.nestedAppAuthAdapter.toAuthenticationResultFromCache(r,a,i,n,n.correlationId):(this.logger.verbose("No cached id token found"),Promise.resolve(null))}async acquireTokenPopup(e){return this.acquireTokenInteractive(e)}acquireTokenRedirect(e){throw oj.createUnsupportedError()}async acquireTokenSilent(e){return this.acquireTokenSilentInternal(e)}acquireTokenByCode(e){throw oj.createUnsupportedError()}acquireTokenNative(e,t,r){throw oj.createUnsupportedError()}acquireTokenByRefreshToken(e,t){throw oj.createUnsupportedError()}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){throw oj.createUnsupportedError()}removePerformanceCallback(e){throw oj.createUnsupportedError()}enableAccountStorageEvents(){throw oj.createUnsupportedError()}disableAccountStorageEvents(){throw oj.createUnsupportedError()}getAllAccounts(e){return nL(this.logger,this.browserStorage,this.isBrowserEnv(),e)}getAccount(e){return nz(e,this.logger,this.browserStorage)}getAccountByUsername(e){return nD(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return nB(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return nU(e,this.logger,this.browserStorage)}setActiveAccount(e){return nH(e,this.browserStorage)}getActiveAccount(){return nq(this.browserStorage)}handleRedirectPromise(e){return Promise.resolve(null)}loginPopup(e){return this.acquireTokenInteractive(e||tA.uq)}loginRedirect(e){throw oj.createUnsupportedError()}logout(e){throw oj.createUnsupportedError()}logoutRedirect(e){throw oj.createUnsupportedError()}logoutPopup(e){throw oj.createUnsupportedError()}ssoSilent(e){return this.acquireTokenSilentInternal(e)}getTokenCache(){throw oj.createUnsupportedError()}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){}setNavigationClient(e){this.logger.warning("setNavigationClient is not supported in nested app auth")}getConfiguration(){return this.config}isBrowserEnv(){return this.operatingContext.isBrowserEnvironment()}getBrowserCrypto(){return this.browserCrypto}getPerformanceClient(){throw oj.createUnsupportedError()}getRedirectResponse(){throw oj.createUnsupportedError()}async clearCache(e){throw oj.createUnsupportedError()}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");let r=e6.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(r,e.correlationId),this.browserStorage.hydrateCache(e,t)}}class oW{static async initializeNestedAppAuthBridge(){if(void 0===window)throw Error("window is undefined");if(void 0===window.nestedAppAuthBridge)throw Error("window.nestedAppAuthBridge is undefined");try{window.nestedAppAuthBridge.addEventListener("message",e=>{let t="string"==typeof e?e:e.data,r=JSON.parse(t),n=oW.bridgeRequests.find(e=>e.requestId===r.requestId);void 0!==n&&(oW.bridgeRequests.splice(oW.bridgeRequests.indexOf(n),1),r.success?n.resolve(r):n.reject(r.error))});let e=await new Promise((e,t)=>{let r=oW.buildRequest("GetInitContext"),n={requestId:r.requestId,method:r.method,resolve:e,reject:t};oW.bridgeRequests.push(n),window.nestedAppAuthBridge.postMessage(JSON.stringify(r))});return oW.validateBridgeResultOrThrow(e.initContext)}catch(e){throw window.console.log(e),e}}getTokenInteractive(e){return this.getToken("GetTokenPopup",e)}getTokenSilent(e){return this.getToken("GetToken",e)}async getToken(e,t){let r=await this.sendRequest(e,{tokenParams:t});return{token:oW.validateBridgeResultOrThrow(r.token),account:oW.validateBridgeResultOrThrow(r.account)}}getHostCapabilities(){return this.capabilities??null}getAccountContext(){return this.accountContext?this.accountContext:null}static buildRequest(e,t){return{messageType:"NestedAppAuthRequest",method:e,requestId:rB(),sendTime:Date.now(),clientLibrary:tA.Q1.MSAL_SKU,clientLibraryVersion:ne,...t}}sendRequest(e,t){let r=oW.buildRequest(e,t);return new Promise((e,t)=>{let n={requestId:r.requestId,method:r.method,resolve:e,reject:t};oW.bridgeRequests.push(n),window.nestedAppAuthBridge.postMessage(JSON.stringify(r))})}static validateBridgeResultOrThrow(e){if(void 0===e)throw{status:oU.NestedAppAuthUnavailable};return e}constructor(e,t,r,n){this.sdkName=e,this.sdkVersion=t,this.accountContext=r,this.capabilities=n}static async create(){let e=await oW.initializeNestedAppAuthBridge();return new oW(e.sdkName,e.sdkVersion,e.accountContext,e.capabilities)}}oW.bridgeRequests=[];class oV extends nt{constructor(){super(...arguments),this.bridgeProxy=void 0,this.accountContext=null}getModuleName(){return oV.MODULE_NAME}getId(){return oV.ID}getBridgeProxy(){return this.bridgeProxy}async initialize(){try{if("undefined"!=typeof window){"function"==typeof window.__initializeNestedAppAuth&&await window.__initializeNestedAppAuth();let e=await oW.create();this.accountContext=e.getAccountContext(),this.bridgeProxy=e,this.available=void 0!==e}}catch(e){this.logger.infoPii(`Could not initialize Nested App Auth bridge (${e})`)}return this.logger.info(`Nested App Auth Bridge available: ${this.available}`),this.available}}oV.MODULE_NAME="",oV.ID="NestedAppOperatingContext";class oG{static async createPublicClientApplication(e){let t=await oB(e);return new oG(e,t)}constructor(e,t){this.controller=t||new oD(new nr(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}async function oK(e){let t=new oV(e);if(await t.initialize(),t.isAvailable()){let r=new oG(e,new o$(t));return await r.initialize(),r}return oX(e)}async function oX(e){let t=new oG(e);return await t.initialize(),t}function oY(e){let t=e.lastIndexOf(" ")+1;if(t<1)return e;let r=e.substring(t),n=r.lastIndexOf("/");return(n=n<0?r.lastIndexOf("\\"):n)>=0?(e.substring(0,t)+"("+r.substring(n+1)+(")"===r.charAt(r.length-1)?"":")")).trimStart():e.trimStart()}class oZ{constructor(e,t,r,n,o,i,a,s){for(let s of(this.authority=t,this.libraryName=n,this.libraryVersion=o,this.applicationTelemetry=i,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.eventStack=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map,this.intFields=a||new Set,tk))this.intFields.add(s);for(let[e,t]of(this.abbreviations=s||new Map,tC))this.abbreviations.set(e,t)}startPerformanceMeasurement(e,t){return{}}getPreQueueTime(e,t){let r=this.preQueueTimeByCorrelationId.get(t);if(r){if(r.name!==e){this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue time found for ${e}, unable to add queue measurement`);return}}else{this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: ${t}, unable to add queue measurement`);return}return r.time}calculateQueuedTime(e,t){return e<1?(this.logger.trace(`PerformanceClient: preQueueTime should be a positive integer and not ${e}`),0):t<1?(this.logger.trace(`PerformanceClient: currentTime should be a positive integer and not ${t}`),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e}addQueueMeasurement(e,t,r,n){if(!t){this.logger.trace(`PerformanceClient.addQueueMeasurement: correlationId not provided for ${e}, cannot add queue measurement`);return}if(0===r)this.logger.trace(`PerformanceClient.addQueueMeasurement: queue time provided for ${e} is ${r}`);else if(!r){this.logger.trace(`PerformanceClient.addQueueMeasurement: no queue time provided for ${e}`);return}let o={eventName:e,queueTime:n?0:r,manuallyCompleted:n},i=this.queueMeasurements.get(t);i?(i.push(o),this.queueMeasurements.set(t,i)):(this.logger.trace(`PerformanceClient.addQueueMeasurement: adding correlationId ${t} to queue measurements`),this.queueMeasurements.set(t,[o])),this.preQueueTimeByCorrelationId.delete(t)}startMeasurement(e,t){var r,n;let o=t||this.generateId();t||this.logger.info(`PerformanceClient: No correlation id provided for ${e}, generating`,o),this.logger.trace(`PerformanceClient: Performance measurement started for ${e}`,o);let i={eventId:this.generateId(),status:tI.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:o,appName:this.applicationTelemetry?.appName,appVersion:this.applicationTelemetry?.appVersion};return this.cacheEventByCorrelationId(i),r=this.abbreviations,(n=this.eventStack.get(o))&&n.push({name:r.get(i.name)||i.name}),{end:(e,t)=>this.endMeasurement({...i,...e},t),discard:()=>this.discardMeasurements(i.correlationId),add:e=>this.addFields(e,i.correlationId),increment:e=>this.incrementFields(e,i.correlationId),event:i,measurement:new tE}}endMeasurement(e,t){let r=this.eventsByCorrelationId.get(e.correlationId);if(!r)return this.logger.trace(`PerformanceClient: Measurement not found for ${e.eventId}`,e.correlationId),null;let n=e.eventId===r.eventId,o={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};e.durationMs=Math.round(e.durationMs||this.getDurationMs(e.startTimeMs));let i=JSON.stringify(function(e,t,r,n){let o;if(!r?.length)return;let i=e=>e.length?e[e.length-1]:void 0,a=t.get(e.name)||e.name,s=i(r);if(s?.name!==a)return;let l=r?.pop();if(!l)return;let c=n instanceof p.lR?n.errorCode:n instanceof Error?n.name:void 0,u=n instanceof p.lR?n.subError:void 0;c&&l.childErr!==c&&(l.err=c,u&&(l.subErr=u)),delete l.name,delete l.childErr;let d={...l,dur:e.durationMs};e.success||(d.fail=1);let f=i(r);if(!f)return{[a]:d};if(c&&(f.childErr=c),f[a]){let e=Object.keys(f).filter(e=>e.startsWith(a)).length;o=`${a}_${e+1}`}else o=a;return f[o]=d,f}(e,this.abbreviations,this.eventStack.get(r.correlationId),t));if(n?(o=this.getQueueInfo(e.correlationId),this.discardMeasurements(r.correlationId)):r.incompleteSubMeasurements?.delete(e.eventId),this.logger.trace(`PerformanceClient: Performance measurement ended for ${e.name}: ${e.durationMs} ms`,e.correlationId),t&&function(e,t,r,n=5){if(e instanceof Error){if(e instanceof p.lR){r.errorCode=e.errorCode,r.subErrorCode=e.subError,(e instanceof n$||e instanceof nw.CB)&&(r.serverErrorNo=e.errorNo);return}if(e instanceof tl){r.errorCode=e.errorCode;return}if(r.errorStack?.length){t.trace("PerformanceClient.addErrorStack: Stack already exist",r.correlationId);return}else if(!e.stack?.length){t.trace("PerformanceClient.addErrorStack: Input stack is empty",r.correlationId);return}}else{t.trace("PerformanceClient.addErrorStack: Input error is not instance of Error",r.correlationId);return}e.stack&&(r.errorStack=function(e,t){if(t<0)return[];let r=e.split("\n")||[],n=[],o=r[0];o.startsWith("TypeError: Cannot read property")||o.startsWith("TypeError: Cannot read properties of")||o.startsWith("TypeError: Cannot set property")||o.startsWith("TypeError: Cannot set properties of")||o.endsWith("is not a function")?n.push(oY(o)):(o.startsWith("SyntaxError")||o.startsWith("TypeError"))&&n.push(oY(o.replace(/['].*[']|["].*["]/g,"<redacted>")));for(let e=1;e<r.length&&!(n.length>=t);e++){let t=r[e];n.push(oY(t))}return n}(e.stack,n)),r.errorName=e.name}(t,this.logger,r),!n)return r[e.name+"DurationMs"]=Math.floor(e.durationMs),{...r};n&&!t&&(r.errorCode||r.subErrorCode)&&(this.logger.trace(`PerformanceClient: Remove error and sub-error codes for root event ${e.name} as intermediate error was successfully handled`,e.correlationId),r.errorCode=void 0,r.subErrorCode=void 0);let a={...r,...e},s=0;return a.incompleteSubMeasurements?.forEach(t=>{this.logger.trace(`PerformanceClient: Incomplete submeasurement ${t.name} found for ${e.name}`,a.correlationId),s++}),a.incompleteSubMeasurements=void 0,a={...a,queuedTimeMs:o.totalQueueTime,queuedCount:o.totalQueueCount,queuedManuallyCompletedCount:o.manuallyCompletedCount,status:tI.Completed,incompleteSubsCount:s,context:i},this.truncateIntegralFields(a),this.emitEvents([a],e.correlationId),a}addFields(e,t){this.logger.trace("PerformanceClient: Updating static fields");let r=this.eventsByCorrelationId.get(t);r?this.eventsByCorrelationId.set(t,{...r,...e}):this.logger.trace("PerformanceClient: Event not found for",t)}incrementFields(e,t){this.logger.trace("PerformanceClient: Updating counters");let r=this.eventsByCorrelationId.get(t);if(r)for(let t in e){if(r.hasOwnProperty(t)){if(isNaN(Number(r[t])))return}else r[t]=0;r[t]+=e[t]}else this.logger.trace("PerformanceClient: Event not found for",t)}cacheEventByCorrelationId(e){let t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace(`PerformanceClient: Performance measurement for ${e.name} added/updated`,e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace(`PerformanceClient: Performance measurement for ${e.name} started`,e.correlationId),this.eventsByCorrelationId.set(e.correlationId,{...e}),this.eventStack.set(e.correlationId,[]))}getQueueInfo(e){let t=this.queueMeasurements.get(e);t||this.logger.trace(`PerformanceClient: no queue measurements found for for correlationId: ${e}`);let r=0,n=0,o=0;return t?.forEach(e=>{r+=e.queueTime,n++,o+=e.manuallyCompleted?1:0}),{totalQueueTime:r,totalQueueCount:n,manuallyCompletedCount:o}}discardMeasurements(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e),this.logger.trace("PerformanceClient: Event stack discarded",e),this.eventStack.delete(e)}addPerformanceCallback(e){for(let[t,r]of this.callbacks)if(r.toString()===e.toString())return this.logger.warning(`PerformanceClient: Performance callback is already registered with id: ${t}`),t;let t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose(`PerformanceClient: Performance callback registered with id: ${t}`),t}removePerformanceCallback(e){let t=this.callbacks.delete(e);return t?this.logger.verbose(`PerformanceClient: Performance callback ${e} removed.`):this.logger.verbose(`PerformanceClient: Performance callback ${e} not removed.`),t}emitEvents(e,t){this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach((r,n)=>{this.logger.trace(`PerformanceClient: Emitting event to callback ${n}`,t),r.apply(null,[e])})}truncateIntegralFields(e){this.intFields.forEach(t=>{t in e&&"number"==typeof e[t]&&(e[t]=Math.floor(e[t]))})}getDurationMs(e){let t=Date.now()-e;return t<0?t:0}}function oQ(){let e;try{e=window[tA.Al.SessionStorage];let t=e?.getItem(tA.Fi);if(1===Number(t))return r.e(69022).then(r.bind(r,69022))}catch(e){}}function oJ(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now}class o0 extends oZ{constructor(e,t,r){super(e.auth.clientId,e.auth.authority||`${u.YM.DEFAULT_AUTHORITY}`,new d(e.system?.loggerOptions||{},r7,ne),r7,ne,e.telemetry?.application||{appName:"",appVersion:""},t,r)}generateId(){return rB()}getPageVisibility(){return document.visibilityState?.toString()||null}deleteIncompleteSubMeasurements(e){oQ()?.then(t=>{let r=this.eventsByCorrelationId.get(e.event.correlationId),n=r&&r.eventId===e.event.eventId,o=[];n&&r?.incompleteSubMeasurements&&r.incompleteSubMeasurements.forEach(e=>{o.push({...e})}),t.BrowserPerformanceMeasurement.flushMeasurements(e.event.correlationId,o)})}startMeasurement(e,t){let r=this.getPageVisibility(),n=super.startMeasurement(e,t),o=oJ()?window.performance.now():void 0,i=oQ()?.then(t=>new t.BrowserPerformanceMeasurement(e,n.event.correlationId));return i?.then(e=>e.startMeasurement()),{...n,end:(e,t)=>{let a=n.end({...e,startPageVisibility:r,endPageVisibility:this.getPageVisibility(),durationMs:function(e){if(e&&oJ())return Math.round(window.performance.now()-e)}(o)},t);return i?.then(e=>e.endMeasurement()),this.deleteIncompleteSubMeasurements(n),a},discard:()=>{n.discard(),i?.then(e=>e.flushMeasurement()),this.deleteIncompleteSubMeasurements(n)}}}setPreQueueTime(e,t){if(!oJ()){this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for ${e}`);return}if(!t){this.logger.trace(`BrowserPerformanceClient: correlationId for ${e} not provided, unable to set telemetry queue time`);return}let r=this.preQueueTimeByCorrelationId.get(t);r&&(this.logger.trace(`BrowserPerformanceClient: Incomplete pre-queue ${r.name} found`,t),this.addQueueMeasurement(r.name,t,void 0,!0)),this.preQueueTimeByCorrelationId.set(t,{name:e,time:window.performance.now()})}addQueueMeasurement(e,t,r,n){if(!oJ()){this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to add queue measurement for ${e}`);return}if(!t){this.logger.trace(`BrowserPerformanceClient: correlationId for ${e} not provided, unable to add queue measurement`);return}let o=super.getPreQueueTime(e,t);if(!o)return;let i=window.performance.now(),a=r||super.calculateQueuedTime(o,i);return super.addQueueMeasurement(e,t,a,n)}}let o1={...tS,PairwiseBrokerApplicationInitializeBrokering:"pairwiseBrokerApplicationInitializeBrokering",BrokerClientApplicationHandleBrokerHandshake:"brokerClientApplicationHandleBrokerHandshake",BrokerClientApplicationBrokeredSSOSilentRequest:"brokerClientApplicationBrokeredSSOSilentRequest",BrokerClientApplicationBrokeredSilentRequest:"brokerClientApplicationBrokeredSilentRequest",EmbeddedClientApplicationSendSSOSilentRequest:"embeddedSSOSilent",EmbeddedClientApplicationSendPopupRequest:"embeddedPopup",EmbeddedClientApplicationSendRedirectRequest:"embeddedRedirect",EmbeddedClientApplicationHandleRedirectRequest:"embeddedHandleRedirect",EmbeddedClientApplicationSendSilentRefreshRequest:"embeddedSilentRefresh"},o2=new Map([[o1.PairwiseBrokerApplicationInitializeBrokering,"PWBInitBrk"],[o1.BrokerClientApplicationHandleBrokerHandshake,"BrkClientHandeBrkHandshake"],[o1.BrokerClientApplicationBrokeredSSOSilentRequest,"BrkClientBrkSSOReq"],[o1.BrokerClientApplicationBrokeredSilentRequest,"BrkClientBrkSltReq"],[o1.EmbeddedClientApplicationSendSSOSilentRequest,"EmbClientSendSSOReq"],[o1.EmbeddedClientApplicationSendPopupRequest,"EmbClientSendPopupReq"],[o1.EmbeddedClientApplicationSendRedirectRequest,"EmbClientSendRedirectReq"],[o1.EmbeddedClientApplicationHandleRedirectRequest,"EmbClientHandleRedirectReq"],[o1.EmbeddedClientApplicationSendSilentRefreshRequest,"EmbClientSendSltRefreshReq"]]),o3=new Set(["brokerInteractionTimeoutMs","brokerMessageTimeoutMs","brokerHandshakeTimeoutMs","brokerIframeTimeoutMs"]);var o5=r(646235);let o6="mats-telemetry-profile-id";class o4{constructor(e,t,r,n,o,i,a,s){this.synthetic=!1,this.observabilityRatio=.1,this.samplingRatio=.01,this.clientId=e,this.logger=t,this.eventsToEmit=new Set(n),this.eventsToSample=new Set(o),this.appInsights=new o5.a,this.appInsights.initialize({instrumentationKey:"d634483c08244c1ca09af2b2d952c92e-ab2bba03-2ba3-49d8-a82c-ef6da750d8ab-7725",extensions:[],propertyConfiguration:{gpcDataSharingOptIn:!1},disableCookiesUsage:!0},[]),this.synthetic=i||!1,this.appName=a,this.appVersion=s,this.sessionId=rB(),this.sampleEvents=Math.random()<=this.samplingRatio,this.logger.verbose(`Sampling for misc event enabled: ${this.sampleEvents}`);try{let e=new nP(this.clientId,t,r),n=e.getItem(o6);if(n)this.profileTelemetryId=n;else{let t=rB();this.profileTelemetryId=t,e.setItem(o6,t)}}catch(e){t.warning("PerformanceTelemetryReporter: local storage is not available"),this.profileTelemetryId=""}this.logger.verbose("PerformanceTelemetryReporter: Initialized")}sendCustomEvent(e){if(!this.eventsToEmit.has(e.name)||this.eventsToSample.has(e.name)&&!this.sampleEvents){this.logger.verbose(`PerformanceTelemetryReporter: Skipping telemetry for ${e.name}`,e.correlationId);return}let t={...e,synthetic:this.synthetic,appName:this.appName,appVersion:this.appVersion,profileTelemetryId:this.profileTelemetryId,sessionId:this.sessionId};e.success&&!(Math.random()<=this.observabilityRatio)?(delete t.context,delete t.errorStack,this.logger.verbose(`PerformanceTelemetryReporter: Sending ${t.name} for tracking`)):this.logger.verbose(`PerformanceTelemetryReporter: Sending ${t.name} with additional observability for tracking`);let r={name:e.name,data:t};this.appInsights.track(r),e.name===o1.AcquireTokenPreRedirect&&this.appInsights.flush()}}let o8=[o1.InitializeClientApplication,o1.LocalStorageUpdated],o9=new Set([o1.AcquireTokenSilent,o1.AcquireTokenByCode,o1.AcquireTokenPopup,o1.AcquireTokenRedirect,o1.AcquireTokenPreRedirect,o1.PairwiseBrokerApplicationInitializeBrokering,o1.SsoSilent,o1.EmbeddedClientApplicationSendSSOSilentRequest,o1.EmbeddedClientApplicationSendPopupRequest,o1.EmbeddedClientApplicationSendRedirectRequest,o1.EmbeddedClientApplicationHandleRedirectRequest,o1.EmbeddedClientApplicationSendSilentRefreshRequest,...o8]);class o7{constructor(e,t,r,n){this.logger=t;let o=n?.eventsToEmit?.filter(e=>o9?.has(e))||[...o9];this.perfTelemetryReporter=new o4(e,t,r,o,o8,n?.synthetic,n?.appName,n?.appVersion)}sendCustomEvent(e){this.perfTelemetryReporter.sendCustomEvent(e)}getTelemetryCallback(){return this.logger.trace("TelemetryReporter: Attaching callback to send custom metrics."),this.logger.verbose("TelemetryReporter: Returning callback as telemetry emitted."),e=>{e.forEach(e=>{e.name===o1.AcquireTokenByBroker&&(e.name=e.brokerEventName||e.name,e.isBroker=!0,delete e.brokerEventName,this.logger.verbosePii(`TelemetryReporter: Updated broker event ${JSON.stringify(e)}`,e.correlationId)),this.sendCustomEvent(e)})}}}let ie=[h.AzurePublic,h.AzurePpe];class it extends oG{constructor(e,t){let r;let n="undefined"!=typeof window;if(!t?.disabled&&function(e){return!e.auth.authority||ie.some(t=>e.auth.authority?.indexOf(t.toString())===0)}(e)&&n?super({...e,telemetry:{...e.telemetry,client:r=e.telemetry?.client||new o0(e,new Set(o3),new Map(o2))}}):(super(e),r=new t_),this.performanceClient=r,n){let n=new o7(e.auth.clientId,this.getLogger(),r,t);this.addPerformanceCallback(n.getTelemetryCallback())}}static async createPublicClientApplication(e,t,r){let n=new it(e,t);return await n.initialize({correlationId:r}),n}}var ir=r(223093);async function io(e,t,r,n=!1,o=!1,a=!1){var s;let c={auth:{clientId:t,authority:e,redirectUri:r,navigateToLoginRequestUrl:!0,...a&&{clientCapabilities:["CP1"]}},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loadFrameTimeout:1e4,loggerOptions:{logLevel:i.Trace,loggerCallback:(e,t,r)=>{if(!r)switch(e){case i.Trace:n&&(0,l.Fi)({eventId:"LogInfo",detail:"Msal logger [Trace]: "+t});return;case i.Verbose:n&&(0,l.Fi)({eventId:"LogInfo",detail:"Msal logger [Verbose]: "+t});return;case i.Error:(0,l.Fi)({eventId:"LogInfo",detail:"Msal logger [Error]: "+t});return;case i.Warning:(0,l.Fi)({eventId:"LogInfo",detail:"Msal logger [Warning]: "+t});return;default:return}}}}};return o?s=await oK(c):(s=new it(c,{appName:"M365ChatClient",appVersion:(0,ir.Oo)()}),await s.initialize()),function(){(0,l.Fi)({eventId:"LogInfo",detail:"enable3pCookiesForMsal Start"});let e=document.createElement("meta");e.name="ot",e.httpEquiv="origin-trial",e.content="A4NLtNK3HuEopD6nNE9UU2It7671fXHbApv7lBzJZrAAYgsPDKguJpt1QRby/Xk+7rfOFpGFypgZamyFd18k/QAAAABreyJvcmlnaW4iOiJodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb206NDQzIiwiZmVhdHVyZSI6IlRwY2QiLCJleHBpcnkiOjE3MzUzNDM5OTksImlzVGhpcmRQYXJ0eSI6dHJ1ZX0=",document.head.append(e),(0,l.Fi)({eventId:"LogInfo",detail:"enable3pCookiesForMsal End"})}(),s}var ii=r(69088),ia=r(359135),is=r(690),il=r(493180),ic=r(537103),iu=r(771262);async function id(e,t,r,n,o,i,a,s,l,u){let d=(0,iu._R)();try{let f;(0,c.wX)("immersive-bizchat-msal-loginhint-telemetry")&&(0,il.Q5)(`login hint - loginHint length: ${is.M?.metaOSAppContext?.user?.loginHint?.length}, UPN length: ${n?.toString()?.length}`,t,i);let h={scopes:(0,ii.Xf)(t,l),loginHint:is.M?.metaOSAppContext?.user?.loginHint??n?.toString(),correlationId:d};(0,c.wX)("immersive-bizchat-msal-cache-policy")&&(h.cacheLookupPolicy=tA.nN.Default);try{f=is.M.isMSALRefreshUiPopUpEnabled?await ip(e,h,t,!1,i,u):await ih(e,h,t,i)}catch(r){if(is.M.isMSALRefreshUiPopUpEnabled?(0,il.Q5)("loginUserAndGetMsalToken() - tryLoginPopup() fail",t,i,(0,ii.fP)(r),d):(0,il.Q5)("loginUserAndGetMsalToken() - trySsoSilent() fail",t,i,(0,ii.fP)(r),d),d=(0,iu._R)(),!r||is.M.isMSALRefreshUiPopUpEnabled)throw(0,il.Q5)("loginUserAndGetMsalToken() - first try failed, would not fallback to loginPopup",t,i,(0,ii.fP)(r),d),r;h={scopes:(0,ii.Xf)(t,l),loginHint:is.M?.metaOSAppContext?.user?.loginHint??n?.toString(),correlationId:d},f=await ip(e,h,t,!0,i,u)}if(f?.account){let d=f.account;(0,ii.kb)(e,t,r,d,n?.toString(),(0,c.wX)("immersive-bizchat-msa-support"),o,i,a,s,l,u)}else{let e;(0,il.Q5)("loginUserAndGetMsalToken() - loginPopup failed. loginResponse?.account is empty. ",t,i,void 0,d),f?(e.errorCode="loginpopup_response_no_useraccount",e.errorMessage="loginPopup returned response without userAccount"):(e.errorCode="loginpopup_response_null",e.errorMessage="loginPopup returned empty response"),o(e,null)}}catch(e){(0,il.Q5)("loginUserAndGetMsalToken() - Failed to fetch MSAL Token",t,i,(0,ii.fP)(e),d),e?.errorCode!=="popup_window_error"||is.M.isMSALRefreshUiPopUpEnabled||((0,il.Q5)("loginUserAndGetMsalToken() - get popup_window_error error, enabled Poup",t,i,void 0,d),(0,ia.H)(!0)),o(e,null)}}async function ih(e,t,r,n){(0,il.Q5)("loginUserAndGetMsalToken() - start ssoSilent()",r,n,void 0,t?.correlationId);let o=await e.ssoSilent(t);return(0,il.Q5)("loginUserAndGetMsalToken() - ssoSilent() succeeded",r,n,void 0,t?.correlationId),o}async function ip(e,t,r,n,o,i){(0,il.Q5)(`loginUserAndGetMsalToken() - start loginPopup(), isAfterSSOSilentFail: ${n}`,r,o,void 0,t?.correlationId);try{let a=await (0,ii.zd)(e,t,i);return(0,ic.T)(!1),(0,il.Q5)(`loginUserAndGetMsalToken() - loginPopup() succeeded, isAfterSSOSilentFail: ${n}`,r,o,void 0,t?.correlationId),a}catch(e){throw(0,ic.T)(!1),e}}var im=r(366482);let ig=!1;async function iv(e,t,r,i,a,s,l,u,d,f,h,p=!1,m,g){o=is.M.browserId;let v="https://login.microsoftonline.com/";u&&is.M.accountInfo?.accountType==="MSA"?v+="consumers":v+="organizations",void 0===n&&(n=io(v,e,t,p,l,(0,c.wX)("immersive-bizchat-enable-cae")));let b=await n,y=function(e,t,r,n,o){let i;if(t)(0,il.Q5)("Retrieving account using NAA get active account",r,n),i=e.getActiveAccount(),(0,il.Q5)(`Retrieved account using NAA get active account is non-null: ${!!i}`,r,n),(0,c.wX)("immersive-bizchat-msal-loginhint-telemetry")&&(0,il.Q5)(`login hint - loginHint length: ${is.M?.metaOSAppContext?.user?.loginHint?.length}, UPN length: ${o?.toString()?.length}`,r,n),i||(i=e.getAccount({tenantId:ib(),localAccountId:is.M.accountInfo?.objectId,loginHint:is.M.metaOSAppContext?.user?.loginHint}),(0,il.Q5)(`Retrieved account using NAA get account with filter is non-null: ${!!i}`,r,n));else if((0,c.wX)("immersive-bizchat-msal-login-hint-account")&&(0,im.tn)()!==ir.Gu||(0,c.wX)("immersive-bizchat-msal-login-hint-account-mac")&&(0,im.tn)()===ir.Gu){let t=e.getAllAccounts({tenantId:ib(),localAccountId:is.M.accountInfo?.objectId});(0,il.Q5)(`userAccountList count: ${t?.length}`,r,n);let a=t?.filter(e=>!!e?.idTokenClaims?.login_hint);(0,il.Q5)(`validUserAccounts count: ${t?.length}`,r,n),i=a&&a.length>0?a[0]:(0,c.wX)("immersive-bizchat-msal-login-hint-account-fallback")?e.getAccountByUsername(o):null}else i=e.getAccountByUsername(o);return i}(b,l,r,o,s);if((0,c.wX)("immersive-bizchat-msal-detailedlogging")&&y&&(0,il.Q5)("userAccounts is not empty, login_hint length: "+y?.idTokenClaims?.login_hint?.length,r,o),!ig){ig=!0,(0,il.Q5)("handleRedirectPromise() - start",r,o);try{(0,c.wX)("immersive-bizchat-owa-location-hash")?((0,il.Q5)(`msalInstance.handleRedirectPromise() with owaLocationHash - length: ${self.owaLocationHash?.length}`,r,o),await b.handleRedirectPromise(self.owaLocationHash)):await b.handleRedirectPromise()}catch(e){(0,il.Q5)("handleRedirectPromise() - error",r,o,e?.errorCode)}(0,il.Q5)("handleRedirectPromise() - end",r,o)}if(y&&!is.M.isMSALRefreshUiPopUpEnabled)(0,il.Q5)("getTokenFromMsal() - call into getTokenFromMsalInternal()",r,o),(0,ii.kb)(b,r,i,y,s?.toString(),u,a,o,d,f,h,m,g);else{if(g){a(null,null,!0);return}(0,il.Q5)(`getTokenFromMsal() - call into loginUserAndGetMsalToken() - isUserAccountEmpty:${null==y}`,r,o),id(b,r,i,s?.toString(),a,o,d,f,h,m)}}function ib(){return is.M?.accountInfo?.accountType!=="MSA"||(0,c.wX)("immersive-bizchat-disable-fix-msal-tenant")?is.M?.accountInfo?.tenantId:"9188040d-6c67-4c5b-b112-36a304b66dad"}var iy=r(425573),iw=r(377255),iS=r(486353),iC=r.n(iS),iI=r(108547),ik=r(456593),iE=r(320498),i_=r(442976),iA=r(38303);let iT="c0ab8ce9-e9a0-42e7-b064-33d422df41f1",iP=!1,iO=!1,iR=0,ix=0,iM=new Map,iN=function({ttl:e,onUpdate:t,onTimeout:r}){let n={},o=!1,i=null;return Object.defineProperty(n,"value",{get:()=>o,set:n=>{o=n,!0===n?(i&&clearTimeout(i),i=setTimeout(()=>{o=!1,i=null,r?.()},e)):i&&(clearTimeout(i),i=null),t?.()},enumerable:!0,configurable:!0}),n}({ttl:3e5,onTimeout(){(0,l.Fi)({eventId:"LogInfo",detail:"Lock for first MSAL Token request has expired"})}}),iF=new Map,iL=(0,a.r9)({maximumAttempts:20,timeBetweenRetryInMS:()=>10}),iz=(0,a.r9)({maximumAttempts:10,timeBetweenRetryInMS:()=>500}),iD=(0,a.r9)({maximumAttempts:1209600,timeBetweenRetryInMS:()=>500}),iB=(0,a.r9)({maximumAttempts:120960,timeBetweenRetryInMS:()=>500});async function iU(e,t,r,n,o,i,a,s,l){if(n&&performance.mark("bizchat-metaOS-app.FetchTokenStart"+t),iK((0,im.tn)(),is.M.clientType)){let c=(await iH(e,t,r,l,o,i,a,s)).authToken;return iY(t,n),c}if((0,im.tn)()===ir.Hz){let r;return r=(0,c.wX)("immersive-bizchat-fix-fta-token-perf-mark")?await ij(e,t):ij(e,t),iY(t,n),r}{let a=(await iH(e,t,r,l,o,i)).authToken;return iY(t,n),a}}async function iH(e,t,r,n,o,i,a,s){let u=is.M.isMSALRefreshUiPopUpEnabled,d=new Date,f=(0,iu._R)();if(iZ()||is.M.isMSALRefreshUiPopUpEnabled||(0,c.wX)("immersive-bizchat-stop-token-request-tabcache")&&is.M.isCopilotTabCached){(0,l.Fi)({eventId:"Fetch Token",detail:a?"acquire MSAL token in parallel"+e+" isPopUpEnabled:"+is.M.isMSALRefreshUiPopUpEnabled:"Waiting for completion of first MSAL Token request  "+e+" , isMsalFirstRequestBeingProcessed:"+iZ()+" isPopUpEnabled:"+is.M.isMSALRefreshUiPopUpEnabled,message:new Date().getTime(),metaData:JSON.stringify({isCopilotTabCached:is.M.isCopilotTabCached})});try{let h=iD(async()=>{u||(u=is.M.isMSALRefreshUiPopUpEnabled);let s=(0,c.wX)("immersive-bizchat-stop-token-request-tabcache")&&is.M.isCopilotTabCached;return(iP||a)&&!is.M.isMSALRefreshUiPopUpEnabled&&!s?iq(t,e,r,n,void 0,f,o,i,a):Promise.reject(Error("First MSAL Token is not ready yet."))});a&&s?.addEventListener("abort",()=>{iF.clear(),iO=!1,iN.value=!1,h.cancel()});let p=await h.retriableFunc();return(0,l.Fi)({eventId:"LogInfo",detail:a?`Fetch ${t} MSAL Token - Done`:`Fetch ${t} MSAL Token - Done - after waiting for first token`}),iX(e,f,d,u,!0),p}catch(e){return(0,l.Fi)({eventId:"Error",errorMessage:`getTokenFromMsal wait - ${t} Token - throw exception - MSAL`,detail:e.message+`, functionCallId: ${f}`}),l.r7().logCopilotErrorEvent?.({eventId:i_.v.UncaughtError,errorMessage:`getTokenFromMsal wait - ${t} Token - throw exception - MSAL`,clientCorrelationId:is.M.clientCorrelationId}),Promise.reject(new ik.A("Get FetchAccessTokenV2 waiting failed to fetch MSAL auth token",e))}}else{(0,l.Fi)({eventId:"LogInfo",detail:"Fetching MSAL Token - "+e+`, functionCallId: ${f}`}),0!=iR&&new Date().getTime()-iR>3e5&&(iP=!1,iR=0),iO=!0,iN.value=!0;let s=!1;try{let c=(0,iu._R)(),h=1,p=await iz(async()=>{if(u||(u=is.M.isMSALRefreshUiPopUpEnabled),(0,l.Fi)({eventId:"LogInfo",detail:`MSALfetchMSALTokenRetryable - id:${c}, counter:${h++}, functionCallId: ${f}`}),!is.M.isMSALRefreshUiPopUpEnabled)return iq(t,e,r,n,void 0,f,o,i,a);{let e=await iB(async()=>(u||(u=is.M.isMSALRefreshUiPopUpEnabled),!is.M.isMSALRefreshUiPopUpEnabled||(s=!0,Promise.reject(Error("wait for user to click the refresh button."))))).retriableFunc();return Promise.reject(Error('"wait for user to click refesh token" finish. try to get token in next round.'+e))}}).retriableFunc();return iO=!1,iN.value=!1,p.authToken&&iV(),(0,l.Fi)({eventId:"LogInfo",detail:`Fetch ${t} MSAL Token - Done - first token succeed`}),iX(e,f,d,u,s),p}catch(e){return iO=!1,iN.value=!1,(0,l.Fi)({eventId:"Error",errorMessage:`getTokenFromMsal - ${t} Token - throw exception - MSAL`,detail:e.message+`, functionCallId: ${f}`}),Promise.reject(new ik.A("Get FetchAccessTokenV2 failed to fetch MSAL auth token",e))}}}async function iq(e,t,r,n,o,i,a,u,d){let f=(0,iy.resolve)((0,s.$z)(),"/semanticoverview/m365ChatSSO"),h=(0,c.wX)("immersive-bizchat-enable-cae-parsing")?u&&function(e,t,r){let n=e.get("WWW-Authenticate"),o=n?function(e){let t;let r={},n=/(\w+)="([^"]*)"/g;for(;null!==(t=n.exec(e));){let e=t[1],n=decodeURI(t[2]);r[e]=n}return r}(n).claims:void 0;if(o)try{return atob(o)}catch{(0,l.Fi)({eventId:"LogInfo",detail:`Failed to parse claims for token ${t}, functionCallId: ${r}`})}}(u,e,i):"";h&&(0,l.Fi)({eventId:"LogInfo",detail:`CAE header found for ${e} - authChallenge successfully parsed`});try{let s=new Date().getTime();(0,l.Fi)({eventId:"Fetch Token",dynamicEventPart:`Fetch ${e} MSAL Token - Start`,detail:`functionCallId: ${i}`});let u=await (()=>{var s;let u="";if((0,c.wX)("immersive-bizchat-msal-token-req-throttle")&&(s={clientId:iT,redirectUri:f,resource:t,authChallenge:h??"",userPrincipalName:is.M.accountInfo?.accountUpn??"",nestedAppAuthEnabled:iK(),consentRequired:r,scopes:n,detailedLoggingEnabled:(0,c.wX)("immersive-bizchat-msal-detailedlogging")},u=JSON.stringify(s),iF.has(u))){let t=iF.get(u);if(t&&t.expiration>Date.now())return(0,l.Fi)({eventId:"LogInfo",detail:`Fetch ${e} MSAL Token - found cached token request`}),t.result}let p=new Promise((s,u)=>{let p=function(e){let t=ix++;return(0,c.wX)("immersive-bizchat-stop-token-request-tabcache")&&iM.set(t,e),t}(u);iv(iT,f,t,h??"",(t,r,n)=>{r?((0,l.Fi)({eventId:"LogInfo",detail:`getTokenFromMsal - ${e} Token - succeed. refreshUIButtonClicked: ${o}, functionCallId: ${i}, correlationId: ${r?.correlationId}, requestId: ${r?.requestId}`}),iJ(p),s(r)):(d?n?(0,l.Fi)({eventId:"LogInfo",errorMessage:`getTokenFromMsal - ${e} Token - early return for parallize scenario. refreshUIButtonClicked: ${o}, functionCallId: ${i}, correlationId: ${t?.correlationId}`,detail:t?t.message:""}):(0,l.Fi)({eventId:"Error",errorMessage:`getTokenFromMsal - ${e} Token - failed to parallel get token . refreshUIButtonClicked: ${o}, functionCallId: ${i}, correlationId: ${t?.correlationId}`,detail:t?t.message:""}):(0,l.Fi)({eventId:"Error",errorMessage:`getTokenFromMsal - ${e} Token - fail to get token. refreshUIButtonClicked: ${o}, functionCallId: ${i}, correlationId: ${t?.correlationId}`,detail:t?t.message:""}),iJ(p),u(t))},is.M.accountInfo?.accountUpn??"",iK(),(0,c.wX)("immersive-bizchat-msa-support"),e,r,n,(0,c.wX)("immersive-bizchat-msal-detailedlogging"),a,d).catch(t=>((0,l.Fi)({eventId:"Error",errorMessage:`getTokenFromMsal - ${e} Token - throw exception. refreshUIButtonClicked: ${o}`,detail:t.message+`, functionCallId: ${i}`}),Promise.reject(new ik.A("Copilot fails to fetch MSAL auth token",t))))});return(0,c.wX)("immersive-bizchat-msal-token-req-throttle")&&(iF.set(u,{result:p,expiration:Date.now()+3e4}),function(){try{let e=Date.now();iF.forEach((t,r)=>{t.expiration<e&&iF.delete(r)})}catch(e){(0,l.Fi)({eventId:"LogInfo",detail:"Fail to clean up MSAL token cache"})}}()),p})(),p=u?.accessToken;if(null==p||""===p)return(0,l.Fi)({eventId:"Error",errorMessage:`Fetch ${e} MSAL Token - Return null`}),Promise.reject(Error("Copilot fails to fetch MSAL auth token, token is empty"));return(0,l.Fi)({eventId:"Fetch Token",dynamicEventPart:`Fetch ${e} MSAL Token - Finish - `,latency:new Date().getTime()-s,detail:`ExpireOn: ${u?.expiresOn?.toISOString()}, functionCallId: ${i}`}),{authResponse:u,authToken:p}}catch(t){return(0,l.Fi)({eventId:"Error",errorMessage:`Fetch ${e} MSAL Token - Error: ${t.message}`}),Promise.reject(new ik.A("Copilot fails to fetch MSAL auth token, throw exception",t))}}async function ij(e,t){try{(0,l.Fi)({eventId:"Fetch Token",dynamicEventPart:`Fetch '${t}' FTA Token for resource '${e}' - Start`});let r=new Date,n=0,o=await iL(async()=>{n++;let r=await i$(e);if(r){if((0,c.wX)("immersive-bizchat-teams-fta-fix-mismatch-token"))try{let t=iC()(r),o=t?.aud?.toString()??"";if(o&&o.toLowerCase().indexOf("http")>=0&&iW(o.toLowerCase())!==iW(e.toLowerCase()))return(0,l.Fi)({eventId:"Error",errorMessage:`actual resource '${o}' and expected source '${e}' don't match for FullTrustAuth, retry Counter: ${n}`}),Promise.reject(Error("actual resource and expected source DO NOT match."))}catch{(0,l.Fi)({eventId:"Error",errorMessage:`fail to parse token for resource '${e}', retry Counter: ${n}`})}return r}return(0,l.Fi)({eventId:"Fetch Token",dynamicEventPart:`Fetch '${t}' FTA Token for resource '${e}' - Retry`,detail:`retry Counter: ${n}`}),Promise.reject(Error("FTA Token is empty."))}).retriableFunc();if(null==o||""===o)return(0,l.Fi)({eventId:"Error",errorMessage:`Fetch '${t}' FTA Token for resource '${e}' - Return null`}),Promise.resolve("");let i=new Date().getTime()-r.getTime();return(0,l.Fi)({eventId:"Fetch Token",dynamicEventPart:`Fetch '${t}' FTA Token for resource '${e}' with latency: ${i} - Success`,latency:i}),o}catch(r){return(0,l.Fi)({eventId:"Error",errorMessage:`Fetch '${t}' FTA Token for resource '${e}' - Error: ${r.message}`}),Promise.resolve("")}}async function i$(e,t){let r=(0,iu._R)(),n="";n=(0,im.tn)()===ir.Hz?void 0===e?iW((0,s.$z)()):e:iW(e??(0,s.$z)()),(0,l.Fi)({eventId:"Fetch Token",dynamicEventPart:`getHubToken resource: '${n}'`,detail:`functionCallId: ${r}`});let o={resources:[n]};t&&(o.claims=[t]);let i="",a=0;try{i=await iL(async()=>(a++,await iw.getAuthToken(o)||((0,l.Fi)({eventId:"Fetch Token",dynamicEventPart:"Fetch Hub Token - Retry",detail:`functionCallId: ${r}, attemptCounter: ${a}`}),Promise.reject(Error("Hub Token is empty"))))).retriableFunc()}catch(e){throw(0,l.Fi)({eventId:"Error",errorMessage:"Fetch Hub Token - fetchTokenRetryable fail",detail:`functionCallId: ${r}`}),e}if(!i)return(0,l.Fi)({eventId:"Error",errorMessage:"Fetch Hub Token - Return null",detail:`functionCallId: ${r}`}),Promise.resolve("");let c=0;try{c=iC()(i)?.exp??0}catch(e){(0,l.Fi)({eventId:"Fetch Token",dynamicEventPart:`Not an error: Unable to decode the token for resource: ${n}`,detail:`functionCallId: ${r}, errorMessage: ${e.message}`}),c=Date.now()+3e5}return(0,l.Fi)({eventId:"LogInfo",detail:`getHubToken success - resource: ${n}, TokenLength: ${i?.length}, TokenExpiry: ${c}, functionCallId: ${r}`}),i}function iW(e){return e.length>0&&"/"!==e[e.length-1]?e+"/":e}async function iV(){iP=!0,(0,iI.$)(!0),0==iR&&(iR=new Date().getTime())}async function iG(){iO=!1,iN.value=!1}function iK(e,t){return!!(0,iE.Fh)()&&(e===ir.Hz&&t?.toLowerCase()==="web"?(0,c.wX)("immersive-bizchat-nested-app-auth-teamsweb"):(0,c.wX)("immersive-bizchat-nested-app-auth"))}function iX(e,t,r,n,o){let i=new Date().getTime()-r.getTime();(0,l.Fi)({eventId:"LogInfo",detail:`MsalLatency - ${e} - functionCallId:${t} - latency: ${i} - hasRefreshUIEverShowed:${n}`,message:`hasWaited:${o}`})}function iY(e,t){t&&performance.mark("bizchat-metaOS-app.FetchTokenEnd"+e)}function iZ(){return!(0,c.wX)("immersive-bizchat-bypass-msal-first-req-lock")&&((0,c.wX)("immersive-bizchat-msal-first-req-lock-timeout")?iN.value:iO)}function iQ(){(0,c.wX)("immersive-bizchat-stop-token-request-tabcache")&&(function(){try{let e=Error("cancel unsettled token requests");for(let[t,r]of iM)r(e);(0,l.Fi)({eventId:"LogInfo",detail:"cancel unsettled token requests with size:"+iM.size}),iM.clear(),iF.clear()}catch{(0,l.Fi)({eventId:"LogInfo",detail:"fail to cancel unsettled token requests"})}}(),(0,iA.f)(!1))}function iJ(e){(0,c.wX)("immersive-bizchat-stop-token-request-tabcache")&&iM.delete(e)}},634091:(e,t,r)=>{"use strict";let n,o,i,a;r.d(t,{l:()=>p,x:()=>h});var s=r(643108),l=r(654018);function c(){return w("scriptVer")}function u(){return n??(n=m(w("devCdnUrl")))}function d(e,t){let r=function(){let e=w("devCdnUrl");if(m(e))return e}();if(r)return r;let n=w(t?"backupCdnUrl":"cdnUrl"),o=w("cdnContainer");if(m(n)&&m(o))return n+o+((e?void 0:w("hashedPath"))||c())+"/";let i=C();return(t?i.BackupBaseUrl:i.PackageBaseUrl)+(u()?"":c()+"/"+((0,l.b)("debugJs")?"debug/":""))}let f=[void 0,void 0];function h(e){var t;return f[t=e?0:1]??(f[t]=y(d(e)+g()))}function p(e){return y(d(e,!0)+g())}function m(e){return!!e&&e.indexOf("/")>-1}function g(){let e=w("scriptPath");return m(e)?e:C().ScriptPath}let v=()=>(void 0===i&&(i=window?.location?.protocol||"https:"),i),b=RegExp("^https?:");function y(e){return b.test(e)||(e=v()+e),e}function w(e){return(0,s.x)(e)||""}let S="owamail/";function C(){if(!a){let e="2"==(0,l.j)("bO"),t=I()+S,r=I(!0)+S,n=(0,s.x)("baseUrl");u()&&n&&(t=r=n),a={PackageBaseUrl:e?r:t,ExtraSettings:{},BackupBaseUrl:e?t:r,ResourcesPath:"",ScriptPath:o??(o=!!w("devCdnUrl")&&!new URL(y(w("devCdnUrl"))).pathname?.split("/").filter(e=>e)[0]?.endsWith("-branch"))?"":"scripts/"}}return a}function I(e){let t=e?2:1,r=!0,n=(0,s.x)("scriptVer");n&&-1===n.indexOf(".")&&(r=!1);let o=r?`res-${t}`:`res-${t}-sdf`;return"Gallatin"==function(){let e=((0,s.x)("environment")||"").toLowerCase();return E.filter(t=>t.toLowerCase()===e)[0]||"Unknown"}()?`//outlook-${t}.cdn.partner.outlook.cn/`:`//${o}.cdn.office.net/`}var k=(e=>(e.Unknown="Unknown",e.AG08="AG08",e.AG09="AG09",e.BlackForest="BlackForest",e.DITAR="DITAR",e.DoD="DoD",e.Dogfood="Dogfood",e.Gallatin="Gallatin",e.GCCModerate="GCCModerate",e.GccHigh="GccHigh",e.GovCloud="GovCloud",e.ITAR="ITAR",e.Prod="Prod",e))(k||{});let E=["Unknown","AG08","AG09","BlackForest","DITAR","DoD","Dogfood","Gallatin","GCCModerate","GccHigh","GovCloud","ITAR","Prod"]},324233:(e,t,r)=>{"use strict";r.d(t,{q:()=>c});class n{constructor(e){this.result=e}then(e,t){try{let t=e(this.result);return o(t)?t:Promise.resolve(t)}catch(e){return new Promise((t,r)=>r(e))}}catch(e){return this}toString(){return"QP"}finally(e){try{return e(),o(this.result)?this.result:Promise.resolve(this.result)}catch(e){return new Promise((t,r)=>r(e))}}}function o(e){return e?.then&&"function"==typeof e.then}let i=0;var a=r(848398),s=r(412145);let l=/function\s*\(.*\)\s*{\s*return [^.]*([^;]*.*)}/;class c{constructor(e,t,r){this.lazyModule=e,this.getter=t,this.shouldGovern=r,this.pendingImports=0,this.defaultRetryOptions={maximumAttempts:3,timeBetweenRetryInMS:1e3,timeoutInMS:5e3},this.import=e=>{if(!this.importPromise){let t;try{t=this.lazyModule.importModule(this.shouldGovern?"LazyGovernImport":"LazyImport",e||"LazyImport",this.getName()),this.importPromise=t.then(e=>{var t;return this.importValue=this.getter(e),this.importPromise=(t=this.importValue,new n(t)),(0,a.zj)().markImportAsLoaded(this.id),this.pendingImports=0,this.importValue}).catch(e=>{throw this.importPromise=void 0,this.pendingImports=0,e})}catch(e){this.importPromise=Promise.reject(e)}}return this.pendingImports++,this.importPromise},this.importWithRetry=(e,t)=>{let r={...this.defaultRetryOptions,...t},n=(0,s.r9)({maximumAttempts:r.maximumAttempts,timeBetweenRetryInMS:"function"==typeof r.timeBetweenRetryInMS?r.timeBetweenRetryInMS:()=>r.timeBetweenRetryInMS}),o=()=>this.import(e);return r.timeoutInMS?n(()=>(0,s.MK)(o(),r.timeoutInMS)).retriableFunc():n(o).retriableFunc()},this.id=(i++).toString()}dangerouslyImportSync(){if(!this.isLoaded())throw Error("Import is not available yet.");return this.importValue}tryImportForRender(){if((0,a.zj)().isImportLoaded(this.id))return this.importValue;this.import()}isLoaded(){return(0,a.zj)().isImportLoaded(this.id)}getName(){let e=this.getter.toString();try{let t=e.match(l);return t&&t.length>1?t[1]:e}catch{return e}}}},654470:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>l});var n=r(634091),o=r(848398),i=r(773509),a=r(643108);let s=class{constructor(e,t){this.importCallback=e,this.options=t,this.isLoaded=!1,this.attempts=0,this.failedRetries=0,this.pendingImports=0}importModule(e,t,r){return this.promise||(this.promise=new Promise((n,a)=>{(this.options?.runWhen||i.En)(async()=>{let i=!this.options?.maxFailedRetries||this.failedRetries<this.options.maxFailedRetries;this.attempts=0,s.outstandingImports++;let l=this.options?.name,c=t?`becuase of ${t} ${r}`:`directly with source ${e}`;for((0,o.zj)().trace(`${l?`[${l}]`:""}LazyModule started to download ${c}, outstanding imports: ${s.outstandingImports}`);!this.isLoaded&&this.attempts<5&&i;)try{await this.loadModule(n,e)}catch(e){await this.onLoadFailed(e,a)}s.outstandingImports--},"LazyImport"!=e||!!this.options?.govern,this.options?.prioritize)})),!this.isLoaded&&this.pendingImports++,this.promise}getIsLoaded(){return this.isLoaded}getUrl(e){return 5-e<=1?(0,n.l)():(0,n.x)()}async loadModule(e,t){var o,i;let s=self.performance.now();o=this.getUrl(this.attempts++),r.p=o;let l=this.importCallback(),f=this.options?.name;Object.values(d).map(e=>e(l,f)),i=(0,n.x)(),r.p=i;let h=await l,p=s&&self.performance.now()-s;p&&u.push({start:s,duration:p,attemps:this.attempts}),this.options?.initializer&&this.options.initializer(h)(),e(h),(0,a.C)()&&"object"==typeof h&&"LazyImport"!=t&&c.push(t),this.isLoaded=!0,this.pendingImports=0}async onLoadFailed(e,t){let r=this.options?.name;if((0,o.zj)().trace(`${r?`[${r}]`:""}LazyModule failed to load ${e?.message||e}`),this.failedRetries++,e.request){if(this.attempts>=5){let r="Failed to load javascript.";e.httpStatus&&(r+="Status:"+e.httpStatus),t(Error(r)),this.pendingImports=0,this.promise=void 0}else{var n,i;this.attempts>1&&await (n=1e3*Math.pow(2,this.attempts-2),Promise.resolve(void 0)===i&&i.catch(()=>{}),new Promise((e,t)=>{setTimeout(e,n,i)}))}}else e.scriptEval=!0,(0,o.zj)().logError(e),this.isLoaded=!0,e.reported=!0,t(e)}},l=s;l.outstandingImports=0;let c=[],u=[];var d={}},848398:(e,t,r)=>{"use strict";r.d(t,{zj:()=>i});let n={},o={markImportAsLoaded:e=>{n[e]=!0},isImportLoaded:e=>n[e],logError:()=>{},trace:()=>{}};function i(){return o}},773509:(e,t,r)=>{"use strict";r.d(t,{En:()=>a,t5:()=>s});var n=r(848398);let o=[],i=!1;function a(e,t,r){let{govern:a}=(0,n.zj)(),s=()=>a&&t?a(e):e();i?s():r?o.unshift(s):o.push(s)}function s(){i=!0;for(var e=0;e<o.length;e++)o[e]();o=[]}},223093:(e,t,r)=>{"use strict";let n;r.d(t,{Ah:()=>u,EO:()=>d,Gu:()=>f,Hz:()=>s,NC:()=>c,OB:()=>g,Oo:()=>b,Sl:()=>l,W_:()=>a,dg:()=>h,hz:()=>v,iq:()=>k,mW:()=>I,mg:()=>C,s6:()=>i});var o=r(643108);let i="native",a="win32outlookhub",s="teamshub",l="owahub",c="monarchhub",u="officeweb",d="officedesktop",f="macoutlookhub",h="edgeweb";var p=(e=>(e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.FirstRelease="FirstRelease",e.WW="WW",e.Unknown="Unknown",e))(p||{}),m=(e=>(e[e.hub="hub"]="hub",e[e.teamshub=s]="teamshub",e[e.win32outlookhub=a]="win32outlookhub",e[e.monarchhub=c]="monarchhub",e[e.owahub=l]="owahub",e[e.officeweb=u]="officeweb",e[e.officedesktop=d]="officedesktop",e[e.macoutlookhub=f]="macoutlookhub",e[e.edgeweb=h]="edgeweb",e))(m||{});function g(){return v()?n:""}function v(){return window?.location?.pathname?.indexOf("/hosted")==0}function b(){return(0,o.x)("scriptVer")||""}let y=["teams","teamsmodern","outlook","outlookwin32","office","edge"],w=["desktop","web","macos"],S=["hub",s,a,c,l,u,d,f,h];function C(e,t){let r="Unknown",n=e?.toLowerCase()||"",o=t?.toLowerCase()||"";return e&&y.includes(n)&&t&&w.includes(o)?"teams"===n||"teamsmodern"===n?r=s:"outlookwin32"===n?r=a:"outlook"===n?"desktop"===o?r=c:"web"===o?r=l:"macos"===o&&(r=f):"office"===n?"desktop"===o?r=d:"web"===o&&(r=u):r="edge"===n?h:"hub":r="hub",r}function I(e,t){(!n||n==S[0])&&v()&&(n=C(e,t))}function k(){return n}},859645:(e,t,r)=>{"use strict";r.d(t,{P5:()=>u,Ue:()=>c,fF:()=>d});var n=r(366482),o=r(574221),i=r(654018),a=r(467439),s=r(858881),l=r(266143);function c(){a.mI!==s.mI&&u("m365-chat-loader version does NOT match m365-blaze-loader version")}function u(e){if("Dogfood"===(0,n.K)()&&(0,i.j)("branch")&&(0,o.wX)("immersive-bizchat-block-pr-build")&&!(0,o.wX)("immersive-bizchat-disabled-pr-build-crash")){let t=window.document.getElementById("app");if(t){let r=t.parentElement;r?.removeChild(t),r?.appendChild(document.createTextNode("[BizChat MetaOS app] You are using a client-web PR build version, seem like your PR may cause some issue. Error Message: "+e))}}}function d(){(0,l.X)(window,"BizChatAppLoadStartSignal")}},574221:(e,t,r)=>{"use strict";r.d(t,{We:()=>u,YX:()=>i,Zb:()=>f,_2:()=>c,cM:()=>d,mM:()=>l,s:()=>s,wX:()=>a});var n=r(690),o=r(654018);let i=["immersive-bizchat-session-panel-sdf","immersive-bizchat-try-these-prompts-sept06","immersive-bizchat-proactive-carousel-card","immersive-bizchat-stay-on-top","immersive-bizchat-entities","immersive-bizchat-entities-hero","immersive-bizchat-entities-hover","immersive-bizchat-entities-hero-people","immersive-bizchat-entities-hover-people","immersive-bizchat-entities-hover-external","immersive-bizchat-entities-hero-event","immersive-bizchat-entities-hero-event-actions","immersive-bizchat-entities-hover-event","immersive-bizchat-entities-hover-event-actions","immersive-bizchat-entities-hero-file","immersive-bizchat-entities-hover-file","immersive-bizchat-entities-file-preview-thumbnail","immersive-bizchat-entities-file-hover-preview-thumbnail","immersive-bizchat-entities-message-extensions","immersive-bizchat-entities-external-api-plugin","immersive-bizchat-entities-disable-rendering","immersive-bizchat-entities-hero-stream","immersive-bizchat-entities-contextualprompts","immersive-bizchat-automate","immersive-bizchat-analytics-skill","immersive-bizchat-handoff-sydney-outlookmailto","immersive-bizchat-handoff-sydney-outlooksplitbutton","immersive-bizchat-handoff-buttons","immersive-bizchat-allow-url-override","immersive-bizchat-ciq-chat-entities","immersive-bizchat-ciq-email-entities","immersive-bizchat-ciq-topic-entities","immersive-bizchat-ciq-topic-ecc","immersive-bizchat-ciq-hybrid-workflows","immersive-bizchat-ciq-mark-source-inserted-delta","immersive-bizchat-streaming-cursor","immersive-bizchat-3p-extensibility","immersive-bizchat-3p-extensibility-teams","immersive-bizchat-3p-extensibility-owa","immersive-bizchat-3p-extensibility-office","immersive-bizchat-3p-more-plugins-teams","immersive-bizchat-3p-more-plugins-owa","immersive-bizchat-3p-more-plugins-office","immersive-bizchat-3p-plugins-search-teams","immersive-bizchat-3p-plugins-search-owa","immersive-bizchat-3p-plugins-search-office","immersive-bizchat-3p-manage-plugins-teams","immersive-bizchat-3p-manage-plugins-owa","immersive-bizchat-3p-manage-plugins-office","immersive-bizchat-3p-store-front-plugins-teams","immersive-bizchat-3p-store-front-plugins-owa","immersive-bizchat-3p-store-front-plugins-office","immersive-bizchat-3p-flyout-preview-teams","immersive-bizchat-3p-flyout-user-settings","immersive-bizchat-plugin-flyout-fre","immersive-bizchat-plugin-flyout-v2","immersive-bizchat-3p-plugins","immersive-bizchat-ppdv-plugins","immersive-bizchat-feedback-sdk","immersive-bizchat-testhotfix-sydney-url","immersive-bizchat-pl-explore-more-button","immersive-bizchat-responsive-expanded-ecc","immersive-bizchat-no-preview-label","immersive-bizchat-msal-login-hint-account","immersive-bizchat-msal-login-hint-account-mac","immersive-bizchat-msal-login-hint-account-fallback","immersive-bizchat-owa-location-hash","immersive-bizchat-msal-cache-policy","immersive-bizchat-disabled-pr-build-crash","immersive-bizchat-block-pr-build","immersive-bizchat-puid-sydney","immersive-bizchat-allow-fetch-outlook-token","immersive-bizchat-allow-fetch-ams-token-for-msa","immersive-bizchat-no-3s-token-to-sydney","immersive-bizchat-sensitivity-label","immersive-bizchat-enable-shared-prompt-library-component","immersive-bizchat-enabled-pl-new-entry-point","immersive-bizchat-ciq-refresh","immersive-bizchat-enable-l2-suggestions","immersive-bizchat-enable-new-file-tidbits","immersive-bizchat-enable-sydney-prompt-id-prop","immersive-bizchat-show-sydney-latency-metrics","immersive-bizchat-avalon-endpoint","immersive-bizchat-source-attributions-avalon","immersive-bizchat-rehydrate-recent-session","immersive-bizchat-ciq-people-entity-id-v2","immersive-bizchat-send-trace-id-in-feedback","immersive-bizchat-hydrated-entities","immersive-bizchat-reference-list-v2","immersive-bizchat-citations-during-streaming","immersive-bizchat-web-toggle-fre","immersive-bizchat-web-toggle-fre-always-shown","immersive-bizchat-limit-input-text-char-count-2000","immersive-bizchat-limit-input-text-char-count-4000","immersive-bizchat-limit-input-text-char-count-16000","immersive-bizchat-limit-input-text-char-count-128000","immersive-bizchat-remove-limit-input-text-char-count","immersive-bizchat-send-conv-id-for-new-chat","immersive-bizchat-chathub-connection-timeout-30s","immersive-bizchat-enable-log-prompt-id","immersive-bizchat-sessions-ui-experimental","immersive-bizchat-sessions-api-experimental","immersive-bizchat-3s-init-request","immersive-bizchat-header-dcr","immersive-bizchat-ciq-oa-result-timeout-7-and-half-seconds","immersive-bizchat-chat-input-auto-focus","immersive-bizchat-chat-input-transform-spo-file-url","immersive-bizchat-chat-input-placeholder-ground-your","immersive-bizchat-chat-input-placeholder-insert-people","immersive-bizchat-chat-input-placeholder-lets-you-ref","immersive-bizchat-layout-maxwidth-900","immersive-bizchat-enable-meeting-banner","immersive-bizchat-sessions-pin","immersive-bizchat-perf-preload-runtime","immersive-bizchat-sw-verify-cache","immersive-bizchat-app-initialize-async","immersive-bizchat-prompt-saving","immersive-bizchat-prompt-saving-hydrated-entities","immersive-bizchat-prompt-editing","immersive-bizchat-prompt-sharing","immersive-bizchat-prompt-sharing-dialog","immersive-bizchat-enable-ux-alignment-changes","immersive-bizchat-enable-placeholder-tag","immersive-bizchat-enable-pl-header-footer","immersive-bizchat-enable-close-pld","immersive-bizchat-enable-view-prompts-text","immersive-bizchat-prompt-response-sharing","immersive-bizchat-enable-side-pane-feedback","immersive-bizchat-topics-reference","immersive-bizchat-esc-return-focus-to-teams","immersive-bizchat-teams-focus-on-load-hack","immersive-bizchat-feed-cards-in-ttp","immersive-bizchat-sidepane-openonload","immersive-bizchat-enable-feedback-screenshot-side-pane","immersive-bizchat-iseurope-logging","immersive-bizchat-enable-ttp-prefetch","immersive-bizchat-no-token-block-3s-requests","immersive-bizchat-enable-windowevent-logging","immersive-bizchat-enable-searchbar","immersive-bizchat-block-chat-input","immersive-bizchat-log-phase-one-duration","immersive-bizchat-eu-logging-update","immersive-bizchat-enable-3S-events-logging","immersive-bizchat-enable-tag-extra-space","immersive-bizchat-enable-planner-handoff","immersive-bizchat-enable-calendar-handoff","immersive-bizchat-enable-gradient-placeholder","immersive-bizchat-enable-ecc-people-scope","immersive-bizchat-enable-rtl","immersive-bizchat-fluentai-feedback-buttons","immersive-bizchat-fluentai-message-controls","immersive-bizchat-fluentai-suggestions-list","immersive-bizchat-hide-feedback-thumbs-abort","immersive-bizchat-enable-feedback-diagnostics-id","immersive-bizchat-enable-console-logging","immersive-bizchat-enable-pacman-logging","immersive-bizchat-enable-new-launch-option-decoding","immersive-bizchat-enable-trace-id-in-old-message-fix","immersive-bizchat-prompt-ring-tag","immersive-bizchat-enable-restricted-search-testing","immersive-bizchat-enable-handin-prompt-from-launch-url","immersive-bizchat-enable-handin-prompt-from-launch-url-teams","immersive-bizchat-ocps-null-token","immersive-bizchat-enable-bing-answer","immersive-bizchat-scs-client-correlation-id","immersive-bizchat-ciq-bootstrap-v2","immersive-bizchat-enable-web-toggle-by-default","immersive-bizchat-sydney-response-unpack-v2","immersive-bizchat-sydney-telemetry-ids","immersive-bizchat-sydney-throttle-streaming","immersive-bizchat-sydney-traffic-type","immersive-bizchat-teams-fta-fix-mismatch-token","immersive-bizchat-disable-m365chat-alt-element","immersive-bizchat-blaze-feature","immersive-bizchat-blaze-feature-bypass-url","immersive-bizchat-blaze-as-prod-traffic","immersive-bizchat-blaze-cache-ttp-local","immersive-bizchat-parse-cdn-version","immersive-bizchat-stop-token-request-tabcache","immersive-bizchat-log-key-latency","immersive-bizchat-log-more-key-latency","immersive-bizchat-react-new-root","immersive-bizchat-servicedelivery-manifest-emergency-shutdown","immersive-bizchat-log-ecs-headers","immersive-bizchat-msal-loginhint-telemetry","immersive-bizchat-send-custom-telemetry","immersive-bizchat-timeout-acquire-token-slient","immersive-bizchat-ciq-teaching-moment-experiment","immersive-bizchat-msal-detailedlogging","immersive-bizchat-nested-app-auth","immersive-bizchat-nested-app-auth-teamsweb","immersive-bizchat-feedback-send-session-id","immersive-bizchat-feedback-sidepane-3s","immersive-bizchat-enable-loop-handoff","immersive-bizchat-enable-spark-text","immersive-bizchat-image-option-set","immersive-bizchat-image-v1-option-set","immersive-bizchat-image-v2-option-set","immersive-bizchat-enable-gzip-decompression","immersive-bizchat-enable-teams-theme-cache","immersive-bizchat-gpt","immersive-bizchat-gpt-demo-tenant","immersive-bizchat-enable-cache-remove-dom","immersive-bizchat-enable-prompt-suggestions-api-ttp","immersive-bizchat-enable-sticky-session-panel","immersive-bizchat-enable-toolbox-for-teams","immersive-bizchat-enable-toolbox-with-multi-turn-support-for-teams","immersive-bizchat-enable-api-plugins-auth-skill","immersive-bizchat-enable-confirmation-dialog-skill","immersive-bizchat-enable-client-skill","immersive-bizchat-enable-harmony-bce","immersive-bizchat-enable-harmony-bce-v1","immersive-bizchat-enable-web-tab-v2","immersive-bizchat-enable-codex-web-tab","immersive-bizchat-enable-search-msg-ext-via-toolbox","immersive-bizchat-enable-plugins-as-declarative-agents","immersive-bizchat-enable-action-msg-ext-skill","immersive-bizchat-latency-ux-cards","immersive-bizchat-enable-gpt4o-model-reasoning","immersive-bizchat-enable-gpt4o-model-responding","immersive-bizchat-enable-catchup-bold","immersive-bizchat-entities-contextual-prompts-on-hero-card","immersive-bizchat-toolbox-with-skdsstore","immersive-bizchat-enable-stay-on-top-v2","immersive-bizchat-enable-logging-refactoring","immersive-bizchat-m365-chat-action-callbacks-metaos","immersive-bizchat-performance-loglongTasks","immersive-bizchat-enable-app-load-time-in-debug-tool","immersive-bizchat-msal-first-req-lock-timeout","immersive-bizchat-bypass-msal-first-req-lock","immersive-bizchat-msal-token-req-throttle","immersive-bizchat-fix-fta-token-perf-mark","immersive-bizchat-enable-perf-lazy-chunks-owa-with-retry","immersive-bizchat-enable-editor-state-refresh","immersive-bizchat-fetch-designer-token-using-lazyfetchAccessToken","immersive-bizchat-enable-sydney-warmup-on-input","immersive-bizchat-enable-sydney-warmup-on-load","immersive-bizchat-enable-send-sydney-latency-metrics","immersive-bizchat-enable-handoff-response-action-processing","immersive-bizchat-enable-cdp-logging","immersive-bizchat-enable-msg-ext-auth-skill","immersive-bizchat-enable-logging-immersivebizchat-merge","immersive-bizchat-websearch-policy","immersive-bizchat-enable-non-teams-caching","immersive-bizchat-enable-cae-parsing","immersive-bizchat-enable-cae","immersive-bizchat-enable-cae-graph","immersive-bizchat-enable-cae-sydney","immersive-bizchat-enable-cae-spo","immersive-bizchat-enable-prefetch-all-msal-access-tokens","immersive-bizchat-context-appsessionid","immersive-bizchat-enable-cwc-cdp-logging","immersive-bizchat-enable-cdp-copilot-error-logging","immersive-bizchat-enable-teams-starter","immersive-bizchat-enable-outlook-starter","immersive-bizchat-enable-calipso-dispatcher-fix","immersive-bizchat-enable-calipso-add-flightsvalue","immersive-bizchat-enable-calipso-add-metadatavalues","immersive-bizchat-eligibility-emergency-mock","immersive-bizchat-msa-support","immersive-bizchat-msa-support-3s","immersive-bizchat-msa-support-pacman","immersive-bizchat-disable-fix-msal-tenant","immersive-bizchat-enable-substrate-tenant-id-and-msa-scenario-name","immersive-bizchat-cps-local-storage","immersive-bizchat-spo-token-v3","immersive-bizchat-eligibility-gcc-mock","immersive-bizchat-eligibility-gcc-nomock","immersive-bizchat-enable-storage-license-check","immersive-bizchat-enable-gpt-prefetch-admin-flag","immersive-bizchat-use-weighted-endpoints","immersive-bizchat-enable-ppc-auth-skill","immersive-bizchat-fix-eligibility-fetch","immersive-bizchat-reorder-steps","immersive-bizchat-delay-low-priority-tasks","immersive-bizchat-enable-copilot-cache-reload","immersive-bizchat-enable-copilot-cache-reload_ten_seconds"];function a(e){return!!n.M?.featureFlags&&!!e&&void 0!==n.M.featureFlags[e]&&(n.M.featureFlags[e]??!1)}function s(e){return a(e)||o.j("M365ChatFeatures")?.indexOf(e)>=0}function l(e){return!!n.M?.featureFlags&&!!e&&void 0!==n.M.featureFlags[e]&&(n.M.featureFlags[e]??!1)}function c(e,t){try{if(!e)return!1;let r={};for(let[t,n]of Object.entries(e))r[t]=n;return r[t]??!1}catch{}return!1}function u(){let e=[];return n.M?.featureFlags&&Object.keys(n.M.featureFlags).forEach(t=>{t.indexOf("immersive-bizchat")>=0&&n.M.featureFlags&&n.M.featureFlags[t]&&e.push(t)}),e}function d(e,t){return e?(t&&Object.keys(t).forEach(r=>{e[r]=t[r]}),e):t}let f=()=>({serverFlights3S:u().filter(e=>e.startsWith("immersive-bizchat-3s-server-flight"))})},834970:(e,t,r)=>{"use strict";r.d(t,{Ad:()=>o,H2:()=>n,He:()=>i});let n="GetChats";var o=(e=>(e.NotStarted="NotStarted",e.InProgress="InProgress",e.Completed="Completed",e.Failed="Failed",e))(o||{}),i=(e=>(e.Recent="Recent",e.Recurring="Recurring",e))(i||{})},771262:(e,t,r)=>{"use strict";function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}function o(){return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}function i(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/.test(e)}function a(e){if(!e)return"00000000-0000-0000-0000-000000000000";if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/.test(e))return e;if(e.length>32)throw Error("Input string length must not exceed 32 characters");return e.padStart(32,"0").replace(/^(.{8})(.{4})(.{4})(.{4})(.{12})$/,"$1-$2-$3-$4-$5")}r.d(t,{W_:()=>i,_R:()=>o,dg:()=>a})},295806:(e,t,r)=>{"use strict";r.d(t,{Hl:()=>h,ID:()=>f,N8:()=>d,UT:()=>l,_G:()=>s,l5:()=>c,nU:()=>u});var n=r(654470),o=r(324233),i=r(446623);let a=new n.Ay(async()=>Promise.resolve().then(r.bind(r,340828)));async function s(e,t,r,n,s,l,c,u,d){let f=new o.q(a,o=>()=>o.fetchAccessToken(e,t,r,n,s,l,c,u,d));return(0,i.o)(f)}async function l(e,t,r,n,s){let l=new o.q(a,o=>()=>o.fetchAccessTokenV2(e,t,r,n,void 0,s));return(0,i.o)(l)}async function c(e,t,r,n,s,l){let c=new o.q(a,o=>()=>o.fetchMSALAccessTokenHelper(e,t,r,n,s,l));return(0,i.o)(c)}async function u(e,t){let r=new o.q(a,r=>()=>r.fetchFTAToken(e,t));return(0,i.o)(r)}async function d(e,t){let r=new o.q(a,r=>()=>r.getHubToken(e,t));return await (0,i.o)(r)}async function f(){let e=new o.q(a,e=>e.setMsalFirstRequestCompleted);return(0,i.o)(e)}async function h(){let e=new o.q(a,e=>e.setMsalFirstRequestFinished);return(0,i.o)(e)}},923161:(e,t,r)=>{"use strict";r.d(t,{u:()=>a});var n=r(654470),o=r(324233),i=r(446623);async function a(){let e=new n.Ay(async()=>Promise.resolve().then(r.bind(r,484275))),t=new o.q(e,e=>e.doesUserHaveStorageLicense);return(0,i.o)(t)}},766914:(e,t,r)=>{"use strict";r.d(t,{C:()=>a});var n=r(654470),o=r(324233),i=r(446623);async function a(e,t,a,s,l){let c=new n.Ay(async()=>r.e(57275).then(r.bind(r,922124))),u=new o.q(c,r=>()=>r.init3SRequest(e,t,a,s,l));return(0,i.o)(u)}},205660:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LICENSE_ENDPOINT:()=>s,SERVICE_PLAN_ID:()=>c,SERVICE_PLAN_NAME:()=>u,TOKEN_RESOURCE_GRAPH:()=>l,doesUserHaveM365ChatLicense:()=>d});var n=r(717208),o=r(574221),i=r(295806),a=r(579270);let s="https://graph.microsoft.com/v1.0/me/licenseDetails",l="https://graph.microsoft.com",c="3f30311c-6b1e-48a4-ab79-725b469da960",u="M365_COPILOT_BUSINESS_CHAT";async function d(){if(!(0,o.wX)("immersive-bizchat-m365-license-check"))return(0,a.Fi)({eventId:"Fetch LicenseDetails",dynamicEventPart:"bypassing license check, immersive-bizchat-m365-license-check isn't enabled"}),!0;try{(0,a.Fi)({eventId:"Fetch LicenseDetails",dynamicEventPart:`from ${s} - Start`});let e=await (0,i._G)(l,"GRAPH"),t=await (0,n.h)(s,{method:"GET",headers:{Authorization:`Bearer ${e}`}});if(401===t.status||!1===t.ok){(0,a.Fi)({eventId:"Error",errorMessage:"Fetch LicenseDetails - Error. Reason: (401) Unauthorized || (ok) false"});return}{(0,a.Fi)({eventId:"Fetch LicenseDetails",dynamicEventPart:"API Successful - Finish"});let e=!1,r=(0,o.wX)("immersive-bizchat-m365-fix-license-check-v2"),n=r?e=>e===c:()=>!0,i=await t.json();return i?.value?.forEach(t=>{let r=t?.servicePlans?.find(e=>e?.servicePlanName===u&&n(e?.servicePlanId)),o=r?.provisioningStatus;"Success"===o&&(e=!0,r?.servicePlanId!==c&&a.Fi({eventId:"UXDiagnostic",message:"LicenseCheck: Found unexpected service plan ID"}))}),(0,a.Fi)({eventId:"M365 License Check Successful - Finish",dynamicEventPart:`hasBusinessChatServicePlan: ${e}`,detail:`Check version: ${r?"2":"1"}`}),e}}catch(e){(0,a.Fi)({eventId:"Error",errorMessage:`M365 License Check - Error. Reason: ${e}`});return}}},404735:(e,t,r)=>{"use strict";r.d(t,{AP:()=>o,_S:()=>i,sc:()=>a});var n=r(108314);function o(e,t,r){if(s(e))try{(0,n.SO)(e,t,r)}catch(e){}}function i(e,t){return s(e)?(0,n.Gq)(window,t):null}function a(e,t){if(s(e))return(0,n.Ai)(window,t)}function s(e){try{return e&&!!(0,n.Lg)(e)}catch{return!1}}},493180:(e,t,r)=>{"use strict";r.d(t,{wt:()=>g,RN:()=>b,Py:()=>v,xG:()=>y,ST:()=>h,Ut:()=>f,Qk:()=>C,Gz:()=>m,Q5:()=>w,xF:()=>I,T4:()=>E,nE:()=>S,fh:()=>p});var n,o=r(579270),i=r(574221),a=r(690);(n||(n={})).FlightInfo="FlightInfo";var s=r(654018),l=r(758416),c=r(643108);let u=RegExp("[\\w+]://(.+)"),d=RegExp("(.+?)[/?](.*)");function f(){(0,o.Fi)({eventId:"Feature Flags",metaData:(0,i.We)().join(" ")}),(0,i.wX)("immersive-bizchat-log-ecs-headers")&&(0,o.Fi)({eventId:"LogInfo",detail:"ECS flights from HTML",metaData:(0,c.x)("bootFlights")})}function h(){(0,o.Fi)({eventId:"ECSConfigIds",detail:a.M.ecsConfigIds}),o.r7()?.logCopilotFlightInfo?.({eventId:n.FlightInfo,clientCorrelationId:a.M.clientCorrelationId,flights:a.M.ecsConfigIds??"",featureFlags:i.We().join(",")})}function p(e,t){(0,o.Fi)({eventId:"Sydney API Endpoint",metaData:"Sydney API type: "+e+", ring: "+t})}function m(){try{(0,o.Fi)({eventId:"LogInfo",detail:"sessionId: "+a.M.metaOSAppSessionId+", hostSessionId: "+a.M.metaOSAppHostSessionId+", launchId: "+a.M.metaOSAppLaunchId})}catch{}}function g(e){e&&(0,o.Fi)({eventId:"LogInfo",detail:`BootstrapperDiagnosticsInfo  - ${e(!0)}`})}function v(){let e=(0,s.j)("referrer");(0,o.Fi)({eventId:"LogInfo",detail:`Referrer  - ${e}`})}function b(){let e=(0,s.j)("fromcode"),t=(0,s.j)("redirectid");e&&(0,o.Fi)({eventId:"ReceivedRedirection",metaData:JSON.stringify({fromcode:e,redirectid:t})})}function y(e,t){try{if(e){let r=e;if(u.test(e))try{r=new URL(e).origin}catch{}else if(d.test(e)){let t=e.match(d);t&&t.length>=2&&(r=t[1])}r&&(0,o.Fi)({eventId:"LogInfo",detail:"CSP report: "+r+", "+t})}}catch{}}function w(e,t,r,n,i){(0,o.Fi)({eventId:"LogInfo",detail:`[BizChat MSAL]: ${e}, ResourceUrl: ${t}, MSALRefreshUiId: ${a.M.msalRefreshUiId}, BrowserId: ${r}, ErrorMessage: ${n??""}, IsMsalFirstRequestSuccess: ${a.M.isMsalFirstRequestSuccess}, IsMsalPostLaunch: ${a.M.isMsalPostLaunch}`,message:new Date().getTime(),clientCorrelationId:i})}async function S(){let e=await (0,l.kR)();(0,o.Fi)({eventId:"LogInfo",detail:`prewarm sessionId: ${a.M.prewarmInfo?.prewarmSessionId}, prewarm instanceId: ${a.M.prewarmInfo?.prewarmInstanceId}, isPrewarm: true, browserId: ${e}`})}function C(e,t,r){(0,o.Fi)({eventId:"LogInfo",detail:`runtime version is: ${e}, runtime cdnVersion is: ${t}, isFlightFromCache: ${r}`})}function I(e){(0,o.Fi)({eventId:"LogInfo",detail:`isNAAChannelRecommended is: ${e}`})}let k=(e,t,r,n)=>{let o={requestName:e,latency:t};return function(e,t){for(let[r,n]of t)n&&(e[r]=n)}(o,r),n?.ok||(o.responseBody=n?.body?.toString()),JSON.stringify(o)};function E(e="LogInfo",t,r,n,i,a,s,l,c){(0,o.Fi)({eventId:e,traceId:r,detail:n,message:l,latency:i,metaData:k(t,i,a,c),statusCode:c?c.status.toString():s})}},320498:(e,t,r)=>{"use strict";let n;r.d(t,{$3:()=>S,Cs:()=>p,Fh:()=>b,Ge:()=>m,h8:()=>h,o3:()=>y,vF:()=>v,xe:()=>w,xq:()=>g});var o=r(470199),i=r(254812),a=r(34423),s=r(919607),l=r(829615),c=r(579270),u=r(690),d=r(574221);let f=(e,t)=>{let r=[];return"Dogfood"===e&&r.push("https://copilot.cloud-dev.microsoft","https://ccm.mobile.m365.svc.cloud.microsoft"),t&&r.push("https://work.bing.com"),r};async function h(e,t,r,o){return i.isInitialized()||n?e(n?"initializeMetaAppSdkPromise is not empty in initializeMetaOsAppSdk()":"app.isInitialized() == true in initializeMetaOsAppSdk()"):(e("run app.initialize() in initializeMetaOsAppSdk()"),t("bizchat-metaOS-app.Initialize","ImmersiveBizChat-Initialize"),t("bizchat-metaOS-app.InitializeStart","ImmersiveBizChat-InitializeStart"),n=i.initialize(f(r,o))),n||Promise.resolve(void 0)}let p=async(e,t,r,n,o)=>{e("start run getMetaOsAppContextForBootstrapper()");try{await h(e,r,n,o)}catch(e){throw t("initializeMetaAppSdkPromise throws an exception:"+e?.message),e}r("bizchat-metaOS-app.InitializeEnd","ImmersiveBizChat-InitializeEnd"),r("bizchat-metaOS-app.GetContextStart","ImmersiveBizChat-GetContextStart");try{let e=await i.getContext();return r("bizchat-metaOS-app.GetContextEnd","ImmersiveBizChat-GetContextEnd"),e}catch(e){throw t("getMetaOsAppContextForBootstrapper(): app.getContext throws an exception:"+e?.message),e}},m=async(e,t,r)=>{e("start run getMetaOsAppContextForBootstrapperV2()");try{await n}catch(e){throw t("getMetaOsAppContextForBootstrapperV2: initializeMetaAppSdkPromise throws an exception:"+e?.message),e}r("bizchat-metaOS-app.InitializeEnd","ImmersiveBizChat-InitializeEnd"),r("bizchat-metaOS-app.GetContextStart","ImmersiveBizChat-GetContextStart");try{let e=await i.getContext();return r("bizchat-metaOS-app.GetContextEnd","ImmersiveBizChat-GetContextEnd"),e}catch(e){throw t("getMetaOsAppContextForBootstrapperV2: app.getContext() throws an exception:"+e?.message),e}},g=async()=>(0,d.wX)("immersive-bizchat-enable-read-app-context-from-store")?u.M.metaOSAppContext??i.getContext():i.getContext(),v=async()=>i.getContext(),b=()=>a.isNAAChannelRecommended(),y=async e=>{await i.openLink(e)},w=async()=>await s.requestPermission();async function S(){try{(0,c.Fi)({eventId:"LogInfo",detail:"Fetching Eligibility Information from hub"});let e=new Date().getTime(),t=await l?.eligibility?.getEligibilityInfo()??void 0,r=new Date().getTime()-e;if((0,c.Fi)({eventId:"LogInfo",detail:"Fetching eligibility from Hub end",latency:r,metaData:JSON.stringify({latency:r,eligibilityInfo:void 0===t?"undefined":"defined"})}),!t)return;return{isCopilotEligible:t.isCopilotEligible,cohort:t.cohort?.toLowerCase()??o.N9.None,persona:t.userClassification?t.userClassification.persona.toLowerCase()??o.FN.None:o.FN.None,ageGroup:function(e){switch(e?.toLocaleLowerCase()??""){case o.ob.Adult.toLocaleLowerCase():return o.ob.Adult;case o.ob.NonAdult.toLocaleLowerCase():return o.ob.NonAdult;case o.ob.MinorNoParentalConsentRequired.toLocaleLowerCase():return o.ob.MinorNoParentalConsentRequired;case o.ob.MinorWithParentalConsent.toLocaleLowerCase():return o.ob.MinorWithParentalConsent;case o.ob.MinorWithoutParentalConsent.toLocaleLowerCase():return o.ob.MinorWithoutParentalConsent;case o.ob.None.toLocaleLowerCase():return o.ob.None;case o.ob.Unknown.toLocaleLowerCase():default:return o.ob.Unknown}}(t.ageGroup?.toString()),isCopilotEnabledRegion:t.isCopilotEnabledRegion,isOptedOutByAdmin:t.isOptedOutByAdmin,eduType:t.userClassification&&"eduType"in t.userClassification?function(e){switch(e?.toLowerCase()??""){case"highereducation":return o.fw.Hed;case"k12":return o.fw.K12;case"other":return o.fw.Others;default:return o.fw.None}}(t.userClassification.eduType.toString()):o.fw.None,isError:!1,featureSet:t.featureSet}}catch(e){(0,c.Fi)({eventId:"LogError",detail:`Error while fetching eligibility from Hub: ${e.message} `});return}}},643108:(e,t,r)=>{"use strict";let n;function o(e){return n||(n=function(){let e=Array.from(window.document.getElementsByTagName("meta")),t={};for(let r of e)t[r.name]=r.content;return t}()),n[e]}function i(){let e=(o("physicalRing")||"").toLowerCase();return"sdfv2"===e||"dogfood"===e}r.d(t,{C:()=>i,x:()=>o})},237602:(e,t,r)=>{"use strict";r.d(t,{P:()=>U});var n=r(29227),o=r(603722);if(!o.useState)throw Error("mobx-react-lite requires React with Hooks support");if(!n.makeObservable)throw Error("mobx-react-lite@3 requires mobx at least version 6 to be available");var i=r(764859);function a(e){e()}function s(e){return(0,n.getDependencyTree)(e)}var l=function(){function e(e){var t=this;Object.defineProperty(this,"finalize",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"sweepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sweep",{enumerable:!0,configurable:!0,writable:!0,value:function(e){void 0===e&&(e=1e4),clearTimeout(t.sweepTimeout),t.sweepTimeout=void 0;var r=Date.now();t.registrations.forEach(function(n,o){r-n.registeredAt>=e&&(t.finalize(n.value),t.registrations.delete(o))}),t.registrations.size>0&&t.scheduleSweep()}}),Object.defineProperty(this,"finalizeAllImmediately",{enumerable:!0,configurable:!0,writable:!0,value:function(){t.sweep(0)}})}return Object.defineProperty(e.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,r){this.registrations.set(r,{value:t,registeredAt:Date.now()}),this.scheduleSweep()}}),Object.defineProperty(e.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.registrations.delete(e)}}),Object.defineProperty(e.prototype,"scheduleSweep",{enumerable:!1,configurable:!0,writable:!0,value:function(){void 0===this.sweepTimeout&&(this.sweepTimeout=setTimeout(this.sweep,1e4))}}),e}(),c=new("undefined"!=typeof FinalizationRegistry?FinalizationRegistry:l)(function(e){var t;null===(t=e.reaction)||void 0===t||t.dispose(),e.reaction=null}),u=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a};function d(e){return"observer".concat(e)}var f=function(){};function h(){return new f}var p="function"==typeof Symbol&&Symbol.for,m=p?Symbol.for("react.forward_ref"):"function"==typeof o.forwardRef&&(0,o.forwardRef)(function(e){return null}).$$typeof,g=p?Symbol.for("react.memo"):"function"==typeof o.memo&&(0,o.memo)(function(e){return null}).$$typeof,v={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};(function(e){e||(e=a),(0,n.configure)({reactionScheduler:e})})(i.unstable_batchedUpdates),c.finalizeAllImmediately;var b=0,y={};function w(e){return y[e]||(y[e]=function(e){if("function"==typeof Symbol)return Symbol(e);var t="__$mobx-react "+e+" ("+b+")";return b++,t}(e)),y[e]}function S(e,t){if(C(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var o=0;o<r.length;o++)if(!Object.hasOwnProperty.call(t,r[o])||!C(e[r[o]],t[r[o]]))return!1;return!0}function C(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function I(e,t,r){Object.hasOwnProperty.call(e,t)?e[t]=r:Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!0,value:r})}var k=w("patchMixins"),E=w("patchedDefinition");function _(e,t){for(var r,n=this,o=arguments.length,i=Array(o>2?o-2:0),a=2;a<o;a++)i[a-2]=arguments[a];t.locks++;try{return null!=e&&(r=e.apply(this,i)),r}finally{t.locks--,0===t.locks&&t.methods.forEach(function(e){e.apply(n,i)})}}function A(e,t){return function(){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];_.call.apply(_,[this,e,t].concat(n))}}function T(e,t,r){var n,o,i=((o=(n=e[k]=e[k]||{})[t]=n[t]||{}).locks=o.locks||0,o.methods=o.methods||[],o);0>i.methods.indexOf(r)&&i.methods.push(r);var a=Object.getOwnPropertyDescriptor(e,t);if(!a||!a[E]){var s=e[t],l=function e(t,r,n,o,i){var a,s=A(i,o);return(a={})[E]=!0,a.get=function(){return s},a.set=function(i){if(this===t)s=A(i,o);else{var a=e(this,r,n,o,i);Object.defineProperty(this,r,a)}},a.configurable=!0,a.enumerable=n,a}(e,t,a?a.enumerable:void 0,i,s);Object.defineProperty(e,t,l)}}var P=n.$mobx||"$mobx",O=w("isMobXReactObserver"),R=w("isUnmounted"),x=w("skipRender"),M=w("isForcingUpdate");function N(e){return e.displayName||e.name||e.constructor&&(e.constructor.displayName||e.constructor.name)||"<component>"}function F(e){var t=this;I(this,x,!1),I(this,M,!1);var r=N(this),i=e.bind(this),a=!1,s=function(){var e=new n.Reaction(r+".render()",function(){if(!a&&(a=!0,!0!==t[R])){var r=!0;try{I(t,M,!0),t[x]||o.Component.prototype.forceUpdate.call(t),r=!1}finally{I(t,M,!1),r&&(e.dispose(),t.render[P]=null)}}});return e.reactComponent=t,e};return function e(){a=!1;var t,r=null!=(t=e[P])?t:e[P]=s(),o=void 0,l=void 0;if(r.track(function(){try{l=(0,n._allowStateChanges)(!1,i)}catch(e){o=e}}),o)throw o;return l}}function L(e,t){return this.state!==t||!S(this.props,e)}function z(e,t){var r=w("reactProp_"+t+"_valueHolder"),o=w("reactProp_"+t+"_atomHolder");function i(){return this[o]||I(this,o,(0,n.createAtom)("reactive "+t)),this[o]}Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){var e=!1;return n._allowStateReadsStart&&n._allowStateReadsEnd&&(e=(0,n._allowStateReadsStart)(!0)),i.call(this).reportObserved(),n._allowStateReadsStart&&n._allowStateReadsEnd&&(0,n._allowStateReadsEnd)(e),this[r]},set:function(e){this[M]||S(this[r],e)?I(this,r,e):(I(this,r,e),I(this,x,!0),i.call(this).reportChanged(),I(this,x,!1))}})}function D(e){function t(t,r,o,i,a,s){for(var l=arguments.length,c=Array(l>6?l-6:0),u=6;u<l;u++)c[u-6]=arguments[u];return(0,n.untracked)(function(){if(i=i||"<<anonymous>>",s=s||o,null!=r[o])return e.apply(void 0,[r,o,i,a,s].concat(c));if(t){var n=null===r[o]?"null":"undefined";return Error("The "+a+" `"+s+"` is marked as required in `"+i+"`, but its value is `"+n+"`.")}return null})}var r=t.bind(null,!1);return r.isRequired=t.bind(null,!0),r}function B(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":"symbol"===t||"Symbol"===e["@@toStringTag"]||"function"==typeof Symbol&&e instanceof Symbol?"symbol":t}if(!o.Component)throw Error("mobx-react requires React to be available");if(!n.observable)throw Error("mobx-react requires mobx to be available");function U(e,t){var r;let i=((r=e).isMobxInjector,Object.prototype.isPrototypeOf.call(o.Component,r)||Object.prototype.isPrototypeOf.call(o.PureComponent,r))?function(e){var t=e.prototype;if(e[O]?N(t):e[O]=!0,t.componentWillReact)throw Error("The componentWillReact life-cycle event is no longer supported");if(e.__proto__!==o.PureComponent){if(t.shouldComponentUpdate){if(t.shouldComponentUpdate!==L)throw Error("It is not allowed to use shouldComponentUpdate in observer based components.")}else t.shouldComponentUpdate=L}z(t,"props"),z(t,"state"),e.contextType&&z(t,"context");var r=t.render;if("function"!=typeof r)throw Error("[mobx-react] class component ("+N(t)+") is missing `render` method.\n`observer` requires `render` being a function defined on prototype.\n`render = () => {}` or `render = function() {}` is not supported.");return t.render=function(){return this.render=F.call(this,r),this.render()},T(t,"componentDidMount",function(){this[R]=!1,this.render[P]||o.Component.prototype.forceUpdate.call(this)}),T(t,"componentWillUnmount",function(){var e=this.render[P];e?(e.dispose(),this.render[P]=null):N(this),this[R]=!0}),e}(r):function(e,t){if(g&&e.$$typeof===g)throw Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");var r=!1,i=e,a=e.displayName||e.name;if(m&&e.$$typeof===m&&(r=!0,"function"!=typeof(i=e.render)))throw Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var l=function(e,t){return function(e,t){void 0===t&&(t="observed");var r,i,a=u(o.useState(h),1)[0],l=u(o.useState(),2)[1],f=function(){return l([])},p=o.useRef(null);p.current||(p.current={reaction:null,mounted:!1,changedBeforeMount:!1});var m=p.current;if(m.reaction||(m.reaction=new n.Reaction(d(t),function(){m.mounted?f():m.changedBeforeMount=!0}),c.register(a,m,m)),o.useDebugValue(m.reaction,s),o.useEffect(function(){return c.unregister(m),m.mounted=!0,m.reaction?m.changedBeforeMount&&(m.changedBeforeMount=!1,f()):(m.reaction=new n.Reaction(d(t),function(){f()}),f()),function(){m.reaction.dispose(),m.reaction=null,m.mounted=!1,m.changedBeforeMount=!1}},[]),m.reaction.track(function(){try{r=e()}catch(e){i=e}}),i)throw i;return r}(function(){return i(e,t)},a)};return""!==a&&(l.displayName=a),e.contextTypes&&(l.contextTypes=e.contextTypes),r&&(l=(0,o.forwardRef)(l)),function(e,t){Object.keys(e).forEach(function(r){v[r]||Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}(e,l=(0,o.memo)(l)),l}(r);return t&&"type"in i&&Object.defineProperty(i.type,"name",{value:t}),i}},491306:(e,t,r)=>{"use strict";let n;r.d(t,{wb:()=>U,xz:()=>x,Eq:()=>R,Zl:()=>N,p$:()=>function e(){try{if((0,l.wX)("immersive-bizchat-log-more-key-latency")&&n||!(0,l.wX)("immersive-bizchat-log-key-latency")||E>=6e4)return;E+=5e3,setTimeout(()=>{let t=o.M.metaOSAppContext?.app?.userClickTime,r=!!t,n=t?new Date().getTime()-performance.now()-t:0,i=performance.getEntriesByName("bizchat-metaOS-app.InitializeStart")?.[0],a=!!i,s=i?.duration+i?.startTime,c=performance.getEntriesByName("bizchat-metaOS-app.NotifySuccess")?.[0],u=!!c,d=c?.duration+c?.startTime;if(!w&&(w=!0,r?$("Phase_1_LatencyAppView",n):$("Fail To get phase 1 latency"),a?$("Phase_2_LatencyAppView",s):$("Fail To get phase 2 latency"),a&&u?$("Phase_3_LatencyAppView",d-s):$("Fail To get phase 3 latency"),u&&($("Phase_2_3_LatencyAppView",d),W(d,_)),r&&u&&$("Phase_1_2_3_LatencyAppView",d+n),(0,l.wX)("immersive-bizchat-log-more-key-latency"))){let e=performance.getEntriesByType("navigation")?.[0]?.responseEnd;void 0!==e&&performance.mark("bizchat-metaOS-app.CopilotPageEnd",{startTime:e}),j("Phase2_HtmlDownloadStart_HtmlDownloadEnd","bizchat-metaOS-app.CopilotPageEnd"),j("Phase2_HtmlDownloadEnd_IndexJSStart","bizchat-metaOS-app.IndexJSStart","bizchat-metaOS-app.CopilotPageEnd"),j("Phase2_IndexJSStart_InitializeStart","bizchat-metaOS-app.InitializeStart","bizchat-metaOS-app.IndexJSStart"),j("Phase3_InitializeStart_InitializeEnd","bizchat-metaOS-app.InitializeEnd","bizchat-metaOS-app.InitializeStart"),j("Phase3_InitializeEnd_StartRenderImmersiveBizChatView","bizchat-metaOS-app.StartRenderImmersiveBizChatView","bizchat-metaOS-app.InitializeEnd"),j("Phase3_StartRenderImmersiveBizChatView_ReactAppStart","bizchat-metaOS-app.ReactAppStart","bizchat-metaOS-app.StartRenderImmersiveBizChatView"),j("Phase3_ReactAppStart_ChatMounted","m365-chat.chat-mounted","bizchat-metaOS-app.ReactAppStart"),j("Phase3_ChatMounted_NotifySuccess","bizchat-metaOS-app.NotifySuccess","m365-chat.chat-mounted")}if((0,l.wX)("immersive-bizchat-log-more-key-latency")&&q(!S,"m365-chat.input-ready","Phase_4_LatencyAppView",y,"Phase_1_2_3_4_LatencyAppView",u,d,r,n))S=!0;else if(!S&&!(0,l.wX)("immersive-bizchat-log-more-key-latency")){let e=performance.getEntriesByName("m365-chat.input-ready")?.[0],t=!!e,o=e?.duration+e?.startTime;t&&(S=!0,W(o,A),u&&$("Phase_4_LatencyAppView",o-d),$(y,o),r&&$("Phase_1_2_3_4_LatencyAppView",o+n))}if((0,l.wX)("immersive-bizchat-log-more-key-latency")&&q(!C,"m365-chat.try-these-prompts-mounted","Phase_4TTP_LatencyAppView","Phase_2_3_4TTP_LatencyAppView","Phase_1_2_3_4TTP_LatencyAppView",u,d,r,n))C=!0;else if(!C&&!(0,l.wX)("immersive-bizchat-log-more-key-latency")){let e=performance.getEntriesByName("m365-chat.try-these-prompts-mounted")?.[0],t=!!e,o=e?.duration+e?.startTime;t&&(C=!0,u&&$("Phase_4TTP_LatencyAppView",o-d),$("Phase_2_3_4TTP_LatencyAppView",o),r&&$("Phase_1_2_3_4TTP_LatencyAppView",o+n))}if((0,l.wX)("immersive-bizchat-log-more-key-latency")&&q(!I,"m365-chat.sessionPane-mounted","Phase_4Session_LatencyAppView","Phase_2_3_4Session_LatencyAppView","Phase_1_2_3_4Session_LatencyAppView",u,d,r,n))I=!0;else if(!I&&!(0,l.wX)("immersive-bizchat-log-more-key-latency")){let e=performance.getEntriesByName("m365-chat.sessionPane-mounted")?.[0],t=!!e,o=e?.duration+e?.startTime;t&&(I=!0,u&&$("Phase_4Session_LatencyAppView",o-d),$("Phase_2_3_4Session_LatencyAppView",o),r&&$("Phase_1_2_3_4Session_LatencyAppView",o+n))}if(C&&S&&!k){let e=performance.getEntriesByName("m365-chat.input-ready")?.[0],t=!!e,o=e?.duration+e?.startTime,i=performance.getEntriesByName("m365-chat.try-these-prompts-mounted")?.[0],a=!!i,s=i?.duration+i?.startTime;t&&a&&(k=!0,$("Stage_D_E_LatencyAppView",Math.max(o,s)),r&&$("Stage_B_C_D_E_LatencyAppView",Math.max(o,s)+n))}S&&C&&I&&k||e()},5e3)}catch{}},F6:()=>L,oB:()=>F,tM:()=>B,IO:()=>M,yD:()=>z,ip:()=>H});var o=r(690),i=r(579270),a=r(266143),s=r(940962),l=r(574221);let c=(0,r(45228).jK)("updateAppLoadTimeInStore",e=>{o.M.appLoadTime=e});var u=r(654018),d=r(416835),f=r(829615);let h="ImmersiveBizChat-ReactAppStart",p="ImmersiveBizChat-FetchChatLoaderStart",m="ImmersiveBizChat-InputboxRenderLoading",g="ImmersiveBizChat-InputboxRenderEnd",v="ImmersiveBizChat-NotifySuccess",b="ImmersiveBizChat-LoggedLatency",y="Phase_2_3_4_LatencyAppView",w=!1,S=!1,C=!1,I=!1,k=!1,E=0,_=new d.k("4cd00e73-54fd-4b54-96c6-32de6febbaeb"),A=new d.k("ef939418-74a9-49b0-9aac-e6c690f1e3fc"),T=["hosted/semanticoverview"],P=["owa.immersebizchat.runtime.","owa.semanticoverviewindex.","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-strings.","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-prod.","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-prod-m365chatlogger_","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-prod-m365chat_","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-dev.","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-dev-m365chatlogger_","dty-a2b71887-d912-402a-87aa-bf8fec0d5b6a-default-dev-m365chat_","dty-274d7ae9-e5e0-48eb-80db-f8daf26a8d1b-default-strings.","dty-274d7ae9-e5e0-48eb-80db-f8daf26a8d1b-default-prod.","dty-274d7ae9-e5e0-48eb-80db-f8daf26a8d1b-default-prod-m365chatlogger_","dty-274d7ae9-e5e0-48eb-80db-f8daf26a8d1b-default-prod-m365chat_","dty-274d7ae9-e5e0-48eb-80db-f8daf26a8d1b-default-dev.","dty-274d7ae9-e5e0-48eb-80db-f8daf26a8d1b-default-dev-m365chatlogger_","dty-274d7ae9-e5e0-48eb-80db-f8daf26a8d1b-default-dev-m365chat_"],O=["bizchat-metaOS-app","m365-chat"];function R(){(0,a.Hd)(window,b)||((0,a.J2)(window,b,"true"),(0,s.iq)((0,s.eg)()))}function x(){try{let e;window?.BizChat?.perf&&(e=window.BizChat.perf.longTaskEntries,window.BizChat.perf.longTaskEntries=[]);let t=[];e?.forEach(e=>{t.push({longTaskName:e.name,startTime:e.startTime,duration:e.duration,attribution:{attributionName:e.attribution.name,containerType:e.attribution.containerType}})}),(0,l.wX)("immersive-bizchat-performance-loglongTasks")&&e&&(0,s.Kv)(JSON.stringify(e))}catch{}}function M(){let e=new Date().getTime().toString();(0,a.Hd)(window,h)||((0,a.J2)(window,h,e),(0,s.qv)("bizchat-metaOS-app.ReactAppStart"))}function N(){let e=new Date().getTime().toString();(0,a.Hd)(window,p)||((0,a.J2)(window,p,e),(0,s.qv)("bizchat-metaOS-app.FetchChatLoaderStart"))}function F(){let e=new Date().getTime();if((0,a.Hd)(window,g)||((0,a.J2)(window,g,e.toString()),(0,s.qv)("bizchat-metaOS-app.InputboxRenderEnd"),(0,i.Fi)({eventId:"notifySucess() succeeded",detail:"New InputboxRenderEnd:"+e})),(0,a.Hd)(window,v)?n=!0:(n=!1,(0,a.J2)(window,v,e.toString()),(0,s.qv)("bizchat-metaOS-app.NotifySuccess")),(0,l.wX)("immersive-bizchat-enable-app-load-time-in-debug-tool")){let t=o.M?.metaOSAppContext?.app?.userClickTime;t&&c((e-t)/1e3)}}function L(){let e=new Date().getTime().toString();(0,a.Hd)(window,m)||((0,a.J2)(window,m,e),(0,s.qv)("bizchat-metaOS-app.InputboxRenderLoading"))}function z(){setTimeout(()=>{try{let e=[],t=performance.getEntries(),r=t.filter(e=>e?.entryType==="navigation"&&T.some(t=>(e?.name??"").indexOf(t)>=0));r.length>=1&&(r.length>=2&&(0,i.Fi)({eventId:"LogInfo",detail:"unexpected navigationEntries count: "+r.length}),e.push(D("indexHTML",r[0])));let n=t.filter(e=>e?.entryType==="resource");P.forEach(t=>{let r="."===t.slice(-1)?t+"js":t+".js",o=n.filter(e=>(e?.name??"").indexOf(t)>=0);o.length>=1&&(o.length>=2&&(0,i.Fi)({eventId:"LogInfo",detail:'unexpected jsResourceEntries for "'+r+'" with count: '+o.length}),e.push(D(r,o[0])))}),(0,i.Fi)({eventId:"LogInfo",detail:"Resource files download latency",metaData:JSON.stringify({latencyData:e})})}catch{(0,i.Fi)({eventId:"LogInfo",detail:"Fail to recordResourceDownloadLatency()"})}},1e4)}function D(e,t){return{resource:e,entryType:t?.entryType,deliveryType:t?.deliveryType,isServiceWorkerEngaged:!!t?.workerStart,transferSize:t?.transferSize,latency:Math.round(t.duration),resourceTimingLatency:Math.round(t.responseEnd-t.startTime),responseLatency:Math.round(t.responseEnd-t.responseStart),startTime:Math.round(t.startTime),responseStart:Math.round(t.responseStart),responseEnd:Math.round(t.responseEnd),domContentLoadedEventEnd:Math.round(t?.domContentLoadedEventEnd),loadEventEnd:Math.round(t?.loadEventEnd)}}function B(){setTimeout(()=>{try{let r=[],n=performance.getEntries(),a=n.filter(e=>e?.entryType==="navigation"&&T.some(t=>(e?.name??"").indexOf(t)>=0));if(a.length>=1){let e="indexHTML",t=a[0];r.push({mark:e+"---ResourceDownloadStart",timestamp:t.startTime},{mark:e+"---ResourceDownloadEnd",timestamp:t.responseEnd})}let s=n.filter(e=>{let t=e?.name??"";try{let e=new URL(t);t=e.origin+e.pathname}catch{}let r=t.toLowerCase(),n=e?.entryType==="resource"&&(e?.initiatorType==="script"||e?.initiatorType==="link"||e?.initiatorType==="img"||e?.initiatorType==="image"||e?.initiatorType==="css")&&(t.indexOf(".cdn.")>=0||t.indexOf(".onecdn.")>=0);return(r.indexOf("oid:")>=0||r.indexOf("userId")>=0||r.indexOf("objectId")>=0||r.indexOf("upn")>=0||r.indexOf("emailaddress")>=0||r.indexOf("midgardbranches")>=0||r.indexOf("owamail-branch")>=0)&&(n=!1),n}),l=new Map;s.forEach(e=>{let t=l.get(e.name)??0;r.push({mark:e.name+(0===t?"":"---"+t)+"---ResourceDownloadStart",timestamp:e.startTime},{mark:e.name+(0===t?"":"---"+t)+"---ResourceDownloadEnd",timestamp:e?.responseEnd}),l.set(e.name,t+1)});let c=new Set;n.filter(e=>e?.entryType==="mark"&&O.some(t=>(e?.name??"").indexOf(t)>=0)).forEach(e=>{c.has(e.name)||(r.push({mark:e.name+"---Marker",timestamp:e.startTime}),c.add(e.name))});let u=new Set;n.filter(e=>e?.entryType==="measure"&&O.some(t=>(e?.name??"").indexOf(t)>=0)).forEach(e=>{u.has(e.name)||(r.push({mark:e.name+"---DurationStart",timestamp:e.startTime},{mark:e.name+"---DurationEnd",timestamp:e.startTime+e.duration}),u.add(e.name))}),r.sort(function(e,t){return e.timestamp-t.timestamp});var e=r.filter(e=>!e?.mark?.startsWith("https://"));(0,i.Fi)({eventId:"LogInfo",detail:"BizChat Performance Timing",clientCorrelationId:o.M.clientCorrelationId,metaData:JSON.stringify({timingData:e}),message:JSON.stringify({browserId:o.M.browserId,referrer:o.M.referrer??"",navigationType:o.M.navigationType,blaze:U()})});var t=r.filter(e=>e?.mark?.startsWith("https://"));(0,i.Fi)({eventId:"LogInfo",detail:"BizChat Performance Timing for resources",clientCorrelationId:o.M.clientCorrelationId,metaData:JSON.stringify({timingData:t}),message:JSON.stringify({browserId:o.M.browserId,referrer:o.M.referrer??"",navigationType:o.M.navigationType,blaze:U()})})}catch{(0,i.Fi)({eventId:"LogInfo",detail:"Fail to recordPerformanceTimings()"})}},1e4)}function U(){let e=(0,u.j)("M365ChatLocal")??"",t=(0,u.j)("M365ChatBranch")??"",r=(0,u.j)("M365ChatFeatures")??"";return!((""!=e||""!=t)&&0>r.indexOf("immersive-bizchat-blaze-dev"))&&((0,l.wX)("immersive-bizchat-blaze-feature")&&"1"===(0,u.j)("blaze")||(0,l.wX)("immersive-bizchat-blaze-feature-bypass-url")||r.indexOf("immersive-bizchat-blaze-feature")>=0)&&0>r.indexOf("immersive-bizchat-disable-blaze-feature")}function H(){try{if(!(0,l.wX)("immersive-bizchat-log-phase-one-duration"))return;let e=o.M.metaOSAppContext?.app?.userClickTime,t=e?new Date().getTime()-performance.now()-e:0;t=t>0?t:0,performance.measure("bizchat-metaOS-app.ClickToNavigationStart",{start:0,duration:t})}catch{}}function q(e,t,r,n,o,i,a,s,l){if(!e)return!0;{let e=performance.getEntriesByName(t)?.[0],c=!!e,u=e?.duration+e?.startTime;return!!c&&(i&&$(r,u-a),$(n,u),n===y&&W(u,A),s&&$(o,u+l),!0)}}function j(e,t,r){let n=r?performance.getEntriesByName(r)?.[0]:void 0,o=performance.getEntriesByName(t)?.[0];if((n||!r)&&o){let t=n?n?.duration+n?.startTime:0;$(e,o?.duration+o?.startTime-t)}}function $(e,t){let r=o.M?.ecsConfigIds??"",n=(0,l.We)().join(",");r&&(n?n+=","+r:n=r),(0,i.Fi)({eventId:"LogInfo",detail:e,clientCorrelationId:o.M.clientCorrelationId,latency:Math.round(t??0),message:JSON.stringify({browserId:o.M.browserId,referrer:o.M.referrer??"",navigationType:o.M.navigationType,blaze:U(),appState:(0,u.j)("appState"),osType:(0,u.j)("osType"),hwaVersion:(0,u.j)("hwaVersion")}),metaData:n})}function W(e,t){if((0,l.wX)("immersive-bizchat-send-custom-telemetry"))try{f?.customTelemetry?.sendCustomTelemetryData(t,e)}catch{(0,i.Fi)({eventId:"LogInfo",detail:"fail to sendCustomTelemetryData for "+t.toString()})}}},940962:(e,t,r)=>{"use strict";r.d(t,{Kv:()=>c,eg:()=>s,iq:()=>l,qv:()=>a});var n=r(690),o=r(579270);let i={"bizchat-metaOS-app.set-performance-mark-imported":[],"bizchat-metaOS-app.IndexJSStart":["bizchat-metaOS-app.set-performance-mark-imported"],"bizchat-metaOS-app.IndexJSFetchHubInfoStart":["bizchat-metaOS-app.IndexJSStart"],"bizchat-metaOS-app.IndexJSGetAccountInfoAndEcsEnd":["bizchat-metaOS-app.IndexJSStart"],"bizchat-metaOS-app.IndexJSGetAccountInfoAndEcsEndError":["bizchat-metaOS-app.IndexJSStart"],"bizchat-metaOS-app.IndexJSFetchAccountInfoEnd":["bizchat-metaOS-app.IndexJSStart"],"bizchat-metaOS-app.IndexJSFetchEcsEnd":["bizchat-metaOS-app.IndexJSFetchAccountInfoEnd"],"bizchat-metaOS-app.BootstrapStart":["bizchat-metaOS-app.IndexJSGetAccountInfoAndEcsEndError","bizchat-metaOS-app.IndexJSGetAccountInfoAndEcsEnd","bizchat-metaOS-app.IndexJSStart"],"bizchat-metaOS-app.StartupDataEnd":["bizchat-metaOS-app.BootstrapStart"],"bizchat-metaOS-app.BootstrapEnd":["bizchat-metaOS-app.StartupDataEnd"],"bizchat-metaOS-app.IndexJSCreateRuntimeFactory":["bizchat-metaOS-app.IndexJSFetchHubInfoStart"],"bizchat-metaOS-app.StartRenderImmersiveBizChatView":["bizchat-metaOS-app.StartupDataEnd"],"bizchat-metaOS-app.ReactAppStart":["bizchat-metaOS-app.StartRenderImmersiveBizChatView"],"bizchat-metaOS-app.FetchChatLoaderStart":["bizchat-metaOS-app.ReactAppStart"],"bizchat-metaOS-app.InputboxRenderLoading":["bizchat-metaOS-app.StartupDataEnd"],"bizchat-metaOS-app.InputboxRenderEnd":["bizchat-metaOS-app.InputboxRenderLoading"],"bizchat-metaOS-app.Initialize":[],"bizchat-metaOS-app.InitializeStart":[],"bizchat-metaOS-app.InitializeEnd":["bizchat-metaOS-app.InitializeStart"],"bizchat-metaOS-app.GetContextStart":["bizchat-metaOS-app.InitializeEnd"],"bizchat-metaOS-app.GetContextEnd":["bizchat-metaOS-app.GetContextStart"],"bizchat-metaOS-app.NotifySuccess":["bizchat-metaOS-app.Initialize"],"bizchat-metaOS-app.FetchEligibilityStart":[],"bizchat-metaOS-app.FetchEligibilityEnd":["bizchat-metaOS-app.FetchEligibilityStart"],"bizchat-metaOS-app.createM365ChatRuntimeFactoryStart":[],"bizchat-metaOS-app.createM365ChatRuntimeFactoryEnd":["bizchat-metaOS-app.createM365ChatRuntimeFactoryStart"]};function a(e){try{if(r.g?.performance){r.g.performance.mark(e);let t="";if(i[e]){let n=r.g.performance.getEntriesByType("measure").filter(t=>t?.name&&i[e].indexOf(t.name)>=0);if(n.length>0){let r=!1;for(let o=0;o<i[e].length;o++){let a=i[e][o];for(let e=0;e<n.length;e++){let o=n[e];if(a.toLowerCase()===o.name.toLowerCase()){t=o.name,r=!0;break}}if(r)break}}}t?r.g.performance.measure(e,t,e):r.g.performance.measure(e,{},e)}}catch{}}function s(){return r.g?.performance&&r.g.performance.getEntriesByType("measure").filter(e=>e&&e.name&&0===e.name.indexOf("bizchat-metaOS-app.")).map(({name:e,startTime:t,duration:r})=>({name:e,startTime:t,duration:r}))}function l(e){(0,o.Fi)({eventId:"PerformanceMeasures",detail:JSON.stringify(e),clientCorrelationId:n.M.clientCorrelationId})}function c(e){(0,o.Fi)({eventId:"LogInfo",detail:e})}},654018:(e,t,r)=>{"use strict";r.d(t,{b:()=>a,j:()=>i});let n=null;function o(e){return(e||(e=window.location),e===location)?n||(n=s(location)):s(e)}function i(e){return n?n[e]:o()[e]}function a(e){return n?e in n:Object.prototype.hasOwnProperty.call(o(),e)}function s(e){return void 0!==e&&e.search?function(e){let t={};if("string"==typeof e&&e.length>0){let r=e.split("&"),n=r.length>1e3?1e3:r.length;for(let e=0;e<n;++e){let n=r[e].replace(l,"%20").split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n.slice(1).join("="))}}return t}(e.search.substr(1)):{}}let l=/\+/g},544569:(e,t,r)=>{"use strict";r.d(t,{A:()=>rk,d:()=>rI});var n,o,i,a,s,l,c,u,d,f,h,p,m=r(603722),g=r(932224),v=r(703025),b=r(958063),y=r(395417),w=r(655411),S=r(422275),C=r(402087),I=r(450565),k=r(202801),E=r(166159);function _(e,t){return e&&t?{...e,...t}:e||t}let A=e=>{let t=function(e){let t=(0,w.Y)(),r=(0,k.Pv)(),n=m.useContext(E.k7)||{},{customStyleHooks_unstable:o,children:i,dir:a=t.dir,targetDocument:s=t.targetDocument,overrides_unstable:l={}}=e,c=_(r,l);return{dir:a,targetDocument:s,customStyleHooks_unstable:_(n,o),overrides_unstable:c,components:{root:m.Fragment},root:S.Gk({children:i},{elementType:m.Fragment}),themeClassName:"",theme:{},applyStylesToPortals:!1,serverStyleProps:{cssRule:"",attributes:{}}}}(e),r=(0,C.r)(t);return(0,I.t)(t,r)};var T=r(237602),P=r(564188);function O(e){return e.flatMap(e=>e?.split(/\s/))}let R=(0,T.P)(function({theme:e,targetDocument:t=window.document,children:r}){let{styleTagId:n}=(0,P.V)({theme:e,targetDocument:t,rendererAttributes:{}});return m.useLayoutEffect(()=>{if(n)return function(e,...t){e.classList.add(...O(t))}(t.documentElement,n),()=>{!function(e,...t){e.classList.remove(...O(t))}(t.documentElement,n)}},[t,n]),m.createElement(m.Fragment,null,r)},"FluentThemeWrapper");var x=m.createContext({window:"object"==typeof window?window:void 0}),M=function(){var e;return null===(e=m.useContext(x).window)||void 0===e?void 0:e.document},N=r(856911),F=r(988821),L="__globalSettings__",z="__callbacks__",D=0,B=function(){function e(){}return e.getValue=function(e,t){var r=U();return void 0===r[e]&&(r[e]="function"==typeof t?t():t),r[e]},e.setValue=function(e,t){var r=U(),n=r[z],o=r[e];if(t!==o){r[e]=t;var i={oldValue:o,value:t,key:e};for(var a in n)n.hasOwnProperty(a)&&n[a](i)}return t},e.addChangeListener=function(e){var t=e.__id__,r=U()[z];t||(t=e.__id__=String(D++)),r[t]=e},e.removeChangeListener=function(e){var t=U()[z];delete t[e.__id__]},e}();function U(){var e,t=(0,F.z)()||{};return t[L]||(t[L]=((e={})[z]={},e)),t[L]}var H={settings:{},scopedSettings:{},inCustomizerContext:!1},q=B.getValue("customizations",{settings:{},scopedSettings:{},inCustomizerContext:!1}),j=[],$=function(){function e(){}return e.reset=function(){q.settings={},q.scopedSettings={}},e.applySettings=function(t){q.settings=(0,N.__assign)((0,N.__assign)({},q.settings),t),e._raiseChange()},e.applyScopedSettings=function(t,r){q.scopedSettings[t]=(0,N.__assign)((0,N.__assign)({},q.scopedSettings[t]),r),e._raiseChange()},e.getSettings=function(e,t,r){void 0===r&&(r=H);for(var n={},o=t&&r.scopedSettings[t]||{},i=t&&q.scopedSettings[t]||{},a=0;a<e.length;a++){var s=e[a];n[s]=o[s]||r.settings[s]||i[s]||q.settings[s]}return n},e.applyBatchedUpdates=function(t,r){e._suppressUpdates=!0;try{t()}catch(e){}e._suppressUpdates=!1,r||e._raiseChange()},e.observe=function(e){j.push(e)},e.unobserve=function(e){j=j.filter(function(t){return t!==e})},e._raiseChange=function(){e._suppressUpdates||j.forEach(function(e){return e()})},e}(),W=m.createContext({customizations:{inCustomizerContext:!1,settings:{},scopedSettings:{}}}),V={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"};!function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(n||(n={}));var G={elevation4:n.depth4,elevation8:n.depth8,elevation16:n.depth16,elevation64:n.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"},K=r(956949),X=r(278809),Y={none:0,insertNode:1,appendChild:2},Z="__stylesheet__",Q="undefined"!=typeof navigator&&/rv:11.0/.test(navigator.userAgent),J={};try{J=window||{}}catch(e){}var ee=function(){function e(e,t){var r,n,o,i,a,s;this._rules=[],this._preservedRules=[],this._counter=0,this._keyToClassName={},this._onInsertRuleCallbacks=[],this._onResetCallbacks=[],this._classNameToArgs={},this._config=(0,N.__assign)({injectionMode:"undefined"==typeof document?Y.none:Y.insertNode,defaultPrefix:"css",namespace:void 0,cspSettings:void 0},e),this._classNameToArgs=null!==(r=null==t?void 0:t.classNameToArgs)&&void 0!==r?r:this._classNameToArgs,this._counter=null!==(n=null==t?void 0:t.counter)&&void 0!==n?n:this._counter,this._keyToClassName=null!==(i=null!==(o=this._config.classNameCache)&&void 0!==o?o:null==t?void 0:t.keyToClassName)&&void 0!==i?i:this._keyToClassName,this._preservedRules=null!==(a=null==t?void 0:t.preservedRules)&&void 0!==a?a:this._preservedRules,this._rules=null!==(s=null==t?void 0:t.rules)&&void 0!==s?s:this._rules}return e.getInstance=function(t){if(o=J[Z],J[X.Se])return J[X.Se].getInstance(t);if(!o||o._lastStyleElement&&o._lastStyleElement.ownerDocument!==document){var r=(null==J?void 0:J.FabricConfig)||{},n=new e(r.mergeStyles,r.serializedStylesheet);o=n,J[Z]=n}return o},e.prototype.serialize=function(){return JSON.stringify({classNameToArgs:this._classNameToArgs,counter:this._counter,keyToClassName:this._keyToClassName,preservedRules:this._preservedRules,rules:this._rules})},e.prototype.setConfig=function(e){this._config=(0,N.__assign)((0,N.__assign)({},this._config),e)},e.prototype.onReset=function(e){var t=this;return this._onResetCallbacks.push(e),function(){t._onResetCallbacks=t._onResetCallbacks.filter(function(t){return t!==e})}},e.prototype.onInsertRule=function(e){var t=this;return this._onInsertRuleCallbacks.push(e),function(){t._onInsertRuleCallbacks=t._onInsertRuleCallbacks.filter(function(t){return t!==e})}},e.prototype.getClassName=function(e){var t=this._config.namespace,r=e||this._config.defaultPrefix;return"".concat(t?t+"-":"").concat(r,"-").concat(this._counter++)},e.prototype.cacheClassName=function(e,t,r,n){this._keyToClassName[this._getCacheKey(t)]=e,this._classNameToArgs[e]={args:r,rules:n}},e.prototype.classNameFromKey=function(e){return this._keyToClassName[this._getCacheKey(e)]},e.prototype.getClassNameCache=function(){return this._keyToClassName},e.prototype.argsFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.args},e.prototype.insertedRulesFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.rules},e.prototype.insertRule=function(e,t,r){void 0===r&&(r=X.P6);var n=this._config.injectionMode,o=n!==Y.none?this._getStyleElement():void 0;if(t&&this._preservedRules.push(e),o)switch(n){case Y.insertNode:this._insertRuleIntoSheet(o.sheet,e);break;case Y.appendChild:o.appendChild(document.createTextNode(e))}else this._rules.push(e);this._config.onInsertRule&&this._config.onInsertRule(e),this._onInsertRuleCallbacks.forEach(function(t){return t({key:r,sheet:o?o.sheet:void 0,rule:e})})},e.prototype.getRules=function(e){return(e?this._preservedRules.join(""):"")+this._rules.join("")},e.prototype.reset=function(){this._rules=[],this._counter=0,this._classNameToArgs={},this._keyToClassName={},this._onResetCallbacks.forEach(function(e){return e()})},e.prototype.resetKeys=function(){this._keyToClassName={}},e.prototype._createStyleElement=function(){var e,t=(null===(e=this._config.window)||void 0===e?void 0:e.document)||document,r=t.head,n=t.createElement("style"),o=null;n.setAttribute("data-merge-styles","true");var i=this._config.cspSettings;if(i&&i.nonce&&n.setAttribute("nonce",i.nonce),this._lastStyleElement)o=this._lastStyleElement.nextElementSibling;else{var a=this._findPlaceholderStyleTag();o=a?a.nextElementSibling:r.childNodes[0]}return r.insertBefore(n,r.contains(o)?o:null),this._lastStyleElement=n,n},e.prototype._insertRuleIntoSheet=function(e,t){if(!e)return!1;try{return e.insertRule(t,e.cssRules.length),!0}catch(e){}return!1},e.prototype._getCacheKey=function(e){return e},e.prototype._getStyleElement=function(){var e=this;return this._styleElement||(this._styleElement=this._createStyleElement(),Q||(this._config.window||window).requestAnimationFrame(function(){e._styleElement=void 0})),this._styleElement},e.prototype._findPlaceholderStyleTag=function(){var e=document.head;return e?e.querySelector("style[data-merge-styles]"):null},e}(),et={},er={"user-select":1},en=["column-count","font-weight","flex","flex-grow","flex-shrink","fill-opacity","opacity","order","z-index","zoom"],eo="left",ei="right",ea=((a={})[eo]=ei,a[ei]=eo,a),es={"w-resize":"e-resize","sw-resize":"se-resize","nw-resize":"ne-resize"},el=/\:global\((.+?)\)/g;function ec(e,t){if(e.indexOf(":global(")>=0)return e.replace(el,"$1");if(0===e.indexOf(":host("));else if(0===e.indexOf(":"))return t+e;else if(0>e.indexOf("&"))return t+" "+e;return e}function eu(e,t,r,n,o){void 0===t&&(t={__order:[]}),0===r.indexOf("@")?ed([n],t,r=r+"{"+e,o):r.indexOf(",")>-1?(function(e){if(!el.test(e))return e;for(var t=[],r=/\:global\((.+?)\)/g,n=null;n=r.exec(e);)n[1].indexOf(",")>-1&&t.push([n.index,n.index+n[0].length,n[1].split(",").map(function(e){return":global(".concat(e.trim(),")")}).join(", ")]);return t.reverse().reduce(function(e,t){var r=t[0],n=t[1],o=t[2];return e.slice(0,r)+o+e.slice(n)},e)})(r).split(",").map(function(e){return e.trim()}).forEach(function(r){return ed([n],t,ec(r,e),o)}):ed([n],t,ec(r,e),o)}function ed(e,t,r,n){void 0===t&&(t={__order:[]}),void 0===r&&(r="&");var o=t[r];o||(o={},t[r]=o,t.__order.push(r));for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){var s=n.argsFromClassName(a);s&&ed(s,t,r,n)}else if(Array.isArray(a))ed(a,t,r,n);else for(var l in a)if(a.hasOwnProperty(l)){var c,u=a[l];if("selectors"===l){var d=a.selectors;for(var f in d)d.hasOwnProperty(f)&&eu(r,t,f,d[f],n)}else"object"==typeof u||(c=l).indexOf(":global(")>=0||0===c.indexOf(":")?null!=u&&eu(r,t,l,u,n):void 0!==u&&("margin"===l||"padding"===l?function(e,t,r){var n="string"==typeof r?function(e){for(var t=[],r=0,n=0,o=0;o<e.length;o++)switch(e[o]){case"(":n++;break;case")":n&&n--;break;case"	":case" ":n||(o>r&&t.push(e.substring(r,o)),r=o+1)}return r<e.length&&t.push(e.substring(r)),t}(r):[r];0===n.length&&n.push(r),"!important"===n[n.length-1]&&(n=n.slice(0,-1).map(function(e){return e+" !important"})),e[t+"Top"]=n[0],e[t+"Right"]=n[1]||n[0],e[t+"Bottom"]=n[2]||n[0],e[t+"Left"]=n[3]||n[1]||n[0]}(o,l,u):o[l]=u)}}return t}function ef(e,t){if(!t)return"";var r=[];for(var n in t)t.hasOwnProperty(n)&&"displayName"!==n&&void 0!==t[n]&&r.push(n,t[n]);for(var o=0;o<r.length;o+=2)(function(e,t){var r=e[t];"-"!==r.charAt(0)&&(e[t]=et[r]=et[r]||r.replace(/([A-Z])/g,"-$1").toLowerCase())})(r,o),function(e,t){var r=e[t],n=e[t+1];if("number"==typeof n){var o=en.indexOf(r)>-1,i=r.indexOf("--")>-1;e[t+1]="".concat(n).concat(o||i?"":"px")}}(r,o),function(e,t,r){if(e.rtl){var n=t[r];if(n){var o=t[r+1];if("string"==typeof o&&o.indexOf("@noflip")>=0)t[r+1]=o.replace(/\s*(?:\/\*\s*)?\@noflip\b(?:\s*\*\/)?\s*?/g,"");else if(n.indexOf(eo)>=0)t[r]=n.replace(eo,ei);else if(n.indexOf(ei)>=0)t[r]=n.replace(ei,eo);else if(String(o).indexOf(eo)>=0)t[r+1]=o.replace(eo,ei);else if(String(o).indexOf(ei)>=0)t[r+1]=o.replace(ei,eo);else if(ea[n])t[r]=ea[n];else if(es[o])t[r+1]=es[o];else switch(n){case"margin":case"padding":t[r+1]=function(e){if("string"==typeof e){var t=e.split(" ");if(4===t.length)return"".concat(t[0]," ").concat(t[3]," ").concat(t[2]," ").concat(t[1])}return e}(o);break;case"box-shadow":t[r+1]=function(e,t){var r=e.split(" "),n=parseInt(r[0],10);return r[0]=r[0].replace(String(n),String(-1*n)),r.join(" ")}(o,0)}}}}(e,r,o),function(e,t){var r=function(){var e;if(!i){var t="undefined"!=typeof document?document:void 0,r="undefined"!=typeof navigator?navigator:void 0,n=null===(e=null==r?void 0:r.userAgent)||void 0===e?void 0:e.toLowerCase();i=t?{isWebkit:!!(t&&"WebkitAppearance"in t.documentElement.style),isMoz:!!(n&&n.indexOf("firefox")>-1),isOpera:!!(n&&n.indexOf("opera")>-1),isMs:!!(r&&(/rv:11.0/i.test(r.userAgent)||/Edge\/\d./i.test(navigator.userAgent)))}:{isWebkit:!0,isMoz:!0,isOpera:!0,isMs:!0}}return i}(),n=e[t];if(er[n]){var o=e[t+1];er[n]&&(r.isWebkit&&e.push("-webkit-"+n,o),r.isMoz&&e.push("-moz-"+n,o),r.isMs&&e.push("-ms-"+n,o),r.isOpera&&e.push("-o-"+n,o))}}(r,o);for(var o=1;o<r.length;o+=4)r.splice(o,1,":",r[o],";");return r.join("")}function eh(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=null!==(t=e.stylesheet)&&void 0!==t?t:ee.getInstance(e.shadowConfig),i=ed(r,void 0,void 0,o),a=function(e,t){for(var r=[e.rtl?"rtl":"ltr"],n=!1,o=0,i=t.__order;o<i.length;o++){var a=i[o];r.push(a);var s=t[a];for(var l in s)s.hasOwnProperty(l)&&void 0!==s[l]&&(n=!0,r.push(l,s[l]))}return n?r.join(""):void 0}(e,i);if(a){var s={className:o.classNameFromKey(a),key:a,args:r};if(!s.className){s.className=o.getClassName((l=i&&i["&"])?l.displayName:void 0);for(var l,c=[],u=0,d=i.__order;u<d.length;u++){var f=d[u];c.push(f,ef(e,i[f]))}s.rulesToInsert=c}return s}}function ep(e,t,r,n){void 0===t&&(t=1);var o=null!=n?n:ee.getInstance(r),i=e.className,a=e.key,s=e.args,l=e.rulesToInsert;if(l){for(var c=0;c<l.length;c+=2){var u=l[c+1];if(u){var d=l[c];d=d.replace(/&/g,function e(t,r){return r<=0?"":1===r?t:t+e(t,r-1)}(".".concat(e.className),t));var f="".concat(d,"{").concat(u,"}").concat(0===d.indexOf("@")?"}":"");o.insertRule(f)}}o.cacheClassName(i,a,s,l)}}(function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"})(s||(s={})),function(e){e.Arabic="'".concat(s.Arabic,"'"),e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'".concat(s.Cyrillic,"'"),e.EastEuropean="'".concat(s.EastEuropean,"'"),e.Greek="'".concat(s.Greek,"'"),e.Hebrew="'".concat(s.Hebrew,"'"),e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'".concat(s.Selawik,"'"),e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'".concat(s.Vietnamese,"'"),e.WestEuropean="'".concat(s.WestEuropean,"'"),e.Armenian="'".concat(s.Armenian,"'"),e.Georgian="'".concat(s.Georgian,"'")}(l||(l={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(c||(c={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(u||(u={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(d||(d={}));var em="'Segoe UI', '".concat(s.WestEuropean,"'"),eg={ar:l.Arabic,bg:l.Cyrillic,cs:l.EastEuropean,el:l.Greek,et:l.EastEuropean,he:l.Hebrew,hi:l.Hindi,hr:l.EastEuropean,hu:l.EastEuropean,ja:l.Japanese,kk:l.EastEuropean,ko:l.Korean,lt:l.EastEuropean,lv:l.EastEuropean,pl:l.EastEuropean,ru:l.Cyrillic,sk:l.EastEuropean,"sr-latn":l.EastEuropean,th:l.Thai,tr:l.EastEuropean,uk:l.Cyrillic,vi:l.Vietnamese,"zh-hans":l.ChineseSimplified,"zh-hant":l.ChineseTraditional,hy:l.Armenian,ka:l.Georgian};function ev(e,t,r){return{fontFamily:r,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}var eb=r(911160),ey=r(796233),ew="language",eS=function(e){var t,r=(t=function(e){for(var t in eg)if(eg.hasOwnProperty(t)&&e&&0===t.indexOf(e))return eg[t];return em}(e),"".concat(t,", ").concat("'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif"));return{tiny:ev(c.mini,u.regular,r),xSmall:ev(c.xSmall,u.regular,r),small:ev(c.small,u.regular,r),smallPlus:ev(c.smallPlus,u.regular,r),medium:ev(c.medium,u.regular,r),mediumPlus:ev(c.mediumPlus,u.regular,r),large:ev(c.large,u.regular,r),xLarge:ev(c.xLarge,u.semibold,r),xLargePlus:ev(c.xLargePlus,u.semibold,r),xxLarge:ev(c.xxLarge,u.semibold,r),xxLargePlus:ev(c.xxLargePlus,u.semibold,r),superLarge:ev(c.superLarge,u.semibold,r),mega:ev(c.mega,u.semibold,r)}}(function(e){if(void 0===e&&(e="sessionStorage"),void 0===f){var t=(0,eb.Y)(),r="localStorage"===e?function(e){var t=null;try{var r=(0,F.z)();t=r?r.localStorage.getItem(e):null}catch(e){}return t}(ew):"sessionStorage"===e?ey.G(ew):void 0;r&&(f=r),void 0===f&&t&&(f=t.documentElement.getAttribute("lang")),void 0===f&&(f="en")}return f}());function eC(e,t,r,n){(function(e){var t=ee.getInstance(),r=ef((0,K.Iy)(),e);if(!t.classNameFromKey(r)){var n=t.getClassName();t.insertRule("@font-face{".concat(r,"}"),!0),t.cacheClassName(n,r,[],["font-face",r])}})({fontFamily:e="'".concat(e,"'"),src:(void 0!==n?"local('".concat(n,"'),"):"")+"url('".concat(t,".woff2') format('woff2'),")+"url('".concat(t,".woff') format('woff')"),fontWeight:r,fontStyle:"normal",fontDisplay:"swap"})}function eI(e,t,r,n,o){void 0===n&&(n="segoeui");var i="".concat(e,"/").concat(r,"/").concat(n);eC(t,i+"-light",u.light,o&&o+" Light"),eC(t,i+"-semilight",u.semilight,o&&o+" SemiLight"),eC(t,i+"-regular",u.regular,o),eC(t,i+"-semibold",u.semibold,o&&o+" SemiBold"),eC(t,i+"-bold",u.bold,o&&o+" Bold")}function ek(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++)(function e(t,r,n){for(var o in void 0===n&&(n=[]),n.push(r),r)if(r.hasOwnProperty(o)&&"__proto__"!==o&&"constructor"!==o&&"prototype"!==o){var i=r[o];if("object"!=typeof i||null===i||Array.isArray(i))t[o]=i;else{var a=n.indexOf(i)>-1;t[o]=a?i:e(t[o]||{},i,n)}}return n.pop(),t})(e||{},t[n]);return e}function eE(e,t,r,n,o){void 0===o&&(o=!1);var i={},a=e||{},s=a.white,l=a.black,c=a.themePrimary,u=a.themeDark,d=a.themeDarker,f=a.themeDarkAlt,h=a.themeLighter,p=a.neutralLight,m=a.neutralLighter,g=a.neutralDark,v=a.neutralQuaternary,b=a.neutralQuaternaryAlt,y=a.neutralPrimary,w=a.neutralSecondary,S=a.neutralSecondaryAlt,C=a.neutralTertiary,I=a.neutralTertiaryAlt,k=a.neutralLighterAlt,E=a.accent;return s&&(i.bodyBackground=s,i.bodyFrameBackground=s,i.accentButtonText=s,i.buttonBackground=s,i.primaryButtonText=s,i.primaryButtonTextHovered=s,i.primaryButtonTextPressed=s,i.inputBackground=s,i.inputForegroundChecked=s,i.listBackground=s,i.menuBackground=s,i.cardStandoutBackground=s),l&&(i.bodyTextChecked=l,i.buttonTextCheckedHovered=l),c&&(i.link=c,i.primaryButtonBackground=c,i.inputBackgroundChecked=c,i.inputIcon=c,i.inputFocusBorderAlt=c,i.menuIcon=c,i.menuHeader=c,i.accentButtonBackground=c),u&&(i.primaryButtonBackgroundPressed=u,i.inputBackgroundCheckedHovered=u,i.inputIconHovered=u),d&&(i.linkHovered=d),f&&(i.primaryButtonBackgroundHovered=f),h&&(i.inputPlaceholderBackgroundChecked=h),p&&(i.bodyBackgroundChecked=p,i.bodyFrameDivider=p,i.bodyDivider=p,i.variantBorder=p,i.buttonBackgroundCheckedHovered=p,i.buttonBackgroundPressed=p,i.listItemBackgroundChecked=p,i.listHeaderBackgroundPressed=p,i.menuItemBackgroundPressed=p,i.menuItemBackgroundChecked=p),m&&(i.bodyBackgroundHovered=m,i.buttonBackgroundHovered=m,i.buttonBackgroundDisabled=m,i.buttonBorderDisabled=m,i.primaryButtonBackgroundDisabled=m,i.disabledBackground=m,i.listItemBackgroundHovered=m,i.listHeaderBackgroundHovered=m,i.menuItemBackgroundHovered=m),v&&(i.primaryButtonTextDisabled=v,i.disabledSubtext=v),b&&(i.listItemBackgroundCheckedHovered=b),C&&(i.disabledBodyText=C,i.variantBorderHovered=(null==r?void 0:r.variantBorderHovered)||C,i.buttonTextDisabled=C,i.inputIconDisabled=C,i.disabledText=C),y&&(i.bodyText=y,i.actionLink=y,i.buttonText=y,i.inputBorderHovered=y,i.inputText=y,i.listText=y,i.menuItemText=y),k&&(i.bodyStandoutBackground=k,i.defaultStateBackground=k),g&&(i.actionLinkHovered=g,i.buttonTextHovered=g,i.buttonTextChecked=g,i.buttonTextPressed=g,i.inputTextHovered=g,i.menuItemTextHovered=g),w&&(i.bodySubtext=w,i.focusBorder=w,i.inputBorder=w,i.smallInputBorder=w,i.inputPlaceholderText=w),S&&(i.buttonBorder=S),I&&(i.disabledBodySubtext=I,i.disabledBorder=I,i.buttonBackgroundChecked=I,i.menuDivider=I),E&&(i.accentButtonBackground=E),(null==t?void 0:t.elevation4)&&(i.cardShadow=t.elevation4),!n&&(null==t?void 0:t.elevation8)?i.cardShadowHovered=t.elevation8:i.variantBorderHovered&&(i.cardShadowHovered="0 0 1px "+i.variantBorderHovered),i=(0,N.__assign)((0,N.__assign)({},i),r)}function e_(e,t){void 0===t&&(t={});var r,n,o,i=ek({},e,t,{semanticColors:eE(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(r=t.palette)||void 0===r?void 0:r.themePrimary)&&!(null===(n=t.palette)||void 0===n?void 0:n.accent)&&(i.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var a=0,s=Object.keys(i.fonts);a<s.length;a++){var l=s[a];i.fonts[l]=ek(i.fonts[l],t.defaultFontStyle,null===(o=null==t?void 0:t.fonts)||void 0===o?void 0:o[l])}return i}!function(e){if(e){var t="".concat(e,"/fonts");eI(t,s.Thai,"leelawadeeui-thai","leelawadeeui"),eI(t,s.Arabic,"segoeui-arabic"),eI(t,s.Cyrillic,"segoeui-cyrillic"),eI(t,s.EastEuropean,"segoeui-easteuropean"),eI(t,s.Greek,"segoeui-greek"),eI(t,s.Hebrew,"segoeui-hebrew"),eI(t,s.Vietnamese,"segoeui-vietnamese"),eI(t,s.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),eI(t,l.Selawik,"selawik","selawik"),eI(t,s.Armenian,"segoeui-armenian"),eI(t,s.Georgian,"segoeui-georgian"),eC("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-semilight"),u.light),eC("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-bold"),u.semibold)}}(function(){var e,t,r=null===(e=(0,F.z)())||void 0===e?void 0:e.FabricConfig;return null!==(t=null==r?void 0:r.fontBaseUrl)&&void 0!==t?t:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/assets"}());var eA={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"};function eT(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var r,n,o,i,a=!!e.isInverted;return e_({palette:V,effects:G,fonts:eS,spacing:eA,isInverted:a,disableGlobalClassNames:!1,semanticColors:(o=void 0,void 0===(i=t)&&(i=!1),r=eE(V,G,(0,N.__assign)({primaryButtonBorder:"transparent",errorText:a?"#F1707B":"#a4262c",messageText:a?"#F3F2F1":"#323130",messageLink:a?"#6CB8F6":"#005A9E",messageLinkHovered:a?"#82C7FF":"#004578",infoIcon:a?"#C8C6C4":"#605e5c",errorIcon:a?"#F1707B":"#A80000",blockingIcon:a?"#442726":"#FDE7E9",warningIcon:a?"#C8C6C4":"#797775",severeWarningIcon:a?"#FCE100":"#D83B01",successIcon:a?"#92C353":"#107C10",infoBackground:a?"#323130":"#f3f2f1",errorBackground:a?"#442726":"#FDE7E9",blockingBackground:a?"#442726":"#FDE7E9",warningBackground:a?"#433519":"#FFF4CE",severeWarningBackground:a?"#4F2A0F":"#FED9CC",successBackground:a?"#393D1B":"#DFF6DD",warningHighlight:a?"#fff100":"#ffb900",successText:a?"#92c353":"#107C10"},o),a),n="",!0===i&&(n=" /* @deprecated */"),r.listTextColor=r.listText+n,r.menuItemBackgroundChecked+=n,r.warningHighlight+=n,r.warningText=r.messageText+n,r.successText+=n,r),rtl:void 0},e)}var eP=m.createContext(void 0),eO=function(){var e,t,r,n,o,i=m.useContext(eP),a=(t=["theme"],e=m.useState(0)[1],r=function(){return e(function(e){return++e})},o=(n=m.useContext(W).customizations).inCustomizerContext,m.useEffect(function(){return o||$.observe(r),function(){o||$.unobserve(r)}},[o]),$.getSettings(t,void 0,n)).theme;return i||a||eT({})},eR="__currentId__",ex=(0,F.z)()||{};void 0===ex[eR]&&(ex[eR]=0);var eM=!1;function eN(e){if(!eM){var t=ee.getInstance();t&&t.onReset&&t.onReset(eF),eM=!0}return(void 0===e?"id__":e)+ex[eR]++}function eF(e){void 0===e&&(e=0),ex[eR]=e}function eL(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e&&1===e.length&&e[0]&&!e[0].subComponentStyles&&!(0,X.db)(e[0]))return e[0];for(var r={},n={},o=0;o<e.length;o++){var i=e[o];if(i&&!(0,X.db)(i)){for(var a in i)if(i.hasOwnProperty(a)){if("subComponentStyles"===a&&void 0!==i.subComponentStyles){var s=i.subComponentStyles;for(var l in s)s.hasOwnProperty(l)&&(n.hasOwnProperty(l)?n[l].push(s[l]):n[l]=[s[l]]);continue}var c=r[a],u=i[a];void 0===c?r[a]=u:r[a]=(0,N.__spreadArray)((0,N.__spreadArray)([],Array.isArray(c)?c:[c],!0),Array.isArray(u)?u:[u],!0)}}}if(Object.keys(n).length>0){r.subComponentStyles={};var d=r.subComponentStyles;for(var l in n)!function(e){if(n.hasOwnProperty(e)){var t=n[e];d[e]=function(e){return eL.apply(void 0,t.map(function(t){return"function"==typeof t?t(e):t}))}}}(l)}return r}function ez(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[],o=[];return function t(r){for(var i=0;i<r.length;i++){var a=r[i];if(a&&!(0,X.db)(a)){if("string"==typeof a){if(a.indexOf(" ")>=0)t(a.split(" "));else{var s=e.argsFromClassName(a);s?t(s):-1===n.indexOf(a)&&n.push(a)}}else Array.isArray(a)?t(a):"object"==typeof a&&o.push(a)}}}(t),{classes:n,objects:o}}function eD(e){var t=ee.getInstance(),r=[];for(var n in e)e.hasOwnProperty(n)&&r.push(n,"{",ef((0,K.Iy)(),e[n]),"}");var o=r.join(""),i=t.classNameFromKey(o);if(i)return i;var a=t.getClassName();return t.insertRule("@keyframes ".concat(a,"{").concat(o,"}"),!0),t.cacheClassName(a,o,[],["keyframes",o]),a}var eB={getId:function(){return 0},renderStyles:function(e,t){return function(e,t){var r,n={subComponentStyles:{}},o=void 0;(0,X.db)(e[0])?(o=e[0],r=e[1]):r=e[0],null!=o||(o=null==t?void 0:t.shadowConfig);var i=(0,N.__assign)((0,N.__assign)({},t),{shadowConfig:o});if(!r&&e.length<=1)return{subComponentStyles:{}};var a=ee.getInstance(o);i.stylesheet=a;var s=eL.apply(void 0,e),l=[];for(var c in s)if(s.hasOwnProperty(c)){if("subComponentStyles"===c){n.subComponentStyles=s.subComponentStyles||{};continue}if("__shadowConfig__"===c)continue;var u=ez(a,s[c]),d=u.classes,f=u.objects;if(null==f?void 0:f.length){var h=eh(i||{},{displayName:c},f);h&&(l.push(h),n[c]=d.concat([h.className]).join(" "))}else n[c]=d.join(" ")}for(var p=0;p<l.length;p++){var h=l[p];h&&ep(h,null==t?void 0:t.specificityMultiplier,o)}return n}(Array.isArray(e)?e:[e],t)}},eU=function(e,t){var r,n,o,i=t[0],a=t[1],s=t[2];return null===(o=null===(n=null===(r=e.get(i))||void 0===r?void 0:r.get(a))||void 0===n?void 0:n.get(s))||void 0===o?void 0:o.classMap},eH=function(e,t,r){var n,o,i=t[0],a=t[1],s=t[2],l=null!==(n=e.get(i))&&void 0!==n?n:new Map;e.set(i,l);var c=null!==(o=l.get(a))&&void 0!==o?o:new Map;l.set(a,c),c.set(s,{classMap:r,refCount:0})},eq=function(e){var t=new Map,r=new Set,n=function(e){var o=e.currentTarget,i=o.__id__;t.delete(i),o.removeEventListener("unload",n),r.delete(i)};return function(o){void 0===o&&(o={});var i,a=o.theme,s=m.useContext(x).window;s&&(s.__id__=s.__id__||eN(),i=s.__id__,r.has(i)||(r.add(i),s.addEventListener("unload",n)));var l=eO();a=a||l;var c=eB.getId(),u=[i,c,a],d=eU(t,u);if(m.useEffect(function(){var e,r,n,o,s,l,u;return o=(e=[i,c,a])[0],s=e[1],l=e[2],(u=null===(n=null===(r=t.get(o))||void 0===r?void 0:r.get(s))||void 0===n?void 0:n.get(l))&&u.refCount++,function(){var e,r,n,o,s,l,u,d,f,h,p,m,g;return h=(e=[i,c,a])[0],p=e[1],m=e[2],void((g=null===(n=null===(r=t.get(h))||void 0===r?void 0:r.get(p))||void 0===n?void 0:n.get(m))&&(g.refCount--,0===g.refCount&&(null===(s=null===(o=t.get(h))||void 0===o?void 0:o.get(p))||void 0===s||s.delete(m),(null===(u=null===(l=t.get(h))||void 0===l?void 0:l.get(p))||void 0===u?void 0:u.size)===0&&(null===(d=t.get(h))||void 0===d||d.delete(p),(null===(f=t.get(h))||void 0===f?void 0:f.size)===0&&t.delete(h)))))}},[i,c,a]),!d){var f="function"==typeof e?e(a):e;eH(t,u,d=eB.renderStyles(f,{targetWindow:s,rtl:!!a.rtl}))}return d}}(function(e){var t=e.semanticColors,r=e.fonts;return{body:[{color:t.bodyText,background:t.bodyBackground,fontFamily:r.medium.fontFamily,fontWeight:r.medium.fontWeight,fontSize:r.medium.fontSize,MozOsxFontSmoothing:r.medium.MozOsxFontSmoothing,WebkitFontSmoothing:r.medium.WebkitFontSmoothing}]}}),ej=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=0;n<e.length;n++)for(var o=e[n],i=Array.isArray(o)?o:Object.keys(o),a=0;a<i.length;a++)r[i[a]]=1;return r},e$=ej(["onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),eW=ej(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),eV=ej(eW,e$),eG=ej(eV,["form"]),eK=ej(eV,["height","loop","muted","preload","src","width"]),eX=ej(eK,["poster"]),eY=ej(eV,["start"]),eZ=ej(eV,["value"]),eQ=ej(eV,["download","href","hrefLang","media","rel","target","type"]),eJ=ej(eV,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),e0=ej(eJ,["accept","alt","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),e1=ej(eJ,["autoCapitalize","cols","dirname","form","maxLength","minLength","placeholder","readOnly","required","rows","wrap"]),e2=ej(eJ,["form","multiple","required"]),e3=ej(eV,["selected","value"]),e5=ej(eV,["cellPadding","cellSpacing"]),e6=ej(eV,["rowSpan","scope"]),e4=ej(eV,["colSpan","headers","rowSpan","scope"]),e8=ej(eV,["span"]),e9=ej(eV,["span"]),e7=ej(eV,["acceptCharset","action","encType","encType","method","noValidate","target"]),te=ej(eV,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),tt=ej(eV,["alt","crossOrigin","height","src","srcSet","useMap","width"]),tr={label:eG,audio:eK,video:eX,ol:eY,li:eZ,a:eQ,button:eJ,input:e0,textarea:e1,select:e2,option:e3,table:e5,tr:eV,th:e6,td:e4,colGroup:e8,col:e9,form:e7,iframe:te,img:tt},tn=r(894571),to=((h={})[tn.c.up]=1,h[tn.c.down]=1,h[tn.c.left]=1,h[tn.c.right]=1,h[tn.c.home]=1,h[tn.c.end]=1,h[tn.c.tab]=1,h[tn.c.pageUp]=1,h[tn.c.pageDown]=1,"ms-Fabric--isFocusVisible"),ti="ms-Fabric--isFocusHidden";function ta(e,t){e&&(e.classList.add(t?to:ti),e.classList.remove(t?ti:to))}new WeakMap,new WeakMap;var ts=m.createContext(void 0),tl=function(e){var t=e.providerRef,r=e.layerRoot,n=m.useState([])[0],o=m.useContext(ts),i=void 0!==o&&!r,a=m.useMemo(function(){return i?void 0:{providerRef:t,registeredProviders:n,registerProvider:function(e){n.push(e),null==o||o.registerProvider(e)},unregisterProvider:function(e){null==o||o.unregisterProvider(e);var t=n.indexOf(e);t>=0&&n.splice(t,1)}}},[t,n,o,i]);return(m.useEffect(function(){if(a)return a.registerProvider(a.providerRef),function(){return a.unregisterProvider(a.providerRef)}},[a]),a)?m.createElement(ts.Provider,{value:a},e.children):m.createElement(m.Fragment,null,e.children)},tc=function(e){var t,r=e.customizerContext,n=e.ref,o=e.theme,i=e.as||"div",a="string"==typeof e.as?(t=e.as,function(e,t,r){for(var n=Array.isArray(t),o={},i=Object.keys(e),a=0;a<i.length;a++){var s=i[a];(!n&&t[s]||n&&t.indexOf(s)>=0||0===s.indexOf("data-")||0===s.indexOf("aria-"))&&(!r||(null==r?void 0:r.indexOf(s))===-1)&&(o[s]=e[s])}return o}(e,t&&tr[t]||eV,void 0)):e.as===m.Fragment?{children:e.children}:function(e,t){var r={};for(var n in e)-1===t.indexOf(n)&&e.hasOwnProperty(n)&&(r[n]=e[n]);return r}(e,["as"]);return m.createElement(eP.Provider,{value:o},m.createElement(W.Provider,{value:r},m.createElement(tl,{providerRef:n},m.createElement(i,(0,N.__assign)({},a)))))},tu=new Map,td=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=[],n=0;n<e.length;n++){var o=e[n];if(o){var i=o.id||tu.get(o);i||(i=eN(""),tu.set(o,i)),r.push(i)}}return r.join("-")},tf=function(e){var t=e.theme,r=eO(),n=e.theme=m.useMemo(function(){var e=e_(r,t);return e.id=td(r,t),e},[r,t]);e.customizerContext=m.useMemo(function(){return{customizations:{inCustomizerContext:!0,settings:{theme:n},scopedSettings:n.components||{}}}},[n]),e.theme.rtl!==r.rtl&&(e.dir=e.theme.rtl?"rtl":"ltr")},th=function(e,t){var r=function(e,t){for(var r=(0,N.__assign)({},t),n=0,o=Object.keys(e);n<o.length;n++){var i=o[n];void 0===r[i]&&(r[i]=e[i])}return r}(t,e);return tf(r),{state:r,render:tc}},tp=m.forwardRef(function(e,t){var r,n,o,i,a,s,l,c=th(e,{ref:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=m.useCallback(function(t){r.current=t;for(var n=0;n<e.length;n++){var o=e[n];"function"==typeof o?o(t):o&&(o.current=t)}},(0,N.__spreadArray)([],e,!0));return r}(t,m.useRef(null)),as:"div",applyTo:"element"}),u=c.render,d=c.state;return r=eq(d),n=d.className,o=d.applyTo,i=[r.root,r.body],s="body"===d.applyTo,l=null===(a=M())||void 0===a?void 0:a.body,m.useEffect(function(){if(s&&l){for(var e=0;e<i.length;e++){var t=i[e];t&&l.classList.add(t)}return function(){if(s&&l)for(var e=0;e<i.length;e++){var t=i[e];t&&l.classList.remove(t)}}}},[s,l,i]),d.className=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=[],n=0;n<e.length;n++){var o=e[n];if(o){if("string"==typeof o)r.push(o);else if(o.hasOwnProperty("toString")&&"function"==typeof o.toString)r.push(o.toString());else for(var i in o)o[i]&&r.push(i)}}return r.join(" ")}(n,r.root,"element"===o&&r.body),u(d)});tp.displayName="ThemeProvider";var tm=r(29227);function tg(){for(var e,t,r,n,o,i,a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return e=(0,K.Iy)(),t=a instanceof Array?a:[a],r=e||{},(0,X.db)(t[0])&&(r.shadowConfig=t[0]),r.stylesheet=ee.getInstance(r.shadowConfig),o=(n=ez(r.stylesheet,t)).classes,(i=n.objects).length&&o.push(function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=eh.apply(void 0,(0,N.__spreadArray)([e],t,!1));return n?(ep(n,e.specificityMultiplier,e.shadowConfig,e.stylesheet),n.className):""}(r,i)),o.join(" ")}function tv(e){var t={},r=function(r){if(e.hasOwnProperty(r)){var n;Object.defineProperty(t,r,{get:function(){return void 0===n&&(n=tg(e[r]).toString()),n},enumerable:!0,configurable:!0})}};for(var n in e)r(n);return t}var tb="cubic-bezier(.1,.9,.2,1)",ty="cubic-bezier(.1,.25,.75,.9)",tw="0.167s",tS="0.267s",tC="0.367s",tI="0.467s",tk=eD({from:{opacity:0},to:{opacity:1}}),tE=eD({from:{opacity:1},to:{opacity:0,visibility:"hidden"}}),t_=t3(-10),tA=t3(-20),tT=t3(-40),tP=t3(-400),tO=t3(10),tR=t3(20),tx=t3(40),tM=t3(400),tN=t5(10),tF=t5(20),tL=t5(-10),tz=t5(-20),tD=t6(10),tB=t6(20),tU=t6(40),tH=t6(400),tq=t6(-10),tj=t6(-20),t$=t6(-40),tW=t6(-400),tV=t4(-10),tG=t4(-20),tK=t4(10),tX=t4(20),tY=eD({from:{transform:"scale3d(.98,.98,1)"},to:{transform:"scale3d(1,1,1)"}}),tZ=eD({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(.98,.98,1)"}}),tQ=eD({from:{transform:"scale3d(1.03,1.03,1)"},to:{transform:"scale3d(1,1,1)"}}),tJ=eD({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(1.03,1.03,1)"}}),t0=eD({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(90deg)"}}),t1=eD({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(-90deg)"}});function t2(e,t,r){return{animationName:e,animationDuration:t,animationTimingFunction:r,animationFillMode:"both"}}function t3(e){return eD({from:{transform:"translate3d(".concat(e,"px,0,0)"),pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function t5(e){return eD({from:{transform:"translate3d(0,".concat(e,"px,0)"),pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function t6(e){return eD({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d(".concat(e,"px,0,0)")}})}function t4(e){return eD({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d(0,".concat(e,"px,0)")}})}tv({slideRightIn10:t2("".concat(tk,",").concat(t_),tC,tb),slideRightIn20:t2("".concat(tk,",").concat(tA),tC,tb),slideRightIn40:t2("".concat(tk,",").concat(tT),tC,tb),slideRightIn400:t2("".concat(tk,",").concat(tP),tC,tb),slideLeftIn10:t2("".concat(tk,",").concat(tO),tC,tb),slideLeftIn20:t2("".concat(tk,",").concat(tR),tC,tb),slideLeftIn40:t2("".concat(tk,",").concat(tx),tC,tb),slideLeftIn400:t2("".concat(tk,",").concat(tM),tC,tb),slideUpIn10:t2("".concat(tk,",").concat(tN),tC,tb),slideUpIn20:t2("".concat(tk,",").concat(tF),tC,tb),slideDownIn10:t2("".concat(tk,",").concat(tL),tC,tb),slideDownIn20:t2("".concat(tk,",").concat(tz),tC,tb),slideRightOut10:t2("".concat(tE,",").concat(tD),tC,tb),slideRightOut20:t2("".concat(tE,",").concat(tB),tC,tb),slideRightOut40:t2("".concat(tE,",").concat(tU),tC,tb),slideRightOut400:t2("".concat(tE,",").concat(tH),tC,tb),slideLeftOut10:t2("".concat(tE,",").concat(tq),tC,tb),slideLeftOut20:t2("".concat(tE,",").concat(tj),tC,tb),slideLeftOut40:t2("".concat(tE,",").concat(t$),tC,tb),slideLeftOut400:t2("".concat(tE,",").concat(tW),tC,tb),slideUpOut10:t2("".concat(tE,",").concat(tV),tC,tb),slideUpOut20:t2("".concat(tE,",").concat(tG),tC,tb),slideDownOut10:t2("".concat(tE,",").concat(tK),tC,tb),slideDownOut20:t2("".concat(tE,",").concat(tX),tC,tb),scaleUpIn100:t2("".concat(tk,",").concat(tY),tC,tb),scaleDownIn100:t2("".concat(tk,",").concat(tQ),tC,tb),scaleUpOut103:t2("".concat(tE,",").concat(tJ),tw,ty),scaleDownOut98:t2("".concat(tE,",").concat(tZ),tw,ty),fadeIn100:t2(tk,tw,ty),fadeIn200:t2(tk,tS,ty),fadeIn400:t2(tk,tC,ty),fadeIn500:t2(tk,tI,ty),fadeOut100:t2(tE,tw,ty),fadeOut200:t2(tE,tS,ty),fadeOut400:t2(tE,tC,ty),fadeOut500:t2(tE,tI,ty),rotate90deg:t2(t0,"0.1s",ty),rotateN90deg:t2(t1,"0.1s",ty)}),tv(eS);var t8=function(){return(t8=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},t9="undefined"==typeof window?r.g:window,t7=t9&&t9.CSPSettings&&t9.CSPSettings.nonce,re=function(){var e=t9.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]};return e.runState||(e=t8(t8({},e),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}})),e.registeredThemableStyles||(e=t8(t8({},e),{registeredThemableStyles:[]})),t9.__themeState__=e,e}();function rt(e){var t=re.theme,r=!1;return{styleString:(e||[]).map(function(e){var n=e.theme;if(!n)return e.rawString;r=!0;var o=t?t[n]:void 0,i=e.defaultValue||"inherit";return t&&!o&&console&&!(n in t)&&"undefined"!=typeof DEBUG&&DEBUG,o||i}).join(""),themable:r}}var rr=eT({}),rn=[],ro="theme";function ri(){var e,t,r,n,o,i,a,s=(0,F.z)();(null===(i=null==s?void 0:s.FabricConfig)||void 0===i?void 0:i.legacyTheme)?(e=s.FabricConfig.legacyTheme,void 0===t&&(t=!1),rr=eT(e,t),n=(0,N.__assign)((0,N.__assign)((0,N.__assign)((0,N.__assign)({},rr.palette),rr.semanticColors),rr.effects),function(e){for(var t={},r=0,n=Object.keys(e.fonts);r<n.length;r++)for(var o=n[r],i=e.fonts[o],a=0,s=Object.keys(i);a<s.length;a++){var l=s[a],c=o+l.charAt(0).toUpperCase()+l.slice(1),u=i[l];"fontSize"===l&&"number"==typeof u&&(u+="px"),t[c]=u}return t}(rr)),re.theme=n,function(){if(re.theme){for(var e,t=[],r=0,n=re.registeredThemableStyles;r<n.length;r++){var o=n[r];t.push(o.themableStyle)}t.length>0&&(function(e){e.forEach(function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)})}(re.registeredThemableStyles),re.registeredThemableStyles=[],e=[].concat.apply([],t),re.loadStyles?re.loadStyles(rt(e).styleString,e):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],r=document.createElement("style"),n=rt(e),o=n.styleString,i=n.themable;r.setAttribute("data-load-themed-styles","true"),t7&&r.setAttribute("nonce",t7),r.appendChild(document.createTextNode(o)),re.perf.count++,t.appendChild(r);var a=document.createEvent("HTMLEvents");a.initEvent("styleinsert",!0,!1),a.args={newStyle:r},document.dispatchEvent(a);var s={styleElement:r,themableStyle:e};i?re.registeredThemableStyles.push(s):re.registeredStyles.push(s)}}(e))}}(),$.applySettings(((r={})[ro]=rr,r)),rn.forEach(function(e){try{e(rr)}catch(e){}})):$.getSettings([ro]).theme||((null===(a=null==s?void 0:s.FabricConfig)||void 0===a?void 0:a.theme)&&(rr=eT(s.FabricConfig.theme)),$.applySettings(((o={})[ro]=rr,o)))}ri();var ra={};for(var rs in V)V.hasOwnProperty(rs)&&(rl(ra,rs,"",!1,"color"),rl(ra,rs,"Hover",!0,"color"),rl(ra,rs,"Background",!1,"background"),rl(ra,rs,"BackgroundHover",!0,"background"),rl(ra,rs,"Border",!1,"borderColor"),rl(ra,rs,"BorderHover",!0,"borderColor"));function rl(e,t,r,n,o){Object.defineProperty(e,t+r,{get:function(){var e,r,i=((r={})[o]=(void 0===e&&(e=!1),!0===e&&(rr=eT({},e)),rr).palette[t],r);return tg(n?{selectors:{":hover":i}}:i).toString()},enumerable:!0,configurable:!0})}var rc=!1,ru=0,rd="undefined"==typeof WeakMap?null:WeakMap;function rf(){ru++}(function(e,t,r){if(void 0===t&&(t=100),void 0===r&&(r=!1),rd){if(!rc){var n=ee.getInstance();n&&n.onReset&&ee.getInstance().onReset(rf),rc=!0}}})(0),function(e){e.Nav=1,e.ScrollablePane=1,e.FocusStyle=1,e.Coachmark=1e3,e.Layer=1e6,e.KeytipLayer=1000001}(p||(p={}));var rh=B.getValue("icons",{__options:{disableWarnings:!1,warnOnMissingIcons:!0},__remapped:{}}),rp=ee.getInstance();rp&&rp.onReset&&rp.onReset(function(){for(var e in rh)rh.hasOwnProperty(e)&&rh[e].subset&&(rh[e].subset.className=void 0)});var rm={},rg=void 0;try{rg=window}catch(e){}function rv(e,t){if(void 0!==rg){var r=rg.__packages__=rg.__packages__||{};r[e]&&rm[e]||(rm[e]=t,(r[e]=r[e]||[]).push(t))}}rv("@fluentui/set-version","6.0.0"),rv("@fluentui/style-utilities","8.11.7"),ri();let rb=Object.fromEntries([...Object.keys(V),"black","blackTranslucent50","blackTranslucent40","blackTranslucent20","blackTranslucent10","white","whiteTranslucent40","whiteTranslucent90","neutralDark","neutralPrimary","neutralPrimaryAlt","neutralPrimarySurface","neutralSecondary","neutralSecondaryAlt","neutralSecondarySurface","neutralTertiary","neutralTertiaryAlt","neutralTertiarySurface","neutralQuaternary","neutralQuaternaryAlt","neutralLight","neutralLighter","neutralLighterAlt","redDark","green20","purple","suiteuxNeutralLight","suiteuxNeutralSecondary","flaggedMessage","richUserContentBackground","composeNeutralBackground","composeNeutralLighterBackground","readingPaneCardBorder","readingPaneCardFocusBorder","oobeWhite","oobePrimary","oobeDarkAlt","oobeThemeLighter","cardStyleWhite","freeBusyAwayColor","messageWebWarning","messageMobileWarningPrimary","messageMobileWarningShade20","messageMobileWarningShade30","messageMobileWarningTint30","messageMobileWarningTint40","communicationBlueWebPrimary","messageMobileDangerPrimary","messageMobileDangerShade20","messageMobileDangerTint30","messageMobileDangerTint40","messageMobileSuccessPrimary","presenceAway","presenceDoNotDisturb","presenceOnline","presenceInvisible","presenceOOF","addisonComponentButtonGradientStart","addisonComponentButtonGradientEnd","storageCritialStateColor","storageCritialStateHoverColor","storageNearingStateColor","storageNearingStateHoverColor","storageUsageBarBorder","bizBarRed","msqOneDrive","msqTeams","msqOutlook","msqWindows","msqEdge","placesPrimary","placesLightBlueSolidColor","placesNavyBlueSolidColor","placesBackgroundColorPink","placesBackgroundColorPurple","placesBackgroundColorLightBlue","placesBackgroundColorNavy","placesBluePrimary","placesBlueTint40","placesLightBackground3","placesLightBlueBackground","placesNeutralGrey92","colorBrandBackgroundInvertedSelected","colorBrandBackgroundInvertedHover","colorPaletteCornflowerBackground2","placesBlueGradient1","placesBlueGradient2","placesBlueBackground1","placesBlueForeground1","placesBlueBorder1","placesCornflowerForeground1","placesCornflowerForeground2","placesRemote1","placesRemoteBorder1","neutralBackground6","lilacBackground2","neutralForeground4","neutralBackground2Pressed","sharedLavenderTint10","sharedCornflowerTint20","sharedCornflowerTint30","sharedCornflowerTint50","sharedCornflowerTint60","sharedCornFlowerShade20","placesPurpleOOFBackground1","placesPurpleOOFForeground1","placesPurpleGradient1","boxShadowPrimary","boxShadowSecondary","places70","places80","places80Pressed","places160","paneLighterBackground","copilotGradientStart","copilotGradientEnd","yellow","orange","red","blue","green","sharedLightGreenTint50","sharedDarkGreenTint30","bookingsTeal10","bookingsTeal20","bookingsTeal50","bookingsTeal80","bookingsAccentGreen10","bookingsAccentGreen20","bookingsForegroundTeal60","bookingsForegroundTeal80","bookingsNeutralForeground1","bookingsNeutralForeground2","bookingsNeutralForeground4","bookingsRedForeground1","bookingsNeutralStroke1","bookingsNeutralBackground1","bookingsGreenConsistent","bookingsGrayConsistent","placesOffice","placesWalkway","placesWall","placesBlueTint50","placesLightBlueShade20","placesCyanTint50","placesCyanShade10","placesCyanShade20","placesNeutralForeground2","placesUnavailablePin","placesSelectedPin","placesSeaformShade20","placesSeaformShade30","placesLightGreenShade20","themeDarker","themeDark","themeDarkAlt","themePrimary","themeSecondary","themeTertiary","themeLight","themeLighter","themeLighterAlt","themeSecondarySurfaceSelected","headerBackground","headerBackgroundSearch","headerBrandText","headerTextIcons","headerSearchBoxBackground","headerSearchBoxIcon","headerSearchPlaceholderText","headerSearchButtonBackground","headerSearchButtonBackgroundHover","headerSearchButtonIcon","headerSearchFilters","headerSearchFiltersHover","headerButtonsBackground","headerButtonsBackgroundHover","headerButtonsBackgroundSearch","headerButtonsBackgroundSearchHover","headerBadgeBackground","headerBadgeText","headerSearchIcon","searchBoxBackground"].map(e=>[e,`var(--${e})`])),ry=(0,T.P)(function({children:e}){var t,r;let n=(t=()=>{let e={root:{backgroundColor:rb.neutralPrimarySurface},subComponentStyles:{callout:{},menuItem:{root:{selectors:{".ms-ContextualMenu-secondaryText":{color:rb.neutralPrimaryAlt},".fui-FluentProvider":{color:"inherit",backgroundColor:"inherit"},".ms-ContextualMenu-link":{backgroundColor:rb.neutralPrimarySurface,color:rb.neutralPrimary,"&:hover":{backgroundColor:rb.neutralLighter,color:rb.neutralPrimary},"&:active":{backgroundColor:rb.neutralTertiaryAlt,color:rb.neutralPrimary}}}},item:{color:rb.neutralPrimary,selectors:{".ms-ContextualMenu-link.is-expanded":{backgroundColor:rb.neutralTertiaryAlt}}},subMenuIcon:{color:rb.neutralPrimary},divider:{backgroundColor:rb.neutralTertiaryAlt}}}},t={root:{background:rb.neutralPrimarySurface},field:{color:rb.black}},r={callout:{selectors:{".ms-Callout-main":{backgroundColor:rb.neutralPrimarySurface}}},dropdownItem:{color:rb.neutralPrimary,selectors:{"&:hover":{backgroundColor:rb.neutralLighter,color:rb.neutralPrimary}}},dropdownItemSelected:{color:rb.neutralPrimary,backgroundColor:rb.neutralTertiaryAlt,selectors:{"&:hover":{color:rb.neutralPrimary,backgroundColor:rb.neutralTertiaryAlt}}},dropdown:{backgroundColor:rb.neutralPrimarySurface},title:{backgroundColor:"inherit"}},n={pill:{background:rb.neutralPrimarySurface,borderColor:rb.neutralPrimaryAlt,selectors:{"&[aria-checked=true]":{background:rb.themePrimary,borderColor:rb.themePrimary,".ms-Toggle-thumb":{backgroundColor:rb.neutralPrimarySurface}},"&[aria-checked=true]:hover":{background:rb.themeDark,borderColor:"transparent"}}},thumb:{backgroundColor:rb.neutralPrimaryAlt}},o={root:{backgroundColor:rb.neutralPrimarySurface,borderColor:rb.neutralTertiary},rootHovered:{backgroundColor:rb.neutralLighter,borderColor:rb.neutralTertiary},rootPressed:{backgroundColor:rb.neutralLight,borderColor:rb.neutralTertiary},rootDisabled:{backgroundColor:`${rb.neutralLighter} !important`,borderColor:`${rb.neutralLighter} !important`,color:`${rb.neutralTertiary} !important`}},i={root:{backgroundColor:rb.themePrimary,borderColor:rb.themePrimary,color:rb.white},rootHovered:{backgroundColor:rb.themeDark,borderColor:rb.themeDark,color:rb.white},rootPressed:{backgroundColor:rb.themeDarker,borderColor:rb.themeDarker,color:rb.white},rootDisabled:{backgroundColor:`${rb.neutralLighter} !important`,borderColor:`${rb.neutralLighter} !important`,color:`${rb.neutralTertiary} !important`}},a={root:{selectors:{".ms-ChoiceField-field::before":{backgroundColor:rb.neutralPrimarySurface}}}},s={beak:{background:rb.neutralPrimarySurface},beakCurtain:{background:rb.neutralPrimarySurface},calloutMain:{backgroundColor:rb.neutralPrimarySurface}},l={content:{color:rb.black}},c={thumb:{backgroundColor:rb.neutralPrimarySurface}},u={callout:{selectors:{".ms-Callout-main":{backgroundColor:rb.neutralPrimarySurface}}},root:{color:rb.neutralPrimary,backgroundColor:rb.neutralPrimarySurface},input:{backgroundColor:"inherit"}},d={root:{color:rb.neutralPrimary},fieldGroup:{backgroundColor:rb.neutralPrimarySurface}};return{components:{ContextualMenu:{styles:e},SearchBox:{styles:t},Dropdown:{styles:r},Dialog:{styles:{root:{selectors:{".ms-Dialog-header":{".ms-Dialog-title":{color:rb.black}},".ms-Dialog-inner":{".ms-Dialog-content":{".ms-Dialog-subText":{color:rb.neutralPrimary}}}}},main:{backgroundColor:rb.neutralPrimarySurface}}},DialogFooter:{styles:{action:{selectors:{".ms-Button.ms-Button--primary":{backgroundColor:rb.themePrimary,color:rb.white,borderColor:rb.themePrimary,"&:hover":{".ms-Button.ms-Button--primary":{backgroundColor:rb.themeDark}},"&:active":{".ms-Button.ms-Button--primary":{backgroundColor:rb.themeDarker}}},".ms-Button.ms-Button--default":{backgroundColor:rb.neutralPrimarySurface,borderColor:rb.neutralTertiary,borderStyle:"solid",borderWidth:"1px","&:hover":{".ms-Button.ms-Button--default":{backgroundColor:rb.neutralLighter}},"&:active":{".ms-Button.ms-Button--default":{backgroundColor:rb.neutralLight}}}}}}},ComboBox:{styles:u},TextField:{styles:d},ChoiceGroup:{styles:a},DefaultButton:{styles:o},PrimaryButton:{styles:i},CommandButton:{styles:o},Toggle:{styles:n},Slider:{styles:c},CalloutContent:{styles:s},Tooltip:{styles:l}}}},r=[],(0,m.useMemo)(()=>(0,tm.computed)(t),r).get());return m.createElement(tp,{as:m.Fragment,theme:n},e)},"FluentComponentsThemeContext");var rw=r(647616);let rS=()=>!1,rC={10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"};function rI(e=rS()){return m.useMemo(()=>(e?b.W:y.a)(rC),[e])}let rk=(0,T.P)(function({dir:e=(0,rw.jI)()?"rtl":"ltr",targetDocument:t=window.document,children:r}){let n=rI(),o=m.useMemo(()=>{let e=t.head.querySelector("title")??void 0;return t.fluentRendererProvider=t.fluentRendererProvider??(0,g.I)(t,{insertionPoint:e}),t.fluentRendererProvider},[t]);return m.createElement(v.H,{renderer:o,targetDocument:t},m.createElement(ry,null,m.createElement(R,{theme:n,targetDocument:t},m.createElement(A,{dir:e,targetDocument:t},r))))},"FluentContext")},988622:(e,t,r)=>{"use strict";r.d(t,{d:()=>i,m:()=>o});var n=r(544569);function o(e){let t=document.getElementById(e);if(!t)throw Error(`Element ${e} does not exist`);return t}function i(e){return(0,n.d)(e)}},412145:(e,t,r)=>{"use strict";r.d(t,{$l:()=>n,MK:()=>i,r9:()=>o});let n="Async call timeout limit reached";function o(e={}){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||(()=>6e4);let{maximumAttempts:t,timeBetweenRetryInMS:r,errorLogFunc:n,forceToQuit:i}=e;return e=>{let o=0,a=!1,s=(l,c)=>{a?c(Error("The function retry was cancelled")):(o++,e().then(e=>l(e)).catch(e=>{t&&o>=t?c(e):i&&i(e)?c(e):(n&&n(o),setTimeout(()=>s(l,c),r?.(o)))}))};return{retriableFunc:()=>new Promise((e,t)=>s(e,t)),cancel:()=>a=!0}}}async function i(e,t){let r;return Promise.race([e,new Promise((e,o)=>{r=setTimeout(()=>o(Error(n)),t)})]).then(e=>(clearTimeout(r),e))}},788074:(e,t,r)=>{"use strict";r.d(t,{_m:()=>y,Iq:()=>v,Oz:()=>b});var n=r(377255),o=r(233654),i=r(412145),a=r(295806),s=r(690),l=r(488563),c=r(486353),u=r.n(c),d=r(579270);r(223093);var f=r(366482),h=r(574221);let p=(0,r(45228).jK)("updatePuid",e=>{e&&e!==s.M?.puid&&(s.M.puid=e)});var m=r(471936);let g=(0,i.r9)({maximumAttempts:5,timeBetweenRetryInMS:()=>100}),v=async()=>{let e;if(!(e=(0,h.wX)("immersive-bizchat-puid-sydney")?await (0,l.CM)():await (0,a.N8)((0,o.$z)())))return"";try{return u()(e).puid}catch(e){return(0,d.Fi)({eventId:"Error",errorMessage:`Fetch MetaOsHub Token - Error: ${e.message}`}),""}},b=()=>{v().then(e=>{let t=(0,m.Bc)();p(e),t&&(0,d.PV)({user:{puid:e}})}).catch(e=>{(0,d.Fi)({eventId:"Error",errorMessage:`getAndUpdatePuid Fetch MetaOsHub Token - Error: ${e.message}`})})};async function y(){try{let e;if("Dogfood"===(0,f.K)())return 3;(0,d.Fi)({eventId:"LogInfo",detail:"start IsEuropeUser() function"});let t=new Date().getTime(),r=g(S).retriableFunc();try{e=await (0,i.MK)(r,5500)}catch{(0,d.Fi)({eventId:"LogInfo",detail:"Fetch IsEuropeUser fail due to timeout"})}return(0,d.Fi)({eventId:"LogInfo",detail:"Fetch IsEuropeUser succeed, isEu: "+e}),(0,d.Fi)({eventId:"LogInfo",detail:"Fetch IsEuropeUser latency"+(new Date().getTime()-t)}),void 0===e?1:e?2:3}catch{return(0,d.Fi)({eventId:"Error",detail:"Fetch IsEuropeUser fail"}),1}}function w(e,t){if(!(performance.getEntriesByName(e).length>0))return performance.mark(e),performance.measure(e,t,e)}async function S(){try{let e=await n.getUser();if(e?.dataResidency)return e.dataResidency===n.DataResidency.EUDB;return}catch(e){return}}},266143:(e,t,r)=>{"use strict";function n(e){try{return e&&!!e.sessionStorage}catch{return!1}}function o(e,t,r){if(n(e))try{!function(e,t,r){if(n(e))try{e.sessionStorage.setItem(t,r)}catch(e){}}(window,t,r)}catch(e){}}function i(e,t){if(n(e)){var r;return n(r=window)?r.sessionStorage.getItem(t):null}return null}function a(e,t){var r;n(e)&&n(r=window)&&r.sessionStorage.removeItem(t)}r.d(t,{Hd:()=>i,X:()=>a,J2:()=>o})},484275:(e,t,r)=>{"use strict";r.r(t),r.d(t,{doesUserHaveStorageLicense:()=>u,useStorageLicenseEnabledCheck:()=>c});var n=r(603722),o=r(205660),i=r(717208),a=r(574221),s=r(295806),l=r(579270);let c=()=>{let[e,t]=n.useState(!0);return n.useEffect(()=>{u?.().then(e=>t(e??!1))},[]),(0,l.Fi)({eventId:"Fetch LicenseDetails",dynamicEventPart:`useStorageLicenseEnabledCheck: ${e}`}),e};async function u(){if(!(0,a.wX)("immersive-bizchat-enable-storage-license-check"))return(0,l.Fi)({eventId:"Fetch LicenseDetails",dynamicEventPart:"bypassing license check, immersive-bizchat-enable-storage-license-check isn't enabled"}),!0;try{(0,l.Fi)({eventId:"Fetch LicenseDetails",dynamicEventPart:`from ${o.LICENSE_ENDPOINT} for Storage - Start`});let e=await (0,s._G)(o.TOKEN_RESOURCE_GRAPH,"GRAPH"),t=await (0,i.h)(o.LICENSE_ENDPOINT,{method:"GET",headers:{Authorization:`Bearer ${e}`}});if(401===t.status||!1===t.ok){(0,l.Fi)({eventId:"Error",errorMessage:"Fetch storage LicenseDetails - Error. Reason: (401) Unauthorized || (ok) false"});return}{(0,l.Fi)({eventId:"Fetch LicenseDetails",dynamicEventPart:"Storage API Successful - Finish"});let e=!1,r=await t.json();return r?.value?.forEach(t=>{let r=t?.servicePlans?.find(e=>e?.servicePlanName?.toLowerCase().includes("sharepoint")||e?.servicePlanName?.toLowerCase().includes("onedrive")),n=r?.provisioningStatus;"Success"===n&&(e=!0)}),(0,l.Fi)({eventId:"M365 License Check Successful - Finish",dynamicEventPart:`hasStorageServicePlan: ${e}`}),e}}catch(e){(0,l.Fi)({eventId:"Error",errorMessage:`M365 Storage License Check - Error. Reason: ${e}`});return}}},488563:(e,t,r)=>{"use strict";let n;r.d(t,{ZS:()=>e7,pf:()=>te,Fo:()=>tn,EG:()=>to,xf:()=>tc,hU:()=>eQ,RT:()=>tt,Cw:()=>tr,Xq:()=>tm,gV:()=>tp,Jz:()=>tl,FY:()=>th,Co:()=>e0,by:()=>ts,eZ:()=>ti,$6:()=>e9,Ne:()=>e2,iy:()=>tv,dS:()=>td,lE:()=>e1,Cb:()=>e3,o4:()=>tf,sd:()=>eZ,PE:()=>tu,EY:()=>ta,K4:()=>eX,Q5:()=>e5,CM:()=>eY,Ku:()=>tg,cJ:()=>eJ,BA:()=>tb,Mj:()=>ej,$N:()=>e$,kJ:()=>eK});var o=r(766914),i=r(223093),a=r(493180),s=r(45228),l=r(690);let c=(0,s.jK)("updateIsMsalPostLaunch",e=>{l.M.isMsalPostLaunch=e});var u=r(574221),d=r(579270),f=r(366482),h=r(110886),p=r(873209),m=r(758416),g=r(108547),v=r(69088),b=r(717208),y=r(771262);let w=(0,s.jK)("updateTryThesePropmtsData",e=>{l.M.tryThesePromptsData=e}),S=(0,s.jK)("updateUseFallbackTTP",e=>{l.M.useFallbackTTP=e});function C(e){let t=Math.floor(Math.abs(e));return(t<10?"0":"")+t}var I=r(404735);let k="PromptSuggestionFREResponseFail",E="PromptSuggestionFREResponseSuccess",_="ImmersiveBizchatTtpData";async function A(e,t,r="BizChatWeb",n,o){let s,c;if(!e&&(0,f.tn)()==i.Hz){(0,d.Fi)({eventId:"LogError",detail:"No substrateSearchToken found for PromptSuggestions request"}),S(!0);return}if((0,u.s)("immersive-bizchat-blaze-cache-ttp-local")){let e=(0,I._S)(window,`${_}_${t}_${r}_${n}_${o}`);e&&w(e)}let h=(0,y._R)(),p=(0,y._R)(),m=(0,y._R)(),g="",v="",P=(0,u.wX)("immersive-bizchat-scs-client-correlation-id")?l.M.clientCorrelationId:"",O={clientLogicalId:h,clientRequestId:m},R=(0,u.wX)("immersive-bizchat-enable-3S-events-logging");(0,d.Fi)({eventId:"PromptSuggestionFREPreRequest",traceId:p});let x=(0,u.wX)("immersive-bizchat-enable-new-ttp-timeout"),M=(0,u.wX)("immersive-bizchat-enable-ttp-component-one-sec-timeout")||(0,u.wX)("immersive-bizchat-enable-ttp-component-two-sec-timeout"),N=new AbortController,{signal:F}=N,L=setTimeout(()=>{N.abort()},M?1/0:x?1e3:2200),z=+new Date;try{let i=await (0,b.h)("https://substrate.office.com/search/api/v1/suggestions",{method:"POST",headers:{Accept:"application/json","Accept-language":t,Authorization:`Bearer ${e}`,"User-Agent":navigator.userAgent,"Content-Type":"application/json","client-request-id":m??p,"client-session-id":P??"","X-Client-Flights":"EnablePromptSuggestion,ServeStaticPrompts,EnableClientLocaleBasedFilterSupportForPrompts",Origin:window.location.origin,"x-cafelatencyheaderenabled":"1",...o?{"X-AnchorMailbox":o}:{},"X-Client-Localtime":function(e){let t=-e.getTimezoneOffset();return e.getFullYear()+"-"+C(e.getMonth()+1)+"-"+C(e.getDate())+"T"+C(e.getHours())+":"+C(e.getMinutes())+":"+C(e.getSeconds())+"."+C(e.getMilliseconds())+(t>=0?"+":"-")+C(t/60)+":"+C(t%60)}(new Date),"X-Client-Language":t},body:JSON.stringify({EntityRequests:[{EntityType:"Prompt",Query:{QueryString:""},Filter:{And:[{Or:[{Term:{Product:"Bizchat"}}]}]}}],TimeZone:"UTC",Cvid:p,LogicalId:h,Scenario:{Name:r,Dimensions:[{DimensionName:"UserExperience",DimensionValue:n}]}}),signal:F}),l=await i.json();c=+new Date,g=i.status.toString(),O.statusCode=g,O.statusText=i.statusText,v=i.headers.get("request-id")??"",O.latency=String(c-z),clearTimeout(L),i.ok||(g=i.status.toString(),(0,a.T4)(k,"PromptSuggestions",p,`Prompt Suggestions response returned ${i.status} ${i.statusText}`,c-z,[["clientLogicalId",h],["SubstrateTraceId",l?.Instrumentation?.TraceId],["clientRequestId",m],["cafeRequestId",v]],g,"Fail",i),S(!0)),s={traceId:l?.Instrumentation?.TraceId,suggestions:l?.Groups[0]?.Suggestions}}catch(o){c=+new Date;let e=!1;o instanceof Error&&(e=o.message?.includes("The user aborted a request")||o.message?.includes("signal is aborted without reason"));let t=e?"PromptSuggestionFREResponseExpected":k,n=o instanceof Error?o.message:o;(0,a.T4)(t,"PromptSuggestions",p,`PromptSuggestions_traceId: ${s?.traceId??"No traceId found"}; Error: ${n};  scenarioName: ${r}; cafeRequestId: ${v}`,c-z,[["clientLogicalId",h],["SubstrateTraceId",s?.traceId??m],["clientRequestId",m],["cafeRequestId",v]],g),S(!0);return}try{if(function(e){if(!Array.isArray(e?.suggestions))throw Error('Missing "suggestions"')}(s),(0,a.T4)(E,"PromptSuggestions",p,"",c-z,[["clientLogicalId",h],["SubstrateTraceId",s?.traceId??m],["cafeRequestId",v]],g),R)O.promptSuggestionsResponse=s,O.eventId=E;else{let e=JSON.stringify(s);w(e),T(e,t,r,n,o)}}catch(t){let e=t instanceof Error?t.message:t;(0,a.T4)("PromptSuggestionFREResponseUnexpected","PromptSuggestions",p,`PromptSuggestions_traceId: ${s?.traceId??"No traceId found"}; Error: ${e};  scenarioName: ${r}; cafeRequestId: ${v}`,c-z,[["clientLogicalId",h],["SubstrateTraceId",s?.traceId??m]],g),S(!0)}if(R){let e=JSON.stringify(O);w(e),T(e,t,r,n,o)}}function T(e,t,r,n,o){(0,u.s)("immersive-bizchat-blaze-cache-ttp-local")&&(0,I.AP)(window,`${_}_${t}_${r}_${n}_${o}`,e)}var P=r(654470),O=r(324233),R=r(446623);let x=new P.Ay(()=>r.e(34413).then(r.bind(r,877104)));function M(e){let t=new O.q(x,t=>()=>t.warmupGoBold(e));return(0,R.o)(t)}function N(e){let t=new O.q(x,t=>()=>t.warmupCatchup(e));return(0,R.o)(t)}var F=r(266143);let L=(0,s.jK)("updateFeedbackPolicies",e=>{l.M.feedbackPolicies=e}),z=(0,s.jK)("updateOCPSResponseStatus",e=>{l.M.ocpsPolicies.isCPSResponseSuccessful=e}),D=(0,s.jK)("updateOcpsPolicies",e=>{let t=l.M.ocpsPolicies.isCPSResponseSuccessful;if(l.M.ocpsPolicies={optionalConnectedExperiencesEnabled:e.optionalConnectedExperiencesEnabled,isCopilotPinningEnabled:e.isCopilotPinningEnabled,isLoopEnabledForPages:e.loopEnabled,isLoopBizchatDocsEnabledForPages:e.loopBizChatDocsEnabled,isCPSResponseSuccessful:t},(0,u.wX)("immersive-bizchat-websearch-policy")){if(l.M.ocpsPolicies.isCopilotWebSearchEnabledSignal=e.webSearchEnabled,""!==e.webSearchEnabled)switch(e.webSearchEnabled){case"0":l.M.ocpsPolicies.isCopilotWebSearchEnabledWork=!0,l.M.ocpsPolicies.isCopilotWebSearchEnabledWeb=!0;break;case"1":l.M.ocpsPolicies.isCopilotWebSearchEnabledWork=!1,l.M.ocpsPolicies.isCopilotWebSearchEnabledWeb=!1;break;case"2":l.M.ocpsPolicies.isCopilotWebSearchEnabledWork=!1,l.M.ocpsPolicies.isCopilotWebSearchEnabledWeb=!0}else if(""===e.optionalConnectedExperiencesEnabled||l.M.accountInfo?.environment?.toLowerCase().includes("gcc"))l.M.accountInfo?.environment?.toLowerCase().includes("gcc")?(l.M.ocpsPolicies.isCopilotWebSearchEnabledWork=!1,l.M.ocpsPolicies.isCopilotWebSearchEnabledWeb=!1):(l.M.ocpsPolicies.isCopilotWebSearchEnabledWork=!0,l.M.ocpsPolicies.isCopilotWebSearchEnabledWeb=!0);else switch(e.optionalConnectedExperiencesEnabled){case"1":l.M.ocpsPolicies.isCopilotWebSearchEnabledWork=!0,l.M.ocpsPolicies.isCopilotWebSearchEnabledWeb=!0;break;case"2":l.M.ocpsPolicies.isCopilotWebSearchEnabledWork=!1,l.M.ocpsPolicies.isCopilotWebSearchEnabledWeb=!1}}});var B=(e=>(e.Enabled="Enabled",e.Disabled="Disabled",e.NotConfigured="Not Configured",e))(B||{});let U={connectedExperiences:B.Disabled,optionalConnectedExperiences:B.Disabled,policyAllowContact:B.Disabled,policyAllowContent:B.Disabled,policyAllowFeedback:B.Disabled,policyAllowScreenshot:B.Disabled,policyAllowSurvey:B.Disabled,policyEmailCollectionDefault:B.Disabled,policyScreenshotDefault:B.Disabled,policyContentSamplesDefault:B.Disabled,policyAllowCopilotFeedback:B.Disabled},H={connectedExperiences:B.Enabled,optionalConnectedExperiences:B.Enabled,policyAllowContact:B.Enabled,policyAllowContent:B.Enabled,policyAllowFeedback:B.Enabled,policyAllowScreenshot:B.Enabled,policyAllowSurvey:B.Enabled,policyEmailCollectionDefault:B.Enabled,policyScreenshotDefault:B.Enabled,policyContentSamplesDefault:B.Enabled,policyAllowCopilotFeedback:B.Enabled},q={connectedExperiences:B.Enabled,optionalConnectedExperiences:B.Enabled,policyAllowContact:B.Disabled,policyAllowContent:B.Disabled,policyAllowFeedback:B.Disabled,policyAllowScreenshot:B.Disabled,policyAllowSurvey:B.Disabled,policyEmailCollectionDefault:B.Disabled,policyScreenshotDefault:B.Disabled,policyContentSamplesDefault:B.Disabled,policyAllowCopilotFeedback:B.Disabled},j={contactSupportEnabled:"2",diagnosticsTroubleshootingEnabled:"2",emailCollectionEnabled:"2",emailCollectionDefault:"2",feedbackEnabled:"2",logContentEnabled:"2",contentSamplesDefault:"2",npsSurveyEnabled:"2",connectedOfficeExperiencesEnabled:"",outlookRecommendationEnabled:"",screenshotEnabled:"2",screenshotDefault:"2",loopEnabled:"1",loopEnabledForOutlook:"",loopPlannerEnabled:"",loopVideoPlaybackEnabled:"",loopVideoRecordEnabled:"",disableSharingPermissions:"",experiencesDownloadingContentEnabled:"",experiencesAnalyzingContentEnabled:"",copilotFeedbackEnabled:"2",expirationDate:"",loopBizChatDocsEnabled:"1",webSearchEnabled:"",optionalConnectedExperiencesEnabled:"1",isCopilotPinningEnabled:"1",isLoopEnabledForPages:"1",isLoopBizchatDocsEnabledForPages:"1",isCopilotWebSearchEnabledSignal:"0",isCopilotWebSearchEnabledWeb:!0,isCopilotWebSearchEnabledWork:!0},$="CheckIn-Interval";function W(e){return e?"1"===e?B.Enabled:B.Disabled:B.NotConfigured}function V(e){let t="Not Configured",r={optionalConnectedExperiences:t,connectedExperiences:t,policyAllowContact:t,policyAllowContent:t,policyAllowFeedback:t,policyAllowScreenshot:t,policyAllowSurvey:t,policyEmailCollectionDefault:t,policyScreenshotDefault:t,policyContentSamplesDefault:t,policyAllowCopilotFeedback:t};return e&&(r.optionalConnectedExperiences=W(e.optionalConnectedExperiencesEnabled),r.connectedExperiences=W(e.connectedOfficeExperiencesEnabled),r.policyAllowContact=W(e.emailCollectionEnabled),r.policyAllowContent=W(e.logContentEnabled),r.policyAllowFeedback=W(e.feedbackEnabled),r.policyAllowScreenshot=W(e.screenshotEnabled),r.policyAllowSurvey=W(e.npsSurveyEnabled),r.policyEmailCollectionDefault=W(e.emailCollectionDefault),r.policyScreenshotDefault=W(e.screenshotDefault),r.policyContentSamplesDefault=W(e.contentSamplesDefault),r.policyAllowCopilotFeedback=W(e.copilotFeedbackEnabled)),r}let G="Immersive_BizChat_OCPS_Policies",K="Immersive_BizChat_CPS_Policies",X=e=>{try{let t=(0,F.Hd)(window,e||G);return JSON.parse(t||"{}")}catch{return}},Y=e=>{try{let t=(0,I._S)(window,e||K);return JSON.parse(t||"{}")}catch{return}},Z=async(e,t,r=1)=>{try{(0,d.Fi)({eventId:"LogInfo",detail:`Attempting to fetch OCPS policies. Attempt: ${r}`});let n=await (0,b.h)(e,t);if(!n.ok&&r<3)return Z(e,t,r+1);return n}catch(n){if(r<3)return Z(e,t,r+1);throw(0,d.Fi)({eventId:"Error",detail:`Max retries exceeded: ${n instanceof Error?n.message:String(n)}`}),Error("Max retries exceeded")}},Q=async(e,t)=>{let r=new Headers;r.append("Content-Type","application/json; charset=utf-8"),r.append("Authorization",function(e){let t=e?.split(" ")?.[0].toLowerCase();return"msauth1.0"==t||"bearer"==t?e:`Bearer ${e}`}(t)),r.append("x-Cid",e);let n={method:"GET"};return n.headers=r,Z(l.M?.accountInfo?.environment==="GCCModerate"?"https://clients.config.gcc.office.net/user/v1.0/web/policies":"https://clients.config.office.net/user/v1.0/web/policies",n)};async function J(e){var t=l.M?.accountInfo?.environment==="GCCModerate";(0,d.Fi)({eventId:"LogInfo",detail:`Fetching OCPS Policies isGcc: ${t}`});let r={policies:{contactSupportEnabled:"",diagnosticsTroubleshootingEnabled:"",emailCollectionEnabled:"",emailCollectionDefault:"",feedbackEnabled:"",logContentEnabled:"",contentSamplesDefault:"",npsSurveyEnabled:"",optionalConnectedExperiencesEnabled:"",connectedOfficeExperiencesEnabled:"",outlookRecommendationEnabled:"",screenshotEnabled:"",screenshotDefault:"",loopEnabled:"1",loopEnabledForOutlook:"",loopPlannerEnabled:"",loopVideoPlaybackEnabled:"",loopVideoRecordEnabled:"",disableSharingPermissions:"",experiencesDownloadingContentEnabled:"",experiencesAnalyzingContentEnabled:"",copilotFeedbackEnabled:"",isCopilotPinningEnabled:"",expirationDate:"",loopBizChatDocsEnabled:"1",webSearchEnabled:""},feedbackPolicies:{policies:U,expirationDate:""}},n="",o=new Date,i=new Date(Date.UTC(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds()));if(!e)return(0,d.Fi)({eventId:"LogError",detail:"OCPS Token is empty"}),r;try{let t=(0,y._R)(),o=await Q(t,e);(0,d.Fi)({eventId:"LogInfo",detail:"Received response from OCPS",statusCode:o.status.toString()});let a=o.headers.has($)?o.headers.get($):"90";if(a&&(n=i.setMinutes(i.getMinutes()+parseInt(a)).toString()),204!==o.status&&o.ok){let e=await o.json();z(!0),e?.value?.[0]?.policiesPayload.length>0&&(e.value[0].policiesPayload.forEach(e=>{let t={"office16;L_SendFeedback":"feedbackEnabled","office16;L_EmailCollection":"emailCollectionEnabled","office16;L_FeedbackOptionsDefaults;L_FeedbackOptionsDefaultsEmail":"emailCollectionDefault","office16;L_SendSurvey":"npsSurveyEnabled","office16;L_Screenshot":"screenshotEnabled","office16;L_FeedbackOptionsDefaults;L_FeedbackOptionsDefaultsScreenshot":"screenshotDefault","office16;L_LogCollection":"logContentEnabled","office16;L_FeedbackOptionsDefaults;L_FeedbackOptionsDefaultsContentSamples":"contentSamplesDefault","outlk16;L_RecommendOutlookExtension":"outlookRecommendationEnabled","outlkNew;L_ContactSupport":"contactSupportEnabled","outlkNew;L_EnableDiagnosticsTroubleshooting":"diagnosticsTroubleshootingEnabled","office16;L_OptionalConnectedExperiences":"optionalConnectedExperiencesEnabled","office16;L_ConnectedOfficeExperiences":"connectedOfficeExperiencesEnabled","office16;L_Loop":"loopEnabled","outlk16;L_Loop_Outlook":"loopEnabledForOutlook","office16;L_Loop_Planner":"loopPlannerEnabled","office16;L_Stream_Video_Preview_and_Playback":"loopVideoPlaybackEnabled","office16;office16;L_Stream_Video_Record":"loopVideoRecordEnabled","outlk16;L_TurnOffSharingRecommendation":"disableSharingPermissions","office16;L_OfficeExperiencesDownloadingContent":"experiencesAnalyzingContentEnabled","office16;L_OfficeExperiencesAnlayzingContent":"experiencesDownloadingContentEnabled","office16;L_SendCopilotFeedback":"copilotFeedbackEnabled","office16;L_IsCopilotPinningEnabled":"isCopilotPinningEnabled","office16;L_Loop_BizChatDocs":"loopBizChatDocsEnabled","office16;L_CopilotWebSearch;L_CopilotWebSearchOptions":"webSearchEnabled"}[e.settingId];r.policies[t]=e.value}),(0,d.Fi)({eventId:"LogInfo",detail:`User OCPS Policies: ${JSON.stringify(r.policies)}`}),r.feedbackPolicies={policies:V(r.policies),expirationDate:n})}else 204==o.status?((0,d.Fi)({eventId:"LogInfo",detail:"No policies configured",statusCode:o.status.toString()}),z(!0),r.feedbackPolicies={policies:V(r.policies),expirationDate:n}):((0,d.Fi)({eventId:"LogInfo",detail:`Could not fetch policies from OCPS. Default to disabled. X-Cid: ${t}`,statusCode:o.status.toString()}),z(!1),r.policies.optionalConnectedExperiencesEnabled="2",r.policies.webSearchEnabled="1")}catch(e){(0,d.Fi)({eventId:"LogError",detail:`Error while fetching OCPS policies: ${e.toString()} `}),z(!1),r.feedbackPolicies={policies:U},r.policies.optionalConnectedExperiencesEnabled="2",r.policies.webSearchEnabled="1"}try{return(0,u.wX)("immersive-bizchat-cps-local-storage")?(0,I.AP)(window,`${G}_${l.M.accountInfo?.objectId}`,JSON.stringify(r.feedbackPolicies)):(0,F.J2)(window,`${G}_${l.M.accountInfo?.objectId}`,JSON.stringify(r.feedbackPolicies)),r}catch(e){return(0,d.Fi)({eventId:"LogError",detail:`Error while storing OCPS feedback policies: ${e.toString()} `}),r.feedbackPolicies={policies:U,expirationDate:""},r}}async function ee(e){if(l.M.accountInfo?.accountType==="MSA"&&(0,u.wX)("immersive-bizchat-msa-support")){(0,d.Fi)({eventId:"LogInfo",detail:"Account type: MSA. Not fetching policies"});return}let t=new Date().getTime(),r=function(){try{let e,t="",r=`${G}_${l.M.accountInfo?.objectId}`,n=`${K}_${l.M.accountInfo?.objectId}`;try{(0,u.wX)("immersive-bizchat-cps-local-storage")?Y(n)&&(e=JSON.parse((0,I._S)(window,n)??""),t=e?.expirationDate??""):X(r)&&(e=JSON.parse((0,F.Hd)(window,r)??""),t=e?.expirationDate??"")}catch(e){(0,d.Fi)({eventId:"LogInfo",detail:`Error serializing policies from cache: ${e.toString()}`})}let o=new Date,i=new Date(Date.UTC(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds())),a=new Date(i.toISOString());if(t)try{a=new Date(parseInt(t))}catch{t="",(0,d.Fi)({eventId:"LogError",detail:`Error while parsing OCPS expiration: ${t} `})}let s=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds()));if(!t||i>s)return;return(0,F.J2)(window,r,JSON.stringify(e)),e}catch(e){(0,d.Fi)({eventId:"LogError",detail:`Error while fetching OCPS policies from cache: ${e.toString()} `});return}}();if(r){let e=new Date().getTime()-t;(0,d.Fi)({eventId:"LogInfo",detail:"Get feedback policy from cache",metaData:JSON.stringify({latency:e})}),L(r)}J(e).then(e=>{let n=new Date().getTime()-t;r||((0,d.Fi)({eventId:"LogInfo",detail:"Get feedback policy from OCPS",metaData:JSON.stringify({latency:n})}),L(e.feedbackPolicies)),(0,d.Fi)({eventId:"LogInfo",detail:"Get policy from OCPS",metaData:JSON.stringify({latency:n})}),D(e.policies)})}var et=r(295806),er=r(834970);let en=e=>{let t="";for(;t.length<e;)t+=Math.floor(65536*Math.random()).toString(16);return t.substring(0,e)},eo=e=>e.filter(e=>e.conversationId&&e.chatName&&e.createTimeUtc&&e.updateTimeUtc&&!e.hasNoMessages&&!e.isMessageless).sort((e,t)=>t.updateTimeUtc-e.updateTimeUtc),ei=e=>{let t=e.get("x-msedge-ref");return t&&t.substring(7,t.indexOf(" Ref B:"))};function ea(e,t,r,n,o,i,a){let s=new Headers;return s.append("Authorization",`Bearer ${e}`),s.append("Origin",window.location.origin),s.append("Content-Type","application/json"),s.append("X-ClientRequestId",t),s.append("X-Scenario",i??""),"cafe"===r&&((0,d.Fi)({eventId:"SessionsAPI",detail:"Adding AnchorMailbox header for cafe",traceId:t}),s.append("X-AnchorMailbox",`Oid:${n??""}@${o??""}`)),a&&s.append("X-Variants","cdxEnableConversationIsUnreadValue"),s}function es(e,t){if(e?.headers){let r=e.headers.get("X-Feserver"),n=e.headers.get("Request-Id"),o=e.headers.get("Date"),i=e.headers.get("Ms-Cv"),a=e.headers.get("x-calculatedbetarget");(0,d.Fi)({eventId:"SessionsAPI",detail:"Response headers - FEServer: "+r+", RequestId: "+n+", Date: "+o+", MSCV: "+i+", X-CalculatedBeTarget: "+a,traceId:t})}}let el=(e,t)=>`Oid:${e??""}@${t??""}`,ec={sdf:"https://sdf.cortana.ai/m365chat/SecuredChatHub",msit:"https://msit.cortana.ai/m365chat/SecuredChatHub",prod:"https://api.cortana.ai/m365chat/SecuredChatHub",default:"https://api.cortana.ai/m365chat/SecuredChatHub"},eu={sdf:"https://sdf-s01-800-nam-westus3.substrate.cosmic-ppe.office.net/m365chat/securedchathub",msit:"https://msit-s01-001-nam-westus.substrate-msit.cosmic.office.net/m365chat/securedchathub",prod:"https://prod-s01-001-nam-westus.substrate.cosmic.office.net/m365chat/securedchathub",default:"https://substrate.office.com/m365chat/SecuredChathub"},ed={sdf:"https://dev.cortana.ai/turingbot/ChatHub",msit:"https://dev.cortana.ai/turingbot/ChatHub",prod:"https://dev.cortana.ai/turingbot/ChatHub",default:"https://dev.cortana.ai/turingbot/ChatHub"},ef={sdf:"https://substrate.office.com/m365Copilot/Chathub",msit:"https://substrate.office.com/m365Copilot/Chathub",prod:"https://substrate.office.com/m365Copilot/Chathub",default:"https://substrate.office.com/m365Copilot/Chathub"},eh=e=>{let t=function(e){let{scenario:t="Chathub",infra:r,ring:n,urlOverride:o,objectId:i,tenantId:a,routingParamSessionKey:s,clientRequestId:l,traceId:c,conversationId:u,requestId:f,isDeveloperFlagEnabled:h,trafficType:p,sessionId:m,endpointVariant:g,enableClientRequestIdHeader:v,enableSydneyWarmup:b}=e,y=`${t}: Null param values found for `+Object.entries({infra:r,ring:n,urlOverride:o,objectId:i,tenantId:a,routingParamSessionKey:s,clientRequestId:l,trafficType:p}).filter(e=>null===e[1]).join(", ").slice(0,-1),w="";y+=`isSydneyWarmupEnabled=${b}. `;let S=ep(n);if(y+=`IsValidRing=${S}. `,"cafe"===r||"avalon"===r){let e="cafe"===r?eu:"AvalonRoutingPlane"===g?ef:ed;w=S?e[n]:e.default,o&&(w=o);let t=/substrate-sdf\.office\.com/i.test(w)||/substrate\.office\.com/i.test(w);y+=`IsSubstratePath=${t}. `,t?w+="/"+(i??"")+"@"+(a??"")+"?":w+="?X-AnchorMailbox="+el(i,a)+"&",s&&(w+="X-RoutingParameter-SessionKey="+s+"&"),l&&(w+=`${"avalon"===r||v?"":"X-"}ClientRequestId=${l}&`),m&&(w+=`X-SessionId=${m}&`)}else w=S?ec[n]:ec.default,o&&(w=o),w+="?";return h&&(y+="Developer flag is enabled. ",w+="developerMode=Basic&"),p&&(w+=`trafficType=${p}&`),b&&u&&(w+=`ConversationId=${u}&`,y+=`ConversationId=${u}`),(0,d.Fi)({eventId:"UXDiagnostic",traceId:c,conversationId:u,requestId:f,message:`[SydneyClient][EndpointConfig] ${y}`}),w}({...e,scenario:"SessionPane",...e?.infra!=="avalon"||e?.endpointVariant==="AvalonCosmic"||e?.endpointVariant==="AvalonRoutingPlane"?void 0:{infra:"cafe"}});return/\/chathub[/?]/i.test(t)?t.split(/chathub/i)[0]:t.split(/securedchathub/i)[0]};function ep(e){return!!e&&["msit","prod","sdf"].indexOf(e)>=0}let em=(0,s.jK)("updateExtensionsList",e=>{l.M.extensionsList=e}),eg=(0,s.jK)("updateExtensionsPrefetchStatus",e=>{l.M.extensionsPrefetchStatus=e}),ev=(0,s.jK)("updateExtensionsTrace",e=>{l.M.extensionsTraceId=e}),eb=(0,s.jK)("updateExtensionsIsCopilotExtensibilityDisabled",e=>{l.M.isCopilotExtensibilityDisabled=e}),ey=async(e,t,r,n="",o,i)=>{eg(er.Ad.InProgress);let a="",s=ea(e??"",n,o,r?.objectId,r?.tenantId,t);try{(0,d.Fi)({eventId:"FetchGpts",detail:"GetGpts Pre-Fetch: Trying to fetch gpt list from sydney.",traceId:n});let e=JSON.stringify({optionsSets:["flux_gpt_data_retriever_enterprise"],traceId:n}),t="https://substrate.office.com/m365Copilot/GetGptList?request="+encodeURIComponent(e);i&&(t="https://turingbot.sdf-test-18.substrate-turing-turingbot.eastus-sdf.cosmic-ppe.office.net/turingbot/GetGptList?request="+encodeURIComponent(e)),(0,b.h)(t,{method:"GET",headers:s}).then(async e=>{let t=await e.json();t?.gptList===void 0?(0,d.Fi)({eventId:"FetchGpts",detail:"GetGpts: Pre-Fetching gptResponse succeeded. GptList undefined "+JSON.stringify(t?.messageToRender),traceId:n,statusCode:e?.status?.toString()}):(em(JSON.stringify(t.gptList)),ev(n),eg(er.Ad.Completed),(0,u.wX)("immersive-bizchat-enable-gpt-prefetch-admin-flag")&&eb(t.isCopilotExtensibilityDisabled??!0),es(e,n),(0,d.Fi)({eventId:"FetchGpts",detail:"GetGpts: Pre-Fetching gptResponse succeeded. Gpt Count: "+t?.gptList?.length,traceId:n,statusCode:e?.status?.toString()}))}).catch(e=>{eg(er.Ad.Failed),a+=`$HTTP Error: ${e.statusText}`,(0,d.Fi)({eventId:"FetchGpts",detail:"GetGpts: Pre-Fetching gptResponse failed: "+a,traceId:n,statusCode:e?.status?.toString()})})}catch(e){eg(er.Ad.Failed),e instanceof Error?a+=e.message:a+="unknown error while fetching gptResponse",(0,d.Fi)({eventId:"FetchGpts",detail:"GetGpts Pre-Fetching Exception while fetching gptResponse: "+a,traceId:n})}},ew=(0,s.jK)("updateRawSessionList",e=>{l.M.rawSessionList=e}),eS=(0,s.jK)("updateFilteredSessionList",e=>{l.M.filteredSessionList=e}),eC=(0,s.jK)("updateSessionsSyncState",e=>{l.M.sessionsSyncState=e}),eI=(0,s.jK)("updateSessionsTrace",e=>{l.M.sessionsTraceId=e}),ek=(0,s.jK)("updateSessionsPrefetchStatus",e=>{l.M.sessionsPrefetchStatus=e}),eE=async(e,t,r,n,o,i,a,s,l,c="",u,f)=>{ek(er.Ad.InProgress);let h="",p=[];n=o||r!==er.He.Recurring?n:"appchat";let m=o||r!==er.He.Recurring?"":"DevUI",g=ea(e??"",c,s,l?.objectId,l?.tenantId,i);try{(0,d.Fi)({eventId:`Fetch${r}Chats`,detail:`Starting GetChats PreFetch with TraceId: ${c}`}),(0,d.Fi)({eventId:`Fetch${r}Chats`,detail:`GetChats PreFetch: Fetching chats (V3) for ${n}  from sydney with TraceId: ${c}`});let e={source:t,traceId:c,threadType:n,...""!==m&&{productThreadType:m},...(f??0)>0&&{maxReturnedChatsCount:f}},i=JSON.stringify(e),v=function(e,t,r,n){let o=window?.location?.search?.toLocaleLowerCase()&&new URLSearchParams(window.location.search.toLocaleLowerCase()).get("cortanaendpoint")||"";return eh({infra:e,ring:ep(o)?o:t,objectId:r?.objectId,tenantId:r?.tenantId,endpointVariant:n})}(s,a,l,u)+er.H2+"?request="+encodeURIComponent(i);(0,b.h)(v,{method:"GET",headers:g}).then(async e=>{let t=await e.json();t.traceId=ei(e.headers),p=t.chats,o||p.forEach(e=>{e.chatType=r});let n=t.syncState??"",i=c??"",a=eo(p),s=JSON.stringify(p),l=JSON.stringify(a);ew(s),eS(l),eC(n),eI(i),ek(er.Ad.Completed),es(e,c),(0,d.Fi)({eventId:`Fetch${r}Chats`,detail:`GetChats PreFetch: Status code: ${e.status} for ${r} chats`,traceId:c,statusCode:e?.status?.toString()}),(0,d.Fi)({eventId:`Fetch${r}Chats`,detail:"GetChats PreFetch: FetchRecentChats (V3) finished. Fetched "+p?.length+" chats",traceId:c,statusCode:e?.status?.toString()}),(0,d.Fi)({eventId:`Fetch${r}Chats`,detail:`GetChats PreFetch: PreFetch completed for ${r} chats`,traceId:c,statusCode:e?.status?.toString()})}).catch(e=>{ek(er.Ad.Failed),h+=`${n} - HTTP Error. Http StatusCode: ${e.status}`,(0,d.Fi)({eventId:`Fetch${r}Chats`,detail:`GetChats PreFetch: Fetching chats (V3) failed for ${n} - HTTP Error. Http StatusCode: ${e.status}`,traceId:c,statusCode:e?.status?.toString()})})}catch(e){ek(er.Ad.Failed),e instanceof Error?h+=e.message:h+=`Unknown error while fetching chat for ${n} `,(0,d.Fi)({eventId:`Fetch${r}Chats`,detail:`GetChats PreFetch: Fetching chats (V3) failed for ${n} ${h}`,traceId:c})}};var e_=r(940962),eA=r(470199);let eT=(0,s.jK)("updateEligibilityInformation",e=>{l.M.eligibility=e});var eP=r(320498);function eO(){if((0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"&&l.M.eligibility){let e=l.M.eligibility;D(j),e.ageGroup===eA.ob.MinorWithParentalConsent||e.ageGroup===eA.ob.MinorWithoutParentalConsent?L({policies:q,expirationDate:""}):L({policies:H,expirationDate:""})}}async function eR(){(0,d.Fi)({eventId:"LogInfo",detail:"Fetching Eligibility Information from cache"});let e=new Date().getTime();try{let t;let r=await (0,m.$n)(),n=!1;if(r){let e=JSON.parse(r);(n=!(void 0===e||void 0===e.eligibilityInfo||void 0===e.expirationDateTimeInMilliseconds||void 0===e.userId||e.userId!==l.M.accountInfo?.objectId||e.expirationDateTimeInMilliseconds<new Date().getTime()))&&(t=e.eligibilityInfo)}let o=new Date().getTime()-e;return(0,d.Fi)({eventId:"LogInfo",detail:"Fetching Eligibility Information from cache end",latency:o,metaData:JSON.stringify({isCacheHit:n,eligibilityInfo:void 0===t?"undefined":"defined"})}),t}catch(e){(0,d.Fi)({eventId:"LogError",detail:"Error while fetching Eligibility Information from cache",metaData:JSON.stringify({error:e.message})});return}}async function ex(e,t){let r;if((0,d.Fi)({eventId:"LogInfo",detail:"Fetching Eligibility Information from API",metaData:JSON.stringify({isSessionRequired:t})}),!e){(0,d.Fi)({eventId:"LogError",detail:"Error: missing eligibility token",metaData:JSON.stringify({isSessionRequired:t})});return}let n=new Date().getTime();try{let o=await ez(e),i=new Date().getTime()-n;if((0,d.Fi)({eventId:"LogInfo",detail:"Received response from Eligibility API",statusCode:o?.status?.toString(),latency:i,metaData:JSON.stringify({response:o?.ok,isSessionRequired:t})}),o?.ok){let e=(await o.json())?.eligibility;if((0,d.Fi)({eventId:"LogInfo",detail:"Successfully received response from Eligibility API",statusCode:o.status.toString(),metaData:JSON.stringify({isSessionRequired:t})}),r={isCopilotEligible:e?.isCopilotEligible??!1,cohort:e?.cohort?.toLowerCase()??eA.N9.None,persona:e?.persona?.toLowerCase()??eA.FN.None,ageGroup:function(e){switch(e?.toLocaleLowerCase()??""){case eA.ob.Adult.toLocaleLowerCase():return eA.ob.Adult;case eA.ob.NonAdult.toLocaleLowerCase():return eA.ob.NonAdult;case eA.ob.MinorNoParentalConsentRequired.toLocaleLowerCase():return eA.ob.MinorNoParentalConsentRequired;case eA.ob.MinorWithParentalConsent.toLocaleLowerCase():return eA.ob.MinorWithParentalConsent;case eA.ob.MinorWithoutParentalConsent.toLocaleLowerCase():return eA.ob.MinorWithoutParentalConsent;case eA.ob.None.toLocaleLowerCase():return eA.ob.None;case eA.ob.Unknown.toLocaleLowerCase():default:return eA.ob.Unknown}}(e?.ageGroup),isCopilotEnabledRegion:e?.isCodexEnabledRegion??!1,isOptedOutByAdmin:e?.isOptedOutByAdmin??!1,eduType:e?.eduType?.toLowerCase()??eA.fw.None,isError:!1,featureSet:e?.featureSet},l.M.accountInfo?.objectId)try{let e={eligibilityInfo:r,userId:l.M.accountInfo?.objectId,expirationDateTimeInMilliseconds:new Date().getTime()+36e5};(0,m.FI)(JSON.stringify(e))}catch(e){(0,d.Fi)({eventId:"LogError",detail:"Error while saving Eligibility Information into cache",metaData:JSON.stringify({error:e.message,isSessionRequired:t})})}}else(0,d.Fi)({eventId:"LogInfo",detail:"Could not fetch Eligibility Information from API.",statusCode:o.status.toString(),metaData:JSON.stringify({isSessionRequired:t})})}catch(e){(0,d.Fi)({eventId:"LogError",detail:"Error while fetching Eligibility Information from API",metaData:JSON.stringify({error:e.message,isSessionRequired:t})})}let o=new Date().getTime()-n;return(0,d.Fi)({eventId:"LogInfo",detail:"Fetching Eligibility Information from API end",latency:o,metaData:JSON.stringify({eligibilityInfo:void 0===r?"undefined":"defined",isSessionRequired:t})}),r}async function eM(e,t,r){let n;let o=new Date().getTime();try{(0,d.Fi)({eventId:"LogInfo",detail:"Fetching Eligibility token",metaData:JSON.stringify({isSessionRequired:e})}),n=await th(!0,t,r)}catch(t){(0,d.Fi)({eventId:"LogError",detail:`Error while fetching eligibility token: ${t.toString()} `}),(0,d.Fi)({eventId:"LogError",detail:"Error while fetching Eligibility Token",metaData:JSON.stringify({error:t.toString(),isSessionRequired:e})})}let i=new Date().getTime()-o;return(0,d.Fi)({eventId:"LogInfo",detail:"Fetching Eligibility token end",latency:i,metaData:JSON.stringify({token:void 0===n?"undefined":"defined",tokenLength:n?.length,isSessionRequired:e})}),n}async function eN(){let e,t="None";try{(0,e_.qv)("bizchat-metaOS-app.FetchEligibilityStart"),(0,d.Fi)({eventId:"LogInfo",detail:"Fetching Eligibility Information"}),(0,u.wX)("immersive-bizchat-eligibility-gcc-mock")&&!(0,u.wX)("immersive-bizchat-eligibility-gcc-nomock")&&l.M?.accountInfo?.environment==="GCCModerate"?(t="GCC Mock",e={isCopilotEligible:!0,cohort:eA.N9.BCAIS,persona:eA.FN.None,ageGroup:eA.ob.None,isCopilotEnabledRegion:!0,isOptedOutByAdmin:!1,eduType:eA.fw.None,isError:!1}):(0,u.wX)("immersive-bizchat-eligibility-emergency-mock")&&((0,d.Fi)({eventId:"LogInfo",detail:"Emergency mock eligibility info"}),t="Emergency Mock",e={isCopilotEligible:!0,cohort:eA.N9.BCAIS,persona:eA.FN.None,ageGroup:eA.ob.None,isCopilotEnabledRegion:!0,isOptedOutByAdmin:!1,eduType:eA.fw.None,isError:!1}),e||(t="Hub",e=await (0,eP.$3)()),e||(t="Cache",e=await eR()),e&&((0,u.wX)("immersive-bizchat-enable-teams-starter")||e.cohort!==eA.N9.BCWAF&&e.cohort!==eA.N9.BCWBF||(0,i.OB)()!==i.Hz||(t="Teams Mock",e.isCopilotEligible=!1),!(0,u.wX)("immersive-bizchat-enable-outlook-starter")&&(e.cohort===eA.N9.BCWAF||e.cohort===eA.N9.BCWBF)&&[i.W_,i.NC,i.Sl,i.Gu].includes((0,i.OB)())&&(t="Outlook Mock",e.isCopilotEligible=!1))}catch(e){(0,d.Fi)({eventId:"LogError",detail:`Error while fetching Eligibility Information from Hub or Cache: ${e.message} `})}return e&&((0,e_.qv)("bizchat-metaOS-app.FetchEligibilityEnd"),eT(e)),[t,e]}async function eF(e){let t,r="None",n=!1;try{let o=await e;if(o&&([r,t]=o),n=null!=t,!t){let e=await eM(!0);t=await ex(e,!0)}t||(r="Failure",t={isError:!0,isCopilotEligible:!1,isOptedOutByAdmin:!1,isCopilotEnabledRegion:!1,ageGroup:eA.ob.Unknown,cohort:eA.N9.None,eduType:eA.fw.None,persona:eA.FN.None}),(0,u.wX)("immersive-bizchat-enable-teams-starter")||t.cohort!==eA.N9.BCWAF&&t.cohort!==eA.N9.BCWBF||(0,i.OB)()!==i.Hz||(r="Teams Mock",t.isCopilotEligible=!1),!(0,u.wX)("immersive-bizchat-enable-outlook-starter")&&(t.cohort===eA.N9.BCWAF||t.cohort===eA.N9.BCWBF)&&[i.W_,i.NC,i.Sl,i.Gu].includes((0,i.OB)())&&(r="Outlook Mock",t.isCopilotEligible=!1),"Failure"===r&&(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"&&(t.isCopilotEligible=!0,t.cohort=eA.N9.BCWBF,r="MSA")}catch(e){(0,d.Fi)({eventId:"LogError",detail:`Error while fetching Eligibility Information: ${e.message} `}),r="Error",t={isError:!0,isCopilotEligible:!1,isOptedOutByAdmin:!1,isCopilotEnabledRegion:!1,ageGroup:eA.ob.Unknown,cohort:eA.N9.None,eduType:eA.fw.None,persona:eA.FN.None}}(0,d.Fi)({eventId:"LogInfo",detail:"Fetching Eligibility Information end",metaData:JSON.stringify({source:r,eligibilityInfo:void 0===t?"undefined":"defined",featureSet:t?.featureSet===void 0?"undefined":"defined"})}),n||((0,e_.qv)("bizchat-metaOS-app.FetchEligibilityEnd"),eT(t)),eO()}async function eL(e,t){let r;let n=new Date().getTime(),o="Eligibility token not needed",a="None";try{(0,e_.qv)("bizchat-metaOS-app.FetchEligibilityStart"),(0,d.Fi)({eventId:"LogInfo",detail:"Fetching Eligibility Information"}),(0,u.wX)("immersive-bizchat-eligibility-gcc-mock")&&!(0,u.wX)("immersive-bizchat-eligibility-gcc-nomock")&&l.M?.accountInfo?.environment==="GCCModerate"?(a="GCC Mock",r={isCopilotEligible:!0,cohort:eA.N9.BCAIS,persona:eA.FN.None,ageGroup:eA.ob.None,isCopilotEnabledRegion:!0,isOptedOutByAdmin:!1,eduType:eA.fw.None,isError:!1}):(0,u.wX)("immersive-bizchat-eligibility-emergency-mock")&&((0,d.Fi)({eventId:"LogInfo",detail:"Emergency mock eligibility info"}),a="Emergency Mock",r={isCopilotEligible:!0,cohort:eA.N9.BCAIS,persona:eA.FN.None,ageGroup:eA.ob.None,isCopilotEnabledRegion:!0,isOptedOutByAdmin:!1,eduType:eA.fw.None,isError:!1}),r||(a="Hub",r=await (0,eP.$3)()),r||(a="Cache",r=await eR()),r?eM(!1,e,t).then(e=>ex(e,!1)):(a="API",o=await eM(!0,e,t),r=await ex(o,!0)),r||(a="Failure",r={isError:!0,isCopilotEligible:!1,isOptedOutByAdmin:!1,isCopilotEnabledRegion:!1,ageGroup:eA.ob.Unknown,cohort:eA.N9.None,eduType:eA.fw.None,persona:eA.FN.None}),(0,u.wX)("immersive-bizchat-enable-teams-starter")||r.cohort!==eA.N9.BCWAF&&r.cohort!==eA.N9.BCWBF||(0,i.OB)()!==i.Hz||(a="Teams Mock",r.isCopilotEligible=!1),!(0,u.wX)("immersive-bizchat-enable-outlook-starter")&&(r.cohort===eA.N9.BCWAF||r.cohort===eA.N9.BCWBF)&&[i.W_,i.NC,i.Sl,i.Gu].includes((0,i.OB)())&&(a="Outlook Mock",r.isCopilotEligible=!1),"Failure"===a&&(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"&&(r.isCopilotEligible=!0,r.cohort=eA.N9.BCWBF,a="MSA")}catch(e){(0,d.Fi)({eventId:"LogError",detail:`Error while fetching Eligibility Information: ${e.message} `}),a="Error",r={isError:!0,isCopilotEligible:!1,isOptedOutByAdmin:!1,isCopilotEnabledRegion:!1,ageGroup:eA.ob.Unknown,cohort:eA.N9.None,eduType:eA.fw.None,persona:eA.FN.None}}let s=new Date().getTime()-n;return(0,d.Fi)({eventId:"LogInfo",detail:"Fetching Eligibility Information end",latency:s,metaData:JSON.stringify({source:a,eligibilityInfo:void 0===r?"undefined":"defined",featureSet:r?.featureSet===void 0?"undefined":"defined"})}),(0,e_.qv)("bizchat-metaOS-app.FetchEligibilityEnd"),eT(r),(0,u.wX)("immersive-bizchat-fix-eligibility-fetch")&&eO(),o}let ez=async e=>{let t=new Headers;t.append("Content-Type","application/json; charset=utf-8"),t.append("Authorization",function(e){let t=e?.split(" ")?.[0].toLowerCase();return"msauth1.0"==t||"bearer"==t?e:`Bearer ${e}`}(e)),t.append("X-Ms-Correlation-Id",l.M.sessionID);let r={method:"GET"};return r.headers=t,eD(l.M?.accountInfo?.environment==="GCCModerate"?"https://usgov.mss.office.com/api/v3/user/copilot/eligibility":"https://mss.office.com/api/v3/user/copilot/eligibility",r)},eD=async(e,t,r=1)=>{try{(0,d.Fi)({eventId:"LogInfo",detail:`Attempting to fetch Eligibility Information Attempt:${r}`});let n=await (0,b.h)(e,t);if(!n.ok&&r<3)return eD(e,t,r+1);return n}catch(n){if(r<3)return eD(e,t,r+1);throw(0,d.Fi)({eventId:"LogError",detail:"Max retries exceeded fetching Eligibility Information"}),n}};var eB=r(442976);let eU="ERROR",eH=1,eq="";async function ej(){(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?await eV():(await eV(),await e$())}async function e$(){try{if((0,f.tn)()!==i.Hz||(0,u.wX)("immersive-bizchat-enable-prefetch-all-msal-access-tokens"))return!0;let[e,t,r,n,o,a]=await Promise.all([eY().then(e=>(tw(e),e)),eQ(),eX().then(e=>(ty(e),e)),e9().then(e=>(M(e.accessToken),N(e.accessToken),e)),e1().then(e=>(ee(e),e)),eL().then(e=>((0,u.wX)("immersive-bizchat-fix-eligibility-fetch")||eO(),e))]);return!!t&&!!r&&!!e&&!!n&&!!o&&!!a}catch(e){return!1}}function eW(e,t){let r=()=>e9(!0,e,t).then(e=>(M(e.accessToken),N(e.accessToken),e.accessToken)),n=()=>eX(!0,e,t).then(e=>(ty(e),e));return[()=>eY(!0,void 0,e,t).then(e=>(tw(e),e)),()=>(0,u.wX)("immersive-bizchat-fetch-bold-token-first")?r():n(),()=>(0,u.wX)("immersive-bizchat-fetch-bold-token-first")?n():r(),()=>eQ(void 0,e,t),()=>e0(void 0,e,t),()=>e1(!0,void 0,e,t).then(e=>((0,d.Fi)({eventId:"LogInfo",detail:"OCPS token fetched during prefetching msal tokens"}),ee(e),e)),()=>eL(e,t).then(e=>((0,u.wX)("immersive-bizchat-fix-eligibility-fetch")||eO(),e))]}async function eV(){try{if((0,f.tn)()===i.Hz&&!(0,u.wX)("immersive-bizchat-enable-prefetch-all-msal-access-tokens"))return!0;let[e,t,r,n,o,a,s]=[void 0,void 0,void 0,void 0,void 0,void 0,void 0];if((0,u.wX)("immersive-bizchat-enable-prefetch-all-msal-access-tokens")){let i=new AbortController,{signal:l}=i;try{let i=eW(!0,l).map(e=>e());if([e,t,r,n,o,a,s]=await Promise.all(i),e&&t&&r&&n&&o&&a&&s)return(0,d.Fi)({eventId:"LogInfo",detail:"Successfully fetched all access tokens through MSAL",message:new Date().getTime()}),!0}catch(e){i.abort(),(0,d.Fi)({eventId:"LogInfo",detail:"Failed to fetch all access tokens through MSAL",message:new Date().getTime()})}}if((0,u.wX)("immersive-bizchat-fix-eligibility-fetch"))return await eG(),!0;(0,d.Fi)({eventId:"LogInfo",detail:"Fetch sydney token in prefetch flow in prefetchTokensMsal - Start",message:new Date().getTime()});let l=eW();if(e=await l[0](),(0,d.Fi)({eventId:"LogInfo",detail:"Fetch sydney token in prefetch flow in prefetchTokensMsal - Stop",message:new Date().getTime()}),!e)return(0,d.Fi)({eventId:"LogInfo",detail:"Failed to fetch first MSAL Token from popup.",message:new Date().getTime()}),!1;(0,d.Fi)({eventId:"LogInfo",detail:"Prefetching msal tokens"});let c=l.slice(1).map(e=>e());[t,r,n,o,a,s]=await Promise.all(c);let h=!!t&&!!r&&!!n&&!!o&&!!a&&!!s;return(0,d.Fi)({eventId:"LogInfo",detail:"Fetched response from all MSAL tokens. Success =  "+h,message:new Date().getTime()}),h}catch(e){return(0,d.Fi)({eventId:"LogInfo",detail:"Failed to retrieve MSAL tokens "+e.message,message:new Date().getTime()}),!1}}async function eG(){(0,d.Fi)({eventId:"LogInfo",detail:"Fetch sydney token in prefetch flow in prefetchTokensMsalV2 - Start",message:new Date().getTime()});var e=eY(!0),t=eN(),r=await e;(0,d.Fi)({eventId:"LogInfo",detail:"Fetch sydney token in prefetch flow in prefetchTokensMsalV2 - Stop",message:new Date().getTime()}),eF(t),tw(r),e9(!0).then(e=>(M(e.accessToken),N(e.accessToken),e.accessToken)),eX(!0).then(e=>(ty(e),e)),e1(!0).then(e=>((0,d.Fi)({eventId:"LogInfo",detail:"OCPS token fetched during prefetching msal tokens"}),ee(e),e))}async function eK(e="unknown"){n||(n=await (0,m.b$)())||(n="");try{(0,a.Q5)(`TokenHelper: Trying to Fetch One Msal Token using ${e} button.`,"",n);let t=(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?h.O2:h.eq,r=(await et.l5("SYDNEY",t,void 0,void 0,e))?.authToken;if(!(r&&r.length>0))throw(0,a.Q5)("TokenHelper: When try to Fetch One Msal Token, it returns an empty token ","",n),Error("TokenHelper: MSAL return an empty token ");return(0,a.Q5)("TokenHelper: Fetch One Msal Token result: true, attempt: "+eH,"",n),c(!0),(0,g.$)(!0),eH=1,eq="",!0}catch(t){let e="TokenHelper: Failed to retrieve MSAL tokens "+t.message+", attempt: "+eH;return(0,a.Q5)(e,"",n,eq+(0,v.fP)(t)),d.r7().logCopilotErrorEvent?.({eventId:eB.v.UncaughtError,errorMessage:e,clientCorrelationId:l.M.clientCorrelationId}),eq=eH%2==1?(0,v.fP)(t)+" -> ":"",eH++,!1}}async function eX(e,t,r){let n=(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA";return(0,et._G)(n?h.Xe:h.Sk,"SEARCH",void 0,e,void 0,void 0,t,r,n?h.Qo:void 0)}async function eY(e,t,r,n){let o=(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?h.O2:h.eq;return(0,et._G)(o,"SYDNEY",void 0,e,void 0,t,r,n)}async function eZ(e,t,r){return(0,u.wX)("immersive-bizchat-msa-support")&&!(0,u.wX)("immersive-bizchat-msa-support-pacman")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.cX,"PACMAN",void 0,e,void 0,t,r)}async function eQ(e,t,r){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.Je,"AUGLOOP",void 0,void 0,void 0,e,t,r)}async function eJ(){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.nE,"SUBSTRATE/TENANTFEEDBACK")}async function e0(e,t,r){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.Xe,"FEED",void 0,void 0,void 0,e,t,r)}async function e1(e,t,r,n){if((0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA")return eU;var o=l.M?.accountInfo?.environment==="GCCModerate";return(0,et._G)(o?h.V5:h.$E,o?"OCPS_GCC":"OCPS",void 0,e,void 0,t,r,n)}async function e2(){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.z9,"MOS")}async function e3(e,t){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,f.tn)()===i.Hz?(0,et.nU)(e,"OBO"):(await (0,et.UT)(e,"OBO",t)).authToken}function e5(){return(0,u.wX)("immersive-bizchat-spo-token-v3")?e8:(0,f.tn)()===i.Hz?e6:e4}async function e6(e){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?{AuthToken:""}:{AuthToken:await (0,et.nU)(e,"SPO")}}async function e4(e,t){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?{AuthToken:""}:{AuthToken:(await (0,et.UT)(e,"SPO",void 0,void 0,t)).authToken}}async function e8(e,t){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?{AuthToken:""}:{AuthToken:await (0,et._G)(e,"SPO",void 0,void 0,void 0,t)}}async function e9(e,t,r){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?{accessToken:"",expirationTime:(0,h.WG)()}:{accessToken:await (0,et._G)(h.DL,"Loki",void 0,e,void 0,void 0,t,r),expirationTime:(0,h.WG)()}}async function e7(){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.$B,"AEA")}async function te(){if((0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"&&!(0,u.wX)("immersive-bizchat-allow-fetch-ams-token-for-msa"))return eU;let e=l.M?.accountInfo?.accountType==="MSA"?h.GO:h.r6;return(0,et._G)(e,"AMS")}async function tt(){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.uo,"POWERAUTOMATE")}async function tr(e){if((0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA")return eU;switch(e){case"prod":return(0,et._G)(h.pH,"PPAPI_PROD");case"preprod":return(0,et._G)(h.kA,"PPAPI_PREPROD");case"test":return(0,et._G)(h.s_,"PPAPI_TEST");default:return Promise.reject(Error("Unknown clusterCategory"))}}async function tn(){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.dv,"APIHUB")}async function to(e){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.US,"APISKYPE",void 0,void 0,void 0,e)}async function ti(e){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.aC,"GRAPH",void 0,void 0,void 0,e)}async function ta(e){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(e?h.L6:h.dX,"SAFE_LINKS")}async function ts(){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.BL,"GCS")}async function tl(){return(0,u.wX)("immersive-bizchat-fetch-designer-token-using-lazyfetchAccessToken")?await (0,et._G)(h.rz,"DESIGNER"):(await (0,et.UT)(h.rz,"DESIGNER")).authToken}async function tc(){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.F1,"APIURLP")}async function tu(e){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.Pm,"PUSHCHANNEL",void 0,void 0,void 0,e)}async function td(e,t){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.tW,"MSS",void 0,!1,!0,void 0,e,t)}async function tf(){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.c3,"ONENOTE")}async function th(e,t,r){let n=(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?h.$h:h.d_;return(0,et._G)(n,"ELIGIBILITY",void 0,e,void 0,void 0,t,r)}async function tp(e){if((0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA")return eU;switch(e){case"prod":return(0,et._G)(h.c0,"COPILOTSTUDIO_PROD");case"test":return(0,et._G)(h.ji,"COPILOTSTUDIO_TEST");default:return Promise.reject(Error("Unknown Copilot Studio realm provided."))}}async function tm(e="prod"){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?"ERROR":"prod"===e?(0,et._G)(h.XH,"BAP"):Promise.reject(Error("Unknown BAP realm provided."))}async function tg(e){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.C$,"TEAMS",void 0,void 0,void 0,e)}async function tv(e){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:(0,et._G)(h.Eu,"MRUPLUSPLUS",void 0,void 0,void 0,e)}async function tb(e){return(0,u.wX)("immersive-bizchat-msa-support")&&l.M?.accountInfo?.accountType==="MSA"?eU:e?(0,et._G)(e,"TROUTER"):(0,et._G)(h.hp,"TROUTER_PROD")}async function ty(e){let t=(0,u.wX)("immersive-bizchat-enable-3S-events-logging"),r=(0,f.tn)(),n=t?function(e,t,r,n){let o="FRE"===t||"proactive_fre"===t;switch(e){case"OWA":case"owahub":return n?"OWA.Web.Copilot_Drawer":o?"OWA.Web.Copilot_FRE":"OWA.Web.Copilot_Lib";case"Monarch":case"monarchhub":case"monarchHub":case"win32outlookhub":return n?"OWA.Win32.Copilot_Drawer":o?"OWA.Win32.Copilot_FRE":"OWA.Win32.Copilot_Lib";case"macoutlookhub":return o?"OWA.Mac.Copilot_FRE":"OWA.Mac.Copilot_Lib";case"officeweb":return n?"Harmony.Web.Copilot_Drawer":o?"Harmony.Web.Copilot_FRE":"Harmony.Web.Copilot_Lib";case"officedesktop":return n?"Harmony.Win32.Copilot_Drawer":o?"Harmony.Win32.Copilot_FRE":"Harmony.Win32.Copilot_Lib";case"teamshub":return function(e,t,r){switch(t.toLowerCase()){case"web":return r?"Teams.Web.Copilot_Drawer":e?"Teams.Web.Copilot_FRE":"Teams.Web.Copilot_Lib";case"ios":return r?"Teams.Ios.Copilot_Drawer":e?"Teams.Ios.Copilot_FRE":"Teams.Ios.Copilot_Lib";case"android":return r?"Teams.Android.Copilot_Drawer":e?"Teams.Android.Copilot_FRE":"Teams.Android.Copilot_Lib";case"macos":return r?"Teams.Mac.Copilot_Drawer":e?"Teams.Mac.Copilot_FRE":"Teams.Mac.Copilot_Lib";default:return r?"Teams.Win32.Copilot_Drawer":e?"Teams.Win32.Copilot_FRE":"Teams.Win32.Copilot_Lib"}}(o,r??"",n);case"BCBv2Windows":return n?"BingAtWork.Win32.Copilot_Drawer":o?"BingAtWork.Win32.Copilot_FRE":"BingAtWork.Win32.Copilot_Lib";case"BCBv2Edge":return n?"BingAtWork.Edge.Copilot_Drawer":o?"BingAtWork.Edge.Copilot_FRE":"BingAtWork.Edge.Copilot_Lib";case"edgeweb":return n?"BCX.Edge.Copilot_Drawer":o?"BCX.Edge.Copilot_FRE":"BCX.Edge.Copilot_Lib";case"BCBv2CopilotApp":case"BCBv2UnionApp":return n?"BingAtWork.CopilotApp.Copilot_Drawer":o?"BingAtWork.CopilotApp.Copilot_FRE":"BingAtWork.CopilotApp.Copilot_Lib";case"BCBv2CopilotHub":return n?"BingAtWork.CopilotHub.Copilot_Drawer":o?"BingAtWork.CopilotHub.Copilot_FRE":"BingAtWork.CopilotHub.Copilot_Lib";case"BCBv2Chat":return n?"BingAtWork.Chat.Copilot_Drawer":o?"BingAtWork.Chat.Copilot_FRE":"BingAtWork.Chat.Copilot_Lib";case"bingatworkweb":return"BingAtWork.Web.Copilot_Lib";default:return o?"WebApp.Copilot_FRE":"WebApp.Copilot_Lib"}}((0,f.tn)(),"proactive_fre",l.M.clientType,(0,u.wX)("immersive-bizchat-enable-prompt-suggestions-api-ttp")):r.replace(/&/g,"-");if((0,u.wX)("immersive-bizchat-3s-init-request")){(0,d.Fi)({eventId:"LogInfo",detail:"Calling 3S Init Api"});let t=function(e,t){switch(e){case"OWA":case"owahub":return"OWA.Web.Copilot";case"Monarch":case"monarchhub":case"monarchHub":case"win32outlookhub":return"OWA.Win32.Copilot";case"macoutlookhub":return"OWA.Mac.Copilot";case"officeweb":return"Harmony.Web.Copilot";case"officedesktop":return"Harmony.Win32.Copilot";case"teamshub":return function(e){switch(e.toLowerCase()){case"web":return"Teams.Web.Copilot";case"macos":return"Teams.Mac.Copilot";default:return"Teams.Win32.Copilot"}}(t??"");default:return""}}((0,f.tn)(),l.M.clientType);""!==t?(0,o.C)(e,t,l.M.locale,(0,p.J)(),l.M.clientCorrelationId):(0,d.Fi)({eventId:"LogInfo",detail:"3S Warmup scenario name is empty, skipping warmup request"})}return(0,u.wX)("immersive-bizchat-enable-prompt-suggestions-api-ttp")&&(0,u.wX)("immersive-bizchat-enable-ttp-prefetch")&&!(0,u.wX)("immersive-bizchat-enable-catchup-bold")&&await A(e,l.M.locale??"",n,"FRE",(0,p.J)()),e}async function tw(e){return(0,u.wX)("immersive-bizchat-enable-sessions-prefetch")&&await eE(e,(0,f.tn)(),er.He.Recent,"bizchat",(0,u.wX)("immersive-bizchat-enable-remove-recurring-chat-type"),(0,f.tn)(),""===l.M.serviceEndpointRing?void 0:l.M.serviceEndpointRing,""===l.M.serviceEndpointInfra?void 0:l.M.serviceEndpointInfra,l.M.accountInfo,en(32),"AvalonRoutingPlane",25),(0,u.wX)("immersive-bizchat-enable-agents-prefetch")&&await ey(e,(0,f.tn)(),l.M.accountInfo,en(32),""===l.M.serviceEndpointInfra?void 0:l.M.serviceEndpointInfra,(0,u.wX)("immersive-bizchat-gpt-demo-tenant")),e}},233654:(e,t,r)=>{"use strict";function n(){let e=window.location,t=e.origin;return t||(t=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")),t}r.d(t,{$z:()=>n})},45563:(e,t,r)=>{"use strict";let n;r.d(t,{Dj:()=>i}),r(404735),r(412506);let o={"5.1":"XP","6.0":"Vista","6.1":"7","6.2":"8","6.3":"8.1","6.4":"10","10.0":"10"};function i(){return(n||(n=function(){let e,t;let r="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent:"";return/(cros)\s[\w]+\s([\w\.]+\w)/i.test(r)?e="Chromium OS":/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i.test(r)?e="iOS":/android/i.test(r)?e="Android":/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i.test(r)?e="Linux":/(macintosh|mac os x)/i.test(r)?e="Mac OS X":/(windows|win32)/i.test(r)?(e="Windows",t=function(e){let t=e.match(RegExp("Windows NT ([\\d,.]+)"));return t?o[t[1]]??"Unknown":"Unknown"}(r)):e="Unknown",{os:e,osVersion:t}}()),n).os}},38303:(e,t,r)=>{"use strict";r.d(t,{f:()=>i});var n=r(45228),o=r(690);let i=(0,n.jK)("updateIsCopilotTabCachedMutator",e=>{o.M.isCopilotTabCached=e})},359135:(e,t,r)=>{"use strict";r.d(t,{H:()=>a});var n=r(45228),o=r(690),i=r(771262);let a=(0,n.jK)("updateIsMSALRefreshUiPopUpEnabled",e=>{o.M.isMSALRefreshUiPopUpEnabled!==e&&(o.M.isMSALRefreshUiPopUpEnabled=e,e?o.M.msalRefreshUiId=(0,i._R)():o.M.msalRefreshUiId="")})},537103:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});var n=r(45228),o=r(690);let i=(0,n.jK)("updateIsMsalAADLoginPagePopupShowUp",e=>{o.M.isMsalAADLoginPagePopupShowUp!==e&&(o.M.isMsalAADLoginPagePopupShowUp=e)})},108547:(e,t,r)=>{"use strict";r.d(t,{$:()=>i});var n=r(45228),o=r(690);let i=(0,n.jK)("updateIsMsalFirstRequestSuccess",e=>{o.M.isMsalFirstRequestSuccess=e})},690:(e,t,r)=>{"use strict";r.d(t,{M:()=>a});var n=r(985065),o=r(771262),i=r(834970);let a=(0,n.y)("immersiveBizChatStore",{tabIndex:0,sessionID:(0,o._R)(),metaOSAppSessionId:"",metaOSAppHostSessionId:"",metaOSAppLaunchId:"",metaOSAppHostRing:"",metaOSAppContext:void 0,enableDeeplinks:!1,focusOnLoad:"",hostUserClickTime:0,accountInfo:void 0,puid:void 0,prewarmInfo:void 0,isSessionStartInBackground:!1,isCopilotTabCached:!1,serviceEndpointInfra:"",serviceEndpointRing:"",serviceEndpointUrl:"",sydneyVariants:"",sessionsEndpointUrl:"",sessionsVariants:"",featureFlags:void 0,feedbackPolicies:void 0,ocpsPolicies:{isCPSResponseSuccessful:!1},isEuropeUser:void 0,locale:void 0,clientType:void 0,isMSALRefreshUiPopUpEnabled:!1,msalRefreshUiId:"",tryThesePromptsData:"",useFallbackTTP:!1,isMsalFirstRequestSuccess:!1,isMsalPostLaunch:!1,isMsalAADLoginPagePopupShowUp:!1,clientCorrelationId:(0,o._R)(),ecsConfigIds:void 0,themeContext:"default",launchOptionPrompt:void 0,eligibility:void 0,browserId:"",referrer:void 0,appLoadTime:0,rawSessionList:void 0,filteredSessionList:void 0,extensionsList:void 0,sessionsSyncState:void 0,sessionsTraceId:void 0,extensionsTraceId:void 0,sessionsPrefetchStatus:i.Ad.NotStarted,extensionsPrefetchStatus:i.Ad.NotStarted,latestConversationId:void 0,isCopilotExtensibilityDisabled:void 0,contextualChat:{displaySummaryPrompt:!1}})()},579270:(e,t,r)=>{"use strict";let n;r.d(t,{Fi:()=>k,PV:()=>I,r7:()=>C});var o=r(343850),i=r(655260),a=r(690),s=r(574221),l=r(471936),c=r(491306);let u="ImmersiveBizchat",d="3sEvent",f="CopilotAction",h="CopilotResultsRender",p="CopilotFlightInfo",m="AutoCompleteEvent",g="DiagnosticEvent",v="ErrorEvent",b="EventV2",y=[],w=!1,S={logEvent:k,log3sEvent:function(e){if(!e)return;let t=n;t?t.logEvent({eventType:d,properties:e}):(y.push({event:{eventType:d,properties:e},chatContext:(0,l.J2)()}),E())},logCopilotActionEvent:function(e){if(!e)return;let t=n;t?t.logEvent({eventType:f,properties:e}):(y.push({event:{eventType:f,properties:e},chatContext:(0,l.J2)()}),E())},logCopilotResultsRenderEvent:function(e){if(!e)return;let t=n;t?t.logEvent({eventType:h,properties:e}):(y.push({event:{eventType:h,properties:e},chatContext:(0,l.J2)()}),E())},logCopilotFlightInfo:function(e){if(!e)return;let t=n;t?t.logEvent({eventType:p,properties:e}):(y.push({event:{eventType:p,properties:e},chatContext:(0,l.J2)()}),E())},logAutoCompleteEvent:function(e){if(!e)return;let t=n;t?t.logEvent({eventType:m,properties:e}):(y.push({event:{eventType:m,properties:e},chatContext:(0,l.J2)()}),E())},logDiagnosticEvent:function(e){if(!e)return;let t=n;t?t.logEvent({eventType:g,properties:e}):(y.push({event:{eventType:g,properties:e},chatContext:(0,l.J2)()}),E())},logCopilotErrorEvent:function(e){if(!e)return;let t=n;t?t.logEvent({eventType:v,properties:e}):(y.push({event:{eventType:v,properties:e},chatContext:(0,l.J2)()}),E())},logEventV2:function(e){if(!e)return;let t=n;t?t.logEvent({eventType:b,properties:e}):(y.push({event:{eventType:b,properties:e},chatContext:(0,l.J2)()}),E())},setChatContext:function(e){(0,s.wX)("immersive-bizchat-enable-harmony-bce-v1")&&_(()=>{let t=n;if(!t){(0,l.J2)()!==e&&((0,l.pM)(e),k({eventId:"LogInfo",detail:`Chat Context set to ${e} w/ Logger not loaded`}));return}let{chatTabContext:r}=t.getStaticProperties()?.hostProperties||{};r!==e&&(k({eventId:"LogInfo",detail:`Chat Context set to ${e} w/ Logger loaded`}),t.updateStaticProperties({hostProperties:{chatTabContext:e}}))},"error setting chat context","setChatContext")},setScenario:function(e){(0,s.wX)("immersive-bizchat-enable-harmony-bce-v1")&&_(()=>{let t=n,r=t?t.getStaticProperties()?.hostProperties?.clientType:(0,l.yS)(),o=t?t.getStaticProperties()?.hostProperties?.supportedScenarioTypes?.web:(0,l.zb)(),i=r===e?"work":"web",a=t?.getStaticProperties()?.hostProperties?.supportedScenarioTypes;if(r){if(t){if(k({eventId:"LogInfo",detail:`Setting ${i} Scenario to ${e} w/ Logger loaded. Current Supported Scenarios: ${JSON.stringify(a||"{}")}`}),!a||a?.[i])return;"work"===i?a.work=e:"web"===i&&(a.web=e),t.updateStaticProperties({hostProperties:{supportedScenarioTypes:a,chatTabContext:i}})}else"web"!==i||(o&&o!==e?k({eventId:"Error",errorMessage:`Scenario mismatch. Current scenario: ${o}, new scenario: ${e}`,error:"Scenario mismatch"}):o||((0,l.f9)(e),k({eventId:"LogInfo",detail:`Web Scenario set to ${e} w/ Logger not loaded`})))}else k({eventId:"Error",errorMessage:`Unable to set scenario ${e} as Client type is not set`,error:"Client type is not set"})},"error setting scenario","setScenario")},setAgentExtensionId:function(e){if(!e)return;let t=n;t?t.updateStaticProperties({hostProperties:{agentExtensionId:e}}):(0,l.U1)(e)}};function C(){return S}function I(e){_(()=>{let t=n;t?.updateStaticProperties(e)},"error updating chat logger static properties","updateChatLoggerStaticProperties")}function k(e){if(!e)return;let t=n;t?t.logEvent({eventType:u,properties:e}):(y.push({event:{eventType:u,properties:{...e,codeLocation:e?.codeLocation??"PendingEventsArray"}},chatContext:(0,l.J2)()}),E())}function E(){if(!w){let e=new Date().getTime();w=!0,((0,c.wb)()?i.J:o.J)().then(t=>{n=t;let r=(0,l.J2)(),o=(0,l.zb)(),{chatTabContext:i,supportedScenarioTypes:s}=n.getStaticProperties()?.hostProperties||{};k({eventId:"LogInfo",detail:`Logger Initialization Parameters: ${JSON.stringify({supportedScenarioTypes:s,initialChatTabContext:r,initialWebScenario:o,chatTabContext:i})}`}),i&&s?.web||n.updateStaticProperties({hostProperties:{chatTabContext:i??r,supportedScenarioTypes:{...s,web:s?.web??o}}}),n?.logEvent({eventType:u,properties:{eventId:"LogInfo",detail:`Number of pending events: ${y?.length??0}`}});let c=n?.getStaticProperties();y.length>0&&y.forEach(e=>{let t=c?{...c,hostProperties:{...c.hostProperties,chatTabContext:e.chatContext}}:void 0;n.logEvent(e.event,t)}),y=[];let d=n?.getStaticProperties();d?.piiData&&d?.piiData?.length!==0||n?.logEvent({eventType:u,properties:{eventId:"Error",detail:"PII data from the host is not set"}}),a.M.prewarmInfo?.isPrewarm||n?.logEvent({eventType:u,properties:{eventId:"LogInfo",detail:"initialize logger latency: "+(new Date().getTime()-e)}}),w=!1}).catch(()=>{w=!1})}}let _=(e,t,r,n=!0)=>{try{e()}catch(e){if(n)try{k({eventId:"Error",message:t,codeLocation:r,errorMessage:`Error in M365ChatLogger: ${JSON.stringify(e)}`,error:"M365ChatLogger Error"})}catch(e){}}}},366482:(e,t,r)=>{"use strict";r.d(t,{$6:()=>g,EO:()=>b,FC:()=>w,K:()=>S,OB:()=>h,PU:()=>y,S9:()=>c,X9:()=>u,n:()=>p,t0:()=>v,tf:()=>C,tn:()=>f,wM:()=>m});var n=r(223093),o=r(654018),i=r(110886),a=r(690),s=r(574221),l=r(491306);let c="OWA",u="Monarch",d=RegExp(".*-(refs-pull-.*)");function f(){let e;let t=(0,n.OB)();switch(t){case"(none)":e=c;break;case n.s6:e=u;break;default:e=t||"Unknown"}return e}function h(){let e=[],t=a.M.accountInfo?.userName,r=a.M.accountInfo?.accountUpn,n=a.M.accountInfo?.accountUpn,o=a.M.accountInfo?.accountUpn?.split("@")[0];return t&&e.push(t),r&&e.push(r),n&&e.push(n),o&&e.push(o),e}function p(){return!!((0,o.b)("M365ChatLocal")||(0,o.b)("M365ChatBranch")||(0,o.b)("M365ChatVersion")||(0,o.b)("M365ChatMode")||(0,o.b)("localLoki")||(0,o.b)("lokiToLocalThreeS")||(0,o.b)("top")||(0,o.b)("gulp")||(0,o.b)("ori")||(0,o.b)("branch")||(0,o.b)("agentId")||(0,o.b)("addFlights")||(0,o.b)("removeFlights"))||!!(0,o.b)("M365ChatFeatures")&&(!(0,l.wb)()||!(0,s.s)("immersive-bizchat-blaze-as-prod-traffic"))}function m(){let e=b(),t=S(),r=e===i.OI||e===i.RB;return!!p()&&(!!r||"Dogfood"===t||"Microsoft"===t)}function g(){return(0,s.wX)("immersive-bizchat-eu-logging-update")?a.M?.accountInfo?.environment==="GCCModerate"?i.Y6:m()?i.Ov:2===a.M.isEuropeUser||1===a.M.isEuropeUser||void 0===a.M.isEuropeUser?i.Xt:i.Y6:m()?i.Ov:2===a.M.isEuropeUser?i.Xt:i.Y6}function v(){return a.M.accountInfo?.accountType==="MSA"}function b(){return a.M.accountInfo?.tenantId}function y(){return a.M.accountInfo?.objectId}function w(){return a.M.puid}function S(){return function(){switch(a.M.accountInfo?.physicalRing){case"SDFV2":case"Dogfood":return"Dogfood";case"MSIT":return"Microsoft";default:return"WW"}}()}function C(e){let t=(0,n.Oo)();return d.test(t)&&(t=t.match(d)?.[1]??""),t+"."+(S()?.toString()||"null")+"."+e}},471936:(e,t,r)=>{"use strict";let n,o,i;r.d(t,{Bc:()=>S,IH:()=>w,J2:()=>g,U1:()=>b,f9:()=>p,pM:()=>v,yS:()=>y,zb:()=>m});var a=r(654018),s=r(45563),l=r(110886),c=r(366482),u=r(690),d=r(488563),f=r(574221);let h=(0,r(412145).r9)({maximumAttempts:2e3,timeBetweenRetryInMS:()=>30});function p(e){o=e}function m(){return o}function g(){return n}function v(e){n=e}function b(e){i!==e&&(i=e)}function y(){return u.M.prewarmInfo?.isPrewarm?u.M.prewarmInfo?.clientName:(0,c.tn)()}async function w(){try{await h(async()=>void 0!==u.M.isEuropeUser||Promise.reject(Error("waiting for isEu info."))).retriableFunc()}catch{}return Promise.resolve(function(){let e=(0,s.Dj)(),t=(0,a.b)("hostApp")?(0,a.j)("hostApp"):e,r=(0,a.b)("referrer")&&"copilot"===(0,a.j)("referrer"),h=(0,a.b)("fromcode")?(0,a.j)("fromcode"):void 0,p=(0,a.b)("redirectid")?(0,a.j)("redirectid"):void 0,m=(0,c.tf)(t),g=[];g.push("immersive-bizchat-enable-loggerV2"),(0,f.wX)("immersive-bizchat-enable-console-logging")&&g.push("immersive-bizchat-enable-console-logging"),((0,f.wX)("immersive-bizchat-enable-harmony-bce")||r)&&g.push("immersive-bizchat-enable-harmony-bce"),(0,f.wX)("immersive-bizchat-enable-harmony-bce-v1")&&g.push("immersive-bizchat-enable-harmony-bce-v1"),(0,f.wX)("immersive-bizchat-enable-logging-refactoring")&&g.push("immersive-bizchat-enable-logging-refactoring"),(0,f.wX)("immersive-bizchat-enable-logging-immersivebizchat-merge")&&g.push("immersive-bizchat-enable-logging-immersivebizchat-merge"),(0,f.wX)("immersive-bizchat-enable-web-tab-v2")&&g.push("immersive-bizchat-enable-web-tab-v2"),(0,f.wX)("immersive-bizchat-enable-pacman-logging")&&g.push("immersive-bizchat-enable-pacman-logging"),(0,f.wX)("immersive-bizchat-enable-codex-web-tab")&&g.push("immersive-bizchat-enable-codex-web-tab"),r&&g.push("isCopilotReferrer"),(0,f.wX)("immersive-bizchat-enable-cwc-cdp-logging")&&g.push("immersive-bizchat-enable-cwc-cdp-logging"),(0,f.wX)("immersive-bizchat-enable-cdp-copilot-error-logging")&&g.push("immersive-bizchat-enable-cdp-copilot-error-logging"),(0,f.wX)("immersive-bizchat-enable-calipso-dispatcher-fix")&&g.push("immersive-bizchat-enable-calipso-dispatcher-fix"),(0,f.wX)("immersive-bizchat-enable-calipso-add-flightsvalue")&&g.push("immersive-bizchat-enable-calipso-add-flightsvalue"),(0,f.wX)("immersive-bizchat-enable-calipso-add-metadatavalues")&&g.push("immersive-bizchat-enable-calipso-add-metadatavalues");let v=y();return{user:{aadUserId:(0,f.wX)("immersive-bizchat-eu-logging-update")?(0,c.PU)():void 0===u.M.isEuropeUser||1===u.M.isEuropeUser||2===u.M.isEuropeUser&&(0,c.wM)()?void 0:(0,c.PU)(),tenantId:(0,c.EO)(),puid:S()?(0,c.FC)():void 0},debug:{environment:"Dogfood"===(0,c.K)()?"DEV":"PROD",deploymentRing:c.K()?.toString()||"null"},hostProperties:{ingestionKey:(0,c.$6)(),telemetryDataBoundary:(0,c.$6)()===l.Xt?"EU":"ROW",appName:l.Ae,accountType:(0,c.t0)()?"outlook":"office365",hostAppVersion:m,clientType:u.M.prewarmInfo?.isPrewarm?"teamshub":(0,c.tn)(),locale:u.M.locale,tableName:l.bD,isDevMode:(0,c.wM)(),sessionId:u.M.sessionID,appSessionId:(0,f.wX)("immersive-bizchat-context-appsessionid")?u.M?.metaOSAppContext?.app?.sessionId:u.M.metaOSAppSessionId,prewarmSessionId:u.M.prewarmInfo?.prewarmSessionId,prewarmInstanceId:u.M.prewarmInfo?.prewarmInstanceId,isPrewarm:u.M.prewarmInfo?.isPrewarm,hostRing:u.M.metaOSAppHostRing,clientPlatform:u.M.clientType,chatTabContext:n,supportedScenarioTypes:(0,f.wX)("immersive-bizchat-enable-harmony-bce-v1")?{web:o,work:v}:void 0,hostEnvironment:function(){if(u.M?.accountInfo?.environment==="GCCModerate")return"gcc"}(),agentExtensionId:i,urlReferrer:(0,f.wX)("immersive-bizchat-enable-calipso-add-metadatavalues")?u.M.referrer:void 0},sydneyProperties:{sydneyAuthTokenCallback:()=>(0,d.CM)()},pacmanProperties:{pacmanAuthTokenCallback:()=>(0,d.sd)()},substrateProperties:{substrateAuthTokenCallback:()=>(0,d.K4)()},piiData:u.M.prewarmInfo?.isPrewarm?[u.M.accountInfo?.userName??"",u.M.accountInfo?.accountUpn??""]:(0,c.OB)(),loggerFlights:g,fromCode:h,redirectId:p,ecsConfigIds:(0,f.wX)("immersive-bizchat-enable-calipso-add-flightsvalue")?u.M.ecsConfigIds??"":void 0,featureFlags:(0,f.wX)("immersive-bizchat-enable-calipso-add-flightsvalue")?(0,f.We)():void 0}}())}function S(){return!!(0,f.wX)("immersive-bizchat-eu-logging-update")||!(void 0===u.M.isEuropeUser||1===u.M.isEuropeUser||2===u.M.isEuropeUser&&(0,c.wM)())}},758416:(e,t,r)=>{"use strict";r.d(t,{$n:()=>f,FI:()=>m,b$:()=>d,kR:()=>u});var n=r(404735),o=r(771262),i=r(579270);let a="COPILOT_BROWSER_ID",s="ClientCacheGetError",l="ClientCacheSaveError",c="BizChatEligibilityInfo",u=async()=>{let e=await d();return e||(e=(0,o._R)(),await p(e)),e},d=async()=>h(a),f=async()=>h(c),h=async e=>{try{return await (0,n._S)(window,e)}catch(t){if(t instanceof Error){(0,i.Fi)({eventId:s,message:`Error getting ${e} from cache`,detail:`Error: ${t.message}`});return}(0,i.Fi)({eventId:s,message:`Error getting ${e} from cache`,detail:`Error: ${t}`});return}},p=async e=>g(a,e),m=async e=>g(c,e),g=async(e,t)=>{try{return await (0,n.AP)(window,e,t)}catch(t){if(t instanceof Error){(0,i.Fi)({eventId:l,message:`Error saving ${e} cache`,detail:`Error: ${t.message}`});return}(0,i.Fi)({eventId:l,message:`Error saving ${e} cache`,detail:`Error: ${t}`});return}}},210809:(e,t,r)=>{"use strict";let n,o;r.d(t,{X5:()=>s,s1:()=>l,ye:()=>a});var i=r(30876);function a(e,t,r){(n||i.uZ)(e,t,r)}function s(e,t,r){(n||i.Xs)(e,t,r)}function l(e,t,r,n){(o||i.IY)(e,t,r,n)}},410998:(e,t,r)=>{"use strict";let n;r.d(t,{OI:()=>p.OI,B3:()=>p.B3,u1:()=>$,qw:()=>W,yp:()=>ec.y,cO:()=>ed,wF:()=>q.wF,a9:()=>eu.a,mH:()=>e8,mJ:()=>p.mJ,QR:()=>q.QR,nR:()=>p.nR,CM:()=>p.CM,$q:()=>eU,wo:()=>B,Wh:()=>ew,pS:()=>H.A,ZP:()=>x.A,Sn:()=>V,Kx:()=>el.A,P4:()=>K,TC:()=>ei.A,Rx:()=>ep,RL:()=>ek,HV:()=>eg,ks:()=>ey,bJ:()=>eC,ki:()=>eh,f7:()=>e_.A,JL:()=>eE.A,fV:()=>eS.A,zF:()=>q.zF,Uj:()=>ef,fJ:()=>q.Ay,Lu:()=>J,I4:()=>e1,EZ:()=>ee.A,yr:()=>eo,NF:()=>et,ZN:()=>er,K8:()=>en.A,mt:()=>ee.m,nM:()=>eb,Xw:()=>ev,iG:()=>ea,mg:()=>Q.A,dI:()=>eT,MW:()=>eA,pP:()=>eP,V2:()=>eO,qZ:()=>G,ry:()=>es.A,ob:()=>eR,_J:()=>eI,VU:()=>ex.A,nB:()=>eu.n,R5:()=>e6,Dt:()=>e3,rm:()=>em,Th:()=>e5.A,z$:()=>e4,xW:()=>e2.A,Fb:()=>p.Fb,Gh:()=>l,xv:()=>u,p3:()=>d,Hc:()=>i,bg:()=>s,w6:()=>a,GL:()=>eK,$5:()=>U,dY:()=>eY,$W:()=>C,$Z:()=>ej,RJ:()=>eW,I2:()=>E,f$:()=>eq,YW:()=>T,k3:()=>e0,fy:()=>R,Jr:()=>M,B5:()=>F,cl:()=>L});var o=r(45228);let i=(0,o.XI)("ON_COPRINCIPAL_ACCOUNT_ADDED",e=>({addedAccount:e})),a=(0,o.XI)("ON_PRE_COPRINCIPAL_ACCOUNT_REMOVED",e=>({removedAccount:e})),s=(0,o.XI)("ON_COPRINCIPAL_BOOTSTATE_CHANGED",(e,t)=>({updatedAccount:e,newBootState:t})),l=(0,o.XI)("onAccountAuthSucceeded",e=>({mailboxInfo:e})),c=(0,o.XI)("ON_SHARED_SOURCES_CHANGED",e=>({updatedAccount:e})),u=(0,o.XI)("onAccountBadState",e=>({mailboxInfo:e})),d=(0,o.XI)("onAccountGoodState",e=>({mailboxInfo:e}));var f=r(210809),h=r(787468),p=r(704108),m=r(633793);function g(e,t){let r=e.sourceId,n=(0,m.A)().sourcesBySourceId.has(e.sourceId),o=p.nR.isCoprincipal(e)||!!t;if(n||!o){let t=Error("AcctSourceIdMap-AddPreConditions");(0,f.s1)("AcctSourceIdMap-AddPreConditions",t,{present:n,coprincipal:o,rank:e.mailboxRank.toString(),type:e.mailboxInfo.type.toString()})}(0,m.A)().sourcesBySourceId.set(r,{source:e,coprincipalSourceId:t})}function v(e){(0,h.A)((0,m.A)().sourcesBySourceId.has(e),"SourceId not found is store"),(0,m.A)().sourcesBySourceId.delete(e)}function b(e){return p.CM.isM365Mailbox(e)?{...e,mailboxInfo:{...e.mailboxInfo,sourceId:e.sourceId,mailboxRank:e.mailboxRank}}:e}function y(e,t,r,n,o){(0,h.A)(t===r.coprincipalSourceId,"Additional info must have the same Coprincipal sourceId");let i=(0,m.A)().sources.filter(e=>e.sourceId===t);(0,h.A)(1===i.length,"Cannot add additional info to a source not in the store");let a=i[0];(0,h.A)(a&&p.nR.isCoprincipal(a)&&p.CM.isM365UserMailbox(a),`We are attempting to set ${e} Account Info to a Non-M365UserMailboxAccountSource`),n(a).sources.forEach(e=>{(0,m.A)().sourcesBySourceId.has(e.sourceId)?v(e.sourceId):(0,f.s1)("DuplicateSourceId-AdditionalSources")}),r.sources=r.sources.map(e=>b(e)),o(a,r.loadState,r.sources),function(e,t){let r=[],n=new Set;if(t.forEach(e=>{n.has(e.sourceId)?r.push(e.sourceId):n.add(e.sourceId)}),r.length>0){let n="AcctAddSources-DuplicateSourceIdsFound",o=Error(n),i=new Set(r);(0,f.s1)(n,o,{type:e,total:t.length,dups:r.length,udups:i.size})}}(e,r.sources),n(a).sources.forEach(e=>{g(e,t)})}function w(e){return e.archiveSources}function S(e,t,r){e.archiveSources.loadState=t,e.archiveSources.sources=r}let C=(0,o.jK)("SET_ARCHIVE_ACCOUNTS",function(e,t,r){y("Archive",e,{coprincipalSourceId:e,loadState:t,sources:r||[]},w,S)});function I(e){return e.groupSources}function k(e,t,r){e.groupSources.loadState=t,e.groupSources.sources=r}let E=(0,o.jK)("SET_GROUP_ACCOUNTS",function(e,t){y("Group",e,t,I,k)});function _(e){return e.publicFolderSources}function A(e,t,r){e.publicFolderSources.loadState=t,e.publicFolderSources.sources=r}let T=(0,o.jK)("SET_PUBLIC_FOLDER_ACCOUNTS",function(e,t,r){y("Public Folder",e,{coprincipalSourceId:e,loadState:t,sources:r},_,A)});function P(e){return e.teamsSources}function O(e,t,r){e.teamsSources.loadState=t,e.teamsSources.sources=r}let R=(0,o.jK)("SET_TEAMS_ACCOUNTS",function(e,t,r){y("Teams",e,{coprincipalSourceId:e,loadState:t,sources:r||[]},P,O)});var x=r(422745);let M=(0,o.jK)("UPDATE_CONNECTED_ACCOUNT_STATE",function(e,t){(0,h.A)((0,x.A)(e),"Cannot update account not in store"),(0,m.A)().sources.forEach(r=>{r.sourceId===e&&p.CM.isM365ConnectedMailbox(r)&&(r.accountState.connectedAccountState=t)})});var N=r(30876);let F=(0,o.jK)("UPDATE_COPRINCIPAL_ACCOUNT_DESCRIPTION",function(e,t){if(!(0,x.A)(e)){(0,N.uZ)("accountDescription_UpdateCoprincipalSourceIdNotFound");return}for(let r of(0,m.A)().sources)r.sourceId===e&&(r.accountDescription=t)}),L=(0,o.jK)("UPDATE_COPRINCIPAL_ACCOUNT_DISPLAY_NAME",function(e,t){(0,h.A)((0,x.A)(e),"Cannot update account not in store"),(0,m.A)().sources.forEach(r=>{r.sourceId===e&&(r.displayName=t)})});var z=r(690172),D=r(615410);let B=(0,o.jK)("addEasidAsLicensingMailboxInfo",function(e){let t=(0,x.A)(e);if(p.nR.isCoprincipal(t)){let{mailboxSmtpAddress:e}=t.mailboxInfo,r="Outlook",n={sourceId:(0,D.f)(t.sourceId,r,e),type:"UserPrincipalName",userIdentity:e,mailboxSmtpAddress:e,mailboxProvider:r,sourceType:z.XB.OutlookDotCom,mailboxRank:"Licensing",diagnosticData:"EasidAsLicensingMailboxInfo",policyState:z.V4.NoError};t.licensingMailboxInfo=n}}),U=(0,o.jK)("removeEasidAsLicensingMailboxInfo",function(e){let t=(0,x.A)(e);p.nR.isCoprincipal(t)&&(t.licensingMailboxInfo=void 0)});var H=r(192173),q=r(329603),j=r(436980),$=(e=>(e[e.Starting=0]="Starting",e[e.Completed=1]="Completed",e[e.Error=2]="Error",e[e.Any=3]="Any",e))($||{}),W=(e=>(e[e.All=0]="All",e[e.Calendar=1]="Calendar",e[e.Contacts=2]="Contacts",e[e.Mail=3]="Mail",e[e.Settings=4]="Settings",e))(W||{});function V(e,t){return K(e,t).map(e=>(0,j.EN)(e.mailboxInfo))}function G(e,t){return K(e,t).map(e=>e.mailboxInfo)}function K(e,t){return(0,q.Ay)(function(e){switch(e){case 0:return q.QR.Starting;case 1:return q.QR.Completed;case 2:return q.QR.Error;case 3:return q.QR.StartingOrCompleteOrError}}(e),function(e){switch(e){case 0:return q.wF.Any;case 1:return q.wF.Calendar;case 2:return q.wF.Contacts;case 3:return q.wF.Mail;case 4:return q.wF.Settings}}(t))}var X=r(838563),Y=r(332408),Z=r(42727),Q=r(938658);function J(e){let t=(0,H.A)(e);if(t){if(j.kH.isCoprincipal(e))return e;if(p.nR.isCoprincipal(t))return t.mailboxInfo;let r=(0,Z.A)(t.sourceId);if(r?.coprincipalSourceId)return(0,Q.A)(r?.coprincipalSourceId)}if(!(0,X.si)("acctNoFallback")&&(0,m.A)().globalSettingsSourceId)return Y.uP.warn("[source-list-store] failed to find MailboxInfo falling back to selected"),(0,Q.A)((0,m.A)().globalSettingsSourceId)}var ee=r(256010);function et(e=!0){let t=(0,x.A)((0,m.A)().globalSettingsSourceId);if(t?.mailboxInfo)return(0,j.ku)(t.mailboxInfo);if(e)throw Error("Failed to get global settings account");return""}function er(e=!0){let t=(0,x.A)((0,m.A)().globalSettingsSourceId);if(t?.mailboxInfo)return(0,j.EN)(t.mailboxInfo);if(e)throw Error("Failed to get global settings account");return""}var en=r(302108);function eo(){let e=(0,ee.A)();return{providerType:e.sourceType,userPrincipalName:e.mailboxInfo.userIdentity}}var ei=r(689047);function ea(e){return m.A().sources.filter(t=>j.wj(t.mailboxInfo,e))[0]?.mailboxInfo}r(127075);var es=r(23951),el=r(142544);r(984134);var ec=r(631967),eu=r(116435),ed=(e=>(e.None="None",e.PreRenderData="PreRenderData",e.PreRenderError="PreRenderError",e.StartupData="StartupData",e))(ed||{});function ef(e){return(0,m.A)().sources.filter(t=>p.nR.isCoprincipal(t)&&t.bootState===e)}function eh(){return ef(ec.y.StartupComplete).filter(e=>e.contracts.supportsCalendar)}function ep(){return(0,m.A)().sources.filter(e=>e.contracts.supportsCalendar)}function em(e){return e==z.XB.Office365||e==z.XB.OutlookDotCom}function eg(){return(0,m.A)().sources.filter(e=>em(e.sourceType))}function ev(e){return ef(e).filter(e=>e.contracts.supportsMail)}function eb(){return ev(ec.y.StartupComplete)}function ey(){return(0,m.A)().sources}function ew(e){return e.map(e=>e.mailboxInfo)}var eS=r(992178);function eC(e,t){let r=(0,eS.A)(e);if(p.CM.isM365UserMailbox(r))return function(e,t){let r=t.toLowerCase(),n=e.archiveSources.sources.filter(e=>r===e.mailboxInfo.auxiliaryMailboxGuid?.toLowerCase());return n[0]?.mailboxInfo}(r,t)}function eI(e,t){let r=(0,eS.A)(e);if(p.CM.isM365UserMailbox(r))return function(e,t){let r=t.toLowerCase(),n=e.sharedSources.sources.filter(e=>r===e.mailboxInfo.mailboxSmtpAddress.toLowerCase());return n[0]?.mailboxInfo}(r,t)}function ek(){return ew(ef(ec.y.StartupComplete))}var eE=r(532868),e_=r(336430);function eA(){return ew(eh())}function eT(){return ew(ep())}function eP(){return ew(eb())}function eO(){return ew(ef(ec.y.StartupComplete).filter(e=>e.contracts.supportsSettings))}function eR(e,t){let r=q._J[t],n=(0,j.ku)(e),o=(0,eE.A)(n);if(!o)return Y.uP.warn("[source-list-store] Failed to find accounts from MailboxInfo can not get shared mailboxes"),[];if(p.CM.isM365UserMailbox(o)){let e=[];return o.sharedSources.sources.forEach(t=>{p.CM.isM365SharedMailbox(t)&&r(t)&&e.push(t)}),e}return Y.uP.warn("[source-list-store] Account is not an M365 account can not get shared mailboxes"),[]}var ex=r(550019);let eM=(0,o.jK)("ADD_COPRINCIPAL_ACCOUNT",function(e){let t=(0,m.A)(),r=t.sources.push(e)-1,n=t.sources[r];g(n),t.globalSettingsSourceId||(t.globalSettingsSourceId=n.sourceId)});var eN=r(691217);function eF(){(0,eN.i)(new Set((0,m.A)().sources.map(e=>e.mailboxInfo.userIdentity)))}var eL=r(29227);function ez(e,t){(0,eL.intercept)(e,t,e=>(function(e){let t=Error("AccountSourceMailboxInfoChanged");return t.additionalInfo={propertyName:e},(0,Y.Z1)("AccountSourceMailboxInfoChanged",t),null})(t.toString()))}function eD(e){let t=(0,x.A)(e);t&&(ez(t,"mailboxInfo"),ez(t.mailboxInfo,"type"),ez(t.mailboxInfo,"userIdentity"),ez(t.mailboxInfo,"mailboxSmtpAddress"),t.mailboxInfo.auxiliaryMailboxGuid&&ez(t.mailboxInfo,"auxiliaryMailboxGuid"),ez(t.mailboxInfo,"sourceId"),ez(t.mailboxInfo,"mailboxRank"),p.nR.isCoprincipal(t)&&ez(t,"persistenceId"))}var eB=r(282623);function eU(e){(0,h.A)(!(0,x.A)(e.sourceId),"Found duplicated account in the store."),(0,h.A)(e.mailboxRank===j.B3,"Must be a Coprincipal account"),Y.uP.info(`[source-list-store] Adding coprincipal account with boot state ${e.bootState}`),function(e){let t=(0,j.ku)(e.mailboxInfo);(0,eB.b)()&&t!==e.sourceId&&(0,Y.Z1)("AddAccount-IndexerMismatch");let r=(0,eE.A)(t);if(r){let t=Error("DuplicateCoprincipalIndexer"),n={type:e.sourceType,existingType:r.sourceType,areSameType:e.sourceType===r.sourceType,areSameSmtp:e.mailboxInfo.mailboxSmtpAddress===r.mailboxInfo.mailboxSmtpAddress,areSameUid:e.mailboxInfo.userIdentity===r.mailboxInfo.userIdentity,areSamePersistenceId:e.persistenceId===r.persistenceId,persistenceIndexer:(0,eB.b)()};t.additionalInfo=n,(0,Y.Z1)("DuplicateCoprincipalIndexer",t)}}(e=b(e)),eM(e),eD(e.sourceId),eF(),i(e)}let eH=(0,o.jK)("SET_COPRINCIPAL_ACCOUNT_BOOT_STATE",function(e,t,r){(0,m.A)().sources.forEach(n=>{p.nR.isCoprincipal(n)&&n.sourceId===e&&(n.bootState=t,n.bootStateData=r,Y.uP.info(`[source-list-store] Setting coprincipal account boot state to ${n.bootState}`))})});function eq(e){n=e}function ej(e,t,r){let o=(0,x.A)(e);if(!p.nR.isCoprincipal(o)){let t="AcctInit-Cannot set BootState, coprincipal account is not in store",r=Error(t);(0,f.s1)(t,r,{cnt:(0,m.A)().sources.length,sid:typeof e,sidl:e.length});return}if(o.bootState===t)return;eH(e,t,r);let i=(0,x.A)(e);(0,h.A)(i,"Must have been able to find updated account by sourceId"),s(i,t),t===ec.y.StartupComplete&&p.nR.isCoprincipal(i)&&n&&n(i)}let e$=(0,o.jK)("SET_COPRINCIPAL_ACCOUNT_POLICY_STATE",function(e,t){let r=(0,m.A)().sources.find(t=>p.nR.isCoprincipal(t)&&t.sourceId===e);r&&(r.policyState=t,Y.uP.info(`[source-list-store] Setting coprincipal account policy state to ${r.policyState}`))});function eW(e,t){let r=(0,x.A)(e);if(!p.nR.isCoprincipal(r)){let t="AcctInit-Cannot set PolicyState, coprincipal account is not in store",r=Error(t);(0,f.s1)(t,r,{cnt:(0,m.A)().sources.length,sid:typeof e,sidl:e.length});return}r.policyState!==t&&(r.policyState===z.V4.PolicyError&&u(r.mailboxInfo),e$(e,t))}let eV=(0,o.jK)("REMOVE_COPRINCIPAL_ACCOUNT_BY_ID",function(e,t){let r=(0,m.A)();r.sources=r.sources.filter(t=>t.sourceId!==e),e===r.globalSettingsSourceId&&(r.globalSettingsSourceId=r.sources.length>0?r.sources[0].sourceId:(0,m.A)().globalSettingsSourceId),v(e),function(e){(0,h.A)(!!e,"A non empty coprincipalSourceId must be provided");let t=[];(0,m.A)().sourcesBySourceId.forEach((r,n)=>{r.coprincipalSourceId===e&&t.push(n)}),t.forEach(e=>v(e))}(e),void 0!==t&&r.removedAccounts.push(t)});function eG(e,t,r,n){let o=Error(e);(0,f.s1)(e,o,{cnt:(0,m.A)().sources.length,dt:r?.dataType?.toString(),mt:p.CM.isM365Mailbox(r)?r?.accountSourceMailboxType?.toString():void 0,sid:typeof t,sidl:t.length,...n})}function eK(e){var t;let r=(0,m.A)(),n=r.sources.findIndex(t=>t.sourceId===e);if(n<0){eG("AcctRemove-AccountNotFound",e);return}if(r.sources.length<=1){eG("AcctRemove-CannotRemoveLastAccount",e,r.sources[0]);return}if(!p.CM.isM365ConnectedMailbox(r.sources[n])){let t=(0,m.A)().sources.filter(e=>!p.CM.isM365ConnectedMailbox(e));if(t.length<=1){eG("AcctRemove-CannotRemoveDefaultAccount",e,t[0],{ncnt:t.length});return}}let o={type:"RemovedAccount",sourceType:(t=r.sources[n]).sourceType,sourceId:t.sourceId,persistenceId:t.persistenceId,mailboxInfo:{...t.mailboxInfo,isRemoved:!0}};a(r.sources[n]),eV(e,o),eF()}let eX=(0,o.jK)("SET_COPRINCIPAL_ADDITIONAL_MAILBOX_PROPS",function(e,t){var r;let n=(0,m.A)(),o=function(e,t){let r=e.sources.findIndex(e=>e.sourceId===t);if(-1!==r)return{account:e.sources[r],index:r}}(n,e);if(!o){Y.uP.warn("[source-list-store] Account not found for sourceId when setting additional properties");return}let i={...o.account,mailboxInfo:{...o.account.mailboxInfo,...t}};n.sources[o.index]=i,r=n.sources[o.index],(0,m.A)().sourcesBySourceId.set(r.sourceId,{source:r,coprincipalSourceId:r.sourceId})});function eY(e,t){eX(e,{auxiliaryMailboxGuid:t?.MailboxGuid,externalDirectoryObjectId:t?.ExternalDirectoryUserGuid,PUID:t?.IsExplicitLogon?void 0:t?.UserPuid,tenantId:t?.ExternalDirectoryTenantGuid}),eD(e)}function eZ(e){return e.sharedSources}function eQ(e,t,r){e.sharedSources.loadState=t,e.sharedSources.sources=r}let eJ=(0,o.jK)("SET_SHARED_SOURCES",function(e,t){y("Shared Mailbox",e,t,eZ,eQ)});function e0(e,t){let r=(0,x.A)(e);if(!r){let e="AcctSetSharedSources-AccountNotFound",t=Error(e);(0,f.s1)(e,t);return}eJ(e,t),c(r)}function e1(e){return eS.A(e)?.mailboxInfo}var e2=r(773910);function e3(e){let t=e1(e);return!!t&&(0,e2.A)(e,t)}var e5=r(713594);function e6(e){let t=e1(e);return!!t&&(0,e5.A)(t)}function e4(e){return(0,j.Hb)(e,(0,en.A)())}function e8(e,t=!1){return(0,j.UN)(e,er(t))}},42727:(e,t,r)=>{"use strict";r.d(t,{A:()=>function e(t){if(t.includes(o.f)){let r=t.split(o.f);if(r.length>1&&r[1]===i.Wo)return e(r[0])}return(0,n.A)().sourcesBySourceId.get(t)}});var n=r(633793),o=r(614823),i=r(79081)},192173:(e,t,r)=>{"use strict";r.d(t,{A:()=>s,V:()=>a});var n=r(332408),o=r(422745),i=r(633793);function a(e,t){return e.type===t.type&&e.userIdentity===t.userIdentity&&e.mailboxSmtpAddress===t.mailboxSmtpAddress}function s(e){if(e.sourceId){let t=(0,o.A)(e.sourceId);if(t)return t}for(let t of(e.userIdentity&&e.mailboxSmtpAddress||n.uP.info("[source-list-store] MailboxInfo does not have both userIdentity and mailboxSmtpAddress"),(0,i.A)().sourcesBySourceId.values()))if(a(t.source.mailboxInfo,e))return t.source}},422745:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(42727);function o(e){return n.A(e)?.source}},142544:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(633793);function o(e){return(0,n.A)().sources.filter(t=>t.sourceType===e).length}},689047:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(633793);function o(){return(0,n.A)().removedAccounts}},329603:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>d,QR:()=>s,_J:()=>u,wF:()=>l,zF:()=>f});var n=r(787468),o=r(633793),i=r(704108),a=r(631967),s=(e=>(e[e.Starting=0]="Starting",e[e.Completed=1]="Completed",e[e.Error=2]="Error",e[e.StartingOrCompleteOrError=3]="StartingOrCompleteOrError",e))(s||{}),l=(e=>(e[e.Any=0]="Any",e[e.Calendar=1]="Calendar",e[e.Contacts=2]="Contacts",e[e.Mail=3]="Mail",e[e.Settings=4]="Settings",e))(l||{});let c={0:e=>e.bootState!==a.y.StartupComplete&&e.bootState!==a.y.StartupError,1:e=>e.bootState===a.y.StartupComplete,2:e=>e.bootState===a.y.StartupError,3:e=>!0},u={0:e=>!0,1:e=>e.contracts.supportsCalendar,2:e=>e.contracts.supportsContacts,3:e=>e.contracts.supportsMail,4:e=>e.contracts.supportsSettings};function d(e,t){let r=c[e],a=u[t];if(!r||!a){let r=Error("Invalid startup or contract filter");throw r.additionalInfo={startup:e,contracts:t},r}return(0,o.A)().sources.map(e=>((0,n.A)(i.nR.isCoprincipal(e),"All sources must be Coprincipals"),e)).filter(e=>r(e)&&a(e))}function f(e,t){return d(e,t).map(e=>e.mailboxInfo)}},256010:(e,t,r)=>{"use strict";r.d(t,{A:()=>s,m:()=>l});var n=r(787468),o=r(633793),i=r(704108),a=r(422745);function s(){let e=(0,a.A)((0,o.A)().globalSettingsSourceId);return(0,n.A)(e,"AccountSourceListStore is not initialized",()=>`cnt=${(0,o.A)().sources.length} gs=${typeof(0,o.A)().globalSettingsSourceId} s=${typeof e}`),e}function l(){let e=s();if(i.nR.isCoprincipal(e))return e;throw Error("AccountSourceListStore is not initialized, global settings account is not a coprincipal account")}},302108:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(256010);function o(){let e=(0,n.A)();if(!e.mailboxInfo)throw Error("Global settings account lacks MailboxInfo");return e.mailboxInfo}},938658:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(422745);function o(e){return n.A(e)?.mailboxInfo}},127075:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(633793),o=r(422745),i=r(617633),a=r(838563);function s(){if(!(0,a.si)("acctNoFallback"))return(0,i.Ay)("getSelectedAccount"),(0,o.A)((0,n.A)().globalSettingsSourceId)}},23951:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(787468),o=r(633793),i=r(127075);function a(){let e=(0,i.A)();return(0,n.A)(e,"No account is selected as the global settings account",()=>`cnt=${(0,o.A)().sources.length} ss=${typeof(0,o.A)().globalSettingsSourceId} sa=${typeof e}`),(0,n.A)(e.mailboxInfo,"Global settings account lacks MailboxInfo",()=>`cnt=${(0,o.A)().sources.length} mi=${typeof e.mailboxInfo}`),e.mailboxInfo}},984134:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(633793);function o(){let e=(0,n.A)();return{globalSettingsSourceId:e.globalSettingsSourceId,sources:e.sources,removedAccounts:e.removedAccounts,licensingIdentities:e.licensingIdentities}}},633793:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(985065);let o={globalSettingsSourceId:"",sourcesBySourceId:new Map,sources:[],removedAccounts:[],licensingIdentities:[]},i=(0,n.y)("AccountSourceList",o)},704108:(e,t,r)=>{"use strict";r.d(t,{B3:()=>a,CM:()=>s,Fb:()=>c,OI:()=>i,mJ:()=>o,nR:()=>l});var n=r(436980),o=(e=>(e[e.NotStarted=0]="NotStarted",e[e.NotSupported=1]="NotSupported",e[e.Loading=2]="Loading",e[e.Loaded=3]="Loaded",e[e.Error=4]="Error",e))(o||{}),i=(e=>(e[e.M365Mailbox=0]="M365Mailbox",e[e.PstFile=1]="PstFile",e))(i||{}),a=(e=>(e[e.Archive=0]="Archive",e[e.User=1]="User",e[e.Connected=2]="Connected",e[e.Group=3]="Group",e[e.Shared=4]="Shared",e[e.PublicFolder=5]="PublicFolder",e[e.Teams=6]="Teams",e[e.PstFile=7]="PstFile",e))(a||{});let s={isM365Mailbox:e=>e?.dataType===0,isM365UserMailbox:e=>s.isM365Mailbox(e)&&1===e.accountSourceMailboxType,isM365ArchiveMailbox:e=>s.isM365Mailbox(e)&&0===e.accountSourceMailboxType,isM365ConnectedMailbox:e=>s.isM365Mailbox(e)&&2===e.accountSourceMailboxType,isM365GroupMailbox:e=>s.isM365Mailbox(e)&&3===e.accountSourceMailboxType,isM365SharedMailbox:e=>s.isM365Mailbox(e)&&4===e.accountSourceMailboxType,isM365PublicFolderMailbox:e=>s.isM365Mailbox(e)&&5===e.accountSourceMailboxType,isM365TeamsMailbox:e=>s.isM365Mailbox(e)&&6===e.accountSourceMailboxType,isPstFile:e=>e?.dataType===1},l={isCoprincipal:e=>e?.mailboxRank===n.B3},c=e=>{switch(e){case 0:return"ArchiveMailbox";case 2:case 1:return"UserMailbox";case 3:return"GroupMailbox";case 5:return"PublicMailbox";case 4:return"SharedMailbox";case 6:return"TeamsMailbox";case 7:return"PstFile";default:return e}}},631967:(e,t,r)=>{"use strict";r.d(t,{y:()=>n});var n=(e=>(e.Pending="Pending",e.Booting="Booting",e.StartupInitialized="StartupInitialized",e.StartupComplete="StartupComplete",e.StartupError="StartupError",e))(n||{})},116435:(e,t,r)=>{"use strict";r.d(t,{a:()=>n,n:()=>o});var n=(e=>(e[e.None=0]="None",e[e.CoprincipalAccount=1]="CoprincipalAccount",e))(n||{});function o(e){return 1===e.type}},772823:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(436980),o=r(689047),i=r(329603),a=r(992178),s=r(550019),l=r(713594);function c(e,t,r){let n=e.toLowerCase(),o=[];return e===r.mailboxInfo.mailboxSmtpAddress?o.push(`${t}-smtp`):n===r.mailboxInfo.mailboxSmtpAddress.toLowerCase()&&o.push(`${t}-smtp(mmc)`),e===r.mailboxInfo.userIdentity?o.push(`${t}-uid`):n===r.mailboxInfo.userIdentity.toLowerCase()&&o.push(`${t}-uid(mmc)`),r.aliases.includes(e)&&o.push(`${t}-alias`),o.length>0?o.join():void 0}function u(e){let t=(0,s.A)(),r=e?(0,a.A)(e):void 0,u=!!r,d=r?.bootState,f=e&&t?(0,l.A)(e):void 0,h=e?.mailboxRank==="Licensing",p=function(e){if(!e)return;let t=(0,n.ku)(e),r=(0,o.A)().map((e,r)=>{if(t&&(0,n.ku)(e.mailboxInfo)===t)return r.toString()}).filter(e=>void 0!==e);if(r.length>0)return r.join()}(e),m=function(e){if(!e)return;let t=(0,i.Ay)(i.QR.StartingOrCompleteOrError,i.wF.Any).map((t,r)=>{let o=function(e,t){if(e){if(e===t.mailboxInfo.sourceId)return"srcid";if(e.toLocaleLowerCase()===t.mailboxInfo.sourceId.toLowerCase())return"srcid(mmc)"}}(e.sourceId,t),i=(0,n.ku)(e)===(0,n.ku)(t.mailboxInfo)?"indexer":void 0,a=[e?c(e.mailboxSmtpAddress,"SMTP",t):void 0,e?c(e.userIdentity,"UID",t):void 0,o,i].filter(e=>void 0!==e);return a.length>0?`${r}:${a.join()}`:void 0}).filter(e=>void 0!==e);if(t.length>0)return t.join()}(e);return{hasAccount:u,bootState:d,isGlobalSettingsAccount:f,isRemovedAccount:!!p,matchingRemovedAccounts:p,isMatchingAccountEmails:!!m,matchingAccountEmails:m,accountsInStore:(0,i.Ay)(i.QR.StartingOrCompleteOrError,i.wF.Any).map((e,t)=>`${t}: ${e.sourceType} ${e.bootState}`).join(),isLicensingAccount:h}}},336430:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(532868);function o(e,t=!1){return(0,n.A)(e,t)}},532868:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(210809),o=r(912807),i=r(436980),a=r(329603),s=r(282623);let l=new Set;function c(e,t=!1){let r=(0,a.Ay)(a.QR.StartingOrCompleteOrError,a.wF.Any).filter(t=>(0,i.ku)(t.mailboxInfo)==e);return t&&0===r.length?function(e){if(!l.has(e)){l.add(e);let t=Error("AccountNotFoundForIndexer");(0,n.ye)(t.message,{stack:t.stack})}}(e):r.length>1&&function(e,t){let r=new o.T;r.addStep("matches",{cnt:t.length,indexerLen:e.length}),t.forEach(e=>{!function(e,t,r){var n;let o=e.sourceType.toString(),i=e.mailboxInfo.mailboxSmtpAddress.length,s=e.mailboxInfo.userIdentity.length,l=t.map(t=>t.mailboxInfo.mailboxSmtpAddress==e.mailboxInfo.mailboxSmtpAddress?"Y":"N").join(","),c=t.map(t=>t.mailboxInfo.userIdentity==e.mailboxInfo.userIdentity?"Y":"N").join(","),u=t.map(t=>t.persistenceId==e.persistenceId?"Y":"N").join(","),d=t.map(t=>t.sourceType==e.sourceType?"Y":"N").join(","),f=(n=e.sourceId,(0,a.Ay)(a.QR.StartingOrCompleteOrError,a.wF.Any).map((e,t)=>e.sourceId===n?t:-1).filter(e=>-1!==e).map(e=>e.toString()).join(","));r.addStep("match",{type:o,smtpLen:i,userIdLen:s,sameSmtp:l,sameUserId:c,samePersistenceId:u,sameType:d,sourceIdMatches:f})}(e,t,r)});let i={...r.getCustomDataMapForSteps(),persistenceAccountKey:(0,s.b)()},l=Error("DuplicateCoprincipalIndexerFound");return(0,n.s1)("DuplicateCoprincipalIndexerFound",l,i),l}(e,r),r[0]}},992178:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(436980),o=r(532868);function i(e){let t=(0,n.ku)(e);return(0,o.A)(t)}},615410:(e,t,r)=>{"use strict";r.d(t,{f:()=>i});var n=r(79081),o=r(614823);function i(e,t,r){return[e,n.Wo,t,r].join(o.f)}},550019:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(633793);function o(){let e=(0,n.A)().sources.length>0,t=!!(0,n.A)().globalSettingsSourceId;return e&&t}},713594:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(302108),o=r(773910);function i(e){return(0,o.A)(e,(0,n.A)())}},773910:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(192173);function o(e,t){return(0,n.V)(e,t)}},617633:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>d});var n=r(210809),o=r(466829),i=r(838563);let a=0,s=0,l=new Map([[!1,new Set],[!0,new Set]]),c=0,u=!1;function d(e){if((0,o.C0)()&&(0,i.si)("acct-reflowAndDefaultTelemetry")&&(a<10||s<10)){c<2&&!u&&(++c,u=!0,setTimeout(()=>{a=0,s=0,l.get(!1)?.clear(),l.get(!0)?.clear(),u=!1},3e5));let t=function(e){switch(e){case"getAccountSourceListStore":case"getSelectedAccount":case"setSelectedAccount":return!0;default:return!1}}(e);if((t?s:a)>=10)return;let r="AcctDefaultOrReflow-"+e,o=Error(r).stack;if(o){let e=l.get(t);e&&!e.has(o)&&((0,n.ye)(r,{s:o}),e.add(o),t?s++:a++)}}}},464116:(e,t,r)=>{"use strict";r.d(t,{OY:()=>o,XB:()=>n,bn:()=>i});var n=(e=>(e.Office365="Office365",e.OutlookDotCom="Outlook",e.Google="Google",e.ICloud="ICloud",e.Yahoo="Yahoo",e.IMAP="IMAP",e.POP3="POP3",e.PstFile="PstFile",e.Other="Other",e))(n||{});let o={IMAP_port:993,IMAP_encryption:"ssl",POP3_port:995,POP3_encryption:"ssl",SMTP_port:587,SMTP_encryption:"ssl"},i={IMAP:"imap",POP3:"pop3"}},690172:(e,t,r)=>{"use strict";r.d(t,{XB:()=>n.XB,OY:()=>n.OY,V4:()=>i,sx:()=>a,it:()=>o,bn:()=>n.bn});var n=r(464116);function o(e){return e?.type==="RemovedAccount"}var i=(e=>(e.NoError="NoError",e.PolicyError="PolicyError",e))(i||{});let a="add-account"},79081:(e,t,r)=>{"use strict";r.d(t,{M9:()=>a,Si:()=>o,Wo:()=>c,bP:()=>n,gD:()=>i,kT:()=>s,xK:()=>l});let n="archive",o="group",i="public",a="shared",s="shareda",l="teams",c="license"},691217:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,i:()=>o});let n=new Set;function o(e){n=e}function i(){return n}},912807:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});var n=r(30876);let o="steps";class i{constructor(){this.steps=new Map,this.suffixLimitReached=new Set}getKeyName(e,t){return t?`${e}_${t}`:e}addStep(e,t){if(this.suffixLimitReached.has(e))return;let r=this.steps.size,i=e==o?1:0;for(let n=i;n<25;++n)if(!this.steps.has(this.getKeyName(e,n))){this.steps.set(this.getKeyName(e,n),{sequence:r,data:t});return}let a=Error("StepsSuffixLimitReached");(0,n.IY)(a.message,a,{_n:e,...this.getCustomDataMapForSteps()}),this.suffixLimitReached.add(e)}getCustomDataMapForSteps(){let e={};return e[o]=this.steps.size,this.steps.forEach((t,r)=>{e[r]=t.sequence,t.data&&Object.keys(t.data).forEach(n=>{e[`${r}_${n}`]=t.data[n]})}),e}}},458704:(e,t,r)=>{"use strict";r.d(t,{n:()=>a}),r(268585);let n="56468f6991c348029c6bba403b444607-7f5d6cd1-7fbe-4ab1-be03-3b2b6aeb3eb4-7696",o=new Map;o.set("OutlookWeb",n),o.set("CLP","20ed4f5863d145bb9b9811c0f016da47-0f867f8d-a0be-44dc-b557-6da8178006f7-7559");let i=new Map;function a(e,t){return t&&o.has(t)?o.get(t):e&&i.has(e)?i.get(e):n}i.set("BookWithMe","ae3a308c9d714a9bafbae96e11115bc2-cf5099e3-5467-4f24-98eb-fef77b0802fa-6900"),i.set("FindTime","199fda8f7c2e423291001798b2f173c5-fcb15ea6-c8e1-430e-bfed-450cc70fcd67-6876"),i.set("Eventify","64c370c14bad4d92915f904803e88197-5dd29cf4-d011-45e0-b2e5-aade29021e96-6966"),i.set("Meet","199fda8f7c2e423291001798b2f173c5-fcb15ea6-c8e1-430e-bfed-450cc70fcd67-6876"),i.set("People","90c31e9f702c4564b120167247d3cd9f-d894a4e5-72f4-4221-ab00-94e1359dfb60-7137"),i.set("PeopleNew","90c31e9f702c4564b120167247d3cd9f-d894a4e5-72f4-4221-ab00-94e1359dfb60-7137")},30876:(e,t,r)=>{"use strict";let n,o;function i(){return void 0==n&&(n="undefined"!=typeof self&&self.performance?.timing!=null),n}function a(){return void 0==o&&(o="undefined"!=typeof self&&self.performance?.getEntriesByName!=null),o}r.d(t,{Yg:()=>m,CS:()=>u,hq:()=>d,a3:()=>i,Vx:()=>a,To:()=>s.To,Xs:()=>s.Xs,IY:()=>s.IY,uZ:()=>s.uZ,UQ:()=>f});var s=r(18588);let l=[],c=!0;function u(e,t){e(h),t(h),a()&&(self.performance.setResourceTimingBufferSize?self.performance.setResourceTimingBufferSize(500):self.performance.webkitSetResourceTimingBufferSize&&self.performance.webkitSetResourceTimingBufferSize(500))}function d(e,t,r,n){let o=(0,s.aY)(e);return{network:l,usage:o,coreUsage:(0,s.XU)(t),greyError:(0,s.ey)(r),coreGreyError:(0,s.lj)(n)}}function f(){c=!1}function h(){c&&l.push(arguments)}var p=r(458704);let m=()=>(0,p.n)(null,"OutlookWeb")},18588:(e,t,r)=>{"use strict";let n,o,i,a;r.d(t,{IY:()=>h,To:()=>p,XU:()=>g,Xs:()=>f,aY:()=>m,ey:()=>v,lj:()=>b,uZ:()=>d});let s=[],l=[],c=[],u=[];function d(e,t,r){n?n(e,t,r):s.push({name:e,customData:t,options:r})}function f(e,t,r){o?o(e,t,r):l.push({name:e,customData:t,options:r})}function h(e,t,r,n){i?i(e,t,r,n):c.push({name:e,error:t,customData:r,options:n})}function p(e,t,r,n){a?a(e,t,r,n):u.push({name:e,error:t,customData:r,options:n})}function m(e){return n=e,s}function g(e){return o=e,l}function v(e){return i=e,c}function b(e){return a=e,u}},655163:(e,t,r)=>{"use strict";function n(e){return"SimplifiedRibbon"===e||"MultiLineRibbon"===e}r.d(t,{qS:()=>i,Bn:()=>o,eP:()=>a,Ib:()=>n});var o=(e=>(e.Success="Success",e.ServerError="ServerError",e.UserError="UserError",e.UserCancelled="UserCancelled",e.ServerExpectedError="ServerExpectedError",e.ClientError="ClientError",e.RequestNotComplete="RequestNotComplete",e.Timeout="Timeout",e.BackgroundSuccess="BackgroundSuccess",e.AuthError="AuthError",e.PartnerError="PartnerError",e))(o||{}),i=(e=>(e.NETWORK="NETWORK",e.NETWORK_GQL="NETWORK_GQL",e.NETWORK_GATEWAY="NETWORK_GATEWAY",e.SERVICE_WORKER="SERVICE_WORKER",e.INDEXDB="INDEXDB",e.IN_MEMORY="IN_MEMORY",e.NO_QUERY="NO_QUERY",e))(i||{}),a=(e=>(e[e.NETWORK_REQUEST_STARTING=0]="NETWORK_REQUEST_STARTING",e[e.NETWORK_REQUEST_ENDED=1]="NETWORK_REQUEST_ENDED",e[e.DATA_SOURCE=2]="DATA_SOURCE",e[e.DATA_LOADING=0]="DATA_LOADING",e[e.DATA_LOADED=1]="DATA_LOADED",e[e.GQL_BRIDGE_QUERY=2]="GQL_BRIDGE_QUERY",e[e.GQL_BRIDGE_RESULT=3]="GQL_BRIDGE_RESULT",e[e.GQL_BRIDGE_ERROR=4]="GQL_BRIDGE_ERROR",e[e.CODE_LOADING=0]="CODE_LOADING",e[e.CODE_LOADED=1]="CODE_LOADED",e))(a||{})},787468:(e,t,r)=>{"use strict";function n(e,t,r){if(!e){let e=Error(`Assertion:${t}`);throw e.additionalInfo={diagnosticInfo:r?.()},e}}r.d(t,{A:()=>n})},160092:(e,t,r)=>{"use strict";let n,o;r.d(t,{tY:()=>h,Dy:()=>x,qx:()=>u,jm:()=>k,AZ:()=>v.AZ,A_:()=>d,oS:()=>T,Hm:()=>_,Po:()=>R,Nk:()=>s.Nk,YS:()=>f,FR:()=>s.FR,t5:()=>v.t5});class i{constructor(e){this.result=e}then(e,t){try{let t=e(this.result);return a(t)?t:Promise.resolve(t)}catch(e){return new Promise((t,r)=>r(e))}}catch(e){return this}toString(){return"QP"}finally(e){try{return e(),a(this.result)?this.result:Promise.resolve(this.result)}catch(e){return new Promise((t,r)=>r(e))}}}function a(e){return e?.then&&"function"==typeof e.then}var s=r(530698),l=r(518836);let c=/function\s*\(.*\)\s*{\s*return [^.]*([^;]*.*)}/;class u{constructor(e,t,r){this.lazyModule=e,this.getter=t,this.shouldGovern=r,this.pendingImports=0,this.import=(e,t)=>{if(!this.importPromise){let r;try{r=this.lazyModule.importModule(this.shouldGovern?"LazyGovernImport":"LazyImport",e||"LazyImport",this.getName(),t),this.importPromise=r?.then(e=>{let t=this.getter(e);return this.importPromise=new i(t),this.pendingImports=0,t}).catch(e=>{throw this.importPromise=void 0,s.zj().logUsage("LazyImportFailure",{message:e.message,pendingImports:this.pendingImports}),this.pendingImports=0,e})}catch(e){this.importPromise=Promise.reject(e)}}return(this.pendingImports++,(0,s.zj)().isFeatureEnabled("fwk-import-yield"))?(0,l.m9)("LazyImport").then(()=>this.importPromise):this.importPromise}}dangerouslyImportSync(){let e=this.lazyModule.getModuleValue();if(!e)throw Error("Module or import is not available yet.");return this.getter(e)}tryImportForRender(){let e=this.lazyModule.getModuleValue();if(e)return this.getter(e);this.import()}isImportLoaded(){return!!this.lazyModule.getModuleValue()}getName(){let e=this.getter.toString();try{let t=e.match(c);return t&&t.length>1?t[1]:e}catch{return e}}getModuleName(){return this.lazyModule.getModuleName()??"Unknown"}}function d(){let e=n;return n=null,e}function f(e){n=e}class h extends u{constructor(e,t,r){super(e,t);let o=this;this.importAndExecute=function(...e){let t=r?.captureBundleTime?Date.now():null;return o.import("LazyAction",o.perfDatapoint).then(r=>{n=t;let o=r.apply(null,e);return n=null,o})},this.addPerfDatapoint=e=>{o.perfDatapoint=e}}}var p=r(92078),m=r(340816),g=r(198787),v=r(786057),b=r(466829);o=r.u;let y=0;var w=r(655163),S=r(368094),C=r(694293);let I=class{constructor(e,t){this.importCallback=e,this.options=t,this.attempts=0,this.failedRetries=0,this.pendingImports=0,this.importStack=void 0,this.importWaterfallData={},this.id=(y++).toString(),this.constructionStack=Error("LazyModule constructed")}importModule(e,t,r,n){this.importStack=Error("Lazy Module import");let{getWithinGovernor:o,isFeatureEnabled:i,logUsage:a}=(0,s.zj)();if(i("fwk-noop-import-module")&&"LazyImport"!=e&&"LazyGovernImport"!=e&&o&&!o()){a("LazyImportOutsideGovernor",{source:e});return}return this.promise||(this.promise=new Promise((o,i)=>{(this.options?.runWhen||v.En)(async()=>{let a=!this.options?.maxFailedRetries||this.failedRetries<this.options.maxFailedRetries;this.attempts=0,I.outstandingImports++;let l=this.options?.name,c=t?`becuase of ${t} ${r}`:`directly with source ${e}`;(0,s.zj)().trace(`${l?`[${l}]`:""}LazyModule started to download ${c}, outstanding imports: ${I.outstandingImports}`);let u=!0;for(;u&&this.attempts<5&&a;)try{await this.loadModule(o,e,r,n),u=!1}catch(e){u=await this.onLoadFailed(e,i)}I.outstandingImports--},this.options?.govern,this.options?.prioritize,this.options?.name)})),!this.getIsLoaded()&&this.pendingImports++,this.promise}getIsLoaded(){return I.nonObservableImportedLoaded.has(this.id)}observableGetIsLoaded(){let e=(0,s.zj)().isImportLoaded(this.id);return e||I.shouldObservableMarkImportAsLoaded.add(this.id),e}async loadModule(e,t,n,i){var a,c,u;i&&"eventName"in i?i.addToPredefinedWaterfall("Code_S",!0):i&&i.datapoint.addToCustomWaterfall(i.indexes[w.eP.CODE_LOADING],`Code_S_${i.name}`,!0);let d=self.performance.now();this.attempts++,c=(a=this.attempts)>1&&5-a+1!==Math.floor(2.5)?"bO=1":"",o&&c&&(r.u=function(e){return o(e)+"?"+c});let f=5-this.attempts<Math.floor(2.5)?(0,p.lo)():(0,p.xf)();r.p=f;let h=this.importCallback(),m=this.options?.name;Object.values(O).map(e=>e(h,m)),o&&(r.u=o),u=(0,p.xf)(),r.p=u;let g=await h;this.moduleValue=g;let v=(0,s.zj)();I.nonObservableImportedLoaded.add(this.id),I.shouldObservableMarkImportAsLoaded.has(this.id)&&v.markImportAsLoaded([this.id]);let y=`${m?`[${m}]`:""}LazyModule finished downloading ${n} in ${this.attempts} attempts`,S=d&&self.performance.now()-d;S&&(y+=` in ${Math.floor(S)} ms`,A.push({start:d,duration:S,attemps:this.attempts})),v.trace(y),this.options?.initializer&&this.options.initializer(g)(),i&&"eventName"in i?i.addToPredefinedWaterfall("Code_E",!0):i&&i.datapoint.addToCustomWaterfall(i.indexes[w.eP.CODE_LOADED],`Code_E_${i.name}`,!0),(0,b.C0)()&&(this.addWaterfallCheckpoint("module"),setTimeout(()=>{(0,s.zj)().logUsage("LazyModuleImports",{entryModuleId:this.__getEntryModuleIdForLogging(),...this.importWaterfallData}),this.importWaterfallData=null},1e4),"object"==typeof g&&"LazyImport"!=t&&E.push(t)),this.pendingImports=0,this.attempts>1&&(0,s.zj)().logUsage("LazyLoadSuccessAfterRetry",{attempts:this.attempts.toString(),url:f}),(0,s.zj)().isFeatureEnabled("fwk-import-yield")||await (0,l.m9)(`lazymodule:${this.options?.name||"unknown"}`),e(g)}async onLoadFailed(e,t){var r;let n=this.options?.name;if(!(e instanceof Error)){let t=e;e=Error("Lazy module failed to load");try{e.additionalInfo={caughtError:t}}catch{}}if((0,s.zj)().trace(`${n?`[${n}]`:""}LazyModule failed to load ${e?.message||e}`),this.failedRetries++,(r=e).request||(0,m.P)()&&("NetworkError"===r.name||19===r.code)||(0,S.Q)(e?.message)){if(this.attempts>=5){(0,s.zj)().logUsage("LazyLoadFailure",{message:e.message,pendingImports:this.pendingImports});let r="Failed to load javascript.";e.httpStatus&&(r+="Status:"+e.httpStatus);let n=Error(r);n.networkError=!0,n.additionalInfo={loadingError:{message:e.message,...e.additionalInfo}},n.request=e.request,t(n),this.pendingImports=0,this.promise=void 0}else this.attempts>1&&await (0,g.A)(1e3*Math.pow(2,this.attempts-2))}else{try{Object.defineProperty(e,"scriptEval",{value:!0})}catch(r){let t=Error("EVAL ERROR: Could not set value on EVAL ERROR for logging");t.scriptEval=!0,t.additionalInfo={loadingError:e.stack,errorSettingScriptEval:r.stack},e=t}return e.additionalInfo={...e.additionalInfo,constructionStack:this.constructionStack.stack,importStack:this.importStack?.stack},/A store named .*? has already been created\.$/.test(e.message)&&(0,C.zA)()?(0,s.zj)().logGreyError("Safari satcheljs store issue",e):(0,s.zj)().logError(e),e.reported=!0,t(e),!1}return!0}getModuleValue(){if(this.getIsLoaded()||this.observableGetIsLoaded())return this.moduleValue}__getEntryModuleIdForLogging(){let e=this.importCallback.toString();try{let t=e.match(/.*\.bind\(null,([^)]+)\)/);return t&&t.length>1?t[1]:e}catch{return e}}addWaterfallCheckpoint(e){this.importWaterfallData&&void 0===this.importWaterfallData[e]&&(this.importWaterfallData[e]=self?.performance.now())}getModuleName(){return this.options?.name}},k=I;k.outstandingImports=0,k.nonObservableImportedLoaded=new Set,k.shouldObservableMarkImportAsLoaded=new Set;let E=[];function _(){let e=E;return E=[],e}let A=[];function T(e){let t=[...A];return e&&(A=A.filter(t=>t.start+t.duration>=e)),t}let P=0;var O={};function R(e){let t=P++;return O[t]=e,()=>{delete O[t]}}class x extends k{constructor(e,t){(t=t||{}).runWhen=e=>e(),super(e,t),this.isBootModule=()=>!0}}},530698:(e,t,r)=>{"use strict";r.d(t,{FR:()=>s,Nk:()=>a,zj:()=>i});let n={},o={markImportAsLoaded:e=>{for(let t of e)n[t]=!0},isImportLoaded:e=>n[e],logUsage:()=>{},logError:()=>{},logGreyError:async()=>{},trace:()=>{},isFeatureEnabled:()=>!1};function i(){return o}function a(e){e.markImportAsLoaded(Object.keys(n)),o=e}function s(){o.govern=void 0}},786057:(e,t,r)=>{"use strict";r.d(t,{AZ:()=>l,En:()=>a,t5:()=>s});var n=r(530698);let o=[],i=!1;function a(e,t,r,a){let s=void 0!=t?()=>{let{govern:r}=(0,n.zj)();return r?r({task:e,priority:t,name:`LazyModuleGovern${a??"Unknown"}`}):e()}:e;i?s():r?o.unshift(s):o.push(s)}function s(){i=!0;for(var e=0;e<o.length;e++)o[e]();o=[]}function l(){i=!1}},337168:(e,t,r)=>{"use strict";r.d(t,{$:()=>i,T:()=>o});let n=["Office365","Outlook"],o=new Set([...n]),i=new Set([...n,"Google","ICloud","Yahoo","IMAP","POP3","PstFile","Unknown"])},308267:(e,t,r)=>{"use strict";r.d(t,{B3:()=>o,Fw:()=>i,Uk:()=>n});let n=new Set(["Coprincipal","Resource","Licensing","Anonymous"]),o="Coprincipal",i="Resource"},614823:(e,t,r)=>{"use strict";r.d(t,{c:()=>o,f:()=>n});let n=":",o=/:/gi},739155:(e,t,r)=>{"use strict";r.d(t,{j:()=>o});var n=r(614823);function o(e){return e?e.split(n.f)[0]:void 0}},436980:(e,t,r)=>{"use strict";r.d(t,{B3:()=>d.B3,Fw:()=>d.Fw,EN:()=>l,ku:()=>s,qS:()=>c,Dq:()=>h,UN:()=>p,A_:()=>g,wj:()=>v,Hb:()=>m,Bt:()=>u,kH:()=>f});var n=r(282623),o=r(585931),i=r(739155);let a="default_emptyAccountKey";function s(e){if((0,n.b)()){let t=(0,i.j)(e.sourceId);if(t)return t}return(0,o.pB)(e)??((0,n.b)()?void 0:e.userIdentity)??a}function l(e){return s(e)}function c(e){return e===a}function u(e){return void 0!==e&&!!e&&e!==a&&""!==e}var d=r(308267);let f={isCoprincipal:e=>e?.mailboxRank===d.B3,isResource:e=>e?.mailboxRank===d.Fw};function h(e){return["type","userIdentity","mailboxSmtpAddress"].every(t=>e?.hasOwnProperty?.(t))}function p(e,t){let r=!1;return u(e)&&u(t)&&(r=e===t),r}function m(e,t){let r=!1;return e&&t&&(r=p(s(e),s(t))),r}function g(e,t){let r=!1;return e&&(r=p(s(e),t)),r}function v(e,t){let r=!1;if(e){var n;let o;n=s(e),o=!1,n&&t&&n!==a&&""!==n&&t!==a&&""!==t&&(o=n===t),r=o}return r}r(337168)},282623:(e,t,r)=>{"use strict";let n;r.d(t,{b:()=>i});var o=r(838563);function i(){return void 0==n&&(n=(0,o.si)("acctPersistentIdIndexerV2")),n}},585931:(e,t,r)=>{"use strict";let n;function o(e){n=e}function i(){return!!n}function a(e){return n?n(e):void 0}r.d(t,{Rn:()=>o,pB:()=>a,zY:()=>i})},92078:(e,t,r)=>{"use strict";let n,o,i,a,s,l,c;r.d(t,{sT:()=>F,Sx:()=>w,lM:()=>I,rG:()=>C,Oo:()=>S,Db:()=>_,sF:()=>P,lo:()=>O,xf:()=>T,cF:()=>k,t5:()=>E,Fg:()=>R,Y6:()=>b,eL:()=>y});var u=r(5960),d=r(268585),f=r(818747),h=r(466829);let p="owamail/";function m(){if(!n){let e="2"==(0,d.jo)("bO"),t=g()+p,r=g(!0)+p,o=(0,u.Ay)("baseUrl");k()&&o&&(t=r=o),n={PackageBaseUrl:e?r:t,ExtraSettings:{},BackupBaseUrl:e?t:r,ResourcesPath:"",ScriptPath:E()?"":"scripts/"}}return n}function g(e){let t=e?2:1,r=!0,n=(0,u.Ay)("scriptVer");n&&-1===n.indexOf(".")&&(r=!1);let o=r?`res-${t}`:`res-${t}-sdf`;return"Gallatin"==(0,h.Pt)()?`//outlook-${t}.cdn.partner.outlook.cn/`:`//${o}.cdn.office.net/`}let v=[];function b(e){v.push(e)}function y(e){o=e,function(e){for(let t of v)t(e)}(e)}function w(){return o}function S(){return L("scriptVer")}function C(){let e=L("cdnUrl");return R(e)?e:g()}function I(){let e=L("backupCdnUrl");return R(e)?e:g(!0)}function k(){return a??(a=R(L("devCdnUrl")))}function E(){return s??(s=!!L("devCdnUrl")&&!new URL(F(L("devCdnUrl"))).pathname?.split("/").filter(e=>e)[0]?.endsWith("-branch"))}function _(e,t){if(i)return i;let r=function(){let e=L("devCdnUrl");if(R(e))return e}();if(r)return r;let n=L(t?"backupCdnUrl":"cdnUrl"),o=L("cdnContainer");if(R(n)&&R(o))return n+o+((e?void 0:L("hashedPath"))||S())+"/";let a=m();return(t?a.BackupBaseUrl:a.PackageBaseUrl)+(k()?"":S()+"/"+((0,d.bK)("debugJs")?"debug/":""))}let A=[void 0,void 0];function T(e){var t;return A[t=e?0:1]??(A[t]=F(_(e)+x()))}function P(){return c??(c=F(_(!0)+(function(){let e=L("scriptPath");if(R(e)&&e!=m().ScriptPath){let t=e.split("/")[0];return t?t+"/":""}return""}()+"resources/")))}function O(e){return F(_(e,!0)+x())}function R(e){return!!e&&e.indexOf("/")>-1}function x(){let e=L("scriptPath");return R(e)?e:m().ScriptPath}let M=()=>(void 0===l&&(l=f.H().location?.protocol||"https:"),l),N=RegExp("^https?:");function F(e){return N.test(e)||(e=M()+e),e}function L(e){return(0,u.Ay)(e)||""}},364590:(e,t,r)=>{"use strict";r.d(t,{EN:()=>l,Hm:()=>u,K3:()=>a,Mr:()=>s,iC:()=>c});var n=r(268585),o=r(249447);let i={nativeVersion:void 0,sessionId:void 0,deviceId:void 0,extendedHost:void 0};function a(){return i.nativeVersion||(0,n.jo)("nativeVersion")}function s(){return i.sessionId}function l(){return i.deviceId}function c(){return i.extendedHost}function u(e,t,r,a){i={nativeVersion:e||(0,n.jo)("nativeVersion"),sessionId:t||(0,o.u)(),deviceId:r,extendedHost:a||void 0}}},588997:(e,t,r)=>{"use strict";let n;function o(e){n=e}function i(){return n}r.d(t,{Q:()=>i,w:()=>o})},260699:(e,t,r)=>{"use strict";let n;r.d(t,{iq:()=>d,mW:()=>u});var o=r(369687),i=r(268585),a=r(993872),s=r(588997);let l=["teams","teamsmodern","outlook","outlookwin32","office"],c=["desktop","web","ios","android","ipados","macos"];function u(e,t){let r;let u=[o.Q$,o.Hz,o.W_,o.NC,o.Sl,o.Ah,o.EO];(0,i.bK)("hostApp")?r=(0,i.jo)("hostApp").toLowerCase():(0,i.bK)("testHostApp")&&(r=(0,i.jo)("testHostApp").toLowerCase()),r&&u.includes(r)&&(n=r);let d=(0,a.h)();if((!n||n==u[0])&&d){let r=e?.toLowerCase()||"",i=t?.toLowerCase()||"";e&&l.includes(r)&&t&&c.includes(i)?((0,s.w)(i),n="teams"===r||"teamsmodern"===r?o.Hz:"outlookwin32"===r?o.W_:"outlook"===r?"desktop"===i?o.NC:"web"===i?o.Sl:"ios"===i?o.k:"android"===i?o.ID:o.bZ:"office"===r?"desktop"===i?o.EO:"web"===i?o.Ah:"ios"===i?o.jq:"android"===i?o.rZ:o.xO:o.Q$):n=o.Q$}}function d(){return n}},449241:(e,t,r)=>{"use strict";r.d(t,{O:()=>l});var n=r(369687),o=r(790757),i=r(260699),a=r(993872),s=r(364590);function l(){return(0,s.K3)()?n.s6:(0,a.h)()?(0,i.iq)():(0,o.J)()}},790757:(e,t,r)=>{"use strict";let n;r.d(t,{J:()=>s,JQ:()=>l,Mg:()=>c,QA:()=>a});var o=r(249447);let i="(none)";function a(){return n}function s(){return i}function l(e){i=e}function c(e){n=e.then(e=>{let t=e.sessionId;return t&&(0,o.b)(t),e})}},249447:(e,t,r)=>{"use strict";let n;r.d(t,{b:()=>l,u:()=>s});var o=r(268585),i=r(364590),a=r(486603);function s(){return n||(n=(0,i.Mr)()||(0,o.jo)("sessionId")||(0,a.a)()),n}function l(e){n=e}},993872:(e,t,r)=>{"use strict";r.d(t,{h:()=>o});var n=r(818747);function o(){return n.H()?.location?.pathname.indexOf("/hosted")==0}},340816:(e,t,r)=>{"use strict";function n(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope}r.d(t,{P:()=>n})},486603:(e,t,r)=>{"use strict";r.d(t,{a:()=>o});let n=/[xy]/g;function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(n,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}},369687:(e,t,r)=>{"use strict";r.d(t,{$m:()=>P,Ah:()=>w,EO:()=>S,Gu:()=>A,Hz:()=>g,ID:()=>a,JD:()=>d,NC:()=>y,Nk:()=>s,O2:()=>o,Q$:()=>v,Sl:()=>b,T3:()=>f,VV:()=>p,W9:()=>E,W_:()=>m,bZ:()=>c,hf:()=>n,iB:()=>T,jq:()=>C,k:()=>i,pg:()=>h,rZ:()=>I,s6:()=>u,w2:()=>l,wC:()=>_,xO:()=>k});let n="outlookdesktop",o="macoutlook",i="iosoutlook",a="androidoutlook",s="outlooklite",l="outlookextension",c="outlookotherhub",u="native",d="o365shell",f="teams",h="androidteams",p="iosteams",m="win32outlookhub",g="teamshub",v="hub",b="owahub",y="monarchhub",w="officeweb",S="officedesktop",C="officeios",I="officeandroid",k="officeotherhub",E="androidhub",_="iosoutlookhub",A="macoutlookhub",T="sharepoint",P="loopapp"},368094:(e,t,r)=>{"use strict";r.d(t,{Q:()=>i});var n=r(941840);let o=["out of memory","not enough storage","not enough memory resources","espacio de almacenamiento insuficiente","insuffisante pour cette","no hay suficiente espacio de pila","espace pile insuffisant","Memoria esaurita","Mmoire insuffisante","Memoria insuficiente","Memria insuficiente"];function i(e){return(0,n.E)(o,e)}},941840:(e,t,r)=>{"use strict";function n(e,t){return!!t&&e.some(e=>t.toLowerCase().indexOf(e.toLowerCase())>-1)}r.d(t,{E:()=>n})},112033:(e,t,r)=>{"use strict";r.d(t,{U:()=>n});let n=(0,r(45228).XI)("FEATURE_FLAGS_INITIALIZED",(e,t,r)=>({enabledFlights:e,mailboxInfo:t,indexer:r}))},908839:(e,t,r)=>{"use strict";r.d(t,{iv:()=>v,eG:()=>b,Ay:()=>w});var n=r(950278),o=r(268585),i=r(376693),a=r(996276),s=r(135267),l=r(931013),c=r(886585),u=r(410998),d=r(436980),f=r(282623),h=r(112033),p=r(505182);let m=new Set,g=!1;function v(e){if(g&&!e)return!0;let t=m.size>0&&m.has((0,l.A)(e,!0));return!e&&t&&(g=!0),t}function b(e){return m.has(e)}function y(e,t){for(let r of Object.keys(t))e[r.toLowerCase()]=t[r]}let w=function(e,t,r){let g=e.reduce((e,t)=>(e[t.toLowerCase()]=!0,e),{}),b=function(e=i.Ay){return e("ring-dogfood")?"Dogfood":e("ring-microsoft")?"Microsoft":e("ring-firstrelease")?"FirstRelease":e("ring-ww")?"WW":"Unknown"}(e=>g[e]);if(v(r))return b;let w=(0,f.b)()?!r||(0,u.NF)(!1)===(0,d.ku)(r):!r;(0,a.P)(function(e){let t={};for(let r of Object.keys(e))t[r]=e[r];return t}(g),r||null),"Dogfood"==b&&t&&y(g,t),g["fwk-devtools"]&&w&&y(g,function(e){for(let[t,r]of Object.entries((0,o.OU)()))if(t.toLowerCase()===e.toLowerCase())return(0,n.A)(r);return{}}("features")),(0,s.Ay)(r).featureFlags=new Map(Object.keys(g).map(e=>[e,g[e]]));let S=(0,l.A)(r,!0);return m.add(S),(0,h.U)((0,p.R)(r),r,S),(0,c.PK)(),b}},643761:(e,t,r)=>{"use strict";let n,o;r.d(t,{iv:()=>c.iv,n5:()=>v,UK:()=>b,yC:()=>l,UG:()=>_.U,jO:()=>h.j,RD:()=>S.R,Ti:()=>w,kc:()=>a,sL:()=>C.A,Y_:()=>u.Y_,dE:()=>E.d,ev:()=>c.Ay,bM:()=>u.bM,uU:()=>A.A,G7:()=>u.Ay,nI:()=>I,gG:()=>k,aB:()=>T,U8:()=>d.U,JA:()=>f});var i=r(135267);function a(){return o??(o=(0,i.Ay)(null).featureFlags)}let s="Features";function l(e){return e&&e[s]?Object.keys(e[s]||{}).filter(t=>!0===e[s][t]):[]}var c=r(908839),u=r(376693),d=r(16233);let f=function(e,t){for(let r of e)(0,d.A)(r.name,r.isEnabled,t)};var h=r(996276);let p="fwk-uberflag",m="fwk-consumer",g="fwk-business";function v(){return y().includes(p)?1:0}function b(e){let t=y();return e&&t.includes(m)&&!t.includes(g)||!e&&t.includes(g)&&!t.includes(m)?1:0}function y(){return n||(n=(function(e){let t=(0,h.j)(void 0);return Object.keys(t).filter(e=>t[e])})().filter(e=>e===p||e===m||e===g)),n}function w(e,t){let r=(0,i.Ay)(t).featureFlags;return[...r.keys()].filter(t=>0==t.indexOf(e)&&r.get(t.toLowerCase()))}var S=r(505182),C=r(931013);function I(e,t){return(0,u.Ay)("fwk-useoutlookgateway-getSchedule",e,t)}function k(e,t){return(0,u.Ay)("cal-hybrid-working-hours",e,t)&&I(e,t)}r(886585);var E=r(463886),_=r(112033),A=r(63269);function T(e,t){return(0,u.Ay)("fwk-immutable-ids",e,t)}},135267:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>i});var n=r(931013);let o=new Map;function i(e){let t=(0,n.A)(e),r=o.get(t);if(!r){let e={featureFlags:new Map};o.set(t,e),r=e}return r}},886585:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>s,PK:()=>a});var n=r(332408),o=r(908839);let i=!1;function a(){i&&(0,o.iv)()&&(i=!1,n.uP.info("Anonymous Flighting Disabled"))}function s(){return a(),i}},996276:(e,t,r)=>{"use strict";r.d(t,{P:()=>i,j:()=>a});var n=r(931013);let o=new Map([["",{}]]);function i(e,t){let r=(0,n.A)(t);o.set(r,e)}function a(e){let t=(0,n.A)(e);return o.get(t)||o.get("")}},505182:(e,t,r)=>{"use strict";r.d(t,{R:()=>o});var n=r(135267);function o(e){return[...(0,n.Ay)(e).featureFlags.keys()]}},931013:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(410998),o=r(436980),i=r(282623),a=r(30876),s=r(332408);let l={accountKey:"",initialStack:"",currentLogCount:0};function c(e,t){return(0,i.b)()?function(e,t){let r=(0,n.NF)(!1);if(e&&!e.isAnonymous){let t=(0,o.EN)(e);if(t!==r)return t}if(l.accountKey||(l.accountKey=r,l.initialStack=Error("GlobalAccountKeyInitialized").stack||""),!l.accountKey&&t&&(0,s.Z1)("FeatureFlagsIndexerForMailboxInfo: Global account not initialized"),l.accountKey!==r&&l.currentLogCount<3){let e=`${typeof l.accountKey}(${l.accountKey.length})`,t=`${typeof r}(${r.length})`,n=function(e,t){let r=Math.min(e.length,t.length);for(let n=0;n<r;n++)if(e[n]!==t[n])return n;return r}(e,t);(0,a.IY)("MismatchedGlobalAccountKey",Error("MismatchedGlobalAccountKey"),{initial:e,current:t,firstDiff:n,initialStack:l.initialStack}),l.currentLogCount++}return l.accountKey}(e,t):e?.isAnonymous?(0,n.NF)(!1):!function(e){if(!e)return!0;{let t=n.EZ()?.mailboxInfo;return!t||(0,o.ku)(t)===(0,o.ku)(e)}}(e)?(0,o.ku)(e):""}},63269:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(376693);function o(){return(0,n.Ay)("mos-multiAccount")&&(0,n.Ay)("mos-mos3AppService")}},376693:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>w,Ut:()=>b,Y_:()=>v,bM:()=>S});var n=r(135267),o=r(332408),i=r(908839),a=r(886585),s=r(931013),l=r(410998),c=r(772823),u=r(585931),d=r(282623),f=r(30876),h=r(449241),p=r(340816),m=r(690172),g=(e=>(e.UnknownMailbox="UnknownMailbox",e.RunningOnWorker="RunningOnWorker",e.GlobalSettingsAccount="GlobalSettingsAccount",e.RemovedAccount="RemovedAccount",e.Other="Other",e))(g||{});function v(e){var t,r,n;let o=(0,c.A)(e),i=(0,l.NF)(!1),a=e?(0,u.pB)(e):void 0,s=(0,p.P)(),d=(t=o.hasAccount,r=!!o.isGlobalSettingsAccount,n=!!o.isRemovedAccount,e&&!t?"UnknownMailbox":s?"RunningOnWorker":!e||r?"GlobalSettingsAccount":n?"RemovedAccount":"Other");return{hasMailboxInfo:!!e,mailboxType:e?.type,hasSourceId:!!e?.sourceId,hasUserId:!!e?.userIdentity,hasSmtp:!!e?.mailboxSmtpAddress,rank:e?.mailboxRank,diagnosticData:e?.diagnosticData,isAnonymous:e?.isAnonymous,isRemoved:e?.isRemoved,isTryLookupSet:(0,u.zY)(),hasGlobalSettingsIndexer:!!i,hasTryIndexer:!!a,isTryIndexerGSA:a===i,isTryIndexderUID:a===e?.userIdentity,runningOnWorker:s,typeOfAccess:d,...o}}function b(e,t){let r=(0,s.A)(t),n=t?(0,u.pB)(t):void 0,o=v(t);return{feature:e,hasIndexer:""!==r,isGlobalInitalized:(0,i.iv)(),isTryIndexderFF:n===r,...o}}function y(e,t,r){if(function(e,t,r,n){if((0,i.iv)(t)&&!(0,d.b)()&&!r){let r=t?.userIdentity;if(r&&!(0,i.eG)(r)){let o=(0,s.A)(t);if(o&&o!==r){let r=Error("WouldHaveThrownBeforeAliasLookup");(0,f.IY)("WouldHaveThrownBeforeAliasLookup",r,n(e,t))}}}}(e,t,r,b),!(0,i.iv)(t)){if(r||(0,a.Ay)()||m.sx==(0,s.A)(t))return!1;let n=b(e,t),i=function(e,t){switch(e){case"UnknownMailbox":return"teamshub"==(0,h.O)()?Error("[TeamsHub] Attempted to read feature flag from unknown mailbox"):Error("Attempted to read feature flag from unknown mailbox");case"RunningOnWorker":return Error("Attempted to read feature flag too early on worker");case"GlobalSettingsAccount":return Error(`Attempted to read global account feature flag ${t} too early`);case"RemovedAccount":return Error("Attempted to read secondary account feature flag of removed account");default:return Error("Attempted to read secondary account feature flag too early")}}(n.typeOfAccess,e);i.additionalInfo=n,t&&l.fV(t)?.bootState==="StartupError"?(0,f.IY)("isFeatureEnabled: "+i.message,i):(0,o.Z1)(i)}return(0,n.Ay)(t).featureFlags.get(e.toLowerCase())||!1}function w(e,t,r){return y(e,t,r)}function S(e,t,r){return y(e,t,r)}},463886:(e,t,r)=>{"use strict";r.d(t,{d:()=>a});var n=r(931013),o=r(282623),i=r(410998);function a(e){let t=(0,n.A)(e);return(0,o.b)()?t===(0,i.NF)(!1)?"":`:${t}`:t?`:${t}`:""}},950278:(e,t,r)=>{"use strict";function n(e){let t={};return e.split(",").forEach(e=>{let r=!0;0===e.indexOf("-")&&(r=!1,e=e.slice(1,e.length)),t[e.toLowerCase()]=r}),t}r.d(t,{A:()=>n})},16233:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,U:()=>a});var n=r(135267);let o=[];function i(e,t,r){for(let i of((0,n.Ay)(r).featureFlags.set(e.toLowerCase(),t),o))i()}function a(e){o.push(e)}},717208:(e,t,r)=>{"use strict";function n(...e){return self.fetch(...e)}r.d(t,{h:()=>n})},108314:(e,t,r)=>{"use strict";r.d(t,{Gq:()=>n.Gq,i7:()=>n.i7,Lg:()=>n.Lg,ly:()=>n.ly,qe:()=>n.qe,Aq:()=>n.Aq,dO:()=>n.dO,Ai:()=>n.Ai,SO:()=>n.SO});var n=r(633912);r(332408)},633912:(e,t,r)=>{"use strict";r.d(t,{Ai:()=>u,Aq:()=>h,FB:()=>s,Gq:()=>c,Lg:()=>p,SO:()=>l,dO:()=>m,i7:()=>f,ly:()=>d,qe:()=>a});var n=r(818747);let o="olk-",i=!1;function a(e){return o+e}function s(){i=!0}function l(e,t,r){if(m(e))try{let n=o+t;localStorage.setItem(n,r),e.localStorage.setItem(n,r),e.localStorage.removeItem(t)}catch{}else{let e=(0,n.H)();e?.localStorage?.setItem(t,r)}}function c(e,t){if(i)return null;let r=o+t;if(m(e))try{return e.localStorage.getItem(r)||e.localStorage.getItem(t)}catch{return null}else{let e=(0,n.H)();return e?.localStorage?.getItem(r)||e?.localStorage?.getItem(t)||null}}function u(e,t){if(m(e))try{e.localStorage.getItem(t)?e.localStorage.removeItem(t):e.localStorage.removeItem(o+t)}catch{}else{let e=(0,n.H)();return e?.localStorage?.removeItem(t)}}function d(e){if(m(e))try{return e.localStorage.length}catch{}return 0}function f(e,t){if(m(e))try{let r=RegExp("^"+o),n=e.localStorage.key(t);if(n)return n?.replace(r,"")}catch{}return null}function h(e,t){return null!==(c(e,t)||c(e,`owaPrefix${t}`))}function p(e){return e.localStorage}function m(e){try{return e&&!!e.localStorage}catch{return!1}}},658858:(e,t,r)=>{"use strict";function n(e){let t,r=!1;return function(...n){return r||(r=!0,t=e.apply(this,n)),t}}r.d(t,{O:()=>n})},5960:(e,t,r)=>{"use strict";let n;function o(e){return n||(n=i()),n[e]}function i(){return n||(n=function(){let e=Array.from(window.document.getElementsByTagName("meta")),t={};for(let r of e)t[r.name]=r.content;return t}()),n}r.d(t,{Ay:()=>o,Tk:()=>i})},466829:(e,t,r)=>{"use strict";let n;r.d(t,{C0:()=>c,Pt:()=>l,YQ:()=>u,eg:()=>s});var o=r(5960);let i=["Unknown","WW","Dogfood","SIP","BlackForest","DONMT","MSIT","Gallatin","SDFV2","PDT","TDF","ITAR"],a=["Unknown","AG08","AG09","BlackForest","DITAR","DoD","Dogfood","Gallatin","GCCModerate","GccHigh","GovCloud","ITAR","Prod"];function s(){let e=((0,o.Ay)("physicalRing")||"").toLowerCase();return i.filter(t=>t.toLowerCase()===e)[0]||"Unknown"}function l(){let e=((0,o.Ay)("environment")||"").toLowerCase();return a.filter(t=>t.toLowerCase()===e)[0]||"Unknown"}function c(){if(void 0===n){let e=s();n="Dogfood"==e||"SDFV2"==e||"Dogfood"==l()}return n}function u(){let e=l();return"AG08"==e||"AG09"==e}},838563:(e,t,r)=>{"use strict";let n,o,i;r.d(t,{_B:()=>c,g6:()=>l,si:()=>s});var a=r(5960);function s(e){return(o||(o=new Set(l().map(e=>e.toLowerCase()))),o).has(e.toLowerCase())}function l(){if(!n){let e=(0,a.Ay)("bootFlights");n=e?e.split(",").map(e=>e.split(":")[0]):[]}return n}function c(){if(!i){let e=(0,a.Ay)("bootFlights");i=e?e.split(","):[]}return i}},238329:(e,t,r)=>{"use strict";function n(e){if(self.document&&"visible"==self.document.visibilityState)return self.requestAnimationFrame(function(){e(!0)});e(!1)}r.d(t,{A:()=>n})},908632:(e,t,r)=>{"use strict";r.d(t,{Kp:()=>c,TW:()=>f,a1:()=>d,bz:()=>s,kf:()=>l,mj:()=>h});var n=r(238329),o=r(268585);let i=new Map,a=new Map;function s(){return i}function l(){return a}function c(){i.clear(),a.clear()}let u=null;function d(e){u=e}function f(e,t){if("function"==typeof performance?.now){let r=`${e}:${t}`;i.set(performance.now(),r);let a=(0,o.jo)("markTiming");if(("*"==a||a&&r.includes(a))&&performance.mark(`timingMap:${r}`),u){let e=u(r,{minDuration:1e3});e&&(0,n.A)(t=>{setTimeout(()=>{e(t)})})}}}function h(e,t,r){let n=r??("function"==typeof performance?.now?performance.now():void 0);void 0!=n&&a.set(n,`${e}:${t}`)}},268585:(e,t,r)=>{"use strict";r.d(t,{As:()=>h,DU:()=>u,Dn:()=>f,OU:()=>i,bK:()=>l,jo:()=>s,tm:()=>a});var n=r(818747);let o=null;function i(e){return(e||(e=(0,n.H)().location),e===location)?o||(o=c(location)):c(e)}function a(){o=c(location)}function s(e){return o?o[e]:i()[e]}function l(e){return o?e in o:Object.prototype.hasOwnProperty.call(i(),e)}function c(e){return void 0!==e&&e.search?f(e.search.substr(1)):{}}function u(e,t){let r=RegExp("(\\?|&)"+t+"=\\w*&?","g"),n=e.split(r).join(""),o=n[n.length-1];return("?"===o||"&"===o)&&(n=n.substr(0,n.length-1)),n}let d=/\+/g;function f(e){let t={};if("string"==typeof e&&e.length>0){let r=e.split("&"),n=r.length>1e3?1e3:r.length;for(let e=0;e<n;++e){let n=r[e].replace(d,"%20").split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n.slice(1).join("="))}}return t}function h(e){return e?Object.keys(e).map(t=>encodeURIComponent(t)+(e[t]?"="+encodeURIComponent(e[t]):"")).join("&"):""}},985065:(e,t,r)=>{"use strict";r.d(t,{y:()=>s});var n=r(45228),o=r(658858),i=r(838563);let a=new Set;function s(e,t){if(!(!("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope)&&(0,i.si)("fwk-createstore-deffered")))return(0,n.y$)(e,t);if(!a.has(e))return a.add(e),(0,o.O)(()=>(0,n.y$)(e,t)());throw Error(`Store with key ${e} already exists`)}},243034:(e,t,r)=>{"use strict";r.d(t,{E4:()=>s,ak:()=>a,vw:()=>i});var n=r(160092);let o=new n.jm(()=>Promise.all([r.e(30588),r.e(89280),r.e(18522),r.e(14348)]).then(r.bind(r,23197)),{prioritize:!0}),i=new n.tY(o,e=>e.installServiceWorkerCache),a=new n.tY(o,e=>e.cleanUpServiceWorkerCache),s=new n.tY(o,e=>e.initializeServiceWorker)},344743:(e,t,r)=>{"use strict";let n;r.d(t,{K:()=>l,R:()=>c});var o=r(985065),i=r(7305),a=r(239232),s=r(340816);let l=()=>((0,i.W)(),n),c=()=>(n||(n=(0,o.y)("owaSessionStore",{nonGlobalAccountDataMap:new Map([]),userConfiguration:void 0,userSessionCount:(0,s.P)()?(0,a.Yz)():(0,a.pl)(),npsDismissCount:(0,a.z7)(),defaultFolderIdToNameMap:new Map([]),sharedMailboxFolderInformationMaps:new Map([]),sharedMailboxFolderIdToNameMap:new Map([]),connectedAccountsUserConfigurationMap:new Map([]),allowDefaultDataReturn:!1})()),n)},7305:(e,t,r)=>{"use strict";r.d(t,{W:()=>i});var n=r(30876),o=r(344743);function i(e){let{allowDefaultDataReturn:t,userConfiguration:r}=(0,o.R)();if(!t&&void 0===r){let t=Error("OwaSessionStoreGlobalSettingsNotReady");(0,n.IY)("OwaSessionStoreGlobalSettingsNotReady",t,{context:e})}}},239232:(e,t,r)=>{"use strict";r.d(t,{M6:()=>l,Yz:()=>a,pl:()=>i,z7:()=>s});var n=r(108314);let o={OwaSessionCount:"OwaSessionCount",NpsDismissCount:"NpsDismissCount"};function i(){let e=a();return(0,n.SO)(self,o.OwaSessionCount,(e+1).toString()),e}function a(){return parseInt((0,n.Gq)(self,o.OwaSessionCount)??"0")}function s(){return parseInt((0,n.Gq)(self,o.NpsDismissCount)??"0")}function l(){let e=s();(0,n.SO)(self,o.NpsDismissCount,(e+1).toString())}},664866:(e,t,r)=>{"use strict";r.d(t,{v:()=>n});let n=()=>({defaultFolderNameToIdMap:new Map,defaultFolderIdToNameMap:new Map})},198787:(e,t,r)=>{"use strict";function n(e){return new Promise(t=>{setTimeout(t,e)})}r.d(t,{A:()=>n})},518836:(e,t,r)=>{"use strict";r.d(t,{Ir:()=>a,_:()=>o,m9:()=>i});var n=r(908632);function o(e,t){let r="number"==typeof t||void 0===t,n=r?t:t?.delay,o=r?"background":t?.priority,i=r?void 0:t?.signal;return"function"==typeof self.scheduler?.postTask?self.scheduler.postTask(e,{priority:o,delay:n,signal:i}):new Promise((t,r)=>{let a;let s=void 0===n&&"background"===o&&"function"==typeof self.requestIdleCallback;if(i){let e=function(){s?self.cancelIdleCallback(a):self.clearTimeout(a),r(i?.reason),i?.removeEventListener("abort",e)};if(i.aborted){r(i.reason);return}i.addEventListener("abort",e)}function l(){if(i?.aborted){r(i.reason);return}try{t(e())}catch(e){r(e)}}a=s?self.requestIdleCallback(l):self.setTimeout(l,n)})}async function i(e){"function"==typeof self.scheduler?.yield?await self.scheduler.yield():await o(()=>{},{priority:"user-blocking"}),(0,n.TW)("yieldNow",e)}async function a(e){self.requestIdleCallback?(await new Promise(e=>self.requestIdleCallback(e)),(0,n.TW)("yieldIdle",e)):await i(e)}},49676:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=(e=>(e[e.None=0]="None",e[e.Error=1]="Error",e[e.DebugError=2]="DebugError",e[e.Warning=3]="Warning",e[e.Info=4]="Info",e[e.Verbose=5]="Verbose",e))(n||{});let o=n},332408:(e,t,r)=>{"use strict";r.d(t,{Mh:()=>o,kp:()=>a.A,G2:()=>n.G2,Z1:()=>n.Z1,wr:()=>n.wr,jI:()=>i,N0:()=>n.N0,uP:()=>n.Ay});var n=r(218644);let o="[empty onerror]";function i(e,t,r,i,a,s){if(e||a){if(a||((a=Error(e)).stack=s||o),-1!=(e=e||a.message).indexOf('"responseText":"<!DOCTYPE')){let t=e.toLocaleLowerCase().indexOf("<!doctype html"),r=e.substring(t),n=-1!==r.toLocaleLowerCase().indexOf("</html>\r\n")?r.toLocaleLowerCase().indexOf("</html>\r\n")+9:r.toLocaleLowerCase().indexOf("</html>")+7;-1!==t&&-1!==n&&(e=e.substring(0,t)+"ReplacedGenericHTMLErrorMessage"+e.substring(t+n))}if(Object.isExtensible(a))try{t&&Object.defineProperty(a,"filename",{value:t}),"number"==typeof r&&Object.defineProperty(a,"lineno",{value:r}),"number"==typeof i&&Object.defineProperty(a,"colno",{value:i})}catch{}a?.reported||(0,n.Z1)(e,a)}}var a=r(49676)},218644:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>g,G2:()=>f,N0:()=>c,Z1:()=>h,wr:()=>p});var n=r(49676),o=r(174067);let i=[],a=[],s=[],l={GlobalAnalytics:{required:!0,registered:!1},DevTools:{required:!0,registered:!1},UIExceptionHandler:{required:!0,registered:!1},Tests:{required:!1,registered:!1},Oobe:{required:!1,registered:!1}};function c(e,t,r){if(l.Oobe?.registered&&"GlobalAnalytics"===e&&(l.Oobe.registered=!1,a=a.filter(e=>"Oobe"!==e.name)),s&&l[e]?.required&&!l[e].registered){for(let r of(d(`[Trace] Processing boot cache for ${e}. Cache size: ${s.length}`,"analytics"),s))t(...r);l[e].registered=!0}(r?a:i).push({name:e,listener:t}),("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?!l.DevTools.registered:Object.values(l).filter(e=>e.required).some(e=>!e.registered))||(s=void 0,d("[Trace] Cleared boot cache","analytics"))}function u(e,t,r,o){if(s&&s.push([e,t,r,o]),t===n.A.Error||t===n.A.DebugError)for(let{listener:n}of a)n(e,t,r,o);if(i.length>0)for(let{listener:n}of i)n(e,t,r,o)}function d(e,t){u(e,n.A.Info,t)}function f(e,t,r){m(n.A.DebugError,e,t,r)}function h(e,t,r){m(n.A.Error,e,t,r)}function p(e,t,r){if(h(e,t,r),"string"==typeof e)throw Error(e);throw e||Error("UnknownError")}function m(e,t,r,n){let i,a;"string"==typeof t?(a=t,i=(0,o.R)(r)||Error(t)):a=(i=(0,o.R)(t)||t||Error("UnknownError")).message,i.error?.message&&i.error.stack&&(a=i.error.message,i.stack=i.error.stack,i.name=i.error.name),i.component?a="COMPONENT ERROR: "+i.message:i.scriptEval&&(a="EVAL ERROR: "+i.message),u(a||"",e,n,i)}let g={info:d,warn:function(e,t){u(e,n.A.Warning,t)},verbose:function(e,t){u(e,n.A.Verbose,t)}}},174067:(e,t,r)=>{"use strict";function n(e){if(!e)return;let t=["GraphqlServerError"],r=["GraphqlNetworkError"],n=function(e){if(e.graphQLErrors){for(let t of e.graphQLErrors)if(t.extensions&&Object.keys(t.extensions).length>0)return t}return e.graphQLErrors?.[0]||e.originalError}(e);if(!n)return e;if(n.path&&(n.gqlPath=n.path.join(".")),n.extensions&&Object.keys(n.extensions).forEach(e=>{if(void 0!=n.extensions[e]&&(n[e]=n.extensions[e]),"code"==e){let o=n.extensions[e];o&&(n.responseCode=o,t.indexOf(o)>-1&&(n.fetchErrorType="ServerFailure"),r.indexOf(o)>-1&&(n.fetchErrorType="RequestNotComplete"))}else"InnerMessage"==e?n.innerMessage=n.extensions[e]:"queryStack"===e&&(n.queryStack=n.extensions[e])}),n.originalError){let e=n.originalError;Object.keys(e).forEach(t=>{e[t]&&(n[t]=e[t])})}return n}r.d(t,{R:()=>n})},694293:(e,t,r)=>{"use strict";r.d(t,{E$:()=>s,Gx:()=>u,S_:()=>h,cX:()=>i,cc:()=>p,gI:()=>d,nX:()=>f,rq:()=>c,uF:()=>a,xx:()=>l,zA:()=>m});var n=r(246803),o=r(523213);function i(){return"Mac OS X"==(0,o.Dj)()}function a(){return"Windows"===(0,o.Dj)()}function s(){let e=(0,o.rA)();return"Windows"===e.os&&"10"===e.osVersion}async function l(){let e=await (0,o.zR)();return"Windows"===e.os&&"11"===e.osVersion}function c(){return"Chromium OS"==(0,o.Dj)()}function u(){return"Android"==(0,o.Dj)()}function d(){return"iOS"==(0,o.Dj)()}function f(){return"Chrome"===(0,n.Ay)().browser}function h(){return"Firefox"===(0,n.Ay)().browser}function p(){return"Edge Anaheim"===(0,n.Ay)().browser}function m(){return"Safari"===(0,n.Ay)().browser}},246803:(e,t,r)=>{"use strict";let n;r.d(t,{Ay:()=>i});var o=r(980474);function i(){return n||(n=function(){let e,t,r="Unknown",n=(0,o.A)();return/OPR\//.test(n)?(r="Opera",t=a(n,"OPR")):/OPiOS/.test(n)?(r="Opera",t=a(n,"OPiOS")):/PhantomJS/.test(n)?r="PhantomJS":/SamsungBrowser/.test(n)?(r="Samsung Internet",t=a(n,"SamsungBrowser")):/Edge/.test(n)?r="Edge":/EdgiOS/.test(n)?(r="Edge Anaheim",t=a(n,"EdgiOS")):/EdgA/.test(n)?(r="Edge Anaheim",t=a(n,"EdgA")):/Edg/.test(n)||"undefined"!=typeof navigator&&navigator?.userAgentData?.brands?.some(e=>e?.brand=="Microsoft Edge")?(r="Edge Anaheim",t=a(n,"Edg")):/Electron/.test(n)?r="Electron":/CriOS/.test(n)?(r="Chrome",t=a(n,"CriOS")):/Chrome/.test(n)?r="Chrome":/Trident/.test(n)?(r="MSIE",t=(e=n.match(/MSIE ([\d,\.]+)/))?s(e[1]):(e=n.match(/rv:([\d,\.]+)/))?s(e[1]):[]):/FxiOS/.test(n)?(r="Firefox",t=a(n,"FxiOS")):/Firefox/.test(n)?r="Firefox":/Safari/.test(n)||/AppleWebKit/.test(n)?(r="Safari",t=a(n,"Version")):/SkypeShell/.test(n)&&(r="SkypeShell"),{browser:r,browserVersion:t||a(n,r)}}()),n}function a(e,t){let r=e.match(RegExp(t+"/([\\d,\\.]+)"));return r?s(r[1]):[]}function s(e){return e.split(/[\.,]/).map(e=>parseInt(e))}},102772:(e,t,r)=>{"use strict";r.d(t,{I:()=>a});let n={architecture:1,bitness:1,platformVersion:1,model:1},o=null,i=!0;async function a(){if(i&&(i=!1,self.navigator.userAgentData?.getHighEntropyValues))try{o=await self.navigator.userAgentData.getHighEntropyValues(Object.keys(n))}catch{}return o}},523213:(e,t,r)=>{"use strict";let n,o;r.d(t,{Dj:()=>c,rA:()=>l,zR:()=>u});var i=r(980474),a=r(102772);let s={"5.1":"XP","6.0":"Vista","6.1":"7","6.2":"8","6.3":"8.1","6.4":"10","10.0":"10"};function l(){return n||(n=function(){let e,t;let r=(0,i.A)();return/(cros)\s[\w]+\s([\w\.]+\w)/i.test(r)?e="Chromium OS":/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i.test(r)?(e="iOS",t=function(e){let t=/OS ([\_\d]+)/.exec(e);return t?t[1].split(/[\_,]/).map(e=>parseInt(e)).join("."):void 0}(r)):/android/i.test(r)?(e="Android",t=function(e){let t=/Android ([\.\_\d]+)/.exec(e);return t?t[1].split(/[\.\_,]/).map(e=>parseInt(e)).join("."):void 0}(r)):/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i.test(r)?e="Linux":/(macintosh|mac os x)/i.test(r)?e="Mac OS X":/(windows|win32)/i.test(r)?(e="Windows",t=function(e){let t=e.match(RegExp("Windows NT ([\\d,.]+)"));return t?s[t[1]]??"Unknown":"Unknown"}(r)):e="Unknown",{os:e,osVersion:t}}()),n}function c(){return l().os}async function u(){if(!o){let e=l();if("Windows"==e.os){let t=await (0,a.I)();"string"==typeof t?.platformVersion&&parseInt(t.platformVersion.split(".")[0])>=13&&(e.osVersion="11")}o=e}return o}},980474:(e,t,r)=>{"use strict";function n(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent:""}r.d(t,{A:()=>n})},818747:(e,t,r)=>{"use strict";let n;r.d(t,{H:()=>i});class o{get location(){return window.location}get innerHeight(){return window.innerHeight}get innerWidth(){return window.innerWidth}get document(){return window.document}get isPwa(){return window.matchMedia("(display-mode: standalone)").matches}get cookie(){try{return window.document.cookie}catch{return""}}get localStorage(){try{return window.localStorage}catch(e){return}}get origin(){return window.origin}get _locStrings(){return window._locStrings}}function i(){return n||"undefined"==typeof window||(n=new o),n}},623090:(e,t,r)=>{"use strict";r.d(t,{m:()=>i});var n=r(603722),o=(0,r(447101).createSingletonState)("@1js/create-shared-react-context",{});function i(e,t){var r=o.get();return r[t]||(r[t]=n.createContext(e))}},696400:(e,t,r)=>{"use strict";r.d(t,{s:()=>f});var n=r(856911),o=r(705632),i=r(891425),a=r(603722),s=(0,r(623090).m)({lookupString:function(e){return function(){return e}}},"LocalizationComponentsStringProvider"),l=s.Provider;function c(e){var t=e.lookupString,r=e.children,n=a.useContext(s),o=a.useMemo(function(){var e;return{lookupString:(e=n.lookupString,function(r){return function(n){var o=t(r)(n);if(o!==r)return o;var i=e(r)(n);return i!==r?i:r}})}},[t,n]);return a.createElement(l,{value:o},r)}var u=function(){},d=function(e){return function(){return e}};function f(e,t,r){return void 0===r&&(r=u),function(s){var l,u=(0,o.D)(),f=(0,i.toSupportedLocale)(r()||u.defaultLocale||"en-us","en-us"),h=(0,n.__read)(a.useState(null),2),p=h[0],m=h[1];a.useEffect(function(){u.resolveStrings(e,f).promise.then(function(e){var t=(0,i.lookupStringInStringProvider)({strings:e,errorHandler:function(){},currentLocale:f,loaders:[]}),r=function(e){return function(r){return t(e)(r)||e}};m(function(){return r})}).catch(function(e){m(function(){return d})})},[u,f]);var g=a.useMemo(function(){var r=function(){return u.resolve(e).promise.then(function(e){return t?t(e):e}).then(function(e){return{default:e}})};return r().then(void 0,function(e){}),a.lazy(r)},[u]),v=null!==(l=null==s?void 0:s.lazyComponentPlaceholder)&&void 0!==l?l:null;return p?a.createElement(a.Suspense,{fallback:v},a.createElement(c,{lookupString:p},a.createElement(g,(0,n.__assign)({},s)))):v}}},821333:(e,t,r)=>{"use strict";r.d(t,{n:()=>o});var n=r(856911);function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)throw Error("No module loaders to compose");return 1===e.length?e[0]:{loadModule:function(t,r){return function e(t,r,o){var i=(0,n.__read)(t),a=i[0],s=i.slice(1);if(0===s.length)return a.loadModule(r,o);var l=function(){return e(s,r,o)};try{return a.loadModule(r,o).catch(function(e){return l()})}catch(e){return l()}}(e,t,r)}}}},291762:(e,t,r)=>{"use strict";r.d(t,{S:()=>o});var n=r(856911);function o(e,t,r,o,i,a,s){var l=(0,n.__spreadArray)(["interfaceId=".concat(e),"implementationName=".concat(t),a?"densityWorkerModule=true":"densityModule=true"],(0,n.__read)("prod"===i?["sourcemap=inline","minify=true"]:[]),!1).join("&");return"http".concat(s?"s":"","://").concat(r,":").concat(o,"/bundle?").concat(l)}},720879:(e,t,r)=>{"use strict";function n(e,t,r,n,o){var i,a=(i={interfaceId:t,implementationName:r,mode:n},"dty-".concat(i.interfaceId,"-").concat(i.implementationName,"-").concat(i.mode,".js").toLowerCase());return"".concat(e,"/").concat(a).concat("undefined"===o?"?cache-buster=".concat(o):"")}r.d(t,{r:()=>n})},982241:(e,t,r)=>{"use strict";function n(e,t,r){var n,o,i,a=(o=(n={interfaceId:t,implementationName:r}).interfaceId,i=n.implementationName,"dty-".concat(o,"-").concat(i,"-strings.js").toLowerCase());return"".concat(e,"/").concat(a)}r.d(t,{D:()=>n})},659234:(e,t,r)=>{"use strict";r.d(t,{w:()=>i});var n=r(720879),o=r(819184);function i(e){var t=e.branchName.replace(/^\//,""),r="https://".concat(e.useMidgardBranches?"midgardbranches.blob.core.windows.net/lpc":"res-dev.cdn.officeppe.net/midgard","/refs/heads/").concat(t);return{loadModule:function(t,i){var a=(0,n.r)(r,t,i,e.mode,e.cacheBuster);return(0,o.K)(t,i,a,e.resolveExternal)}}}},722926:(e,t,r)=>{"use strict";r.d(t,{e:()=>o});var n=r(856911);function o(e){var t=[],r={};return{loadModule:function(o,i){var a,s=((a=e.getImporters())!==t&&(r=function(e){var t,r,o,i,a={};try{for(var s=(0,n.__values)(e),l=s.next();!l.done;l=s.next()){var c=(0,n.__read)(l.value,2),u=c[0],d=c[1];try{for(var f=(o=void 0,(0,n.__values)(Object.keys(d))),h=f.next();!h.done;h=f.next()){var p=h.value;a[u.id+"#"+p]=d[p]}}catch(e){o={error:e}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return a}(t=a)),r)[o+"#"+i];if(!s)throw Error("Don't know how to locate \"".concat(i,'" implementation of interface ').concat(o));return s()}}}},514067:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var n=r(291762),o=r(819184);function i(e){return{loadModule:function(t,r){var i=(0,n.S)(t,r,e.hostname,e.port,e.mode,!1,e.useHttps);return(0,o.K)(t,r,i,e.resolveExternal)}}}},109209:(e,t,r)=>{"use strict";function n(e){var t={};return{loadModule:function(r,n){var o=t["".concat(r,"#").concat(n)];return o||(t[r]=o=e.loadModule(r,n).catch(function(e){throw t[r]===o&&delete t[r],e})),o}}}r.d(t,{L:()=>n})},272667:(e,t,r)=>{"use strict";r.d(t,{X:()=>i});var n=r(720879),o=r(819184);function i(e){var t=e.baseUrl||"https://res-1.cdn.office.net/midgard/",r="".concat(t).concat(e.version);return{loadModule:function(t,i){var a=(0,n.r)(r,t,i,e.mode,e.cacheBuster);return(0,o.K)(t,i,a,e.resolveExternal)}}}},137615:(e,t,r)=>{"use strict";r.d(t,{F:()=>i});var n=r(982241),o={loadStrings:function(){return Promise.resolve({})}};function i(e,t){if(!e)return t||o;if("localhost"===e.override)return o;var r="version"===e.override?"https://res-1.cdn.office.net/midgard/".concat(e.version):"https://".concat(e.useMidgardBranches?"midgardbranches.blob.core.windows.net/lpc":"res-dev.cdn.officeppe.net/midgard","/refs/heads/").concat(e.branchName.replace(/^\//,""));return{loadStrings:function(e,t,o){return import((0,n.D)(r,e,t)).then(function(e){return e.loadStrings?e.loadStrings(o):{}})}}}},968479:(e,t,r)=>{"use strict";r.d(t,{R:()=>a});var n=r(856911),o=r(408792),i="midgardbranches:";function a(e){if("undefined"!=typeof window&&"undefined"!=typeof URLSearchParams)return function(e,t){var r=e?e.toLowerCase():e,o=function(e){try{for(var t=decodeURIComponent(e);t!==e;)e=t,t=decodeURIComponent(e)}catch(e){}return e},a=function(e){var r=null;return e=e.toLowerCase(),t.forEach(function(t,n){n.toLowerCase()===e&&(r=t)}),r?o(r):r},s=function(e){return r&&a(r+e)||a("density"+e)},l=(s("mode")||"").toLowerCase(),c="prod"===l?"prod":"dev",u=s("version");if(u)return{override:"version",version:u,mode:c};var d=s("branch");if(d)return 0===d.indexOf(i)?{override:"branch",branchName:d.substring(i.length),mode:c,useMidgardBranches:!0}:{override:"branch",branchName:d,mode:c,useMidgardBranches:!1};var f=s("local");if(f){var h=f.match(/^((http|https):\/\/)?(([^:]+):)?(true|\d+)?$/);if(h){var p,m=(0,n.__read)(h,6),g=m[2];return{override:"localhost",hostname:m[4]||"localhost",port:isNaN(p=parseInt(m[5],10))?8887:p,mode:c,useHttps:"true"===s("https")||"https"===g}}}if(l&&"dev"===c)return{override:"version",version:"1.latest",mode:c}}(e,new URLSearchParams((0,o.U)().location.search||""))}},973053:(e,t,r)=>{"use strict";r.d(t,{BN:()=>o,RN:()=>n,yy:()=>i});var n=8;function o(e){var t=e||{};return"object"==typeof t&&"object"==typeof t.default&&t.default.densityContractVersion===n}function i(e){var t=e||{};return"object"==typeof t&&"object"==typeof t.default&&t.default.densityContractVersion!==n}},819184:(e,t,r)=>{"use strict";r.d(t,{K:()=>a});var n=r(279357),o=r(973053),i=r(421015);function a(e,t,a,s){return Promise.resolve(s||Promise.all([r.e(31791),r.e(1776),r.e(58066),r.e(63977),r.e(97606),r.e(22873)]).then(r.bind(r,933643)).then(function(e){return e.resolveExternalDensityModule})).then(function(r){return new Promise(function(s,l){var c,u;(0,n.k)(a,{ref:(c=function(r){s((0,i.D)(r,e,t))},u=function(e){if(o.RN!==e){var t=Error("Incompatible Density module: module loader is using contract version ".concat(o.RN,", not ").concat(e));throw l(t),t}},function(e){e.densityModuleLoaderInfo={checkContractVersion:u,exportModule:c,require:r}})}).catch(l)})})}},421015:(e,t,r)=>{"use strict";r.d(t,{D:()=>o});var n=r(973053);function o(e,t,r){if((0,n.BN)(e)){if(e.default.key.id!==t)throw Error("Expected an implementation of ".concat(t,", not ").concat(e.default.key.id));if(e.default.name!==r)throw Error("Expected an implementation named ".concat(r,", not ").concat(e.default.name));return e}if((0,n.yy)(e))throw Error("Incompatible Density module: expected contract version ".concat(n.RN,", not ").concat(e.densityContractVersion));throw Error("Could not recognize Density module")}},828797:(e,t,r)=>{"use strict";r.d(t,{O:()=>o});var n=r(856911);function o(){var e={};return function(t,r,o,i){var a="".concat(t,"#").concat(r),s="".concat(o,"#").concat(i),l=function t(r,o){var i,a;if(r===o)return[r];try{for(var s=(0,n.__values)(e[r]||[]),l=s.next();!l.done;l=s.next()){var c=l.value,u=t(c,o);if(u)return(0,n.__spreadArray)([r],(0,n.__read)(u),!1)}}catch(e){i={error:e}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}}(s,a);if(l)throw Error("Circular dependency detected: ".concat(l.join(" -> ")," -> ").concat(s));var c=e[a];c?c.push(s):e[a]=[s]}}},245769:(e,t,r)=>{"use strict";r.d(t,{S:()=>m});var n=r(856911),o=r(514067),i=r(659234),a=r(272667),s=r(722926),l=r(968479),c=r(109209),u=r(821333),d=r(137615),f=r(844362),h=r(97708),p={};function m(e){var t,r,m,g,v,b,y=e.name,w=e.initContainer,S=e.defaultLocale,C=void 0===S?"en-us":S;if(y&&y in p)return p[y];var I=(null===(b=e.allowUrlOverrides)||void 0===b||b?(0,l.R)(y):void 0)||e.versionOverrideOptions,k=I||e.workerVersionOverrideOptions,E=(0,n.__spreadArray)([],(0,n.__read)(e.importers||[]),!1);function _(){return E}var A=(t=e.fallbackCDNVersions,r=e.resolveExternal,m=e.baseUrl,g=e.cacheBuster,v=[],I&&("localhost"===I.override?v.push((0,o.p)((0,n.__assign)((0,n.__assign)({},I),{resolveExternal:r}))):"branch"===I.override?v.push((0,i.w)((0,n.__assign)((0,n.__assign)({},I),{resolveExternal:r,cacheBuster:g}))):"version"===I.override&&v.push((0,a.X)((0,n.__assign)((0,n.__assign)({},I),{resolveExternal:r,baseUrl:m,cacheBuster:g})))),v.push((0,s.e)({getImporters:_})),null==t||t.forEach(function(e){v.push((0,a.X)({version:e,mode:"prod",resolveExternal:r,baseUrl:m,cacheBuster:g}))}),v),T=(0,c.L)(u.n.apply(void 0,(0,n.__spreadArray)([],(0,n.__read)(A),!1))),P=(0,d.F)(I,e.stringLoader),O=(0,f.d)({moduleLoader:T,stringLoader:P,defaultLocale:C}),R=O.register.bind(O),x=O.resolve.bind(O),M=O.resolveStrings.bind(O),N=O.selectDefaultImplementation.bind(O);w&&w({register:R,selectDefaultImplementation:N});var F={name:y,versionOverrideOptions:I,workerVersionOverrideOptions:k,moduleLoader:T,moduleLoaders:A,dependencyContainer:O,register:R,resolve:x,resolveStrings:M,stringLoader:P,defaultLocale:C,addImporters:function(e){return E=(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(E),!1),(0,n.__read)(e),!1),function(){E=E.filter(function(t){return -1===e.indexOf(t)})}},getImporters:_,cleanup:function(){return y&&delete p[y]}};return y&&((0,h.L)(F),p[y]=F),F}},844362:(e,t,r)=>{"use strict";r.d(t,{d:()=>c});var n=r(856911),o=r(878525),i=r(828797),a=r(501287),s=function(e){throw Error(e)};function l(e,t){return"".concat(e,"#").concat(t)}function c(e){var t=e.moduleLoader,r=e.stringLoader,c=e.defaultLocale,u={},d={},f={},h={},p={},m={};function g(e){m[e]&&s("Cannot register an implementation of ".concat(e," after resolving it"))}function v(e){return d[e]||"default"}function b(e,t){var r=u[e];if(r){for(var n=0;n<r.length;n++)if(r[n].implementationName===t)return r[n]}}var y=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if("function"==typeof e)return{resolved:!1,promise:Promise.all(t.map(function(e){return y(e).promise})).then(function(t){return e.apply(void 0,(0,n.__spreadArray)([],(0,n.__read)(t),!1))})};var o="string"==typeof e?e:e.id;if(1===t.length&&Array.isArray(t[0])){var i=t[0].map(function(e){return w(o,e)});return(0,a.l)(i)}return w(o,v(o))};function w(e,r){var a=l(e,r);if(a in h){var c=h[a];return{resolved:!0,value:c,promise:Promise.resolve(c)}}return a in p?{resolved:!1,promise:p[a]}:{resolved:!1,promise:new Promise(function(a,c){var u={},d=0,g=!1;function w(e){d-=1,g||(f[l(e.default.key.id,e.default.name)]=e.default,e.default.deps.forEach(function(e){var t=e.id;return C(t,v(t))}),I())}function S(e){d-=1,g=!0,c(e)}function C(e,r){if(e!==o.A.id){var n=l(e,r);if(!u[n]){u[n]=!0;var i=b(e,r);i?i.deps.forEach(function(e){var t=e.id;return C(t,v(t))}):f[n]?f[n].deps.forEach(function(e){var t=e.id;return C(t,v(t))}):(d+=1,t.loadModule(e,r).then(w,S))}}}function I(){g||0!==d||(g=!0,a(function e(t,r,i){if(t===o.A.id)return Promise.resolve(y);var a,c,u=l(t,r);if(u in p)return p[u];var d=b(t,r)||f[u];if(!d)return s("Missing module for "+u);try{for(var g=(0,n.__values)(d.deps),w=g.next();!w.done;w=g.next()){var S=w.value.id;i(t,r,S,v(S))}}catch(e){a={error:e}}finally{try{w&&!w.done&&(c=g.return)&&c.call(g)}finally{if(a)throw a.error}}var C=Promise.all(d.deps.map(function(t){var r=t.id;return e(r,v(r),i)})).then(function(e){return d.factory.apply(d,(0,n.__spreadArray)([],(0,n.__read)(e),!1))});return p[u]=C,C.then(function(e){h[u]=e}).catch(function(){}),m[t]=!0,C}(e,r,(0,i.O)())))}C(e,r),I()})}}return{registrations:u,modules:f,instances:h,instancePromises:p,register:function(e){for(var t,r,o,i,a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];var l="default";if("factory"in e?(l=e.name,r=e.factory,o=e.deps,i=e.key.id):(r=(t=(0,n.__read)(a))[0],o=t.slice(1),i="string"==typeof e?e:e.id),g(i),u[i]||(u[i]=[]),b(i,l))throw Error("Cannot register new implementation '".concat(l,"' of '").concat(i,"' as it already exists."));u[i].push({factory:r,deps:o,implementationName:l})},selectDefaultImplementation:function(e,t){var r="string"==typeof e?e:e.id;g(r),d[r]=t},getDefaultImplementations:function(){return d},resolve:y,resolveStrings:function(e,t){var n="string"==typeof e?e:e.id,o=v(n);return{resolved:!1,promise:r.loadStrings(n,o,t||c||"en-us")}},defaultLocale:c}}},97708:(e,t,r)=>{"use strict";function n(e){var t=e.name;if(t&&"object"==typeof window&&window){var r=window;r.Density||(r.Density={}),r.Density[t]=e}}r.d(t,{L:()=>n})},501287:(e,t,r)=>{"use strict";function n(e){if(e.some(function(e){return!e.resolved}))return{resolved:!1,promise:Promise.all(e.map(function(e){return e.promise}))};var t=e.map(function(e){return e.value});return{resolved:!0,value:t,promise:Promise.resolve(t)}}r.d(t,{l:()=>n})},705632:(e,t,r)=>{"use strict";r.d(t,{D:()=>a,o:()=>s});var n=r(623090),o=r(603722),i=(0,n.m)(null,"@1js/density-react#DensityEnvironment");function a(){var e=o.useContext(i);if(!e)throw Error("no Density environment on the context");return e}var s=i.Provider},938507:(e,t,r)=>{"use strict";r.d(t,{GG:()=>s,LT:()=>o,Li:()=>a});var n=r(400622);function o(e){return(0,n.Gi)(e)&&e===e.toLowerCase()}var i=/^([a-z]+[a-z0-9]*\-?)+$/;function a(e){return void 0===e||i.test(e)}function s(e,t){if(!o(e))throw Error("Invalid interface ID: "+e);if(!a(t))throw Error("Invalid interface name: "+t);return{id:e,name:t}}},878525:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(938507).GG)("6f3d2e44-2f2f-45af-abf8-715f416cc5ae","resolve")},975826:(e,t,r)=>{"use strict";r.r(t),r.d(t,{filterOutNull:()=>o});var n=r(934968);function o(e){return e.filter(n.O)}},993882:(e,t,r)=>{"use strict";function n(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(t(n))return n}}r.d(t,{I:()=>n})},647156:(e,t,r)=>{"use strict";r.d(t,{AM:()=>h,D_:()=>p,Q$:()=>c,TN:()=>i,Vv:()=>m,cG:()=>d,d$:()=>f,fd:()=>a,mQ:()=>u,t0:()=>s});var n=r(595661),o=[];function i(e){return e||o}function a(e){return l(e,function(e){return null!=e&&""!==e&&(!(e instanceof Array)||e.length>0)})}function s(e){return l(e,function(e){return null!==e})}function l(e,t){if(null==e)return e;for(var r={},o=0,i=(0,n.H)(e);o<i.length;o++){var a=i[o];t(e[a])&&(r[a]=e[a])}return r}function c(e,t){return Object.assign({},e,t)}function u(e,t){return e.hasOwnProperty(t)}function d(e){var t=void 0;return function(r){if(t&&r===t.arg)return t.result;var n=e(r);return t={arg:r,result:n},n}}function f(e){return void 0===e?null:e}function h(e,t){var r=[];if(e>0&&e<Number.MAX_VALUE)for(var n=0;n<e;n+=1)r.push(t(n));return r}function p(e){return e}function m(e,t,r){return void 0===r&&(r=1e-5),Math.abs(e-t)<r}},602663:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(){var e=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},653315:(e,t,r)=>{"use strict";r.r(t),r.d(t,{areEqualNumbers:()=>p.Vv,backfillUndefined:()=>o,cacheLatest:()=>p.cG,countStringOccurrences:()=>a,createArrayAndFillWith:()=>p.AM,deepMapKeysToCamelCase:()=>c,defaultToEmptyArray:()=>p.TN,endsWith:()=>L.d5,filterOutNull:()=>u.filterOutNull,find:()=>d.I,flattenJoin:()=>h,generateGuid:()=>g.A,getLocalISOTimeWithOffset:()=>s,getTimeUntil:()=>v,hasOwnProperty:()=>p.mQ,identity:()=>p.D_,isDefined:()=>b.O,isEmpty:()=>y.I,isEqualish:()=>C,isSafeInteger:()=>I.A,isString:()=>L.Kg,keys:()=>k.H,lowerFirst:()=>L.oZ,makeObject:()=>E._,matchAll:()=>_.H,memoizeFunction:()=>n.J,memoizeFunctionProperties:()=>A.q,memoizeSelector:()=>R,merge:()=>x,neverGuard:()=>m.Q,neverGuardDefault:()=>m.t,omitEmpty:()=>p.fd,omitNull:()=>p.t0,poll:()=>M,range:()=>N.y,safeJoinStrings:()=>L.Cz,sortObjectBy:()=>F.N,startsWith:()=>L.w1,throwError:()=>z.throwError,undefinedToNull:()=>p.d$,uniq:()=>B,uniqBy:()=>D,updateWith:()=>p.Q$,upperFirst:()=>L.Zb,withRetry:()=>U.b});var n=r(3206);function o(e,t){return void 0===e?t:e}var i=r(856911);function a(e){return e.reduce(function(e,t){var r;return(0,i.__assign)((0,i.__assign)({},e),((r={})[t]=(e[t]||0)+1,r))},{})}function s(e){var t=e.getTimezoneOffset(),r=new Date(e.valueOf()-6e4*t).toISOString().slice(0,-1),n=function(e){var t=parseInt(Math.abs(e).toString(),0).toString();return t.length>1?t:"0".concat(t)},o="".concat(t>0?"-":"+").concat(n(t/60),":").concat(n(t%60));return"".concat(r).concat(0===t?"Z":o)}var l=r(868630),c=function(e){return Array.isArray(e)?e.map(function(e){return c(e)}):null!=e&&e.constructor===Object?Object.keys(e).reduce(function(t,r){var n;return(0,i.__assign)((0,i.__assign)({},t),((n={})[(0,l.A)(r)]=c(e[r]),n))},{}):e},u=r(975826),d=r(993882),f=r(824806);function h(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,f.A)((0,u.filterOutNull)(e)).join(",")}var p=r(647156),m=r(693398),g=r(602663);function v(e){var t=(e||new Date).getTime()-new Date().getTime();return t<=0?{days:0,hours:0,minutes:0}:{days:Math.floor(t/864e5),hours:Math.floor(t%864e5/36e5),minutes:Math.floor(t%36e5/6e4)}}var b=r(934968),y=r(432020),w=r(966464);function S(e){switch(typeof e){case"number":case"string":case"boolean":case"bigint":case"symbol":case"undefined":return!0;default:return!1}}function C(e,t){var r=function(e){var t=function e(t,r,n){return(void 0===r&&(r=!1),void 0===n&&(n=""),null===t)?null:Object.entries(t).reduce(function(t,o){var i=o[0],a=o[1],s=n?"".concat(n,".").concat(i):i;return Array.isArray(a)?r?a.forEach(function(n,o){var i="".concat(s,".").concat(o);S(n)||null===n?t[i]=n:Object.assign(t,e(n,r,i))}):t[s]=a.map(function(t){return S(t)?t:e(t,r)}):S(a)||null==a?t[s]=a:Object.assign(t,e(a,r,s)),t},{})}(e,!0);return null===t?null:(0,p.fd)(t)},n=r(e),o=r(t);return(0,w.A)(n,o)}var I=r(849291),k=r(595661),E=r(149184),_=r(251861),A=r(279141),T=Object.keys,P=function(e,t){if(!e||!t||e===t)return e===t;var r=T(e);return r.length===T(t).length&&r.every(function(r){return t.hasOwnProperty(r)&&e[r]===t[r]})},O=function(e){var t=[];return function(r){var n=void 0;if(t.forEach(function(e){var t=(0,i.__read)(e,2),o=t[0],a=t[1];return P(o,r)&&(n=a)}),n)return n;var o=e(r);return t.unshift([r,o]),t=t.slice(0,25),o}},R=function(e,t){var r=O(t),n=void 0;return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var a=r(e.apply(void 0,(0,i.__spreadArray)([],(0,i.__read)(t),!1)));if(void 0!==n&&n!==a){if(Array.isArray(a)&&Array.isArray(n)){var s=n;if(a.length===s.length&&a.every(function(e,t){return e===s[t]}))return n}else if("object"==typeof a&&"object"==typeof n&&P(n,a))return n}return n=a,a}};function x(e,t,r){if(0===t.length)return e;if(0===e.length)return t;for(var n=0,o=0,i=[];n<e.length&&o<t.length;)1===r(e[n],t[o])?i.push(t[o++]):i.push(e[n++]);return n===e.length&&i.push.apply(i,t.slice(o)),o===t.length&&i.push.apply(i,e.slice(n)),i}function M(e){return new Promise(function(t,r){!function e(n,o){void 0===o&&(o=0);var a=n.condition,s=n.maxAttempts,l=n.baseIntervalInMs,c=n.additionalIntervalPerAttemptInMs;if(a())return t();if(!(++o<s))return r("".concat(s," attempts exhausted"));var u=(0,i.__assign)((0,i.__assign)({},n),{baseIntervalInMs:l+(c||0)});setTimeout(function(){return e(u,o)},l)}(e)})}var N=r(244608),F=r(674731),L=r(469103),z=r(218335);function D(e,t){var r=e.map(t);return e.filter(function(e,n){return r.indexOf(t(e))===n})}function B(e){return D(e,function(e){return e})}var U=r(1067)},934968:(e,t,r)=>{"use strict";function n(e){return null!=e}r.d(t,{O:()=>n})},432020:(e,t,r)=>{"use strict";r.d(t,{I:()=>o});var n=r(480829);function o(e){return(0,n.A)(e)}},595661:(e,t,r)=>{"use strict";function n(e){return"string"==typeof e?Object.keys(e.split("")):"number"==typeof e||"boolean"==typeof e?[]:Object.keys(e)}r.d(t,{H:()=>n})},149184:(e,t,r)=>{"use strict";function n(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n={};return t.forEach(function(t){return n[t]=e(t)}),n}r.d(t,{_:()=>n})},251861:(e,t,r)=>{"use strict";function n(e,t){var r=[];if(!t.global)throw Error("regular expression must have the global flag set");var n=null;do(n=t.exec(e))&&r.push(n);while(n&&n[0])return r}r.d(t,{H:()=>n})},693398:(e,t,r)=>{"use strict";function n(e){return e}function o(e,t){return t}r.d(t,{Q:()=>n,t:()=>o})},244608:(e,t,r)=>{"use strict";r.d(t,{y:()=>o});var n=r(856911);function o(e,t,r){return(0,n.__spreadArray)([],Array(e),!0).map(function(e,n){return(t||0)+n*(r||1)})}},674731:(e,t,r)=>{"use strict";r.d(t,{N:()=>o});var n=r(595661);function o(e,t){var r=(0,n.H)(e).sort(function(e,r){return t(e.toString()).localeCompare(t(r.toString()))}),o={};return r.forEach(function(t){o[t]=e[t]}),o}},469103:(e,t,r)=>{"use strict";function n(e){return"string"==typeof e}function o(e){return null==e||0===e.length}function i(e){return e.length?e[0].toUpperCase()+e.slice(1):e}function a(e){return e.length?e[0].toLowerCase()+e.slice(1):e}function s(e,t){return e.slice(0,t.length)===t}function l(e,t){return e.slice(0-t.length)===t}function c(e,t){return e.join(t)}r.d(t,{Cz:()=>c,Kg:()=>n,Zb:()=>i,d5:()=>l,oZ:()=>a,uJ:()=>o,w1:()=>s})},218335:(e,t,r)=>{"use strict";function n(e){throw Error(e)}r.r(t),r.d(t,{throwError:()=>n})},400622:(e,t,r)=>{"use strict";function n(e){return!(!e||"00000000-0000-0000-0000-000000000000"===e)&&/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e||"")}function o(){for(var e,t="object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}(),r=0,n="",o=0;o<36;o++)switch(o){case 8:case 13:case 18:case 23:r+=1,n+="-";break;case 14:r+=1,n+="4";break;case 19:n+=(t[o-r]%4+8).toString(16);break;default:n+=(t[o-r]%16).toString(16)}return n}r.d(t,{DA:()=>o,Gi:()=>n})},578410:(e,t,r)=>{"use strict";r.r(t),r.d(t,{isSupportedLocale:()=>n.d9,supportedLocales:()=>n.O4,toSupportedLocale:()=>n.U5});var n=r(115489)},115489:(e,t,r)=>{"use strict";r.d(t,{O4:()=>n,U5:()=>i,d9:()=>o});var n=["af","am","ar","as-in","az-latn-az","be-by","bg","bn-in","bn-bd","bs-latn-ba","ca","ca-es-valencia","cs","cy","da","de","el","en-gb","en-us","es","es-mx","et","eu","fa","fi","fil","fr","fr-ca","ga-ie","gd-gb","gl","gu","ha-latn-ng","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-kh","kn","ko","kok","ky","lb-lu","lo-la","lt","lv","mi-nz","mk","ml","mn-mn","mr","ms","mt-mt","ne-np","nl","nn-no","no","or","pa-in","pl","prs","pt","pt-pt","quz-pe","ro","ru","sd-arab-pk","si-lk","sk","sl","sq","sr","sr-cyrl","sr-cyrl-ba","sv","sw","ta","te","th","tk-tm","tr","tt","ug-cn","uk","ur","uz","vi","zh-hans","zh-hant","zu-za"];function o(e){return n.indexOf(e)>=0}function i(e,t){if(e){var r=e.toLowerCase().replace("_","-"),i=a(r);if(i)return i;if(o(r))return r;var s=r.split("-");if(s.length>2){var l=s.slice(0,s.length-1).join("-");if(o(l))return l;var c=a(l);if(c)return c}if(s.length>1){var u=s[0];if(o(u))return u}var d=r.substr(0,2);if(o(d))return d;var f=a(d);if(f)return f;for(var h=0;h<n.length;h++){var p=n[h];if(0===p.indexOf(d))return p}}if(t)return t;throw Error("".concat(e," cannot be mapped to a supported locale"))}function a(e){if(0===e.indexOf("es-")&&"es-es"!==e)return"es-mx";if(0===e.indexOf("en-")&&"en-us"!==e)return"en-gb";if(0===e.indexOf("ja-"))return"ja";switch(e){case"zh-hk":case"zh-mo":case"zh-rhk":case"zh-rtw":case"zh-sg":case"zh-tw":return"zh-hant";case"zh-rcn":return"zh-hans";case"be":return"nl";case"ga":return"ga-ie";case"in":return"id";case"iw":return"he";case"nb":return"no";default:return}}},317408:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.declarePluralString=function(e,t){var r=t&&{text:(0,n.createICUString)(t.strings),comment:t.comment},a=function(t){return void 0===t&&(t=(0,i.getDefaultStringProvider)()),(0,o.resolveString)(e,r,t)};return a.toString=a,a.key=e,a},t.declarePluralStringWithPlaceholders=function(e,t){var r=t&&c(t),n=function(t,n){return void 0===n&&(n=(0,i.getDefaultStringProvider)()),(0,o.resolveStringWithPlaceholders)(e,r,n,{alreadyPseudoLocalized:!0})(t)};return n.toString=function(t){return(void 0===t&&(t=(0,i.getDefaultStringProvider)()),(0,a.isDevLocalization)()&&r)?(0,s.getStringDescriptionWithPlaceholders)(e,r).stringToBeLocalized:!(0,l.stringExists)(e,t)&&r?(0,s.getStringDescriptionWithPlaceholders)(e,r).stringToBeLocalized:(0,l.lookUpString)(e,t)},n.key=e,n},t.mapStringsToStandardFormat=function(e){var t=e.comment,r=e.strings;return{text:(0,n.createICUString)(r),comment:t}},t.mapStringsWithPlaceholdersToStandardFormat=c;var n=r(783116),o=r(397670),i=r(526996),a=r(688215),s=r(83984),l=r(153192);function c(e){var t=e.comment,r=e.placeholders,i=e.strings;return{comment:t,placeholders:r,text:function(e){return(0,n.createICUString)((0,a.doPseudoLocalization)()?(0,o.pseudoLocalizePluralWithPlaceholders)(i,e):i(e))}}}},397670:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveString=d,t.resolveStringWithPlaceholders=h,t.lookupStringInStringProvider=function(e){return function(t){return function(r){return r?h(t,void 0,e)(r):d(t,void 0,e)}}},t.declareString=function(e,t){var r=function(r){return void 0===r&&(r=(0,o.getDefaultStringProvider)()),d(e,t,r)};return r.toString=r,r.key=e,r},t.declareStringWithPlaceholders=function(e,t){var r=function(r,n){return void 0===n&&(n=(0,o.getDefaultStringProvider)()),h(e,t,n)(r)};return r.toString=function(r){return(void 0===r&&(r=(0,o.getDefaultStringProvider)()),(0,i.isDevLocalization)()&&t)?(0,a.getStringDescriptionWithPlaceholders)(e,t).stringToBeLocalized:!(0,l.stringExists)(e,r)&&t?(0,a.getStringDescriptionWithPlaceholders)(e,t).stringToBeLocalized:(0,l.lookUpString)(e,r)},r.key=e,r},t.pseudoLocalizePluralWithPlaceholders=function(e,t){var r={},o={};(0,n.keys)(t).forEach(function(e,n){var i="".concat(p,"_").concat(n);r[e]=i,o[i]=t[e]});var i=e(r);return(0,n.keys)(i).forEach(function(e){var t=(0,s.pseudoLocalize)(v(i[e]));i[e]=(0,n.keys)(o).reduce(function(e,t){return e.replace(RegExp(y(t),"g"),o[t])},b(t))}),i};var n=r(653315),o=r(526996),i=r(688215),a=r(83984),s=r(287496),l=r(153192),c=/\\{\\d+\\}/g,u=(0,n.memoizeFunction)(function(e){return RegExp("\\{".concat(e,"\\}"),"g")});function d(e,t,r){try{if((0,i.isDevLocalization)()&&t)return(0,i.doPseudoLocalization)()?function(e){var t={},r={};(e.match(/({.+?})/g)||[]).forEach(function(e,n){var o="".concat(p,"_").concat(n);t[e]=o,r[o]=e});var n=Object.keys(t).reduce(function(e,r){return e.replace(r,t[r])},v(e)),o=(0,s.pseudoLocalize)(n);return Object.keys(r).reduce(function(e,t){return e.replace(t,r[t])},b(o))}(t.text):t.text;if(!(0,l.stringExists)(e,r)&&t)return t.text;return(0,l.lookUpString)(e,r)}catch(e){return(0,l.handleLocalizationError)(e,r),""}}var f=function(e,t){return function(r){try{return e(r)}catch(e){return(0,l.handleLocalizationError)(e,t),""}}};function h(e,t,r,o){try{if((0,i.isDevLocalization)()&&t&&t.text&&!(null==o?void 0:o.alreadyPseudoLocalized))return f(function(e){return(0,i.doPseudoLocalization)()?function(e,t){var r={},o={};(0,n.keys)(t).forEach(function(e,n){var i="".concat(p,"_").concat(n);r[e]=i,o[i]=t[e]});var i=(0,s.pseudoLocalize)(v(e.text(r)));return(0,n.keys)(o).reduce(function(e,t){return e.replace(RegExp(y(t),"g"),o[t])},b(i))}(t,e):t.text(e)},r);if(!(0,l.stringExists)(e,r)&&t&&t.text)return f(t.text,r);return f(function(t){return(0,n.keys)(t).sort().reduce(function(e,r,n){var o=t[r],i=("string"==typeof o&&o||o&&o.toString&&o.toString()||"").replace(c,"");return(e||"").replace(u(n),i)},(0,l.lookUpString)(e,r))},r)}catch(e){return(0,l.handleLocalizationError)(e,r),function(){return""}}}var p="0.7059175321136157",m="->INF::",g="".concat(p,"_-1");function v(e){return e.replace(RegExp(m,"g"),g)}function b(e){return e.replace(RegExp(g,"g"),m)}function y(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}},526996:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultStringProvider=function(){return a},t.setLocalizationErrorHandlerForDefaultStringProvider=function(e){a=(0,i.setLocalizationErrorHandler)(e,a)},t.addStringMapForDefaultStringProvider=function(e,t){a=(0,i.addStringMap)(e,t,a)},t.addStringMapLoaderForDefaultStringProvider=function(e){a=(0,i.addStringMapLoader)(e,a)},t.getCurrentLocaleForDefaultStringProvider=function(){return(0,i.getCurrentLocale)(a)},t.setCurrentLocaleForDefaultStringProvider=function(e){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,(0,i.setCurrentLocale)(e,a)];case 1:return[2,(a=t.sent()).currentLocale]}})})},t.clearStringMapLoadersForDefaultStringProvider=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,(0,i.clearStringMapLoaders)(a)];case 1:return a=e.sent(),[2]}})})},t.lookupStringInDefaultStringProvider=function(e){return(0,i.lookUpString)(e,a)};var n=r(856911),o=r(688215),i=r(153192),a={currentLocale:void 0,strings:{},errorHandler:function(e){},loaders:[],stringMapInitialized:!1,suppressEmptyStringMapErrors:(0,o.isTest)()}},688215:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDev=o,t.skipLocalization=i,t.isDevLocalization=function(){return o()||i()},t.isTest=function(){return"undefined"!=typeof process&&process.env,!1},t.togglePseudoLocalization=function(){r=!r},t.disablePseudoLocalization=function(){r=!0},t.enablePseudoLocalization=function(){r=!1},t.enableDevModeForLocalization=function(){n=!1},t.disableDevModeForLocalization=function(){n=!0},t.doPseudoLocalization=function(){return"undefined"!=typeof __DEV__&&!!__DEV__&&!n&&!("undefined"!=typeof __DISABLE_PSEUDO_LOC__&&__DISABLE_PSEUDO_LOC__||r)};var r=!1,n=!1;function o(){return"undefined"!=typeof __DEV__&&__DEV__&&!n}function i(){return"undefined"!=typeof __SKIP_LOC__&&__SKIP_LOC__}},83984:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStringDescriptionWithOnlyKey=function(e){return{key:e,stringToBeLocalized:"",comment:"",placeholderNames:[]}},t.getStringDescriptionWithoutPlaceholders=function(e,t){return{key:e,stringToBeLocalized:t.text,comment:t.comment,placeholderNames:[]}},t.getStringDescriptionWithPlaceholders=function(e,t){for(var r=(0,o.keys)(t.placeholders).filter(o.isString).sort(),l={},c=0,u=(0,o.keys)(t.placeholders);c<u.length;c++){var d=u[c];l[d]=(0,o.isString)(d)?"{".concat(r.indexOf(d),"}"):(0,a.throwError)("Placeholder name ".concat(d," is not a string"))}var f=t.text(l),h=n.__spreadArray([t.comment],r.map(function(e,r){var n=t.placeholders[e].trim();return n?"{".concat(r,"} is a placeholder for ").concat((0,o.lowerFirst)(n)):null}),!0),p=(0,i.filterOutNull)(h).map(s).filter(Boolean).join(" ");return r.forEach(function(e,t){p=p.replace("{"+e+"}","{"+t+"}")}),{key:e,stringToBeLocalized:f,comment:p,placeholderNames:r}};var n=r(856911),o=r(653315),i=r(975826),a=r(218335);function s(e){return(e=(0,o.upperFirst)(e.trim()))&&!(0,o.endsWith)(e,".")&&(e+="."),e}},891425:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSupportedLocale=t.supportedLocales=t.isSupportedLocale=t.stringExists=t.setLocalizationErrorHandler=t.setCurrentLocale=t.lookUpString=t.getCurrentLocale=t.flattenStringMap=t.clearStringMapLoaders=t.addStringMapLoader=t.addStringMap=t.makeGetStringMapLoader=t.getStringDescriptionWithoutPlaceholders=t.getStringDescriptionWithPlaceholders=t.getStringDescriptionWithOnlyKey=t.togglePseudoLocalization=t.isDevLocalization=t.isDev=t.enablePseudoLocalization=t.enableDevModeForLocalization=t.disablePseudoLocalization=t.disableDevModeForLocalization=t.setLocalizationErrorHandlerForDefaultStringProvider=t.setCurrentLocaleForDefaultStringProvider=t.lookupStringInDefaultStringProvider=t.getDefaultStringProvider=t.getCurrentLocaleForDefaultStringProvider=t.clearStringMapLoadersForDefaultStringProvider=t.addStringMapLoaderForDefaultStringProvider=t.addStringMapForDefaultStringProvider=t.lookupStringInStringProvider=t.declareStringWithPlaceholders=t.declareString=t.mapStringsWithPlaceholdersToStandardFormat=t.mapStringsToStandardFormat=t.declarePluralStringWithPlaceholders=t.declarePluralString=void 0;var n=r(317408);Object.defineProperty(t,"declarePluralString",{enumerable:!0,get:function(){return n.declarePluralString}}),Object.defineProperty(t,"declarePluralStringWithPlaceholders",{enumerable:!0,get:function(){return n.declarePluralStringWithPlaceholders}}),Object.defineProperty(t,"mapStringsToStandardFormat",{enumerable:!0,get:function(){return n.mapStringsToStandardFormat}}),Object.defineProperty(t,"mapStringsWithPlaceholdersToStandardFormat",{enumerable:!0,get:function(){return n.mapStringsWithPlaceholdersToStandardFormat}});var o=r(397670);Object.defineProperty(t,"declareString",{enumerable:!0,get:function(){return o.declareString}}),Object.defineProperty(t,"declareStringWithPlaceholders",{enumerable:!0,get:function(){return o.declareStringWithPlaceholders}}),Object.defineProperty(t,"lookupStringInStringProvider",{enumerable:!0,get:function(){return o.lookupStringInStringProvider}});var i=r(526996);Object.defineProperty(t,"addStringMapForDefaultStringProvider",{enumerable:!0,get:function(){return i.addStringMapForDefaultStringProvider}}),Object.defineProperty(t,"addStringMapLoaderForDefaultStringProvider",{enumerable:!0,get:function(){return i.addStringMapLoaderForDefaultStringProvider}}),Object.defineProperty(t,"clearStringMapLoadersForDefaultStringProvider",{enumerable:!0,get:function(){return i.clearStringMapLoadersForDefaultStringProvider}}),Object.defineProperty(t,"getCurrentLocaleForDefaultStringProvider",{enumerable:!0,get:function(){return i.getCurrentLocaleForDefaultStringProvider}}),Object.defineProperty(t,"getDefaultStringProvider",{enumerable:!0,get:function(){return i.getDefaultStringProvider}}),Object.defineProperty(t,"lookupStringInDefaultStringProvider",{enumerable:!0,get:function(){return i.lookupStringInDefaultStringProvider}}),Object.defineProperty(t,"setCurrentLocaleForDefaultStringProvider",{enumerable:!0,get:function(){return i.setCurrentLocaleForDefaultStringProvider}}),Object.defineProperty(t,"setLocalizationErrorHandlerForDefaultStringProvider",{enumerable:!0,get:function(){return i.setLocalizationErrorHandlerForDefaultStringProvider}});var a=r(688215);Object.defineProperty(t,"disableDevModeForLocalization",{enumerable:!0,get:function(){return a.disableDevModeForLocalization}}),Object.defineProperty(t,"disablePseudoLocalization",{enumerable:!0,get:function(){return a.disablePseudoLocalization}}),Object.defineProperty(t,"enableDevModeForLocalization",{enumerable:!0,get:function(){return a.enableDevModeForLocalization}}),Object.defineProperty(t,"enablePseudoLocalization",{enumerable:!0,get:function(){return a.enablePseudoLocalization}}),Object.defineProperty(t,"isDev",{enumerable:!0,get:function(){return a.isDev}}),Object.defineProperty(t,"isDevLocalization",{enumerable:!0,get:function(){return a.isDevLocalization}}),Object.defineProperty(t,"togglePseudoLocalization",{enumerable:!0,get:function(){return a.togglePseudoLocalization}});var s=r(83984);Object.defineProperty(t,"getStringDescriptionWithOnlyKey",{enumerable:!0,get:function(){return s.getStringDescriptionWithOnlyKey}}),Object.defineProperty(t,"getStringDescriptionWithPlaceholders",{enumerable:!0,get:function(){return s.getStringDescriptionWithPlaceholders}}),Object.defineProperty(t,"getStringDescriptionWithoutPlaceholders",{enumerable:!0,get:function(){return s.getStringDescriptionWithoutPlaceholders}});var l=r(469537);Object.defineProperty(t,"makeGetStringMapLoader",{enumerable:!0,get:function(){return l.makeGetStringMapLoader}});var c=r(153192);Object.defineProperty(t,"addStringMap",{enumerable:!0,get:function(){return c.addStringMap}}),Object.defineProperty(t,"addStringMapLoader",{enumerable:!0,get:function(){return c.addStringMapLoader}}),Object.defineProperty(t,"clearStringMapLoaders",{enumerable:!0,get:function(){return c.clearStringMapLoaders}}),Object.defineProperty(t,"flattenStringMap",{enumerable:!0,get:function(){return c.flattenStringMap}}),Object.defineProperty(t,"getCurrentLocale",{enumerable:!0,get:function(){return c.getCurrentLocale}}),Object.defineProperty(t,"lookUpString",{enumerable:!0,get:function(){return c.lookUpString}}),Object.defineProperty(t,"setCurrentLocale",{enumerable:!0,get:function(){return c.setCurrentLocale}}),Object.defineProperty(t,"setLocalizationErrorHandler",{enumerable:!0,get:function(){return c.setLocalizationErrorHandler}}),Object.defineProperty(t,"stringExists",{enumerable:!0,get:function(){return c.stringExists}});var u=r(404224);Object.defineProperty(t,"isSupportedLocale",{enumerable:!0,get:function(){return u.isSupportedLocale}}),Object.defineProperty(t,"supportedLocales",{enumerable:!0,get:function(){return u.supportedLocales}}),Object.defineProperty(t,"toSupportedLocale",{enumerable:!0,get:function(){return u.toSupportedLocale}})},469537:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetStringMapLoader=void 0;var n=r(404224);t.makeGetStringMapLoader=function(e){return function(t){var r=function(t){return e((0,n.toSupportedLocale)(t,"en-us"))};return t?e((0,n.toSupportedLocale)(t,"en-us")).catch(function(){}).then(function(){return r}):Promise.resolve(r)}}},287496:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pseudoLocalize=void 0;var r={a:"",A:"",b:"",B:"",c:"",C:"",d:"",D:"",e:"",E:"",f:"",F:"",g:"",G:"",h:"",H:"",i:"",I:"",j:"",J:"",k:"",K:"",l:"",L:"",m:"",M:"",n:"",N:"",o:"",O:"",p:"",P:"",q:"",Q:"",r:"",R:"",s:"",S:"",t:"",T:"",v:"",V:"",u:"",U:"",w:"",W:"",x:"",X:"",y:"",Y:"",z:"",Z:""};t.pseudoLocalize=function(e){return e.split("").reduce(function(e,t){var n=r[t]||t;return e+(n+("aeiou".indexOf(t.toLowerCase())>=0?n:""))},"")}},153192:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setLocalizationErrorHandler=function(e,t){return o.__assign(o.__assign({},t),{errorHandler:e})},t.handleLocalizationError=function(e,t){t.errorHandler(e)},t.addStringMap=function(e,t,r){if(r.currentLocale===e||void 0===r.currentLocale){var n=c(t);return o.__assign(o.__assign({},r),{currentLocale:void 0===r.currentLocale?e:r.currentLocale,strings:o.__assign(o.__assign({},r.strings),n),stringMapInitialized:!0})}return l(s(e,t),r)},t.addStringMapLoader=l,t.getCurrentLocale=function(e){return n?n.then(function(e){return e.currentLocale}):Promise.resolve(e.currentLocale)},t.setCurrentLocale=function(e,t){var r=(function(e,t){return o.__awaiter(this,void 0,void 0,function(){var r,n=this;return o.__generator(this,function(i){switch(i.label){case 0:return r=function(r){return o.__awaiter(n,void 0,void 0,function(){var n;return o.__generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,r(e)];case 1:return[2,o.sent()];case 2:return n=o.sent().message||"unknown error",t.errorHandler("Async string map loader failed: ".concat(n)),[2,{}];case 3:return[2]}})})},[4,Promise.all(t.loaders.map(r))];case 1:return[2,i.sent().map(c).reduce(function(e,t){return o.__assign(o.__assign({},e),t)},{})]}})})})(e,t).then(function(r){return o.__assign(o.__assign({},t),{strings:r,currentLocale:e,stringMapInitialized:!0})});return n=n?n.then(function(){return r}):r},t.clearStringMapLoaders=function(e){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:if(!n)return[3,2];return[4,n];case 1:t.sent(),t.label=2;case 2:return n=void 0,[2,o.__assign(o.__assign({},e),{loaders:[],strings:{},currentLocale:void 0})]}})})},t.flattenStringMap=c,t.stringExists=function(e,t){return"string"==typeof t.strings[e]},t.lookUpString=function(e,t){var r=t.strings[e];if(!r||"string"!=typeof r){var n=(0,a.isDev)()||(0,a.isTest)()?e:"";return function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(t.strings)?t.suppressEmptyStringMapErrors||t.errorHandler("The current string map is empty. The string is probably resolved too early, at import time. Key: ".concat(e)):t.errorHandler("Key ".concat(e," does not exist in string map"),{stringsLoaded:!!t.stringMapInitialized}),n}return r};var n,o=r(856911),i=r(653315),a=r(688215),s=(0,i.memoizeFunction)(function(e,t){var r=c(t);return function(t){return Promise.resolve(e===t?r:{})}});function l(e,t){return -1===t.loaders.indexOf(e)?o.__assign(o.__assign({},t),{loaders:t.loaders.concat(e)}):t}function c(e){var t={};return e&&function e(r,n){for(var o=0,a=(0,i.keys)(n);o<a.length;o++){var s=a[o];if("string"==typeof s){var l=n[s];"string"==typeof l?t[r+s]=l:"object"==typeof l&&e(r+s+".",l)}}}("",e),t}},404224:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSupportedLocale=t.supportedLocales=t.isSupportedLocale=void 0;var n=r(578410);Object.defineProperty(t,"isSupportedLocale",{enumerable:!0,get:function(){return n.isSupportedLocale}}),Object.defineProperty(t,"supportedLocales",{enumerable:!0,get:function(){return n.supportedLocales}}),Object.defineProperty(t,"toSupportedLocale",{enumerable:!0,get:function(){return n.toSupportedLocale}})},641398:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(938507).GG)("274d7ae9-e5e0-48eb-80db-f8daf26a8d1b","m365-chat-components")},858881:(e,t,r)=>{"use strict";r.d(t,{WB:()=>k,dn:()=>I,u:()=>E,mI:()=>y,oE:()=>C,ug:()=>S});var n=r(245769),o=r(705632),i=r(921217),a=r(340895),s=r(524367),l=r(603722),c=r(696400),u=r(641398);function d(){return(0,s.E)().locale}function f(e){return(0,c.s)(u.A,e,d)}var h=r(474011),p=r(655260);let m="m365-chat.set-performance-mark-imported";function g(e){return!!performance.getEntriesByName&&"function"==typeof performance.getEntriesByName&&performance.getEntriesByName(e)?.length>0}function v(e){return!g(e)&&!!performance.mark&&"function"==typeof performance.mark&&(performance.mark(e),!0)}function b(e){let t=()=>{var e;g(e="m365-chat.preload-components-done")||(v(e),performance.measure(e,m,e))};e.resolve(u.A).promise.then(t,e=>{t()})}v(m),v("m365-blaze.loader-imported");let y="1.20250306.5.0",w=String(r(87837).rE);function S(e){let{baseUrl:t,preload:r,branch:o,version:s=y,allowUrlOverrides:l,cacheBuster:c}=e,u=(0,n.S)({name:"M365Chat",baseUrl:t,allowUrlOverrides:l,cacheBuster:c,versionOverrideOptions:o?{override:"branch",mode:"prod",branchName:o,useMidgardBranches:!1}:{override:"version",mode:"prod",version:s}});return"boolean"==typeof r?r&&b(u):r&&r.then(()=>b(u),e=>{}),e=>{let{tokenProviders:{augloop:t,substrate:r,sydney:n,tenantFeedback:o,loki:l,feed:c,yammer:d,spo:f,mos:m,oboToken:g,aeaToken:b,amsToken:S,graph:C,powerAutomate:I,powerPlatform:k,apiHub:E,apiSkype:_,teams:A,outlook:T,designer:P,apiUrlp:O,ocps:R,powerbi:x,pushChannel:M,mss:N,copilotStudio:F,bap:L,gcs:z,mruPlusPlus:D,trouter:B,onenote:U,safeLinks:H},getProfilePictureUrl:q,getChatLogger:j,getLoggerProperties:$,locale:W,isRTL:V,firstRunExperience:G,entitySettings:K,hostAppData:X,isFeatureEnabled:Y=()=>!1,createExtensibilityServiceProvider:Z,extensibilityServiceProviderType:Q,citationSurfaceRenderer:J,ecsConfigIds:ee}=e;return j&&$&&((0,p.n)(u,$),(0,i.t)(j())),(0,h.O)(u),v("m365-chat.runtime-created"),{cdnVersion:y,version:s,citationSurfaceRenderer:J,tokenProviders:(0,a.F)({augloop:t,substrate:r,sydney:n,tenantFeedback:o,loki:l,feed:c,yammer:d,spo:f,mos:m,oboToken:g,aeaToken:b,amsToken:S,graph:C,powerAutomate:I,powerPlatform:k,apiHub:E,apiSkype:_,teams:A,outlook:T,designer:P,apiUrlp:O,ocps:R,powerbi:x,pushChannel:M,mss:N,copilotStudio:F,bap:L,gcs:z,mruPlusPlus:D,trouter:B,onenote:U,safeLinks:H}),getProfilePictureUrl:q,getChatLogger:j,densityEnvironment:u,firstRunExperience:G,locale:W,isRTL:V,entitySettings:K,hostAppData:X,isFeatureEnabled:Y,createExtensibilityServiceProvider:Z,extensibilityServiceProviderType:Q,chatLoaderVersion:w,ecsConfigIds:ee}}}function C(e){let{preload:t,allowUrlOverrides:r,branch:n,version:o,...i}=e;return S({preload:t,allowUrlOverrides:r,branch:n,version:o})(i)}let I=({value:e,children:t})=>(l.useEffect(()=>{v("m365-chat.runtime-provider-mounted")},[]),l.createElement(o.o,{value:e.densityEnvironment},l.createElement(s.p,{value:e},t))),k=f(e=>e.loadChat()),E=f(e=>e.loadMsalTokenPopupView())},474011:(e,t,r)=>{"use strict";r.d(t,{E:()=>s,O:()=>a});var n=r(344176),o=r(641398);let i=(0,n.E)();async function a(e){try{let t=await e.resolve(o.A).promise,r=await t.loadGetChatActionCallbacksMetaOS();i.resolve(r)}catch(e){return}}function s(){return i.promise}},655260:(e,t,r)=>{"use strict";r.d(t,{J:()=>s,n:()=>a});var n=r(344176),o=r(641398);let i={loggerPromise:(0,n.E)(),status:!1};async function a(e,t){try{if(i.status)return;i.status=!0;let r=await Promise.resolve(t()),n=await e.resolve(o.A).promise,a=await n.createLogger(r);i.loggerPromise.resolve(a)}catch(e){return}}function s(){return i.loggerPromise.promise}},212124:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(938507).GG)("a2b71887-d912-402a-87aa-bf8fec0d5b6a","m365-chat-components")},467439:(e,t,r)=>{"use strict";r.d(t,{WB:()=>k,dn:()=>I,u:()=>E,mI:()=>y,oE:()=>C,ug:()=>S});var n=r(245769),o=r(705632),i=r(921217),a=r(340895),s=r(524367),l=r(603722),c=r(696400),u=r(212124);function d(){return(0,s.E)().locale}function f(e){return(0,c.s)(u.A,e,d)}var h=r(528729),p=r(343850);let m="m365-chat.set-performance-mark-imported";function g(e){return!!performance.getEntriesByName&&"function"==typeof performance.getEntriesByName&&performance.getEntriesByName(e)?.length>0}function v(e){return!g(e)&&!!performance.mark&&"function"==typeof performance.mark&&(performance.mark(e),!0)}function b(e){let t=()=>{var e;g(e="m365-chat.preload-components-done")||(v(e),performance.measure(e,m,e))};e.resolve(u.A).promise.then(t,e=>{t()})}v(m),v("m365-chat.loader-imported");let y="1.20250306.5.0",w=String(r(714915).rE);function S(e){let{baseUrl:t,preload:r,branch:o,version:s=y,allowUrlOverrides:l,cacheBuster:c}=e,u=(0,n.S)({name:"M365Chat",baseUrl:t,allowUrlOverrides:l,cacheBuster:c,versionOverrideOptions:o?{override:"branch",mode:"prod",branchName:o,useMidgardBranches:!1}:{override:"version",mode:"prod",version:s}});return"boolean"==typeof r?r&&b(u):r&&r.then(()=>b(u),e=>{}),e=>{let{tokenProviders:{augloop:t,substrate:r,sydney:n,tenantFeedback:o,loki:l,feed:c,yammer:d,spo:f,mos:m,oboToken:g,aeaToken:b,amsToken:S,graph:C,powerAutomate:I,powerPlatform:k,apiHub:E,apiSkype:_,teams:A,outlook:T,designer:P,apiUrlp:O,ocps:R,powerbi:x,pushChannel:M,mss:N,copilotStudio:F,bap:L,gcs:z,mruPlusPlus:D,trouter:B,onenote:U,safeLinks:H},getProfilePictureUrl:q,getChatLogger:j,getLoggerProperties:$,locale:W,isRTL:V,firstRunExperience:G,entitySettings:K,hostAppData:X,isFeatureEnabled:Y=()=>!1,createExtensibilityServiceProvider:Z,extensibilityServiceProviderType:Q,citationSurfaceRenderer:J,ecsConfigIds:ee}=e;return j&&$&&((0,p.n)(u,$),(0,i.t)(j())),(0,h.O)(u),v("m365-chat.runtime-created"),{cdnVersion:y,version:s,citationSurfaceRenderer:J,tokenProviders:(0,a.F)({augloop:t,substrate:r,sydney:n,tenantFeedback:o,loki:l,feed:c,yammer:d,spo:f,mos:m,oboToken:g,aeaToken:b,amsToken:S,graph:C,powerAutomate:I,powerPlatform:k,apiHub:E,apiSkype:_,teams:A,outlook:T,designer:P,apiUrlp:O,ocps:R,powerbi:x,pushChannel:M,mss:N,copilotStudio:F,bap:L,gcs:z,mruPlusPlus:D,trouter:B,onenote:U,safeLinks:H}),getProfilePictureUrl:q,getChatLogger:j,densityEnvironment:u,firstRunExperience:G,locale:W,isRTL:V,entitySettings:K,hostAppData:X,isFeatureEnabled:Y,createExtensibilityServiceProvider:Z,extensibilityServiceProviderType:Q,chatLoaderVersion:w,ecsConfigIds:ee}}}function C(e){let{preload:t,allowUrlOverrides:r,branch:n,version:o,...i}=e;return S({preload:t,allowUrlOverrides:r,branch:n,version:o})(i)}let I=({value:e,children:t})=>(l.useEffect(()=>{v("m365-chat.runtime-provider-mounted")},[]),l.createElement(o.o,{value:e.densityEnvironment},l.createElement(s.p,{value:e},t))),k=f(e=>e.loadChat()),E=f(e=>e.loadMsalTokenPopupView())},528729:(e,t,r)=>{"use strict";r.d(t,{E:()=>s,O:()=>a});var n=r(344176),o=r(212124);let i=(0,n.E)();async function a(e){try{let t=await e.resolve(o.A).promise,r=await t.loadGetChatActionCallbacksMetaOS();i.resolve(r)}catch(e){return}}function s(){return i.promise}},343850:(e,t,r)=>{"use strict";r.d(t,{J:()=>s,n:()=>a});var n=r(344176),o=r(212124);let i={loggerPromise:(0,n.E)(),status:!1};async function a(e,t){try{if(i.status)return;i.status=!0;let r=await Promise.resolve(t()),n=await e.resolve(o.A).promise,a=await n.createLogger(r);i.loggerPromise.resolve(a)}catch(e){return}}function s(){return i.loggerPromise.promise}},921217:(e,t,r)=>{"use strict";r.d(t,{t:()=>n});let n=e=>{}},524367:(e,t,r)=>{"use strict";r.d(t,{E:()=>s,p:()=>a});var n=r(623090),o=r(603722);let i=(0,n.m)(null,"M365ChatRuntime"),a=i.Provider;function s(){let e=o.useContext(i);if(!e)throw Error("no M365ChatRuntime provided on the context");return e}},340895:(e,t,r)=>{"use strict";r.d(t,{F:()=>o});var n="undefined"!=typeof window&&window.performance;function o(e){return Object.keys(e).reduce((t,r)=>{var o;let i=e[r];return t[r]=i?(o=`m365-chat.get-token.${r}`,function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=(e=function(){if(!n||!n.mark||!Math||!Math.random)return"";var e="Midgard Mark ".concat(Math.random());return n.mark(e),e}(),{stop:function(t){try{n&&n.measure&&n.measure(t?"".concat(o,"-failed"):o,e)}catch(e){}}});try{return i.apply(void 0,t).then(function(e){return a.stop(),e}).catch(function(e){throw a.stop(!0),e})}catch(e){throw a.stop(!0),e}}):i,t},{})}},470199:(e,t,r)=>{"use strict";var n,o,i,a,s;r.d(t,{FN:()=>n,N9:()=>o,fw:()=>a,ob:()=>i}),function(e){e.None="none",e.Student="student",e.Faculty="faculty"}(n||(n={})),function(e){e.None="none",e.BCAIS="bcais",e.BCWAF="bcwaf",e.BCWBF="bcwbf"}(o||(o={})),function(e){e.None="none",e.MinorWithoutParentalConsent="minorWithoutParentalConsent",e.MinorWithParentalConsent="minorWithParentalConsent",e.MinorNoParentalConsentRequired="minorNoParentalConsentRequired",e.Adult="adult",e.NonAdult="nonAdult",e.Unknown="unknown"}(i||(i={})),function(e){e.None="none",e.Hed="hed",e.K12="k12",e.Others="others"}(a||(a={})),function(e){e.ComingSoon="ComingSoon",e.StudentComingSoon="StudentComingSoon",e.AdminDisable="AdminDisable",e.RegionNotSupported="RegionNotSupported",e.ErrorPage="ErrorPage",e.AgeEighteenMSARequirement="AgeEighteenMSARequirement"}(s||(s={}))},3206:(e,t,r)=>{"use strict";r.d(t,{J:()=>m});var n,o,i,a=r(856911),s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},l="undefined"!=typeof console?console:void 0,c={trace:(null!==(n=null==l?void 0:l.trace)&&void 0!==n?n:s).bind(l),warn:(null!==(o=null==l?void 0:l.warn)&&void 0!==o?o:s).bind(l),table:(null!==(i=null==l?void 0:l.table)&&void 0!==i?i:s).bind(l)},u=r(966464),d="undefined"!=typeof __WHY_DID_YOU_RECOMPUTE__&&__WHY_DID_YOU_RECOMPUTE__||"undefined"!=typeof globalThis&&globalThis.__WHY_DID_YOU_RECOMPUTE__,f={empty:!0},h={},p="undefined"==typeof WeakMap?null:WeakMap,m=function(e,t){if(void 0===t&&(t=100),!p)return e;var r=g(),n=0,o=0,i=d?new Map:void 0,s=d?Error("Memoized function defined").stack:"";return function(){for(var l,p,m,v,b=[],y=0;y<arguments.length;y++)b[y]=arguments[y];var w=r;(0!==o||t>0&&n>t)&&(r=g(),n=0,o=0,null==i||i.clear()),w=r;for(var S=0;S<b.length;S++)!function(e){var t,r=(t=b[e])?"object"==typeof t||"function"==typeof t?t:(h[t]||(h[t]={val:t}),h[t]):f;if(!(null===(l=w.map)||void 0===l?void 0:l.has(r))&&(null===(p=w.map)||void 0===p||p.set(r,g()),d&&i)){var n=null!==(m=i.get(w))&&void 0!==m?m:[],o=n.filter(function(e){return e!==r&&(0,u.A)(e,r)})[0];if(o){c.warn("Why-did-you-recompute: Identical (deep-comparison) past arguments to memoizeFunction found with differing instance equality: ");var y=Error("Indentical argument passed").stack,S=function(e,t){c.table(e),Object.keys(e).forEach(function(r){var n=e[r],o=t[r];n!==o&&(0,u.A)(n,o)&&(c.warn("Duplication present in child prop '".concat(r,"'")),S(n,o))})};S(o,r),c.warn(y),c.warn(s)}i.set(w,(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(n),!1),[r],!1))}w=null===(v=w.map)||void 0===v?void 0:v.get(r)}(S);return!w.hasOwnProperty("value")&&(w.value=e.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(b),!1)),n++),w.value}};function g(){return{map:p?new p:null}}},279141:(e,t,r)=>{"use strict";r.d(t,{q:()=>a});var n=r(856911),o=r(3206),i=Object.keys;function a(e){var t,r,a={};try{for(var s=(0,n.__values)(i(e)),l=s.next();!l.done;l=s.next()){var c=l.value,u=e[c];"function"==typeof u?a[c]=(0,o.J)(u.bind(a)):a[c]=u}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return a}},408792:(e,t,r)=>{"use strict";function n(){try{if(window.self!==window.top)try{return new URL(window.location.origin),window}catch(e){return window.parent}return window}catch(e){return window}}r.d(t,{U:()=>n})},493693:(e,t,r)=>{"use strict";r.d(t,{R:()=>l});var n,o=RegExp("https?://(localhost|local\\.teams\\.(office|live)\\.com)(:|/|$)"),i=function(){return r.p},a=["https://res.cdn.office.net","https://res-sdf.cdn.office.net","https://res-1.cdn.office.net","https://res-2.cdn.office.net","https://res-1.cdn.partner.office365.cn","https://res-gcch.cdn.office.net","https://res-dod.cdn.office.net","https://outlook-1-cdn.azureedge.eaglex.ic.gov","https://outlook-1-cdn.azureedge.microsoft.scloud"];function s(e,t){var r=new URL("https://midgardbranches.blob.core.windows.net/lpc/refs/heads/"),n=new URL("https://res-dev.cdn.officeppe.net/midgard/refs/heads/"),i=new URL(e,document.baseURI).origin;if(i===r.origin||i===n.origin||a.includes(i)||o.test(i))return e;var s=t&&"/_next/"!==t&&"/"!==t&&"/v2/"!==t?new URL(t):void 0;if(s&&i===s.origin)return e;throw Error("TrustedType policy does not allow loading scripts from ".concat(i,", only from ").concat(n.origin,", ").concat(null==s?void 0:s.origin," and localhost."))}function l(e,t,r){void 0===t&&(t=i()),void 0===r&&(r=!0);var o,a=null,l=function(){if(void 0===n&&(n=null,"undefined"!=typeof self&&self.trustedTypes))try{n=self.trustedTypes.createPolicy("@1js/midgard-trusted-types",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e,t){return void 0===t&&(t=i()),s(e,t)}})}catch(e){}return n}();try{a=r&&l?l.createScriptURL(e,t):s(e,t)}catch(e){o=e.message}return{error:o,url:a,trustedTypeAvailable:!!l}}},279357:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});var n=r(493693);function o(e,t){void 0===t&&(t={});var r=function(t){return"Error loading script at ".concat(e," (").concat(t,")")},o=document.head||document.getElementsByTagName("head")[0];if(!o)return Promise.reject(r("no head element"));var i=(0,n.R)(e);if(i.error)return Promise.reject(r(i.error));var a=document.createElement("script");a.src=i.url,a.crossOrigin="anonymous",a.async=!0,a.charset="utf-8",t.ref&&t.ref(a);var s=new Promise(function(e,n){return window.setTimeout(function(){return n(r("timeout"))},t.timeout||12e4)}),l=new Promise(function(e,t){a.onload=function(){return e()},a.onerror=function(e,n,o,i,a){var s="string"==typeof e?e:e.type,l=a?JSON.stringify(a):"none";t(r("Event: ".concat(s,", source: ").concat(n,", line: ").concat(o,", col: ").concat(i,", error: ").concat(l)))}});return o.appendChild(a),Promise.race([l,s])}},682909:(e,t,r)=>{"use strict";r.d(t,{$M:()=>d,B0:()=>b,Ms:()=>m,TA:()=>c,bW:()=>p,cS:()=>u,er:()=>v,ff:()=>h,iW:()=>g,jW:()=>y,yu:()=>f});var n=r(856911),o=r(849291),i=r(579100),a=r.n(i),s=["zero","one","two","few","many","other"],l={zero:/zero\s*{([^}]+)}/,one:/one\s*{([^}]+)}/,two:/two\s*{([^}]+)}/,few:/few\s*{([^}]+)}/,many:/many\s*{([^}]+)}/,other:/other\s*{([^}]+)}/};function c(e){return e.split("-")[0]}function u(e,t){var r=(0,n.__read)(l[t].exec(e)||[],2)[1];return void 0===r?"":r}function d(e,t){return a()(t,e)}function f(e,t){return a().ordinal(t,e)}function h(e){var t="";return s.forEach(function(r){e[r]&&(t+=" ".concat(r,"{").concat(e[r],"}"))}),"".concat("{count, plural,").concat(t).concat("}")}function p(e,t,r){return u(e,d(t,r)||"other")}function m(e,t,r){if(t<0||t!==1/0&&!(0,o.A)(t))throw Error("count must be a positive integer or Infinity");return p(e,t,r)}function g(e,t,r){if(void 0===t)return e;try{return m(e,t,r||"en")}catch(t){return e}}function v(e,t,r){return u(e,f(t,r)||"other")}function b(e,t,r){if(t<0||t!==1/0&&!(0,o.A)(t))throw Error("count must be a positive integer or Infinity");return v(e,t,r)}function y(e,t,r){if(void 0===t)return e;try{return b(e,t,r||"en")}catch(t){return e}}},783116:(e,t,r)=>{"use strict";r.r(t),r.d(t,{createICUString:()=>n.ff,getOrdinalPluralString:()=>n.jW,getOrdinalPluralStringUnsafe:()=>n.B0,getPluralString:()=>n.iW,getPluralStringUnsafe:()=>n.Ms,getStringForRange:()=>n.cS,mapMidgardLocaleToCLDRLocale:()=>n.TA,mapNumberToRangeForLocale:()=>n.$M,mapOrdinalNumberToRangeForLocale:()=>n.yu,parseOrdinalPluralString:()=>n.er,parsePluralString:()=>n.bW});var n=r(682909)},344176:(e,t,r)=>{"use strict";function n(){var e={};return e.promise=new Promise(function(t,r){e.resolve=t,e.reject=r}),e}r.d(t,{E:()=>n})},1067:(e,t,r)=>{"use strict";r.d(t,{b:()=>o});var n=r(856911);function o(e,t,r,o){var i=this;return void 0===r&&(r=1),void 0===o&&(o=500),function(){return(0,n.__awaiter)(i,void 0,void 0,function(){var i,a,s;return(0,n.__generator)(this,function(n){switch(n.label){case 0:i=function(e){return new Promise(function(t){return setTimeout(t,e)})},a=r,n.label=1;case 1:n.label=2;case 2:return n.trys.push([2,4,,8]),[4,e()];case 3:return[2,n.sent()];case 4:if(s=n.sent(),!(--a>=0))return[3,6];return t&&t(a+1,s),[4,i(o)];case 5:return n.sent(),[3,7];case 6:throw s;case 7:return[3,8];case 8:return[3,1];case 9:return[2]}})})}}},442976:(e,t,r)=>{"use strict";var n;r.d(t,{v:()=>n}),function(e){e.UncaughtError="UncaughtError",e.FileRecommendationCardError="FileRecommendationCardError",e.ImageUploadApiCallError="ImageUploadApiCallError",e.ImageUploadApiRAIError="ImageUploadApiRAIError",e.ParseWorkflowError="ParseWorkflowError",e.Ic3ImageFetchError="Ic3ImageFetchError",e.CWCClientError="CWCClientError",e.ChatToggleError="ChatToggleError",e.ESDKUnmountError="ESDKUnmountError",e.PromptSuggestionsMenuError="PromptSuggestionsMenuError",e.TrouterError="TrouterError",e.TrouterWarning="TrouterWarning",e.OutOfCreditsError="OutOfCreditsError",e.UXClientError="UXClientError",e.StreamSubscriberError="StreamSubscriberError",e.SydneyApiInvocationGenericError="SydneyApiInvocationGenericError",e.NoResponseFromSydneyError="NoResponseFromSydneyError",e.ReceivedResponseFromSydneyError="ReceivedResponseFromSydneyError",e.InlineLoopLoadError="InlineLoopLoadError",e.InlineLoopRenderError="InlineLoopRenderError",e.ReadAloudClientError="ReadAloudClientError",e.ReadAloudServerError="ReadAloudServerError",e.ReadAloudAuthTokenError="ReadAloudAuthTokenError",e.MissingTokenError="MissingTokenError",e.APIFetchError="APIFetchError",e.ArcAPIFetchError="ArcAPIFetchError",e.IrisBeaconSentError="IrisBeaconSentError",e.DimeScriptError="DimeScriptError",e.DimeScriptErrorNoGlobal="DimeScriptErrorNoGlobal",e.DimePreloadError="DimePreloadError",e.DimeLaunchError="DimeLaunchError",e.PromptCopyError="PromptCopyError",e.PromptEditError="PromptEditError",e.CEAAsyncMessageError="CEAAsyncMessageError",e.GetAuthToken="GetAuthToken",e.GetServiceLocator="GetServiceLocator",e.GetPolicy="GetPolicy",e.GetURLReputation="GetURLReputation",e.Initialization="Initialization",e.UnfurlError="UnfurlError",e.HomePageCardsDisplayError="HomePageCardsDisplayError",e.SecondaryFetchCallFailed="SecondaryFetchCallFailed",e.MissingRequiredFieldsError="MissingRequiredFieldsError",e.AudioDeviceDeviceError="AudioDeviceDeviceError",e.AudioDeviceUsageError="AudioDeviceUsageError",e.GraphqlError="GraphqlError"}(n||(n={}))},373319:(e,t,r)=>{"use strict";function n(e){for(var t,r=0,n=0,o=e.length;o>=4;++n,o-=4)t=(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))*0x5bd1e995+((t>>>16)*59797<<16),t^=t>>>24,r=(65535&t)*0x5bd1e995+((t>>>16)*59797<<16)^(65535&r)*0x5bd1e995+((r>>>16)*59797<<16);switch(o){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r^=255&e.charCodeAt(n),r=(65535&r)*0x5bd1e995+((r>>>16)*59797<<16)}return r^=r>>>13,(((r=(65535&r)*0x5bd1e995+((r>>>16)*59797<<16))^r>>>15)>>>0).toString(36)}r.d(t,{A:()=>n})},956949:(e,t,r)=>{"use strict";r.d(t,{DU:()=>i,Iy:()=>s});var n,o=r(278809);function i(e){n!==e&&(n=e)}function a(){return void 0===n&&(n="undefined"!=typeof document&&!!document.documentElement&&"rtl"===document.documentElement.getAttribute("dir")),n}function s(){return{rtl:a(),shadowConfig:o.ou}}n=a()},278809:(e,t,r)=>{"use strict";r.d(t,{HD:()=>a,P6:()=>n,Se:()=>o,db:()=>s,ou:()=>i});var n="__global__",o="__shadow_dom_stylesheet__",i={stylesheetKey:n,inShadow:!1,window:void 0,__isShadowConfig__:!0},a=function(e,t,r){return{stylesheetKey:e,inShadow:t,window:r,__isShadowConfig__:!0}},s=function(e){var t;return!!(e&&null!==(t=e)&&"object"==typeof t&&!Array.isArray(t))&&!0===e.__isShadowConfig__}},208758:(e,t,r)=>{"use strict";r.d(t,{F:()=>a,U:()=>s});var n=r(603722);let o=n.createContext(void 0),i={},a=o.Provider,s=()=>n.useContext(o)?n.useContext(o):i},695128:(e,t,r)=>{"use strict";r.d(t,{FD:()=>l,Y:()=>s});var n=r(534043),o=r(255343),i=r(215402),a=r(942282);r(603722);let s=(0,n.q)(a.v.jsx,o.O),l=(0,n.q)(a.v.jsxs,i.J)},534043:(e,t,r)=>{"use strict";r.d(t,{q:()=>a});var n=r(283499);r(603722);var o=r(427879),i=r(856564);function a(e,t){return function(r,a,s,l,c){return(0,n.R)(a)?t((0,o.Q)(r,a),null,s,l,c):(0,n.R)(r)?t(r,a,s,l,c):((0,i.X)(r),e(r,a,s,l,c))}}},255343:(e,t,r)=>{"use strict";r.d(t,{O:()=>a});var n=r(603722),o=r(831308),i=r(942282);let a=(e,t,r)=>{let{elementType:a,renderFunction:s,props:l}=(0,o.$)(e),c={...l,...t};return s?i.v.jsx(n.Fragment,{children:s(a,c)},r):i.v.jsx(a,c,r)}},215402:(e,t,r)=>{"use strict";r.d(t,{J:()=>a});var n=r(603722),o=r(831308),i=r(942282);let a=(e,t,r)=>{let{elementType:a,renderFunction:s,props:l}=(0,o.$)(e),c={...l,...t};return s?i.v.jsx(n.Fragment,{children:s(a,{...c,children:i.v.jsxs(n.Fragment,{children:c.children},void 0)})},r):i.v.jsxs(a,c,r)}},942282:(e,t,r)=>{"use strict";r.d(t,{v:()=>i});var n,o=r(108866);let i=n||(n=r.t(o,2))},427879:(e,t,r)=>{"use strict";r.d(t,{Q:()=>o}),r(603722);var n=r(158670);function o(e,t){return{...t,[n.o]:e}}},831308:(e,t,r)=>{"use strict";r.d(t,{$:()=>o});var n=r(158670);function o(e){let{as:t,[n.o]:r,[n.Y]:o,...i}=e,a="string"==typeof r&&null!=t?t:r;return"string"!=typeof a&&t&&(i.as=t),{elementType:a,props:i,renderFunction:o}}},856564:(e,t,r)=>{"use strict";function n(e){}r.d(t,{X:()=>n}),r(603722),r(283042)},42078:(e,t)=>{"use strict";var r=60103,n=60106,o=60107,i=60108,a=60114,s=60109,l=60110,c=60112,u=60113,d=60120,f=60115,h=60116;if("function"==typeof Symbol&&Symbol.for){var p=Symbol.for;p("react.element"),p("react.portal"),p("react.fragment"),p("react.strict_mode"),p("react.profiler"),p("react.provider"),p("react.context"),p("react.forward_ref"),p("react.suspense"),p("react.suspense_list"),p("react.memo"),p("react.lazy"),p("react.block"),p("react.server.block"),p("react.fundamental"),p("react.debug_trace_mode"),p("react.legacy_hidden")}},283042:(e,t,r)=>{"use strict";r(42078)},867712:(e,t,r)=>{"use strict";function n(e,t){if(t){let r=Object.keys(t).reduce((e,r)=>`${e}--${r}: ${t[r]}; `,"");return`${e} { ${r} }`}return`${e} {}`}r.d(t,{d:()=>n})},450565:(e,t,r)=>{"use strict";r.d(t,{t:()=>p});var n=r(695128),o=r(287556),i=r(426752),a=r(656470),s=r(655411),l=r(838665),c=r(894575),u=r(166159),d=r(184725),f=r(202801),h=r(208758);let p=(e,t)=>((0,o.C)(e),(0,n.Y)(s.K,{value:t.provider,children:(0,n.Y)(l.N,{value:t.theme,children:(0,n.Y)(c.I,{value:t.themeClassName,children:(0,n.Y)(u.gH,{value:t.customStyleHooks_unstable,children:(0,n.Y)(d.J,{value:t.tooltip,children:(0,n.Y)(a.e,{dir:t.textDirection,children:(0,n.Y)(h.F,{value:t.iconDirection,children:(0,n.Y)(f.Nv,{value:t.overrides_unstable,children:(0,n.FD)(e.root,{children:[(0,i.S)()?null:(0,n.Y)("style",{dangerouslySetInnerHTML:{__html:e.serverStyleProps.cssRule},...e.serverStyleProps.attributes}),e.root.children]})})})})})})})})}))},402087:(e,t,r)=>{"use strict";r.d(t,{r:()=>o});var n=r(603722);function o(e){let{applyStylesToPortals:t,customStyleHooks_unstable:r,dir:o,root:i,targetDocument:a,theme:s,themeClassName:l,overrides_unstable:c}=e,u=n.useMemo(()=>({dir:o,targetDocument:a}),[o,a]),[d]=n.useState(()=>({})),f=n.useMemo(()=>({textDirection:o}),[o]);return{customStyleHooks_unstable:r,overrides_unstable:c,provider:u,textDirection:o,iconDirection:f,tooltip:d,theme:s,themeClassName:t?i.className:l}}},154832:(e,t,r)=>{"use strict";r.d(t,{K:()=>l,m:()=>a});var n=r(361027),o=r(515091),i=r(703025);let a={root:"fui-FluentProvider"},s=(0,n.X)({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",fsow6f:["f1o700av","fes3tcz"],Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}"]}),l=e=>{let t=(0,i.J)(),r=s({dir:e.dir,renderer:t});return e.root.className=(0,o.z)(a.root,e.themeClassName,r.root,e.root.className),e}},564188:(e,t,r)=>{"use strict";r.d(t,{V:()=>f});var n,o=r(186286),i=r(23401),a=r(603722),s=r(867712),l=r(154832);let c=(n||(n=r.t(a,2))).useInsertionEffect?(n||(n=r.t(a,2))).useInsertionEffect:o.E,u=(e,t)=>{if(!e)return;let r=e.createElement("style");return Object.keys(t).forEach(e=>{r.setAttribute(e,t[e])}),e.head.appendChild(r),r},d=(e,t)=>{let r=e.sheet;r&&(r.cssRules.length>0&&r.deleteRule(0),r.insertRule(t,0))},f=e=>{let{targetDocument:t,theme:r,rendererAttributes:n}=e,o=a.useRef(),f=(0,i.Bi)(l.m.root),h=a.useMemo(()=>(0,s.d)(`.${f}`,r),[r,f]);return function(e,t){a.useState(()=>{if(!e)return;let r=e.getElementById(t);r&&e.head.append(r)})}(t,f),c(()=>{let e=null==t?void 0:t.getElementById(f);return e?o.current=e:(o.current=u(t,{...n,id:f}),o.current&&d(o.current,h)),()=>{var e;null===(e=o.current)||void 0===e||e.remove()}},[f,t,h,n]),{styleTagId:f,rule:h}}},166159:(e,t,r)=>{"use strict";r.d(t,{$e:()=>s,gH:()=>a,k7:()=>o});var n=r(603722);let o=n.createContext(void 0),i=()=>{},a=o.Provider,s=e=>{var t,r;return null!==(r=null===(t=n.useContext(o))||void 0===t?void 0:t[e])&&void 0!==r?r:i}},202801:(e,t,r)=>{"use strict";r.d(t,{Nv:()=>i,Pv:()=>a});var n=r(603722);let o=n.createContext(void 0),i=o.Provider;function a(){var e;return null!==(e=n.useContext(o))&&void 0!==e?e:{}}},655411:(e,t,r)=>{"use strict";r.d(t,{K:()=>a,Y:()=>s});var n=r(603722);let o=n.createContext(void 0),i={targetDocument:"object"==typeof document?document:void 0,dir:"ltr"},a=o.Provider;function s(){var e;return null!==(e=n.useContext(o))&&void 0!==e?e:i}},894575:(e,t,r)=>{"use strict";r.d(t,{I:()=>i,q:()=>a});var n=r(603722);let o=n.createContext(void 0),i=o.Provider;function a(){var e;return null!==(e=n.useContext(o))&&void 0!==e?e:""}},838665:(e,t,r)=>{"use strict";r.d(t,{D:()=>n,N:()=>o});let n=r(603722).createContext(void 0),o=n.Provider},184725:(e,t,r)=>{"use strict";r.d(t,{J:()=>a,n:()=>s});var n=r(603722);let o=n.createContext(void 0),i={},a=o.Provider;function s(){var e;return null!==(e=n.useContext(o))&&void 0!==e?e:i}},287556:(e,t,r)=>{"use strict";function n(e){}r.d(t,{C:()=>n}),r(603722)},158670:(e,t,r)=>{"use strict";r.d(t,{Y:()=>n,o:()=>o});let n=Symbol.for("fui.slotRenderFunction"),o=Symbol.for("fui.slotElementType")},283499:(e,t,r)=>{"use strict";r.d(t,{R:()=>o});var n=r(158670);function o(e){return!!(null==e?void 0:e.hasOwnProperty(n.o))}},422275:(e,t,r)=>{"use strict";r.d(t,{Gf:()=>s,Gk:()=>i,lq:()=>a});var n=r(603722),o=r(158670);function i(e,t){let{defaultProps:r,elementType:n}=t,i=s(e),a={...r,...i,[o.o]:n};return i&&"function"==typeof i.children&&(a[o.Y]=i.children,a.children=null==r?void 0:r.children),a}function a(e,t){if(null!==e&&(void 0!==e||t.renderByDefault))return i(e,t)}function s(e){return"string"==typeof e||"number"==typeof e||Array.isArray(e)||n.isValidElement(e)?{children:e}:e}},23401:(e,t,r)=>{"use strict";r.d(t,{Bi:()=>l,LX:()=>s});var n,o=r(603722),i=r(440884);let a=o.createContext(void 0),s=a.Provider;function l(e="fui-",t){let s=(0,i.LM)(),c=o.useContext(a)||"",u=(n||(n=r.t(o,2))).useId;if(u){let r=u(),n=o.useMemo(()=>r.replace(/:/g,""),[r]);return t||`${c}${e}${n}`}return o.useMemo(()=>t||`${c}${e}${++s.current}`,[c,e,t,s])}},186286:(e,t,r)=>{"use strict";r.d(t,{E:()=>o});var n=r(603722);let o=(0,r(426752).S)()?n.useLayoutEffect:n.useEffect},440884:(e,t,r)=>{"use strict";r.d(t,{LM:()=>s,wR:()=>l});var n=r(603722),o=r(426752);let i={current:0},a=n.createContext(void 0);function s(){var e;return null!==(e=n.useContext(a))&&void 0!==e?e:i}function l(){let e=s()!==i,[t,r]=n.useState(e);return(0,o.S)()&&e&&n.useLayoutEffect(()=>{r(!1)},[]),t}},426752:(e,t,r)=>{"use strict";function n(){return"undefined"!=typeof window&&!!(window.document&&window.document.createElement)}r.d(t,{S:()=>n})},329372:(e,t,r)=>{"use strict";r.d(t,{N:()=>o});var n=r(432884);let o=e=>({colorNeutralForeground1:n.ON,colorNeutralForeground1Hover:n.ON,colorNeutralForeground1Pressed:n.ON,colorNeutralForeground1Selected:n.ON,colorNeutralForeground2:n.Oh[84],colorNeutralForeground2Hover:n.ON,colorNeutralForeground2Pressed:n.ON,colorNeutralForeground2Selected:n.ON,colorNeutralForeground2BrandHover:e[100],colorNeutralForeground2BrandPressed:e[90],colorNeutralForeground2BrandSelected:e[100],colorNeutralForeground3:n.Oh[68],colorNeutralForeground3Hover:n.Oh[84],colorNeutralForeground3Pressed:n.Oh[84],colorNeutralForeground3Selected:n.Oh[84],colorNeutralForeground3BrandHover:e[100],colorNeutralForeground3BrandPressed:e[90],colorNeutralForeground3BrandSelected:e[100],colorNeutralForeground4:n.Oh[60],colorNeutralForegroundDisabled:n.Oh[36],colorNeutralForegroundInvertedDisabled:n.c8[40],colorBrandForegroundLink:e[100],colorBrandForegroundLinkHover:e[110],colorBrandForegroundLinkPressed:e[90],colorBrandForegroundLinkSelected:e[100],colorNeutralForeground2Link:n.Oh[84],colorNeutralForeground2LinkHover:n.ON,colorNeutralForeground2LinkPressed:n.ON,colorNeutralForeground2LinkSelected:n.ON,colorCompoundBrandForeground1:e[100],colorCompoundBrandForeground1Hover:e[110],colorCompoundBrandForeground1Pressed:e[90],colorBrandForeground1:e[100],colorBrandForeground2:e[110],colorBrandForeground2Hover:e[130],colorBrandForeground2Pressed:e[160],colorNeutralForeground1Static:n.Oh[14],colorNeutralForegroundStaticInverted:n.ON,colorNeutralForegroundInverted:n.Oh[14],colorNeutralForegroundInvertedHover:n.Oh[14],colorNeutralForegroundInvertedPressed:n.Oh[14],colorNeutralForegroundInvertedSelected:n.Oh[14],colorNeutralForegroundInverted2:n.Oh[14],colorNeutralForegroundOnBrand:n.ON,colorNeutralForegroundInvertedLink:n.ON,colorNeutralForegroundInvertedLinkHover:n.ON,colorNeutralForegroundInvertedLinkPressed:n.ON,colorNeutralForegroundInvertedLinkSelected:n.ON,colorBrandForegroundInverted:e[80],colorBrandForegroundInvertedHover:e[70],colorBrandForegroundInvertedPressed:e[60],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:n.Oh[16],colorNeutralBackground1Hover:n.Oh[24],colorNeutralBackground1Pressed:n.Oh[12],colorNeutralBackground1Selected:n.Oh[22],colorNeutralBackground2:n.Oh[12],colorNeutralBackground2Hover:n.Oh[20],colorNeutralBackground2Pressed:n.Oh[8],colorNeutralBackground2Selected:n.Oh[18],colorNeutralBackground3:n.Oh[8],colorNeutralBackground3Hover:n.Oh[16],colorNeutralBackground3Pressed:n.Oh[4],colorNeutralBackground3Selected:n.Oh[14],colorNeutralBackground4:n.Oh[4],colorNeutralBackground4Hover:n.Oh[12],colorNeutralBackground4Pressed:n.Ql,colorNeutralBackground4Selected:n.Oh[10],colorNeutralBackground5:n.Ql,colorNeutralBackground5Hover:n.Oh[8],colorNeutralBackground5Pressed:n.Oh[2],colorNeutralBackground5Selected:n.Oh[6],colorNeutralBackground6:n.Oh[20],colorNeutralBackgroundInverted:n.ON,colorNeutralBackgroundStatic:n.Oh[24],colorNeutralBackgroundAlpha:n.ti[50],colorNeutralBackgroundAlpha2:n.Z1[70],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:n.Oh[22],colorSubtleBackgroundPressed:n.Oh[18],colorSubtleBackgroundSelected:n.Oh[20],colorSubtleBackgroundLightAlphaHover:n.Xv[80],colorSubtleBackgroundLightAlphaPressed:n.Xv[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:n.Q1[10],colorSubtleBackgroundInvertedPressed:n.Q1[30],colorSubtleBackgroundInvertedSelected:n.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:n.Oh[8],colorNeutralBackgroundInvertedDisabled:n.c8[10],colorNeutralStencil1:n.Oh[34],colorNeutralStencil2:n.Oh[20],colorNeutralStencil1Alpha:n.c8[10],colorNeutralStencil2Alpha:n.c8[5],colorBackgroundOverlay:n.Q1[50],colorScrollbarOverlay:n.c8[60],colorBrandBackground:e[70],colorBrandBackgroundHover:e[80],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[100],colorCompoundBrandBackgroundHover:e[110],colorCompoundBrandBackgroundPressed:e[90],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[20],colorBrandBackground2Hover:e[40],colorBrandBackground2Pressed:e[10],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:n.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:n.Oh[20],colorNeutralCardBackgroundHover:n.Oh[24],colorNeutralCardBackgroundPressed:n.Oh[18],colorNeutralCardBackgroundSelected:n.Oh[22],colorNeutralCardBackgroundDisabled:n.Oh[8],colorNeutralStrokeAccessible:n.Oh[68],colorNeutralStrokeAccessibleHover:n.Oh[74],colorNeutralStrokeAccessiblePressed:n.Oh[70],colorNeutralStrokeAccessibleSelected:e[100],colorNeutralStroke1:n.Oh[40],colorNeutralStroke1Hover:n.Oh[46],colorNeutralStroke1Pressed:n.Oh[42],colorNeutralStroke1Selected:n.Oh[44],colorNeutralStroke2:n.Oh[32],colorNeutralStroke3:n.Oh[24],colorNeutralStrokeSubtle:n.Oh[4],colorNeutralStrokeOnBrand:n.Oh[16],colorNeutralStrokeOnBrand2:n.ON,colorNeutralStrokeOnBrand2Hover:n.ON,colorNeutralStrokeOnBrand2Pressed:n.ON,colorNeutralStrokeOnBrand2Selected:n.ON,colorBrandStroke1:e[100],colorBrandStroke2:e[50],colorBrandStroke2Hover:e[50],colorBrandStroke2Pressed:e[30],colorBrandStroke2Contrast:e[50],colorCompoundBrandStroke:e[100],colorCompoundBrandStrokeHover:e[110],colorCompoundBrandStrokePressed:e[90],colorNeutralStrokeDisabled:n.Oh[26],colorNeutralStrokeInvertedDisabled:n.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:n.c8[10],colorNeutralStrokeAlpha2:n.c8[20],colorStrokeFocus1:n.Ql,colorStrokeFocus2:n.ON,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"})},278545:(e,t,r)=>{"use strict";r.d(t,{h:()=>l,m:()=>c});var n=r(43530),o=r(921902),i=r(297483);let a=o.TQ.reduce((e,t)=>{let r=t.slice(0,1).toUpperCase()+t.slice(1);return Object.assign(e,{[`colorPalette${r}Background1`]:n.yd[t].shade40,[`colorPalette${r}Background2`]:n.yd[t].shade30,[`colorPalette${r}Background3`]:n.yd[t].primary,[`colorPalette${r}Foreground1`]:n.yd[t].tint30,[`colorPalette${r}Foreground2`]:n.yd[t].tint40,[`colorPalette${r}Foreground3`]:n.yd[t].tint20,[`colorPalette${r}BorderActive`]:n.yd[t].tint30,[`colorPalette${r}Border1`]:n.yd[t].primary,[`colorPalette${r}Border2`]:n.yd[t].tint20})},{});a.colorPaletteRedForeground3=n.yd.red.tint30,a.colorPaletteRedBorder2=n.yd.red.tint30,a.colorPaletteGreenForeground3=n.yd.green.tint40,a.colorPaletteGreenBorder2=n.yd.green.tint40,a.colorPaletteDarkOrangeForeground3=n.yd.darkOrange.tint30,a.colorPaletteDarkOrangeBorder2=n.yd.darkOrange.tint30,a.colorPaletteRedForegroundInverted=n.yd.red.primary,a.colorPaletteGreenForegroundInverted=n.yd.green.primary,a.colorPaletteYellowForegroundInverted=n.yd.yellow.shade30;let s=o.dt.reduce((e,t)=>{let r=t.slice(0,1).toUpperCase()+t.slice(1);return Object.assign(e,{[`colorPalette${r}Background2`]:n.cc[t].shade30,[`colorPalette${r}Foreground2`]:n.cc[t].tint40,[`colorPalette${r}BorderActive`]:n.cc[t].tint30})},{});s.colorPaletteDarkRedBackground2=n.cc.darkRed.shade20,s.colorPalettePlumBackground2=n.cc.plum.shade20;let l={...a,...s},c=Object.entries(i.s).reduce((e,[t,r])=>{let o=t.slice(0,1).toUpperCase()+t.slice(1);return Object.assign(e,{[`colorStatus${o}Background1`]:n.Ul[r].shade40,[`colorStatus${o}Background2`]:n.Ul[r].shade30,[`colorStatus${o}Background3`]:n.Ul[r].primary,[`colorStatus${o}Foreground1`]:n.Ul[r].tint30,[`colorStatus${o}Foreground2`]:n.Ul[r].tint40,[`colorStatus${o}Foreground3`]:n.Ul[r].tint20,[`colorStatus${o}BorderActive`]:n.Ul[r].tint30,[`colorStatus${o}ForegroundInverted`]:n.Ul[r].shade10,[`colorStatus${o}Border1`]:n.Ul[r].primary,[`colorStatus${o}Border2`]:n.Ul[r].tint20})},{});c.colorStatusDangerBackground3Hover=n.Ul[i.s.danger].shade10,c.colorStatusDangerBackground3Pressed=n.Ul[i.s.danger].shade20,c.colorStatusDangerForeground3=n.Ul[i.s.danger].tint40,c.colorStatusDangerBorder2=n.Ul[i.s.danger].tint30,c.colorStatusSuccessForeground3=n.Ul[i.s.success].tint40,c.colorStatusSuccessBorder2=n.Ul[i.s.success].tint40,c.colorStatusWarningForegroundInverted=n.Ul[i.s.warning].shade20},387460:(e,t,r)=>{"use strict";r.d(t,{N:()=>o});var n=r(432884);let o=e=>({colorNeutralForeground1:n.Oh[14],colorNeutralForeground1Hover:n.Oh[14],colorNeutralForeground1Pressed:n.Oh[14],colorNeutralForeground1Selected:n.Oh[14],colorNeutralForeground2:n.Oh[26],colorNeutralForeground2Hover:n.Oh[14],colorNeutralForeground2Pressed:n.Oh[14],colorNeutralForeground2Selected:n.Oh[14],colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:n.Oh[38],colorNeutralForeground3Hover:n.Oh[26],colorNeutralForeground3Pressed:n.Oh[26],colorNeutralForeground3Selected:n.Oh[26],colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:n.Oh[44],colorNeutralForegroundDisabled:n.Oh[74],colorNeutralForegroundInvertedDisabled:n.c8[40],colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:n.Oh[26],colorNeutralForeground2LinkHover:n.Oh[14],colorNeutralForeground2LinkPressed:n.Oh[14],colorNeutralForeground2LinkSelected:n.Oh[14],colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:n.Oh[14],colorNeutralForegroundStaticInverted:n.ON,colorNeutralForegroundInverted:n.ON,colorNeutralForegroundInvertedHover:n.ON,colorNeutralForegroundInvertedPressed:n.ON,colorNeutralForegroundInvertedSelected:n.ON,colorNeutralForegroundInverted2:n.ON,colorNeutralForegroundOnBrand:n.ON,colorNeutralForegroundInvertedLink:n.ON,colorNeutralForegroundInvertedLinkHover:n.ON,colorNeutralForegroundInvertedLinkPressed:n.ON,colorNeutralForegroundInvertedLinkSelected:n.ON,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:n.ON,colorNeutralBackground1Hover:n.Oh[96],colorNeutralBackground1Pressed:n.Oh[88],colorNeutralBackground1Selected:n.Oh[92],colorNeutralBackground2:n.Oh[98],colorNeutralBackground2Hover:n.Oh[94],colorNeutralBackground2Pressed:n.Oh[86],colorNeutralBackground2Selected:n.Oh[90],colorNeutralBackground3:n.Oh[96],colorNeutralBackground3Hover:n.Oh[92],colorNeutralBackground3Pressed:n.Oh[84],colorNeutralBackground3Selected:n.Oh[88],colorNeutralBackground4:n.Oh[94],colorNeutralBackground4Hover:n.Oh[98],colorNeutralBackground4Pressed:n.Oh[96],colorNeutralBackground4Selected:n.ON,colorNeutralBackground5:n.Oh[92],colorNeutralBackground5Hover:n.Oh[96],colorNeutralBackground5Pressed:n.Oh[94],colorNeutralBackground5Selected:n.Oh[98],colorNeutralBackground6:n.Oh[90],colorNeutralBackgroundInverted:n.Oh[16],colorNeutralBackgroundStatic:n.Oh[20],colorNeutralBackgroundAlpha:n.c8[50],colorNeutralBackgroundAlpha2:n.c8[80],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:n.Oh[96],colorSubtleBackgroundPressed:n.Oh[88],colorSubtleBackgroundSelected:n.Oh[92],colorSubtleBackgroundLightAlphaHover:n.c8[70],colorSubtleBackgroundLightAlphaPressed:n.c8[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:n.Q1[10],colorSubtleBackgroundInvertedPressed:n.Q1[30],colorSubtleBackgroundInvertedSelected:n.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:n.Oh[94],colorNeutralBackgroundInvertedDisabled:n.c8[10],colorNeutralStencil1:n.Oh[90],colorNeutralStencil2:n.Oh[98],colorNeutralStencil1Alpha:n.Q1[10],colorNeutralStencil2Alpha:n.Q1[5],colorBackgroundOverlay:n.Q1[40],colorScrollbarOverlay:n.Q1[50],colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:n.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:n.Oh[98],colorNeutralCardBackgroundHover:n.ON,colorNeutralCardBackgroundPressed:n.Oh[96],colorNeutralCardBackgroundSelected:n.Oh[92],colorNeutralCardBackgroundDisabled:n.Oh[94],colorNeutralStrokeAccessible:n.Oh[38],colorNeutralStrokeAccessibleHover:n.Oh[34],colorNeutralStrokeAccessiblePressed:n.Oh[30],colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:n.Oh[82],colorNeutralStroke1Hover:n.Oh[78],colorNeutralStroke1Pressed:n.Oh[70],colorNeutralStroke1Selected:n.Oh[74],colorNeutralStroke2:n.Oh[88],colorNeutralStroke3:n.Oh[94],colorNeutralStrokeSubtle:n.Oh[88],colorNeutralStrokeOnBrand:n.ON,colorNeutralStrokeOnBrand2:n.ON,colorNeutralStrokeOnBrand2Hover:n.ON,colorNeutralStrokeOnBrand2Pressed:n.ON,colorNeutralStrokeOnBrand2Selected:n.ON,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:n.Oh[88],colorNeutralStrokeInvertedDisabled:n.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:n.Q1[5],colorNeutralStrokeAlpha2:n.c8[20],colorStrokeFocus1:n.ON,colorStrokeFocus2:n.Ql,colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"})},729145:(e,t,r)=>{"use strict";r.d(t,{h:()=>l,m:()=>c});var n=r(43530),o=r(921902),i=r(297483);let a=o.TQ.reduce((e,t)=>{let r=t.slice(0,1).toUpperCase()+t.slice(1);return Object.assign(e,{[`colorPalette${r}Background1`]:n.yd[t].tint60,[`colorPalette${r}Background2`]:n.yd[t].tint40,[`colorPalette${r}Background3`]:n.yd[t].primary,[`colorPalette${r}Foreground1`]:n.yd[t].shade10,[`colorPalette${r}Foreground2`]:n.yd[t].shade30,[`colorPalette${r}Foreground3`]:n.yd[t].primary,[`colorPalette${r}BorderActive`]:n.yd[t].primary,[`colorPalette${r}Border1`]:n.yd[t].tint40,[`colorPalette${r}Border2`]:n.yd[t].primary})},{});a.colorPaletteYellowForeground1=n.yd.yellow.shade30,a.colorPaletteRedForegroundInverted=n.yd.red.tint20,a.colorPaletteGreenForegroundInverted=n.yd.green.tint20,a.colorPaletteYellowForegroundInverted=n.yd.yellow.tint40;let s=o.dt.reduce((e,t)=>{let r=t.slice(0,1).toUpperCase()+t.slice(1);return Object.assign(e,{[`colorPalette${r}Background2`]:n.cc[t].tint40,[`colorPalette${r}Foreground2`]:n.cc[t].shade30,[`colorPalette${r}BorderActive`]:n.cc[t].primary})},{}),l={...a,...s},c=Object.entries(i.s).reduce((e,[t,r])=>{let o=t.slice(0,1).toUpperCase()+t.slice(1);return Object.assign(e,{[`colorStatus${o}Background1`]:n.Ul[r].tint60,[`colorStatus${o}Background2`]:n.Ul[r].tint40,[`colorStatus${o}Background3`]:n.Ul[r].primary,[`colorStatus${o}Foreground1`]:n.Ul[r].shade10,[`colorStatus${o}Foreground2`]:n.Ul[r].shade30,[`colorStatus${o}Foreground3`]:n.Ul[r].primary,[`colorStatus${o}ForegroundInverted`]:n.Ul[r].tint30,[`colorStatus${o}BorderActive`]:n.Ul[r].primary,[`colorStatus${o}Border1`]:n.Ul[r].tint40,[`colorStatus${o}Border2`]:n.Ul[r].primary})},{});c.colorStatusDangerBackground3Hover=n.Ul[i.s.danger].shade10,c.colorStatusDangerBackground3Pressed=n.Ul[i.s.danger].shade20,c.colorStatusWarningForeground1=n.Ul[i.s.warning].shade20,c.colorStatusWarningForeground3=n.Ul[i.s.warning].shade20,c.colorStatusWarningBorder2=n.Ul[i.s.warning].shade20},733108:(e,t,r)=>{"use strict";r.d(t,{V:()=>n});let n={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"}},43530:(e,t,r)=>{"use strict";r.d(t,{Ul:()=>a,cc:()=>i,yd:()=>o});var n=r(432884);let o={red:n.wv,green:n.wL,darkOrange:n.je,yellow:n.D9,berry:n.pT,lightGreen:n.EM,marigold:n.KK},i={darkRed:n.ik,cranberry:n.jF,pumpkin:n.Vv,peach:n.WB,gold:n.bK,brass:n.YA,brown:n.Xk,forest:n.CE,seafoam:n.$T,darkGreen:n.AV,lightTeal:n.JW,teal:n.$S,steel:n.s$,blue:n.z1,royalBlue:n.Os,cornflower:n.um,navy:n.Z,lavender:n.Us,purple:n.Zp,grape:n.QH,lilac:n.qn,pink:n.Vu,magenta:n.GC,plum:n.t1,beige:n.Zz,mink:n.QJ,platinum:n.X1,anchor:n.Y3},a={cranberry:n.jF,green:n.wL,orange:n.T_}},432884:(e,t,r)=>{"use strict";r.d(t,{$S:()=>z,$T:()=>x,AV:()=>F,CE:()=>R,D9:()=>A,EM:()=>M,Fn:()=>m,GC:()=>X,JW:()=>L,KK:()=>_,ON:()=>c,Oh:()=>n,Os:()=>U,Q1:()=>i,QH:()=>W,QJ:()=>Q,Ql:()=>u,Si:()=>f,T_:()=>k,Us:()=>j,Vu:()=>K,Vv:()=>I,WB:()=>E,X1:()=>J,Xk:()=>O,Xv:()=>l,Y3:()=>ee,YA:()=>P,Z:()=>q,Z1:()=>s,Zp:()=>$,Zz:()=>Z,aJ:()=>d,bK:()=>T,c8:()=>o,fo:()=>g,ik:()=>y,jF:()=>w,je:()=>C,m4:()=>h,mY:()=>p,p1:()=>v,p6:()=>b,pT:()=>V,qn:()=>G,s$:()=>D,t1:()=>Y,ti:()=>a,um:()=>H,wL:()=>N,wv:()=>S,z1:()=>B});let n={2:"#050505",4:"#0a0a0a",6:"#0f0f0f",8:"#141414",10:"#1a1a1a",12:"#1f1f1f",14:"#242424",16:"#292929",18:"#2e2e2e",20:"#333333",22:"#383838",24:"#3d3d3d",26:"#424242",28:"#474747",30:"#4d4d4d",32:"#525252",34:"#575757",36:"#5c5c5c",38:"#616161",40:"#666666",42:"#6b6b6b",44:"#707070",46:"#757575",48:"#7a7a7a",50:"#808080",52:"#858585",54:"#8a8a8a",56:"#8f8f8f",58:"#949494",60:"#999999",62:"#9e9e9e",64:"#a3a3a3",66:"#a8a8a8",68:"#adadad",70:"#b3b3b3",72:"#b8b8b8",74:"#bdbdbd",76:"#c2c2c2",78:"#c7c7c7",80:"#cccccc",82:"#d1d1d1",84:"#d6d6d6",86:"#dbdbdb",88:"#e0e0e0",90:"#e6e6e6",92:"#ebebeb",94:"#f0f0f0",96:"#f5f5f5",98:"#fafafa"},o={5:"rgba(255, 255, 255, 0.05)",10:"rgba(255, 255, 255, 0.1)",20:"rgba(255, 255, 255, 0.2)",30:"rgba(255, 255, 255, 0.3)",40:"rgba(255, 255, 255, 0.4)",50:"rgba(255, 255, 255, 0.5)",60:"rgba(255, 255, 255, 0.6)",70:"rgba(255, 255, 255, 0.7)",80:"rgba(255, 255, 255, 0.8)",90:"rgba(255, 255, 255, 0.9)"},i={5:"rgba(0, 0, 0, 0.05)",10:"rgba(0, 0, 0, 0.1)",20:"rgba(0, 0, 0, 0.2)",30:"rgba(0, 0, 0, 0.3)",40:"rgba(0, 0, 0, 0.4)",50:"rgba(0, 0, 0, 0.5)",60:"rgba(0, 0, 0, 0.6)",70:"rgba(0, 0, 0, 0.7)",80:"rgba(0, 0, 0, 0.8)",90:"rgba(0, 0, 0, 0.9)"},a={5:"rgba(26, 26, 26, 0.05)",10:"rgba(26, 26, 26, 0.1)",20:"rgba(26, 26, 26, 0.2)",30:"rgba(26, 26, 26, 0.3)",40:"rgba(26, 26, 26, 0.4)",50:"rgba(26, 26, 26, 0.5)",60:"rgba(26, 26, 26, 0.6)",70:"rgba(26, 26, 26, 0.7)",80:"rgba(26, 26, 26, 0.8)",90:"rgba(26, 26, 26, 0.9)"},s={5:"rgba(31, 31, 31, 0.05)",10:"rgba(31, 31, 31, 0.1)",20:"rgba(31, 31, 31, 0.2)",30:"rgba(31, 31, 31, 0.3)",40:"rgba(31, 31, 31, 0.4)",50:"rgba(31, 31, 31, 0.5)",60:"rgba(31, 31, 31, 0.6)",70:"rgba(31, 31, 31, 0.7)",80:"rgba(31, 31, 31, 0.8)",90:"rgba(31, 31, 31, 0.9)"},l={5:"rgba(36, 36, 36, 0.05)",10:"rgba(36, 36, 36, 0.1)",20:"rgba(36, 36, 36, 0.2)",30:"rgba(36, 36, 36, 0.3)",40:"rgba(36, 36, 36, 0.4)",50:"rgba(36, 36, 36, 0.5)",60:"rgba(36, 36, 36, 0.6)",70:"rgba(36, 36, 36, 0.7)",80:"rgba(36, 36, 36, 0.8)",90:"rgba(36, 36, 36, 0.9)"},c="#ffffff",u="#000000",d="#ffff00",f="#1aebff",h="#3ff23f",p="#000000",m="#ffffff",g="#000000",v="#000000",b="#ffffff",y={shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},w={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},S={shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},C={shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},I={shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},k={shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"},E={shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},_={shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"},A={shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},T={shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},P={shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},O={shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},R={shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},x={shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},M={shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},N={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},F={shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},L={shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},z={shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},D={shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},B={shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},U={shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},H={shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},q={shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},j={shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},$={shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},W={shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},V={shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},G={shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},K={shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},X={shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},Y={shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},Z={shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},Q={shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},J={shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},ee={shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},514820:(e,t,r)=>{"use strict";r.d(t,{L:()=>n});let n={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"}},512431:(e,t,r)=>{"use strict";r.d(t,{S:()=>n});let n={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"}},72012:(e,t,r)=>{"use strict";r.d(t,{GR:()=>n,NM:()=>i,aI:()=>a,lm:()=>o});let n={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},o={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},i={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},a={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"}},52358:(e,t,r)=>{"use strict";r.d(t,{F:()=>i,b:()=>o});let n={none:"0",xxs:"2px",xs:"4px",sNudge:"6px",s:"8px",mNudge:"10px",m:"12px",l:"16px",xl:"20px",xxl:"24px",xxxl:"32px"},o={spacingHorizontalNone:n.none,spacingHorizontalXXS:n.xxs,spacingHorizontalXS:n.xs,spacingHorizontalSNudge:n.sNudge,spacingHorizontalS:n.s,spacingHorizontalMNudge:n.mNudge,spacingHorizontalM:n.m,spacingHorizontalL:n.l,spacingHorizontalXL:n.xl,spacingHorizontalXXL:n.xxl,spacingHorizontalXXXL:n.xxxl},i={spacingVerticalNone:n.none,spacingVerticalXXS:n.xxs,spacingVerticalXS:n.xs,spacingVerticalSNudge:n.sNudge,spacingVerticalS:n.s,spacingVerticalMNudge:n.mNudge,spacingVerticalM:n.m,spacingVerticalL:n.l,spacingVerticalXL:n.xl,spacingVerticalXXL:n.xxl,spacingVerticalXXXL:n.xxxl}},57817:(e,t,r)=>{"use strict";r.d(t,{k:()=>n});let n={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"}},921902:(e,t,r)=>{"use strict";r.d(t,{TQ:()=>n,dt:()=>o});let n=["red","green","darkOrange","yellow","berry","lightGreen","marigold"],o=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"]},297483:(e,t,r)=>{"use strict";r.d(t,{s:()=>n});let n={success:"green",warning:"orange",danger:"cranberry"}},958063:(e,t,r)=>{"use strict";r.d(t,{W:()=>f});var n=r(278545),o=r(329372),i=r(733108),a=r(72012),s=r(57817),l=r(869611),c=r(512431),u=r(514820),d=r(52358);let f=e=>{let t=(0,o.N)(e);return{...i.V,...a.GR,...a.lm,...a.aI,...a.NM,...s.k,...d.b,...d.F,...c.S,...u.L,...t,...n.h,...n.m,...(0,l.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...(0,l.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}}},395417:(e,t,r)=>{"use strict";r.d(t,{a:()=>f});var n=r(729145),o=r(387460),i=r(733108),a=r(72012),s=r(57817),l=r(869611),c=r(512431),u=r(514820),d=r(52358);let f=e=>{let t=(0,o.N)(e);return{...i.V,...a.GR,...a.lm,...a.aI,...a.NM,...s.k,...d.b,...d.F,...c.S,...u.L,...t,...n.h,...n.m,...(0,l.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...(0,l.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}}},869611:(e,t,r)=>{"use strict";function n(e,t,r=""){return{[`shadow2${r}`]:`0 0 2px ${e}, 0 1px 2px ${t}`,[`shadow4${r}`]:`0 0 2px ${e}, 0 2px 4px ${t}`,[`shadow8${r}`]:`0 0 2px ${e}, 0 4px 8px ${t}`,[`shadow16${r}`]:`0 0 2px ${e}, 0 8px 16px ${t}`,[`shadow28${r}`]:`0 0 8px ${e}, 0 14px 28px ${t}`,[`shadow64${r}`]:`0 0 8px ${e}, 0 32px 64px ${t}`}}r.d(t,{t:()=>n})},894571:(e,t,r)=>{"use strict";r.d(t,{c:()=>n});var n={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pauseBreak:19,capslock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,del:46,zero:48,one:49,two:50,three:51,four:52,five:53,six:54,seven:55,eight:56,nine:57,colon:58,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindow:91,rightWindow:92,select:93,zero_numpad:96,one_numpad:97,two_numpad:98,three_numpad:99,four_numpad:100,five_numpad:101,six_numpad:102,seven_numpad:103,eight_numpad:104,nine_numpad:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrollLock:145,semicolon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,openBracket:219,backSlash:220,closeBracket:221,singleQuote:222}},50378:(e,t,r)=>{"use strict";function n(){return"undefined"!=typeof window&&!!(window.document&&window.document.createElement)}r.d(t,{S:()=>n})},911160:(e,t,r)=>{"use strict";r.d(t,{Y:()=>o});var n=r(50378);function o(e){if((0,n.S)()&&"undefined"!=typeof document)return e&&e.ownerDocument?e.ownerDocument:document}},988821:(e,t,r)=>{"use strict";r.d(t,{z:()=>i});var n=r(50378),o=void 0;try{o=window}catch(e){}function i(e){if((0,n.S)()&&void 0!==o)return e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:o}},647616:(e,t,r)=>{"use strict";r.d(t,{DU:()=>u,SM:()=>d,jI:()=>c});var n,o=r(894571),i=r(911160),a=r(796233),s=r(956949),l="isRTL";function c(e){if(void 0===e&&(e={}),void 0!==e.rtl)return e.rtl;if(void 0===n){var t=(0,a.G)(l);null!==t&&u(n="1"===t);var r=(0,i.Y)();void 0===n&&r&&(n="rtl"===(r.body&&r.body.getAttribute("dir")||r.documentElement.getAttribute("dir")),(0,s.DU)(n))}return!!n}function u(e,t){void 0===t&&(t=!1);var r=(0,i.Y)();r&&r.documentElement.setAttribute("dir",e?"rtl":"ltr"),t&&(0,a.S)(l,e?"1":"0"),n=e,(0,s.DU)(n)}function d(e,t){return void 0===t&&(t={}),c(t)&&(e===o.c.left?e=o.c.right:e===o.c.right&&(e=o.c.left)),e}},796233:(e,t,r)=>{"use strict";r.d(t,{G:()=>o,S:()=>i});var n=r(988821);function o(e){var t=null;try{var r=(0,n.z)();t=r?r.sessionStorage.getItem(e):null}catch(e){}return t}function i(e,t){var r;try{null===(r=(0,n.z)())||void 0===r||r.sessionStorage.setItem(e,t)}catch(e){}}},262772:(e,t,r)=>{"use strict";r.d(t,{O:()=>o});var n=r(826352);function o(e){let t=null,r=null;return function(o){let{dir:i}=o,a="ltr"===i;return a?null===t&&(t=(0,n.N)(e,i)):null===r&&(r=(0,n.N)(e,i)),a?t:r}}},589431:(e,t,r)=>{"use strict";function n(e,t){return function(r){let{dir:n}=r;return"ltr"===n?e:t||e}}r.d(t,{D:()=>n})},898502:(e,t,r)=>{"use strict";r.d(t,{y:()=>o});var n=r(472778);function o(e,t,r,i=n.A){let a=i();return function(n){let{dir:o,renderer:i}=n;return a(i,Array.isArray(r)?{r:r}:r),"ltr"===o?e:t||e}}},361027:(e,t,r)=>{"use strict";r.d(t,{X:()=>i});var n=r(472778),o=r(826352);function i(e,t,r=n.A){let a=r(),s=null,l=null;return function(r){let{dir:n,renderer:i}=r,c="ltr"===n;return c?null===s&&(s=(0,o.N)(e,n)):null===l&&(l=(0,o.N)(e,n)),a(i,t),c?s:l}}},921464:(e,t,r)=>{"use strict";r.d(t,{AX:()=>v,EJ:()=>c,Eo:()=>d,FS:()=>g,P2:()=>a,Ut:()=>y,aN:()=>u,ed:()=>l,ez:()=>f,fj:()=>h,k1:()=>s,qw:()=>b,uq:()=>p,wn:()=>m});let n="undefined"==typeof window?r.g:window,o="@griffel/";function i(e,t){return n[Symbol.for(o+e)]||(n[Symbol.for(o+e)]=t),n[Symbol.for(o+e)]}let a=i("DEBUG_RESET_CLASSES",{}),s=i("DEFINITION_LOOKUP_TABLE",{}),l="data-make-styles-bucket",c="data-priority",u="f",d="r",f=7,h="___",p="_",m=h.length+7,g=0,v=1,b={all:1,borderColor:1,borderStyle:1,borderWidth:1,borderBlock:1,borderBlockEnd:1,borderBlockStart:1,borderInline:1,borderInlineEnd:1,borderInlineStart:1},y="DO_NOT_USE_DIRECTLY: @griffel/reset-value"},31791:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DATA_BUCKET_ATTR:()=>S.ed,DATA_PRIORITY_ATTR:()=>S.EJ,DEBUG_RESET_CLASSES:()=>S.P2,DEBUG_SEQUENCE_SEPARATOR:()=>S.uq,DEFINITION_LOOKUP_TABLE:()=>S.k1,HASH_PREFIX:()=>S.aN,LOOKUP_DEFINITIONS_INDEX:()=>S.FS,LOOKUP_DIR_INDEX:()=>S.AX,RESET:()=>S.Ut,RESET_HASH_PREFIX:()=>S.Eo,SEQUENCE_HASH_LENGTH:()=>S.ez,SEQUENCE_PREFIX:()=>S.fj,SEQUENCE_SIZE:()=>S.wn,UNSUPPORTED_CSS_PROPERTIES:()=>S.qw,__css:()=>d.O,__resetCSS:()=>h.D,__resetStyles:()=>p.y,__styles:()=>f.X,createDOMRenderer:()=>n.I,defaultCompareMediaQueries:()=>n.z,getStyleBucketName:()=>v.x,getStyleSheetKey:()=>g.AY,makeResetStyles:()=>c.I,makeStaticStyles:()=>l.P,makeStyles:()=>s.n,mergeClasses:()=>a.z,normalizeCSSBucketEntry:()=>m.$,reduceToClassNameForSlots:()=>b.N,rehydrateRendererCache:()=>o.Q,resolveResetStyleRules:()=>w.A,resolveStyleRules:()=>y.z,resolveStyleRulesForSlots:()=>u.T,safeInsertRule:()=>i.D,shorthands:()=>q,styleBucketOrdering:()=>g.If});var n=r(932224),o=r(844258),i=r(750159),a=r(515091),s=r(781703),l=r(524373),c=r(798362),u=r(698973),d=r(262772),f=r(361027),h=r(589431),p=r(898502),m=r(454640),g=r(155976),v=r(868534),b=r(826352),y=r(597954),w=r(132578),S=r(921464);let C=["Top","Right","Bottom","Left"];function I(e,t,...r){let[n,o=n,i=n,a=o]=r,s=[n,o,i,a],l={};for(let r=0;r<s.length;r+=1)(s[r]||0===s[r])&&(l[e+C[r]+t]=s[r]);return l}function k(...e){return I("border","Width",...e)}function E(...e){return I("border","Style",...e)}function _(...e){return I("border","Color",...e)}let A=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"];function T(e){return A.includes(e)}let P=e=>"string"==typeof e&&/(\d+(\w+|%))/.test(e),O=e=>"number"==typeof e&&!Number.isNaN(e),R=e=>"initial"===e,x=e=>"auto"===e,M=e=>"none"===e,N=["content","fit-content","max-content","min-content"],F=e=>N.some(t=>e===t)||P(e),L=/var\(.*\)/gi,z=/^[a-zA-Z0-9\-_\\#;]+$/,D=/^-moz-initial$|^auto$|^initial$|^inherit$|^revert$|^unset$|^span \d+$|^\d.*/;function B(e){return void 0!==e&&"string"==typeof e&&z.test(e)&&!D.test(e)}let U=["-moz-initial","inherit","initial","revert","unset"],H=["dashed","dotted","double","solid","wavy"],q={border:function(...e){return T(e[0])?Object.assign({},E(e[0]),e[1]&&k(e[1]),e[2]&&_(e[2])):Object.assign({},k(e[0]),e[1]&&E(e[1]),e[2]&&_(e[2]))},borderLeft:function(...e){return T(e[0])?Object.assign({borderLeftStyle:e[0]},e[1]&&{borderLeftWidth:e[1]},e[2]&&{borderLeftColor:e[2]}):Object.assign({borderLeftWidth:e[0]},e[1]&&{borderLeftStyle:e[1]},e[2]&&{borderLeftColor:e[2]})},borderBottom:function(...e){return T(e[0])?Object.assign({borderBottomStyle:e[0]},e[1]&&{borderBottomWidth:e[1]},e[2]&&{borderBottomColor:e[2]}):Object.assign({borderBottomWidth:e[0]},e[1]&&{borderBottomStyle:e[1]},e[2]&&{borderBottomColor:e[2]})},borderRight:function(...e){return T(e[0])?Object.assign({borderRightStyle:e[0]},e[1]&&{borderRightWidth:e[1]},e[2]&&{borderRightColor:e[2]}):Object.assign({borderRightWidth:e[0]},e[1]&&{borderRightStyle:e[1]},e[2]&&{borderRightColor:e[2]})},borderTop:function(...e){return T(e[0])?Object.assign({borderTopStyle:e[0]},e[1]&&{borderTopWidth:e[1]},e[2]&&{borderTopColor:e[2]}):Object.assign({borderTopWidth:e[0]},e[1]&&{borderTopStyle:e[1]},e[2]&&{borderTopColor:e[2]})},borderColor:_,borderStyle:E,borderRadius:function(e,t=e,r=e,n=t){return{borderBottomRightRadius:r,borderBottomLeftRadius:n,borderTopRightRadius:t,borderTopLeftRadius:e}},borderWidth:k,flex:function(...e){let t=1===e.length,r=2===e.length,n=3===e.length;if(t){let[t]=e;if(R(t))return{flexGrow:0,flexShrink:1,flexBasis:"auto"};if(x(t))return{flexGrow:1,flexShrink:1,flexBasis:"auto"};if(M(t))return{flexGrow:0,flexShrink:0,flexBasis:"auto"};if(O(t))return{flexGrow:t,flexShrink:1,flexBasis:0};if(F(t))return{flexGrow:1,flexShrink:1,flexBasis:t}}if(r){let[t,r]=e;if(O(r))return{flexGrow:t,flexShrink:r,flexBasis:0};if(F(r))return{flexGrow:t,flexShrink:1,flexBasis:r}}if(n){let[t,r,n]=e;if(O(t)&&O(r)&&(x(n)||F(n)))return{flexGrow:t,flexShrink:r,flexBasis:n}}return{}},gap:function(e,t=e){return{columnGap:e,rowGap:t}},gridArea:function(...e){if(e.some(e=>!(void 0===e||"number"==typeof e||"string"==typeof e&&!L.test(e))))return{};let t=void 0!==e[0]?e[0]:"auto",r=void 0!==e[1]?e[1]:B(t)?t:"auto",n=void 0!==e[2]?e[2]:B(t)?t:"auto",o=void 0!==e[3]?e[3]:B(r)?r:"auto";return{gridRowStart:t,gridColumnStart:r,gridRowEnd:n,gridColumnEnd:o}},margin:function(...e){return I("margin","",...e)},marginBlock:function(e,t=e){return{marginBlockStart:e,marginBlockEnd:t}},marginInline:function(e,t=e){return{marginInlineStart:e,marginInlineEnd:t}},padding:function(...e){return I("padding","",...e)},paddingBlock:function(e,t=e){return{paddingBlockStart:e,paddingBlockEnd:t}},paddingInline:function(e,t=e){return{paddingInlineStart:e,paddingInlineEnd:t}},overflow:function(e,t=e){return{overflowX:e,overflowY:t}},inset:function(...e){let[t,r=t,n=t,o=r]=e;return{top:t,right:r,bottom:n,left:o}},outline:function(e,t,r){return Object.assign({outlineWidth:e},t&&{outlineStyle:t},r&&{outlineColor:r})},transition:function(...e){return 1===e.length&&U.includes(e[0])?{transitionDelay:e[0],transitionDuration:e[0],transitionProperty:e[0],transitionTimingFunction:e[0]}:(1===e.length&&Array.isArray(e[0])?e[0]:[e]).reduce((e,[t,r="0s",n="0s",o="ease"],i)=>(0===i?(e.transitionProperty=t,e.transitionDuration=r,e.transitionDelay=n,e.transitionTimingFunction=o):(e.transitionProperty+=`, ${t}`,e.transitionDuration+=`, ${r}`,e.transitionDelay+=`, ${n}`,e.transitionTimingFunction+=`, ${o}`),e),{})},textDecoration:function(e,...t){if(0===t.length)return H.includes(e)?{textDecorationStyle:e}:{textDecorationLine:e};let[r,n,o]=t;return Object.assign({textDecorationLine:e},r&&{textDecorationStyle:r},n&&{textDecorationColor:n},o&&{textDecorationThickness:o})}}},472778:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=()=>{let e={};return function(t,r){void 0===e[t.id]&&(t.insertCSSRules(r),e[t.id]=!0)}}},798362:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});var n=r(472778),o=r(132578);function i(e,t=n.A){let r=t(),a=null,s=null,l=null;return function(t){let{dir:n,renderer:i}=t;return null===a&&([a,s,l]=(0,o.A)(e)),r(i,Array.isArray(l)?{r:l}:l),"ltr"===n?a:s||a}}},524373:(e,t,r)=>{"use strict";r.d(t,{P:()=>a});var n=r(472778),o=r(811381),i=r(806804);function a(e,t=n.A){let r=t(),s=Array.isArray(e)?e:[e];return function(e){r(e.renderer,{d:s.reduce((e,t)=>{if("string"==typeof t){for(let r of(0,o.K)(t,!1))e.push(r);return e}for(let r in t){let n=t[r],a=function(e,t){let r=`${e} {${(0,i.F)(t)}}`;return(0,o.K)(r,!1)[0]}(r,n);e.push(a)}return e},[])})}}},781703:(e,t,r)=>{"use strict";r.d(t,{n:()=>a});var n=r(472778),o=r(698973),i=r(826352);function a(e,t=n.A){let r=t(),s=null,l=null,c=null,u=null;return function(t){let{dir:n,renderer:a}=t;null===s&&([s,l]=(0,o.T)(e));let d="ltr"===n;return d?null===c&&(c=(0,i.N)(s,n)):null===u&&(u=(0,i.N)(s,n)),r(a,l),d?c:u}}},515091:(e,t,r)=>{"use strict";r.d(t,{z:()=>s});var n=r(921464),o=r(817177),i=r(826352);let a={};function s(){let e=null,t="",r="",s=Array(arguments.length);for(let e=0;e<arguments.length;e++){let o=arguments[e];if("string"==typeof o&&""!==o){let i=o.indexOf(n.fj);if(-1===i)t+=o+" ";else{let a=o.substr(i,n.wn);i>0&&(t+=o.slice(0,i)),r+=a,s[e]=a}}}if(""===r)return t.slice(0,-1);let l=a[r];if(void 0!==l)return t+l;let c=[];for(let t=0;t<arguments.length;t++){let r=s[t];if(r){let t=n.k1[r];t&&(c.push(t[n.FS]),e=t[n.AX])}}let u=Object.assign.apply(Object,[{}].concat(c)),[d,f]=(0,i.z)(u,e),h=(0,o.G)(f,e,s),p=h+" "+d;return a[r]=p,n.k1[h]=[u,e],t+p}},932224:(e,t,r)=>{"use strict";r.d(t,{I:()=>l,z:()=>s});var n=r(454640),o=r(155976),i=r(750159);let a=0,s=(e,t)=>e<t?-1:e>t?1:0;function l(e="undefined"==typeof document?void 0:document,t={}){let{unstable_filterCSSRule:r,insertionPoint:c,styleElementAttributes:u,compareMediaQueries:d=s}=t,f={insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(u),compareMediaQueries:d,id:`d${a++}`,insertCSSRules(t){for(let a in t){let s=t[a];for(let t=0,l=s.length;t<l;t++){let[l,u]=(0,n.$)(s[t]),d=(0,o.IH)(a,e,c||null,f,u);!f.insertionCache[l]&&(f.insertionCache[l]=a,r?r(l)&&(0,i.D)(d,l):(0,i.D)(d,l))}}}};return f}},100624:(e,t,r)=>{"use strict";r.d(t,{W:()=>o,Y:()=>i});var n=r(921464);function o(e,t,r,o){let i=[];if(o[n.ed]=t,o[n.EJ]=String(r),e)for(let t in o)e.setAttribute(t,o[t]);return{elementAttributes:o,insertRule:function(t){return null!=e&&e.sheet?e.sheet.insertRule(t,e.sheet.cssRules.length):i.push(t)},element:e,bucketName:t,cssRules:()=>null!=e&&e.sheet?Array.from(e.sheet.cssRules).map(e=>e.cssText):i}}function i(e){let t=Array.from(e.attributes).reduce((e,t)=>(e[t.name]=t.value,e),{});return o(e,t[n.ed],Number(t[n.EJ]),t)}},155976:(e,t,r)=>{"use strict";r.d(t,{AY:()=>s,IH:()=>c,If:()=>i,g_:()=>l});var n=r(921464),o=r(100624);let i=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"],a=i.reduce((e,t,r)=>(e[t]=r,e),{});function s(e,t,r){return("m"===e?e+t:e)+r}function l(e){var t;let r=e.getAttribute(n.ed),o=null!=(t=e.getAttribute(n.EJ))?t:"0";return s(r,e.media,o)}function c(e,t,r,i,l={}){var u,d;let f=null!=(u=l.m)?u:"0",h=null!=(d=l.p)?d:0,p=s(e,f,h);if(!i.stylesheets[p]){let s=t&&t.createElement("style"),c=(0,o.W)(s,e,h,Object.assign({},i.styleElementAttributes,"m"===e&&{media:f}));i.stylesheets[p]=c,t&&s&&t.head.insertBefore(s,function(e,t,r,o,i={}){var s,l;let c=a[r],u=null!=(s=i.m)?s:"",d=null!=(l=i.p)?l:0,f=e=>c-a[e.getAttribute(n.ed)],h=e.head.querySelectorAll(`[${n.ed}]`);if("m"===r){let t=e.head.querySelectorAll(`[${n.ed}="${r}"]`);t.length&&(h=t,f=e=>o.compareMediaQueries(u,e.media))}let p=e=>{var t,o;return r+(null!=(t=i.m)?t:"")===e.getAttribute(n.ed)+(null!=(o=e.media)?o:"")?d-Number(e.getAttribute("data-priority")):f(e)},m=h.length,g=m-1;for(;g>=0;){let e=h.item(g);if(p(e)>0)return e.nextSibling;g--}return m>0?h.item(0):t?t.nextSibling:null}(t,r,e,i,l))}return i.stylesheets[p]}},844258:(e,t,r)=>{"use strict";r.d(t,{Q:()=>l});var n=r(100624),o=r(155976);let i=/@(media|supports|layer)[^{]+\{([\s\S]+?})\s*}/g,a=/\.([^{:]+)(:[^{]+)?{(?:[^}]*;)?([^}]*?)}/g,s={k:/@(-webkit-)?keyframes ([^{]+){((?:(?:from|to|(?:\d+\.?\d*%))\{(?:[^}])*})*)}/g,t:i,m:i};function l(e,t="undefined"==typeof document?void 0:document){t&&t.querySelectorAll("[data-make-styles-bucket]").forEach(t=>{let r;let i=t.dataset.makeStylesBucket,l=(0,o.g_)(t);e.stylesheets[l]||(e.stylesheets[l]=(0,n.Y)(t));let c=s[i]||a;for(;r=c.exec(t.textContent);){let[t]=r;e.insertionCache[t]=i}})}},750159:(e,t,r)=>{"use strict";function n(e,t){try{e.insertRule(t)}catch(e){}}r.d(t,{D:()=>n})},698973:(e,t,r)=>{"use strict";r.d(t,{T:()=>o});var n=r(597954);function o(e){let t={},r={};for(let o in e){let i=e[o],[a,s]=(0,n.z)(i);t[o]=a,Object.keys(s).forEach(e=>{r[e]=(r[e]||[]).concat(s[e])})}return[t,r]}},106851:(e,t,r)=>{"use strict";r.d(t,{B:()=>s,K:()=>c});var n=r(267357),o=r(169189),i=r(811381);let a=/,( *[^ &])/g;function s(e){return"&"+(0,o.o)(e.replace(a,",&$1"))}function l(e,t,r){let n=t;return r.length>0&&(n=r.reduceRight((e,t)=>`${s(t)} { ${e} }`,t)),`${e}{${n}}`}function c(e){let{className:t,media:r,layer:o,selectors:a,support:s,property:c,rtlClassName:u,rtlProperty:d,rtlValue:f,value:h,container:p}=e,m=l(`.${t}`,Array.isArray(h)?`${h.map(e=>`${(0,n.a)(c)}: ${e}`).join(";")};`:`${(0,n.a)(c)}: ${h};`,a);return d&&u&&(m+=l(`.${u}`,Array.isArray(f)?`${f.map(e=>`${(0,n.a)(d)}: ${e}`).join(";")};`:`${(0,n.a)(d)}: ${f};`,a)),r&&(m=`@media ${r} { ${m} }`),o&&(m=`@layer ${o} { ${m} }`),s&&(m=`@supports ${s} { ${m} }`),p&&(m=`@container ${p} { ${m} }`),(0,i.K)(m,!0)}},811381:(e,t,r)=>{"use strict";r.d(t,{K:()=>u});var n=r(956463),o=r(260496),i=r(991707),a=r(984929),s=r(415645),l=r(763507);function c(){}function u(e,t){let r=[];return(0,n.l)((0,o.wE)(e),(0,i.r1)([a.t,t?l.R:c,s.j,n.A,(0,i.MY)(e=>r.push(e))])),r}},247410:(e,t,r)=>{"use strict";r.d(t,{W:()=>l,c:()=>c});var n=r(956463),o=r(260496),i=r(991707),a=r(415645),s=r(806804);function l(e){let t="";for(let r in e)t+=`${r}{${(0,s.F)(e[r])}}`;return t}function c(e,t){let r=`@keyframes ${e} {${t}}`,s=[];return(0,n.l)((0,o.wE)(r),(0,i.r1)([n.A,a.j,(0,i.MY)(e=>s.push(e))])),s}},868534:(e,t,r)=>{"use strict";r.d(t,{x:()=>o});let n={"us-w":"w","us-v":"i",nk:"l",si:"v",cu:"f",ve:"h",ti:"a"};function o(e,t,r,o,i){if(r)return"m";if(t||o)return"t";if(i)return"c";if(e.length>0){let t=e[0].trim();if(58===t.charCodeAt(0))return n[t.slice(4,8)]||n[t.slice(3,5)]||"d"}return"d"}},826352:(e,t,r)=>{"use strict";r.d(t,{N:()=>a,z:()=>i});var n=r(921464),o=r(817177);function i(e,t){let r="",n="";for(let o in e){let i=e[o];if(0===i){n+=o+" ";continue}let a=Array.isArray(i),s="rtl"===t?(a?i[1]:i)+" ":(a?i[0]:i)+" ";r+=s,n+=s}return[r.slice(0,-1),n.slice(0,-1)]}function a(e,t){let r={};for(let a in e){let[s,l]=i(e[a],t);if(""===l){r[a]="";continue}let c=(0,o.G)(l,t),u=c+(""===s?"":" "+s);n.k1[c]=[e[a],t],r[a]=u}return r}},132578:(e,t,r)=>{"use strict";r.d(t,{A:()=>I});var n=r(373319),o=r(418569),i=r(921464),a=r(846161),s=r(174080),l=r(181122),c=r(121240),u=r(72707),d=r(267357),f=r(106851),h=r(956463),p=r(260496),m=r(991707),g=r(984929),v=r(769338),b=r(415645);function y(e){var t;let r=[],n=[];return(0,h.l)((0,p.wE)(e),(0,m.r1)([g.t,b.j,h.A,(t=(e,t)=>{if((0,v.q)(e)){n.push(t);return}r.push(t)},function(e){!e.root&&e.return&&t(e,e.return)})])),[r,n]}var w=r(247410),S=r(879320),C=r(109968);function I(e){let[t,r]=function e(t){let r="",h="";for(let p in t){let m=t[p];if(null!=m){if("string"==typeof m||"number"==typeof m){let{key:e,value:t}=(0,o.dG)(p,m);r+=`${(0,d.a)(p)}:${m};`,h+=`${(0,d.a)(e)}:${t};`;continue}if("animationName"===p&&"object"==typeof m){let e=Array.isArray(m)?m:[m],t=[],a=[];for(let s of e){let e=(0,w.W)(s),l=(0,w.W)((0,o.C6)(s)),c=i.Eo+(0,n.A)(e),u=i.Eo+(0,n.A)(l);t.push(c),a.push(u),r+=(0,w.c)(c,e).join(""),c!==u&&(h+=(0,w.c)(u,l).join(""))}r+=`animation-name:${t.join(",")};`,h+=`animation-name:${a.join(",")};`;continue}if(Array.isArray(m)){if(0===m.length)continue;let e=m.map(e=>(0,o.dG)(p,e));if(e.some(t=>t.key!==e[0].key))continue;let t=e[0].key;r+=m.map(e=>`${(0,d.a)(p)}:${e};`).join(""),h+=e.map(e=>`${(0,d.a)(t)}:${e.value};`).join("");continue}if((0,u.G)(m)){if((0,l.B)(p)){let t=(0,f.B)(p),[n,o]=e(m);r+=`${t}{${n}}`,h+=`${t}{${o}}`;continue}if((0,a.k)(p)||(0,s.L)(p)||(0,c.n)(p)||(0,S.z)(p)){let[t,n]=e(m);r+=`${p}{${t}}`,h+=`${p}{${n}}`;continue}}(0,C.B)(p,m)}}return[r,h]}(e),h=i.Eo+(0,n.A)(t),[p,m]=y(`.${h}{${t}}`),g=m.length>0;if(t===r)return[h,null,g?{r:p,s:m}:p];let v=i.Eo+(0,n.A)(r),[b,I]=y(`.${v}{${r}}`);return[h,v,g?{r:p.concat(b),s:m.concat(I)}:p.concat(b)]}},597954:(e,t,r)=>{"use strict";r.d(t,{z:()=>function e(t,r=[],E="",A="",T="",P="",O={},R={},x){for(let N in t){var M;if(i.qw.hasOwnProperty(N)){(0,C.E)(N,t[N]);continue}let F=t[N];if(null!=F){if((0,y.D)(F)){let e=(0,w.c)(r.join(""));M=void 0,O[(0,b.X)(e,P,E,T,N)]=M?[0,M]:0;continue}if("string"==typeof F||"number"==typeof F){let t=(0,w.c)(r.join("")),n=I.P[N];n&&e(Object.fromEntries(n[1].map(e=>[e,i.Ut])),r,E,A,T,P,O,R);let s=(0,b.X)(t,P,E,T,N),l=(0,v.E)({container:P,media:E,layer:A,value:F.toString(),support:T,selector:t,property:N}),c=x&&{key:N,value:x}||(0,o.dG)(N,F),u=c.key!==N||c.value!==F,d=u?(0,v.E)({container:P,value:c.value.toString(),property:c.key,selector:t,media:E,layer:A,support:T}):void 0,f=u?{rtlClassName:d,rtlProperty:c.key,rtlValue:c.value}:void 0,h=(0,g.x)(r,A,E,T,P),[p,m]=(0,a.K)(Object.assign({className:l,media:E,layer:A,selectors:r,property:N,support:T,container:P,value:F},f));O[s]=d?[l,d]:l,_(R,h,p,m,E,k(n))}else if("animationName"===N){let t=Array.isArray(F)?F:[F],a=[],l=[];for(let e of t){let t;let r=(0,s.W)(e),c=(0,s.W)((0,o.C6)(e)),u=i.aN+(0,n.A)(r),d=(0,s.c)(u,r),f=[];r===c?t=u:(t=i.aN+(0,n.A)(c),f=(0,s.c)(t,c));for(let e=0;e<d.length;e++)_(R,"k",d[e],f[e],E,0);a.push(u),l.push(t)}e({animationName:a.join(", ")},r,E,A,T,P,O,R,l.join(", "))}else if(Array.isArray(F)){if(0===F.length)continue;let t=(0,w.c)(r.join("")),n=I.P[N];n&&e(Object.fromEntries(n[1].map(e=>[e,i.Ut])),r,E,A,T,P,O,R);let s=(0,b.X)(t,P,E,T,N),l=(0,v.E)({container:P,media:E,layer:A,value:F.map(e=>(null!=e?e:"").toString()).join(";"),support:T,selector:t,property:N}),c=F.map(e=>(0,o.dG)(N,e));if(c.some(e=>e.key!==c[0].key))continue;let u=c[0].key!==N||c.some((e,t)=>e.value!==F[t]),d=u?(0,v.E)({container:P,value:c.map(e=>{var t;return(null!=(t=null==e?void 0:e.value)?t:"").toString()}).join(";"),property:c[0].key,selector:t,layer:A,media:E,support:T}):void 0,f=u?{rtlClassName:d,rtlProperty:c[0].key,rtlValue:c.map(e=>e.value)}:void 0,h=(0,g.x)(r,A,E,T,P),[p,m]=(0,a.K)(Object.assign({className:l,media:E,layer:A,selectors:r,property:N,support:T,container:P,value:F},f));O[s]=d?[l,d]:l,_(R,h,p,m,E,k(n))}else(0,m.G)(F)&&((0,d.B)(N)?e(F,r.concat((0,p.o)(N)),E,A,T,P,O,R):(0,c.k)(N)?e(F,r,(0,l.z)(E,N.slice(6).trim()),A,T,P,O,R):(0,u.L)(N)?e(F,r,E,(A?`${A}.`:"")+N.slice(6).trim(),T,P,O,R):(0,f.n)(N)?e(F,r,E,A,(0,l.z)(T,N.slice(9).trim()),P,O,R):(0,h.z)(N)?e(F,r,E,A,T,N.slice(10).trim(),O,R):(0,S.B)(N,F))}}return[O,R]}});var n=r(373319),o=r(418569),i=r(921464),a=r(106851),s=r(247410),l=r(612012),c=r(846161),u=r(174080),d=r(181122),f=r(121240),h=r(879320),p=r(169189),m=r(72707),g=r(868534),v=r(348131),b=r(888368),y=r(929340),w=r(994969),S=r(109968),C=r(267409),I=r(877378);function k(e){var t;return null!=(t=null==e?void 0:e[0])?t:0}function E(e,t){return t.length>0?[e,Object.fromEntries(t)]:e}function _(e,t,r,n,o,i){let a=[];0!==i&&a.push(["p",i]),"m"===t&&o&&a.push(["m",o]),null!=e[t]||(e[t]=[]),r&&e[t].push(E(r,a)),n&&e[t].push(E(n,a))}},877378:(e,t,r)=>{"use strict";r.d(t,{P:()=>n});let n={animation:[-1,["animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimeline","animationTimingFunction"]],animationRange:[-1,["animationRangeEnd","animationRangeStart"]],background:[-2,["backgroundAttachment","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPosition","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundSize"]],backgroundPosition:[-1,["backgroundPositionX","backgroundPositionY"]],border:[-2,["borderBottom","borderBottomColor","borderBottomStyle","borderBottomWidth","borderLeft","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRight","borderRightColor","borderRightStyle","borderRightWidth","borderTop","borderTopColor","borderTopStyle","borderTopWidth"]],borderBottom:[-1,["borderBottomColor","borderBottomStyle","borderBottomWidth"]],borderImage:[-1,["borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth"]],borderLeft:[-1,["borderLeftColor","borderLeftStyle","borderLeftWidth"]],borderRadius:[-1,["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"]],borderRight:[-1,["borderRightColor","borderRightStyle","borderRightWidth"]],borderTop:[-1,["borderTopColor","borderTopStyle","borderTopWidth"]],caret:[-1,["caretColor","caretShape"]],columnRule:[-1,["columnRuleColor","columnRuleStyle","columnRuleWidth"]],columns:[-1,["columnCount","columnWidth"]],containIntrinsicSize:[-1,["containIntrinsicHeight","containIntrinsicWidth"]],container:[-1,["containerName","containerType"]],flex:[-1,["flexBasis","flexGrow","flexShrink"]],flexFlow:[-1,["flexDirection","flexWrap"]],font:[-1,["fontFamily","fontSize","fontStretch","fontStyle","fontVariant","fontWeight","lineHeight"]],gap:[-1,["columnGap","rowGap"]],grid:[-1,["columnGap","gridAutoColumns","gridAutoFlow","gridAutoRows","gridColumnGap","gridRowGap","gridTemplateAreas","gridTemplateColumns","gridTemplateRows","rowGap"]],gridArea:[-1,["gridColumnEnd","gridColumnStart","gridRowEnd","gridRowStart"]],gridColumn:[-1,["gridColumnEnd","gridColumnStart"]],gridRow:[-1,["gridRowEnd","gridRowStart"]],gridTemplate:[-1,["gridTemplateAreas","gridTemplateColumns","gridTemplateRows"]],inset:[-1,["bottom","left","right","top"]],insetBlock:[-1,["insetBlockEnd","insetBlockStart"]],insetInline:[-1,["insetInlineEnd","insetInlineStart"]],listStyle:[-1,["listStyleImage","listStylePosition","listStyleType"]],margin:[-1,["marginBottom","marginLeft","marginRight","marginTop"]],marginBlock:[-1,["marginBlockEnd","marginBlockStart"]],marginInline:[-1,["marginInlineEnd","marginInlineStart"]],mask:[-1,["maskClip","maskComposite","maskImage","maskMode","maskOrigin","maskPosition","maskRepeat","maskSize"]],maskBorder:[-1,["maskBorderMode","maskBorderOutset","maskBorderRepeat","maskBorderSlice","maskBorderSource","maskBorderWidth"]],offset:[-1,["offsetAnchor","offsetDistance","offsetPath","offsetPosition","offsetRotate"]],outline:[-1,["outlineColor","outlineStyle","outlineWidth"]],overflow:[-1,["overflowX","overflowY"]],overscrollBehavior:[-1,["overscrollBehaviorX","overscrollBehaviorY"]],padding:[-1,["paddingBottom","paddingLeft","paddingRight","paddingTop"]],paddingBlock:[-1,["paddingBlockEnd","paddingBlockStart"]],paddingInline:[-1,["paddingInlineEnd","paddingInlineStart"]],placeContent:[-1,["alignContent","justifyContent"]],placeItems:[-1,["alignItems","justifyItems"]],placeSelf:[-1,["alignSelf","justifySelf"]],scrollMargin:[-1,["scrollMarginBottom","scrollMarginLeft","scrollMarginRight","scrollMarginTop"]],scrollMarginBlock:[-1,["scrollMarginBlockEnd","scrollMarginBlockStart"]],scrollMarginInline:[-1,["scrollMarginInlineEnd","scrollMarginInlineStart"]],scrollPadding:[-1,["scrollPaddingBottom","scrollPaddingLeft","scrollPaddingRight","scrollPaddingTop"]],scrollPaddingBlock:[-1,["scrollPaddingBlockEnd","scrollPaddingBlockStart"]],scrollPaddingInline:[-1,["scrollPaddingInlineEnd","scrollPaddingInlineStart"]],scrollTimeline:[-1,["scrollTimelineAxis","scrollTimelineName"]],textDecoration:[-1,["textDecorationColor","textDecorationLine","textDecorationStyle","textDecorationThickness"]],textEmphasis:[-1,["textEmphasisColor","textEmphasisStyle"]],transition:[-1,["transitionBehavior","transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction"]],viewTimeline:[-1,["viewTimelineAxis","viewTimelineName"]]}},984929:(e,t,r)=>{"use strict";r.d(t,{t:()=>i});var n=r(917674),o=r(620682);let i=e=>{e.type===n.XZ&&"string"!=typeof e.props&&(e.props=e.props.map(e=>-1===e.indexOf(":global(")?e:(0,o.qw)(e).reduce((e,t,r,n)=>{if(""===t)return e;if(":"===t&&"global"===n[r+1]){let t=n[r+2].slice(1,-1)+" ";return e.unshift(t),n[r+1]="",n[r+2]="",e}return e.push(t),e},[]).join("")))}},769338:(e,t,r)=>{"use strict";r.d(t,{q:()=>o});var n=r(917674);function o(e){switch(e.type){case"@container":case n.Rn:case n.$1:case n.IO:return!0}return!1}},415645:(e,t,r)=>{"use strict";r.d(t,{j:()=>s});var n=r(923203),o=r(917674),i=r(956463),a=r(620682);function s(e,t,r,s){if(e.length>-1&&!e.return)switch(e.type){case o.LU:e.return=function e(t,r,i){switch((0,n.tW)(t,r)){case 5103:return o.j+"print-"+t+t;case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:return o.j+t+t;case 4215:if(102===(0,n.wN)(t,9)||116===(0,n.wN)(t,r+1))return o.j+t+t;break;case 4789:return o.vd+t+t;case 5349:case 4246:case 6968:return o.j+t+o.vd+t+t;case 6187:if(!(0,n.YW)(t,/grab/))return(0,n.HC)((0,n.HC)((0,n.HC)(t,/(zoom-|grab)/,o.j+"$1"),/(image-set)/,o.j+"$1"),t,"")+t;case 5495:case 3959:return(0,n.HC)(t,/(image-set\([^]*)/,o.j+"$1$`$1");case 4095:case 3583:case 4068:case 2532:return(0,n.HC)(t,/(.+)-inline(.+)/,o.j+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if((0,n.b2)(t)-1-r>6)switch((0,n.wN)(t,r+1)){case 102:if(108===(0,n.wN)(t,r+3))return(0,n.HC)(t,/(.+:)(.+)-([^]+)/,"$1"+o.j+"$2-$3$1"+o.vd+(108==(0,n.wN)(t,r+3)?"$3":"$2-$3"))+t;case 115:return~(0,n.K5)(t,"stretch")?e((0,n.HC)(t,"stretch","fill-available"),r)+t:t}}return t}(e.value,e.length);break;case o.XZ:if(e.length)return(0,n.kg)(e.props,function(t){switch((0,n.YW)(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return(0,i.l)([(0,a.C)(e,{props:[(0,n.HC)(t,/:(read-\w+)/,":"+o.vd+"$1")]})],s);case"::placeholder":return(0,i.l)([(0,a.C)(e,{props:[(0,n.HC)(t,/:(plac\w+)/,":"+o.j+"input-$1")]}),(0,a.C)(e,{props:[(0,n.HC)(t,/:(plac\w+)/,":"+o.vd+"$1")]})],s)}return""})}}},763507:(e,t,r)=>{"use strict";r.d(t,{R:()=>o});var n=r(769338);let o=e=>{(0,n.q)(e)&&Array.isArray(e.children)&&e.children.sort((e,t)=>e.props[0]>t.props[0]?1:-1)}},806804:(e,t,r)=>{"use strict";r.d(t,{F:()=>o});var n=r(267357);function o(e){let t="";for(let r in e){let o=e[r];("string"==typeof o||"number"==typeof o)&&(t+=(0,n.a)(r)+":"+o+";")}return t}},612012:(e,t,r)=>{"use strict";function n(e,t){return 0===e.length?t:`${e} and ${t}`}r.d(t,{z:()=>n})},348131:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});var n=r(373319),o=r(921464);function i({container:e,media:t,layer:r,property:i,selector:a,support:s,value:l}){let c=(0,n.A)(a+e+t+r+s+i+l.trim());return o.aN+c}},888368:(e,t,r)=>{"use strict";r.d(t,{X:()=>o});var n=r(373319);function o(e,t,r,o,i){let a=(0,n.A)(e+t+r+o+i),s=a.charCodeAt(0);return s>=48&&s<=57?String.fromCharCode(s+17)+a.slice(1):a}},817177:(e,t,r)=>{"use strict";r.d(t,{G:()=>i});var n=r(373319),o=r(921464);function i(e,t,r=[]){return o.fj+function(e){let t=e.length;if(t===o.ez)return e;for(let r=t;r<o.ez;r++)e+="0";return e}((0,n.A)(e+t))}},267357:(e,t,r)=>{"use strict";r.d(t,{a:()=>s});let n=/[A-Z]/g,o=/^ms-/,i={};function a(e){return"-"+e.toLowerCase()}function s(e){if(Object.prototype.hasOwnProperty.call(i,e))return i[e];if("--"===e.substr(0,2))return e;let t=e.replace(n,a);return i[e]=o.test(t)?"-"+t:t}},879320:(e,t,r)=>{"use strict";function n(e){return"@container"===e.substring(0,10)}r.d(t,{z:()=>n})},174080:(e,t,r)=>{"use strict";function n(e){return"@layer"===e.substr(0,6)}r.d(t,{L:()=>n})},846161:(e,t,r)=>{"use strict";function n(e){return"@media"===e.substr(0,6)}r.d(t,{k:()=>n})},181122:(e,t,r)=>{"use strict";r.d(t,{B:()=>o});let n=/^(:|\[|>|&)/;function o(e){return n.test(e)}},72707:(e,t,r)=>{"use strict";function n(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}r.d(t,{G:()=>n})},929340:(e,t,r)=>{"use strict";r.d(t,{D:()=>o});var n=r(921464);function o(e){return e===n.Ut}},121240:(e,t,r)=>{"use strict";function n(e){return"@supports"===e.substr(0,9)}r.d(t,{n:()=>n})},454640:(e,t,r)=>{"use strict";function n(e){return Array.isArray(e)?e:[e]}r.d(t,{$:()=>n})},169189:(e,t,r)=>{"use strict";function n(e){return"&"===e.charAt(0)?e.slice(1):e}r.d(t,{o:()=>n})},994969:(e,t,r)=>{"use strict";function n(e){return e.replace(/>\s+/g,">")}r.d(t,{c:()=>n})},978004:(e,t,r)=>{"use strict";function n(...e){}r.d(t,{v:()=>n})},109968:(e,t,r)=>{"use strict";r.d(t,{B:()=>o});var n=r(978004);function o(e,t){let r=JSON.stringify(t,null,2),o=["@griffel/react: A rule was not resolved to CSS properly. Please check your `makeStyles` or `makeResetStyles` calls for following:"," ".repeat(2)+"makeStyles({"," ".repeat(4)+"[slot]: {"," ".repeat(6)+`"${e}": ${r.split("\n").map((e,t)=>" ".repeat(0===t?0:6)+e).join("\n")}`," ".repeat(4)+"}"," ".repeat(2)+"})",""];-1===e.indexOf("&")?(o.push("It looks that you're are using a nested selector, but it is missing an ampersand placeholder where the generated class name should be injected."),o.push(`Try to update a property to include it i.e "${e}" => "&${e}".`)):(o.push(""),o.push("If it's not obvious what triggers a problem, please report an issue at https://github.com/microsoft/griffel/issues")),(0,n.v)(o.join("\n"))}},267409:(e,t,r)=>{"use strict";r.d(t,{E:()=>o});var n=r(978004);function o(e,t){(0,n.v)([`@griffel/react: You are using unsupported shorthand CSS property "${e}". Please check your "makeStyles" calls, there *should not* be following:`," ".repeat(2)+"makeStyles({"," ".repeat(4)+`[slot]: { ${e}: "${t}" }`," ".repeat(2)+"})","","Learn why CSS shorthands are not supported: https://aka.ms/griffel-css-shorthands"].join("\n"))}},703025:(e,t,r)=>{"use strict";r.d(t,{H:()=>l,J:()=>c});var n=r(932224),o=r(844258),i=r(603722),a=r(126422);let s=i.createContext((0,n.I)()),l=({children:e,renderer:t,targetDocument:r})=>((0,a.S)()&&i.useMemo(()=>{(0,o.Q)(t,r)},[t,r]),i.createElement(s.Provider,{value:t},e));function c(){return i.useContext(s)}},656470:(e,t,r)=>{"use strict";r.d(t,{e:()=>i,m:()=>a});var n=r(603722);let o=n.createContext("ltr"),i=({children:e,dir:t})=>n.createElement(o.Provider,{value:t},e);function a(){return n.useContext(o)}},964256:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(126422),o=r(93952);let i=()=>{let e={};return function(t,r){if(o.I&&(0,n.S)()){(0,o.I)(()=>{t.insertCSSRules(r)},[t,r]);return}void 0===e[t.id]&&(t.insertCSSRules(r),e[t.id]=!0)}}},932501:(e,t,r)=>{"use strict";r.d(t,{n:()=>s});var n=r(781703),o=r(964256),i=r(703025),a=r(656470);function s(e){let t=(0,n.n)(e,o.A);return function(){return t({dir:(0,a.m)(),renderer:(0,i.J)()})}}},93952:(e,t,r)=>{"use strict";r.d(t,{I:()=>i});var n,o=r(603722);let i=(n||(n=r.t(o,2))).useInsertionEffect?(n||(n=r.t(o,2))).useInsertionEffect:void 0},126422:(e,t,r)=>{"use strict";function n(){return"undefined"!=typeof window&&!!(window.document&&window.document.createElement)}r.d(t,{S:()=>n})},646235:(e,t,r)=>{"use strict";r.d(t,{a:()=>$});var n,o=r(647759),i="prototype",a=Object;a[i],((0,o.mS$)()||{}).Symbol,((0,o.mS$)()||{}).Reflect;var s=function(e,t){return(s=a.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},l="constructor",c="prototype",u="function",d="_dynInstFuncs",f="_isDynProxy",h="_dynClass",p="_dynInstChk",m="_dfOpts",g="_unknown_",v="__proto__",b="_dyn"+v,y="__dynProto$Gbl",w="_dynInstProto",S="useBaseInst",C="setInstFuncs",I=Object,k=I.getPrototypeOf,E=I.getOwnPropertyNames,_=(0,o.mS$)(),A=_[y]||(_[y]={o:((n={})[C]=!0,n[S]=!0,n),n:1e3});function T(e){return e&&(e===I[c]||e===Array[c])}function P(e){return T(e)||e===Function[c]}function O(e){var t;if(e){if(k)return k(e);var r=e[v]||e[c]||(e[l]?e[l][c]:null);t=e[b]||r,(0,o.v0u)(e,b)||(delete e[w],t=e[b]=e[w]||e[b],e[w]=r)}return t}function R(e,t){var r=[];if(E)r=E(e);else for(var n in e)"string"==typeof n&&(0,o.v0u)(e,n)&&r.push(n);if(r&&r.length>0)for(var i=0;i<r.length;i++)t(r[i])}function x(e,t,r){return t!==l&&typeof e[t]===u&&(r||(0,o.v0u)(e,t))&&t!==v&&t!==c}function M(e){(0,o.zkd)("DynamicProto: "+e)}function N(e,t){for(var r=e.length-1;r>=0;r--)if(e[r]===t)return!0;return!1}function F(e,t){return(0,o.v0u)(e,c)?e.name||t||g:((e||{})[l]||{}).name||t||g}function L(e,t,r,n){(0,o.v0u)(e,c)||M("theClass is an invalid class definition.");var i,a=e[c];!function(e,t){if(k){for(var r=[],n=O(t);n&&!P(n)&&!N(r,n);){if(n===e)return!0;r.push(n),n=O(n)}return!1}return!0}(a,t)&&M("["+F(e)+"] not in hierarchy of ["+F(t)+"]");var s=null;(0,o.v0u)(a,h)?s=a[h]:(s="_dynCls$"+F(e,"_")+"$"+A.n,A.n++,a[h]=s);var l=L[m],g=!!l[S];g&&n&&void 0!==n[S]&&(g=!!n[S]);var v=(i=(0,o.sSX)(null),R(t,function(e){!i[e]&&x(t,e,!1)&&(i[e]=t[e])}),i),b=function(e,t,r,n){function i(e,t,r){var o=t[r];if(o[f]&&n){var i=e[d]||{};!1!==i[p]&&(o=(i[t[h]]||{})[r]||o)}return function(){return o.apply(e,arguments)}}var a=(0,o.sSX)(null);R(r,function(e){a[e]=i(t,r,e)});for(var s=O(e),l=[];s&&!P(s)&&!N(l,s);)R(s,function(e){!a[e]&&x(s,e,!k)&&(a[e]=i(t,s,e))}),l.push(s),s=O(s);return a}(a,t,v,g);r(t,b);var y=!!k&&!!l[C];y&&n&&(y=!!n[C]),function(e,t,r,n,i){if(!T(e)){var a=r[d]=r[d]||(0,o.sSX)(null);if(!T(a)){var s=a[t]=a[t]||(0,o.sSX)(null);!1!==a[p]&&(a[p]=!!i),T(s)||R(r,function(t){if(x(r,t,!1)&&r[t]!==n[t]&&(s[t]=r[t],delete r[t],!(0,o.v0u)(e,t)||e[t]&&!e[t][f])){var i;e[t]=((i=function(){var r,n;return((function(e,t,r,n){var i=null;if(e&&(0,o.v0u)(r,h)){var a=e[d]||(0,o.sSX)(null);if((i=(a[r[h]]||(0,o.sSX)(null))[t])||M("Missing ["+t+"] "+u),!i[p]&&!1!==a[p]){for(var s=!(0,o.v0u)(e,t),l=O(e),c=[];s&&l&&!P(l)&&!N(c,l);){var f=l[t];if(f){s=f===n;break}c.push(l),l=O(l)}try{s&&(e[t]=i),i[p]=1}catch(e){a[p]=!1}}}return i})(this,t,e,i)||(r=i,(n=e[t])===r&&(n=O(e)[t]),typeof n!==u&&M("["+t+"] is not a "+u),n)).apply(this,arguments)})[f]=1,i)}})}}}(a,s,t,v,!1!==y)}L[m]=A.o;var z=r(739426),D=r(874314),B=r(867073),U=r(106784),H=r(736529),q=r(575432),j=(0,o.ZHX)({cookieCfg:{ref:!0,v:{}},extensions:{rdOnly:!0,ref:!0,v:[]},channels:{rdOnly:!0,ref:!0,v:[]},extensionConfig:{ref:!0,v:{}}}),$=function(e){function t(){var r,n,i=e.call(this)||this;return L(t,i,function(e,t){e.initialize=function(e,a){(0,z.r2)(i,function(){return"ApplicationInsights:initialize"},function(){e=(0,D.e)(e,j,i.logger,!1).cfg,r=new H.s;var s=[n=new q.H];a&&(s=s.concat(a)),e||(0,o.$8)("You must provide a config object!");var l=e.channels;if(l&&l.length>0){for(var c=!1,u=0;u<l[0].length;u++)if(l[0][u].identifier===r.identifier){c=!0;break}c||(0,o.Yny)(l[0],r)}else e.channels.push([r]);var d=e.extensionConfig;d[r.identifier]=d[r.identifier]||e&&e.channelConfiguration||{},d[n.identifier]=d[n.identifier]||e&&e.propertyConfiguration||{};try{t.initialize(e,s),i.isInitialized()&&(0,o.lKJ)(e,{channelConfiguration:{g:function(){return e.extensionConfig[r.identifier]}},propertyConfiguration:{g:function(){return e.extensionConfig[n.identifier]}}})}catch(e){(0,B.ZP)(i.logger,1,514,"Failed to initialize SDK."+(0,o.mmD)(e))}},function(){return{config:e,extensions:a}})},e.getPropertyManager=function(){return n},e.getPostChannel=function(){return r}}),i}return function(e,t){function r(){this.constructor=e}"function"!=typeof t&&null!==t&&(0,o.zkd)("Class extends value "+String(t)+" is not a constructor or null"),s(e,t),e[i]=null===t?(0,o.sSX)(t):(r[i]=t[i],new r)}(t,e),t.__ieDyn=1,t}(U._)},106784:(e,t,r)=>{"use strict";r.d(t,{_:()=>p});var n=r(877864),o=r(346036),i=r(647759),a=r(739426),s=r(874314),l=r(867073),c=r(67345),u=r(742431),d=r(341436),f=r(377137),h=(0,i.ZHX)({endpointUrl:u.S,propertyStorageOverride:{isVal:function(e){return!e||e.getProperty&&e.setProperty||(0,i.$8)("Invalid property storage override passed."),!0}}}),p=function(e){function t(){var r=e.call(this)||this;return(0,o.A)(t,r,function(e,t){e[f.mE]=function(r,n,o,c){(0,a.r2)(e,function(){return"AppInsightsCore.initialize"},function(){try{t[f.mE]((0,s.e)(r,h,o||e[f.Uw],!1).cfg,n,o,c)}catch(t){var a=e[f.Uw],u=(0,i.mmD)(t);-1!==u[f.Sj]("channels")&&(u+="\n - Channels must be provided through config.channels only!"),(0,l.ZP)(a,1,514,"SDK Initialization Failed - no telemetry will be sent: "+u)}},function(){return{config:r,extensions:n,logger:o,notificationManager:c}})},e.track=function(r){(0,a.r2)(e,function(){return"AppInsightsCore.track"},function(){if(r){r[f.dg]=r[f.dg]||{},r[f.dg].trackStart=(0,d.WB)(),(0,d.Hh)(r.latency)||(r.latency=1);var n=r.ext=r.ext||{};n.sdk=n.sdk||{},n.sdk.ver=d.xE;var o=r.baseData=r.baseData||{};o[u._0]=o[u._0]||{};var i=o[u._0];i[u.hj]=i[u.hj]||e.pluginVersionString||u.m5}t.track(r)},function(){return{item:r}},!r.sync)},e[f.h4]=function(e){return t[f.h4](e||"InternalLog")}}),r}return(0,n.qU)(t,e),t.__ieDyn=1,t}(c._)},742431:(e,t,r)=>{"use strict";r.d(t,{S:()=>o,_0:()=>a,hj:()=>i,m5:()=>n});var n="",o="https://browser.events.data.microsoft.com/OneCollector/1.0/",i="version",a="properties"},341436:(e,t,r)=>{"use strict";r.d(t,{EO:()=>h,F2:()=>S,Go:()=>g,Hh:()=>p,TC:()=>m,UM:()=>v,WB:()=>y,X$:()=>function e(t,r,n,i,a){var s={},c=!1,u=0,d=arguments[l.oI],f=arguments;for((0,o.Lmq)(f[0])&&(c=f[0],u++);u<d;u++){var t=f[u];(0,o.zav)(t,function(t,r){c&&r&&(0,o.Gvm)(r)?(0,o.cyL)(r)?(s[t]=s[t]||[],(0,o.Iuo)(r,function(r,n){r&&(0,o.Gvm)(r)?s[t][n]=e(!0,s[t][n],r):s[t][n]=r})):s[t]=e(!0,s[t],r):s[t]=r})}return s},ei:()=>C,gj:()=>b,u9:()=>w,xE:()=>c,yD:()=>f});var n,o=r(647759),i=r(235468),a=r(590521),s=r(742431),l=r(377137),c="1DS-Web-JS-4.3.0",u=a.Wy.hasOwnProperty,d=((n={})[0]=0,n[2]=6,n[1]=1,n[3]=7,n[4098]=6,n[4097]=1,n[4099]=7,n);function f(e){return!(e===s.m5||(0,o.hXl)(e))}function h(e){if(e){var t=(0,o.HzD)(e,"-");if(t>-1)return(0,o.ZWZ)(e,t)}return s.m5}function p(e){return!!(e&&(0,o.EtT)(e))&&e>=1&&e<=4}function m(e,t,r){if(!t&&!f(t)||"string"!=typeof e)return null;var n,i=typeof t;if("string"===i||"number"===i||"boolean"===i||(0,o.cyL)(t))t={value:t};else if("object"!==i||u.call(t,"value")){if((0,o.hXl)(t[l.pF])||t[l.pF]===s.m5||!(0,o.KgX)(t[l.pF])&&!(0,o.EtT)(t[l.pF])&&!(0,o.Lmq)(t[l.pF])&&!(0,o.cyL)(t[l.pF]))return null}else t={value:r?JSON.stringify(t):t};if((0,o.cyL)(t[l.pF])&&!(t[l.pF][l.oI]>0))return null;if(!(0,o.hXl)(t[l.QV])){if((0,o.cyL)(t[l.pF])||!(0===(n=t[l.QV])||n>0&&n<=13||32===n))return null;t[l.pF]=t[l.pF].toString()}return t}function g(e,t,r){var n=-1;if(!(0,o.b07)(e)){if(t>0&&(32===t?n=8192:t<=13&&(n=t<<5)),r>=0&&r<=9)-1===n&&(n=0),n|=r;else{var i=d[function e(t){var r=0;if(null!=t){var n=typeof t;"string"===n?r=1:"number"===n?r=2:"boolean"===n?r=3:n===a._1&&(r=4,(0,o.cyL)(t)?(r=4096,t[l.oI]>0&&(r|=e(t[0]))):u.call(t,"value")&&(r=8192|e(t[l.pF])))}return r}(e)]||-1;-1!==n&&-1!==i?n|=i:6===i&&(n=i)}}return n}function v(e,t,r){var n;return void 0===r&&(r=!0),e&&(n=e.get(t),r&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||s.m5}function b(e){void 0===e&&(e="D");var t=(0,i.aq)();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,s.m5)),t}(0,o.Wtk)(),(0,o.Vdv)();var y=o.UUD;function w(e,t){e[l.dg]=e[l.dg]||{},e[l.dg][l.Jg]=e[l.dg][l.Jg]||{},e[l.dg][l.Jg][t]=y()}function S(){return!!(0,o.zS2)("chrome")}function C(e){return e>0}},377137:(e,t,r)=>{"use strict";r.d(t,{Jg:()=>d,QV:()=>c,Sj:()=>i,Uw:()=>o,dg:()=>a,h4:()=>s,mE:()=>n,oI:()=>u,pF:()=>l});var n="initialize",o="logger",i="indexOf",a="timings",s="pollInternalLogs",l="value",c="kind",u="length",d="processTelemetryStart"},590521:(e,t,r)=>{"use strict";r.d(t,{Wy:()=>s,_1:()=>o,hW:()=>n,s6:()=>a,vR:()=>i});var n="function",o="object",i="prototype",a=Object,s=a[i]},877864:(e,t,r)=>{"use strict";r.d(t,{qU:()=>a});var n=r(647759),o=r(590521),i=(((0,n.mS$)()||{}).Symbol,((0,n.mS$)()||{}).Reflect,function(e,t){return(i=o.s6.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)});function a(e,t){function r(){this.constructor=e}typeof t!==o.hW&&null!==t&&(0,n.zkd)("Class extends value "+String(t)+" is not a constructor or null"),i(e,t),e[o.vR]=null===t?(0,n.sSX)(t):(r[o.vR]=t[o.vR],new r)}},346036:(e,t,r)=>{"use strict";r.d(t,{A:()=>M});var n,o=r(647759),i="constructor",a="prototype",s="function",l="_dynInstFuncs",c="_isDynProxy",u="_dynClass",d="_dynInstChk",f="_dfOpts",h="_unknown_",p="__proto__",m="_dyn"+p,g="__dynProto$Gbl",v="_dynInstProto",b="useBaseInst",y="setInstFuncs",w=Object,S=w.getPrototypeOf,C=w.getOwnPropertyNames,I=(0,o.mS$)(),k=I[g]||(I[g]={o:((n={})[y]=!0,n[b]=!0,n),n:1e3});function E(e){return e&&(e===w[a]||e===Array[a])}function _(e){return E(e)||e===Function[a]}function A(e){var t;if(e){if(S)return S(e);var r=e[p]||e[a]||(e[i]?e[i][a]:null);t=e[m]||r,(0,o.v0u)(e,m)||(delete e[v],t=e[m]=e[v]||e[m],e[v]=r)}return t}function T(e,t){var r=[];if(C)r=C(e);else for(var n in e)"string"==typeof n&&(0,o.v0u)(e,n)&&r.push(n);if(r&&r.length>0)for(var i=0;i<r.length;i++)t(r[i])}function P(e,t,r){return t!==i&&typeof e[t]===s&&(r||(0,o.v0u)(e,t))&&t!==p&&t!==a}function O(e){(0,o.zkd)("DynamicProto: "+e)}function R(e,t){for(var r=e.length-1;r>=0;r--)if(e[r]===t)return!0;return!1}function x(e,t){return(0,o.v0u)(e,a)?e.name||t||h:((e||{})[i]||{}).name||t||h}function M(e,t,r,n){(0,o.v0u)(e,a)||O("theClass is an invalid class definition.");var i,h=e[a];!function(e,t){if(S){for(var r=[],n=A(t);n&&!_(n)&&!R(r,n);){if(n===e)return!0;r.push(n),n=A(n)}return!1}return!0}(h,t)&&O("["+x(e)+"] not in hierarchy of ["+x(t)+"]");var p=null;(0,o.v0u)(h,u)?p=h[u]:(p="_dynCls$"+x(e,"_")+"$"+k.n,k.n++,h[u]=p);var m=M[f],g=!!m[b];g&&n&&void 0!==n[b]&&(g=!!n[b]);var v=(i=(0,o.sSX)(null),T(t,function(e){!i[e]&&P(t,e,!1)&&(i[e]=t[e])}),i),w=function(e,t,r,n){function i(e,t,r){var o=t[r];if(o[c]&&n){var i=e[l]||{};!1!==i[d]&&(o=(i[t[u]]||{})[r]||o)}return function(){return o.apply(e,arguments)}}var a=(0,o.sSX)(null);T(r,function(e){a[e]=i(t,r,e)});for(var s=A(e),f=[];s&&!_(s)&&!R(f,s);)T(s,function(e){!a[e]&&P(s,e,!S)&&(a[e]=i(t,s,e))}),f.push(s),s=A(s);return a}(h,t,v,g);r(t,w);var C=!!S&&!!m[y];C&&n&&(C=!!n[y]),function(e,t,r,n,i){if(!E(e)){var a=r[l]=r[l]||(0,o.sSX)(null);if(!E(a)){var f=a[t]=a[t]||(0,o.sSX)(null);!1!==a[d]&&(a[d]=!!i),E(f)||T(r,function(t){if(P(r,t,!1)&&r[t]!==n[t]&&(f[t]=r[t],delete r[t],!(0,o.v0u)(e,t)||e[t]&&!e[t][c])){var i;e[t]=((i=function(){var r,n;return((function(e,t,r,n){var i=null;if(e&&(0,o.v0u)(r,u)){var a=e[l]||(0,o.sSX)(null);if((i=(a[r[u]]||(0,o.sSX)(null))[t])||O("Missing ["+t+"] "+s),!i[d]&&!1!==a[d]){for(var c=!(0,o.v0u)(e,t),f=A(e),h=[];c&&f&&!_(f)&&!R(h,f);){var p=f[t];if(p){c=p===n;break}h.push(f),f=A(f)}try{c&&(e[t]=i),i[d]=1}catch(e){a[d]=!1}}}return i})(this,t,e,i)||(r=i,(n=e[t])===r&&(n=A(e)[t]),typeof n!==s&&O("["+t+"] is not a "+s),n)).apply(this,arguments)})[c]=1,i)}})}}}(h,p,t,v,!1!==C)}M[f]=k.o},726969:(e,t,r)=>{"use strict";r.d(t,{g:()=>i});var n=r(85435),o=r(721830),i=function(){function e(){var t=!0,r=!0,i=!0,a="use-collector-delta",s=!1;(0,n.A)(e,this,function(e){e[o.b5]=function(){return t},e[o.pI]=function(){i&&(i=!1,s||(t=!1))},e[o.NE]=function(){return r},e[o.Oh]=function(){return a},e[o.WZ]=function(e){s||(e?(a=e,r=!0,s=!0):r=!1,t=!0)}})}return e.__ieDyn=1,e}()},64176:(e,t,r)=>{"use strict";r.d(t,{RI:()=>o,ev:()=>i,z3:()=>n});var n="REAL_TIME",o="NEAR_REAL_TIME",i="BEST_EFFORT"},769346:(e,t,r)=>{"use strict";r.d(t,{n:()=>c});var n=r(341436),o=r(647759),i=r(77766),a=r(721830);function s(e){var t=(e.ext||{}).intweb;return t&&(0,n.yD)(t[i._G])?t[i._G]:null}function l(e){for(var t=null,r=0;null===t&&r<e[a.oI];r++)t=s(e[r]);return t}var c=function(){function e(t,r){var n=r?[][a.ux](r):[],c=l(n);this[a.FI]=function(){return t},this.Msfpc=function(){return c||i.m5},this[a.F2]=function(){return n[a.oI]},this[a.dp]=function(){return n},this.addEvent=function(e){return!!e&&(n[a.y5](e),c||(c=s(e)),!0)},this[a.sY]=function(r,i){var s;if(r<n[a.oI]){var u=n[a.oI]-r;(0,o.hXl)(i)||(u=i<u?i:u),s=n[a.Ic](r,u),c=l(n)}return new e(t,s)}}return e.create=function(t,r){return new e(t,r)},e}()},444355:(e,t,r)=>{"use strict";r.d(t,{m:()=>R});var n,o=r(85435),i=r(647759),a=r(874314),s=r(341436),l=r(734150),c=r(446650),u=r(437895),d=r(867073),f=r(739426),h=r(650506),p=r(726969),m=r(769346),g=r(77766),v=r(192430),b=r(896568),y=r(538898),w=r(484024),S=r(721830),C="sendAttempt",I="&"+g.fL+"=true",k="?cors=true&"+g.l6[S.OL]()+"="+g.Xh,E=((n={})[1]=g.vG,n[100]=g.vG,n[200]="sent",n[8004]=g.N4,n[8003]=g.N4,n),_={},A={};function T(e,t,r){_[e]=t,!1!==r&&(A[t]=e)}function P(e,t){var r=!1;if(e&&t){var n=(0,i.cGk)(e);if(n&&n[S.oI]>0)for(var o=t[S.OL](),a=0;a<n[S.oI];a++){var s=n[a];if(s&&(0,i.v0u)(t,s)&&s[S.OL]()===o){r=!0;break}}}return r}function O(e,t,r,n){t&&r&&r[S.oI]>0&&(n&&_[t]?(e[S.Dx][_[t]]=r,e[S.bR]=!0):e.url+="&"+t+"="+r)}T(g._s,g._s,!1),T(g.rv,g.rv),T(g.OF,"Client-Id"),T(g.Bd,g.Bd),T(g.uY,g.uY),T(g.YH,g.YH),T(g.z5,g.z5);var R=function(){function e(t,r,n,_){var T,R,x,M,N,F,L,z,D,B,U,H,q,j,$,W,V,G,K,X,Y,Z,Q,J,ee,et,er,en,eo,ei,ea,es=!1;(0,o.A)(e,this,function(e){var o;function el(e,t){try{return ea&&ea.getSenderInst(e,t)}catch(e){}return null}function ec(e,t,r){var n=(0,u.Lo)(e);ef(t,200,{},n),ek(n)}function eu(e,t,r,n){var o,i={},a=e[S.c1];a&&a.forEach(function(e,t){i[t]=e}),ef(t,e.status,i,o=r||g.m5),ek(o)}function ed(e,t,r){var n=(0,u.Lo)(e);ef(t,e.status,(0,u.w3)(e,!0),n),ek(n)}function ef(e,t,r,n){try{e(t,r,n)}catch(e){(0,d.ZP)(L,2,518,(0,i.mmD)(e))}}function eh(e,t,r){var n=200,o=e[S.tV],a=e[S.Vq]+(Q?I:g.m5);try{var s=(0,i.w3n)();if(o){var l=!!D.getPlugin("LocalStorage"),c=[],u=[];(0,i.Iuo)(o[S.ww],function(e){if(c&&e&&e[S.F2]()>0)for(var t=e[S.dp](),r=0;r<t[S.oI];r++)if(s.sendBeacon(a,j.getEventBlob(t[r])))u[S.y5](e[r]);else{c[S.y5](e[S.sY](r));break}else c[S.y5](e[S.sY](0))}),u[S.oI]>0&&(o.sentEvts=u),l||eE(c,8003,o[S.x],!0)}else n=0}catch(e){(0,d.OG)(L,"Failed to send telemetry using sendBeacon API. Ex:"+(0,i.mmD)(e)),n=0}finally{ef(t,n,{},g.m5)}}function ep(e){return 2===e||3===e}function em(e){return V&&ep(e)&&(e=2),e}function eg(){var e=q;return q=[],e}function ev(e,t,n){var o=!1;return e&&e[S.oI]>0&&!x&&z[t]&&j&&(o=0!==t||!x&&N<r&&(n>0||M[S.b5]())),o}function eb(e){var t={};return e&&(0,i.Iuo)(e,function(e,r){t[r]={iKey:e[S.FI](),evts:e[S.dp]()}}),t}function ey(e,r,n,o,a){if(e&&0!==e[S.oI]){if(x){eE(e,1,o);return}o=em(o);try{var l=e,c=0!==o;(0,f.r2)(D,function(){return"HttpManager:_sendBatches"},function(i){i&&(e=e.slice(0));for(var l=[],u=null,d=(0,s.WB)(),f=z[o]||(c?z[1]:z[0]),h=f&&f[S.O6],p=Z&&(V||ep(o)||3===h||f._isSync&&2===h);ev(e,o,r);){var m=e.shift();m&&m[S.F2]()>0&&(R.isTenantKilled(m[S.FI]())?l[S.y5](m):(u=u||j[S.hJ](r,n,c,p,a,o),j.appendPayload(u,m,t)?null!==u.overflow&&(e=[u.overflow][S.ux](e),u.overflow=null,eC(u,d,(0,s.WB)(),a),d=(0,s.WB)(),u=null):(eC(u,d,(0,s.WB)(),a),d=(0,s.WB)(),e=[m][S.ux](e),u=null)))}u&&eC(u,d,(0,s.WB)(),a),e[S.oI]>0&&(q=e[S.ux](q)),eE(l,8004,o)},function(){return{batches:eb(l),retryCount:r,isTeardown:n,isSynchronous:c,sendReason:a,useSendBeacon:ep(o),sendType:o}},!c)}catch(e){(0,d.ZP)(L,2,48,"Unexpected Exception sending batch: "+(0,i.mmD)(e))}}}function ew(e,t){var r={url:T,hdrs:{},useHdrs:!1};t?(r[S.Dx]=(0,s.X$)(r[S.Dx],H),r.useHdrs=(0,i.cGk)(r.hdrs)[S.oI]>0):(0,i.zav)(H,function(e,t){A[e]?O(r,A[e],t,!1):(r[S.Dx][e]=t,r[S.bR]=!0)}),O(r,g.OF,"NO_AUTH",t),O(r,g.rv,s.xE,t);var n=g.m5;(0,i.Iuo)(e.apiKeys,function(e){n[S.oI]>0&&(n+=","),n+=e}),O(r,g.Bd,n,t),O(r,g.YH,(0,i.f0d)().toString(),t);var o=function(e){for(var t=0;t<e.batches[S.oI];t++){var r=e[S.ww][t].Msfpc();if(r)return encodeURIComponent(r)}return g.m5}(e);if((0,s.yD)(o)&&(r.url+="&ext.intweb.msfpc="+o),M[S.NE]()&&O(r,g.uY,M[S.Oh](),t),D[S.t6]){var a=D[S.t6]();a>=0&&(r.url+="&w="+a)}for(var l=0;l<U[S.oI];l++)r.url+="&"+U[l].name+"="+U[l].value;return r}function eS(e,t,r){e[t]=e[t]||{},e[t][F.identifier]=r}function eC(t,r,o,a){if(t&&t.payloadBlob&&t.payloadBlob[S.oI]>0){var l=!!ee,c=z[t.sendType];!ep(t[S.x])&&t[S.hD]&&2===t.sendReason&&(c=z[2]||z[3]||c);var u=G;(t.isBeacon||3===c[S.O6])&&(u=!1);var p=ew(t,u);u=u||p[S.bR];var m=(0,s.WB)();(0,f.r2)(D,function(){return"HttpManager:_doPayloadSend"},function(){for(var v=0;v<t.batches[S.oI];v++)for(var y=t[S.ww][v][S.dp](),w=0;w<y[S.oI];w++){var I=y[w];if($){var k=I[S.dg]=I[S.dg]||{};eS(k,"sendEventStart",m),eS(k,"serializationStart",r),eS(k,"serializationCompleted",o)}I[C]>0?I[C]++:I[C]=1}eE(t[S.ww],1e3+(a||0),t[S.x],!0);var E={data:t[S.qz],urlString:p.url,headers:p[S.Dx],_thePayload:t,_sendReason:a,timeout:K,disableXhrSync:X,disableFetchKeepAlive:Y};u&&(P(E[S.c1],g.Zf)||(E[S.c1][g.Zf]=g.LB),P(E[S.c1],g.l6)||(E[S.c1][g.l6]=g.Xh));var _=null;c&&(_=function(r){M[S.pI]();var o=function(r,o){(function(t,r,o,a){var l=9e3,c=null,u=!1,d=!1;try{var f=!0;if(typeof t!==h.bA){if(r){M[S.WZ](r[g.Vb]);var p=r[g.Gf]||r["kill-duration-seconds"];(0,i.Iuo)(R[S.NO](r[g.Mr],p),function(e){(0,i.Iuo)(o[S.ww],function(t){if(t[S.FI]()===e){c=c||[];var r=t[S.sY](0);o.numEvents-=r[S.F2](),c[S.y5](r)}})})}if(200==t||204==t){l=200;return}(!(0,b.t)(t)||o.numEvents<=0)&&(f=!1),l=9e3+t%1e3}if(f){l=100;var m=o.retryCnt;0===o[S.x]&&(m<n?(u=!0,eI(function(){0===o[S.x]&&N--,ey(o[S.ww],m+1,o[S.LS],V?2:o[S.x],5)},V,(0,b.L)(m))):(d=!0,V&&(l=8001)))}}finally{u||(M[S.WZ](),function(t,r,n,o){try{o&&F[S.zd]();var a=t[S.ww];200===r&&(a=t.sentEvts||t[S.ww],o||t[S.O_]||F._clearBackOff(),function(e){if($){var t=(0,s.WB)();(0,i.Iuo)(e,function(e){if(e&&e[S.F2]()>0){var r;r=e[S.dp](),$&&(0,i.Iuo)(r,function(e){eS(e[S.dg]=e[S.dg]||{},"sendEventCompleted",t)})}})}}(a)),eE(a,r,t[S.x],!0)}finally{0===t[S.x]&&(N--,5!==n&&e.sendQueuedRequests(t[S.x],n))}}(o,l,a,d)),eE(c,8004,o[S.x])}})(r,o,t,a)},l=t[S.LS]||t[S.O_];try{c.sendPOST(r,o,l),et&&et(E,r,l,t[S.hD])}catch(e){(0,d.OG)(L,"Unexpected exception sending payload. Ex:"+(0,i.mmD)(e)),ef(o,0,{})}}),(0,f.r2)(D,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(_){if(0===t[S.x]&&N++,l&&!t.isBeacon&&3!==c[S.O6]){var e={data:E[S.Cd],urlString:E[S.Vq],headers:(0,s.X$)({},E[S.c1]),timeout:E[S.do],disableXhrSync:E[S.r0],disableFetchKeepAlive:E[S.RJ]},r=!1;(0,f.r2)(D,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{ee(e,function(e){r=!0,B||e[S.tV]||(e[S.tV]=e[S.tV]||E[S.tV],e[S.GR]=e[S.GR]||E[S.GR]),_(e)},t.isSync||t[S.LS])}catch(e){r||_(E)}})}else _(E)}})},function(){return{thePayload:t,serializationStart:r,serializationCompleted:o,sendReason:a}},t[S.O_])}t.sizeExceed&&t.sizeExceed[S.oI]>0&&eE(t.sizeExceed,8003,t[S.x]),t.failedEvts&&t.failedEvts[S.oI]>0&&eE(t.failedEvts,8002,t[S.x])}function eI(e,t,r){t?e():eo.set(e,r)}function ek(e){try{for(var t=0;t<er[S.oI];t++)try{er[t](e)}catch(e){(0,d.ZP)(L,1,519,"Response handler failed: "+e)}if(e){var r=JSON.parse(e);(0,s.yD)(r.webResult)&&(0,s.yD)(r.webResult[g._G])&&W.set("MSFPC",r.webResult[g._G],31536e3)}}catch(e){}}function eE(e,t,r,n){if(e&&e[S.oI]>0&&_){var o,i=_[o=E[t],!(0,s.yD)(o)&&(o=g.L7,t>=9e3&&t<=9999?o=g.l$:t>=8e3&&t<=8999?o=g.N4:t>=1e3&&t<=1999&&(o=g.BC)),o];if(i){var a=0!==r;(0,f.r2)(D,function(){return"HttpManager:_sendBatchesNotification"},function(){eI(function(){try{i.call(_,e,t,a,r)}catch(e){(0,d.ZP)(L,1,74,"send request notification failed: "+e)}},n||a,0)},function(){return{batches:eb(e),reason:t,isSync:a,sendSync:n,sendType:r}},!a)}}}T=null,R=new v.Z,x=!1,M=new p.g,es=!1,N=0,F=null,L=null,z=null,D=null,B=!0,U=[],H={},q=[],j=null,$=!1,W=null,V=!1,G=!1,K=o,X=o,Y=o,Z=o,Q=o,J=[],ee=o,et=o,er=[],en=!1,eo=(0,w.D)(),ei=!1,ea=null,e[S.mE]=function(e,t,r){en||(D=t,W=t.getCookieMgr(),L=(F=r).diagLog(),(0,i.Yny)(J,(0,a.a)(e,function(e){var n,o=e.cfg,a=e.cfg.extensionConfig[r.identifier];eo=(0,w.D)(a[S.bg],a[S.i8]),(0,s.yD)(o.anonCookieName)?function(e,t,r){for(var n=0;n<e[S.oI];n++)if(e[n].name===t){e[n].value=r;return}e[S.y5]({name:t,value:r})}(U,"anoncknm",o.anonCookieName):function(e,t){for(var r=0;r<e[S.oI];r++)if(e[r].name===t){e[S.Ic](r,1);return}}(U,"anoncknm"),ee=a[S.aH],et=a.payloadListener;var f=a.httpXHROverride;T=(a[S.WW]?a[S.WW]:o.endpointUrl)+k,G=!!(0,i.b07)(a[S.Y6])||!a[S.Y6],$=!a[S.X6];var h=a.valueSanitizer,p=a[S.Az],m=!!o[S.zI];(0,i.b07)(a[S.zI])||(m=!!a[S.zI]),K=a.xhrTimeout,X=!!a[S.r0],Y=!!a[S.RJ],Q=!1!==a[S.dc],ei=!!a[S.M_],t.getPlugin("LocalStorage")&&(Y=!0),es=!(0,l.lV)(),j=new y.h(D,h,p,m,s.Go,ei),(0,i.hXl)(a[S.Vi])||(es=!!a[S.Vi]);var g=function(){try{return{enableSendPromise:!1,isOneDs:!0,disableCredentials:!1,disableXhr:!1,disableBeacon:!es,disableBeaconSync:!es,disableFetchKeepAlive:Y,timeWrapper:eo,addNoResponse:Q,senderOnCompleteCallBack:{xdrOnComplete:ec,fetchOnComplete:eu,xhrOnComplete:ed,beaconOnRetry:eh}}}catch(e){}return null}();ea?ea.SetConfig(g):(ea=new c.v)[S.mE](g,L);var v=f,b=a[S.cO]?f:null,C=a[S.cO]?f:null,I=[3,2];if(!f){B=!1;var E=[];(0,l.lV)()?(E=[2,1],I=[2,1,3]):E=[1,2,3],(f=el(E=(0,u.jL)(E,a.transports),!1))||(0,d.OG)(L,"No available transport to send events"),v=el(E,!0)}b||(b=el(I=(0,u.jL)(I,a[S.Yr]),!0)),Z=!B&&(es&&(0,l.Uf)()||!Y&&(0,l.R7)(!0)),(n={})[0]=f,n[1]=v||el([1,2,3],!0),n[2]=b||v||el([1],!0),n[3]=C||el([2,3],!0)||v||el([1],!0),z=n})),en=!0)},e.addResponseHandler=function(e){return er[S.y5](e),{rm:function(){var t=er.indexOf(e);t>=0&&er[S.Ic](t,1)}}},e[S.kO]=function(e){try{if(j)return j.getEventBlob(e)}catch(e){}return g.m5},e[S.sN]=function(){try{var e=j&&j[S.hJ](0,!1,!1,!1,1,0);return ew(e,G)}catch(e){}return null},e[S.r4]=function(e,r){try{var n=[];(0,i.Iuo)(e,function(e){r&&(e=(0,u.hW)(e));var t=m.n.create(e[S.FI],[e]);n[S.y5](t)});for(var o=null;n[S.oI]>0&&j;){var a=n.shift();a&&a[S.F2]()>0&&(o=o||j[S.hJ](0,!1,!1,!1,1,0),j.appendPayload(o,a,t))}var s=ew(o,G),l={data:o[S.qz],urlString:s.url,headers:s[S.Dx],timeout:K,disableXhrSync:X,disableFetchKeepAlive:Y};return G&&(P(l[S.c1],g.Zf)||(l[S.c1][g.Zf]=g.LB),P(l[S.c1],g.l6)||(l[S.c1][g.l6]=g.Xh)),l}catch(e){}return null},e._getDbgPlgTargets=function(){return[z[0],R,j,z]},e[S.nI]=function(e,t){H[e]=t},e.removeHeader=function(e){delete H[e]},e[S.VY]=function(){return!x&&N<r&&M[S.b5]()},e[S.RB]=function(e,t){(0,i.b07)(e)&&(e=0),V&&(e=em(e),t=2),ev(q,e,0)&&ey(eg(),0,!1,e,t||0)},e[S.cY]=function(){return!x&&0===N&&0===q[S.oI]},e[S.EP]=function(e){V=e},e.addBatch=function(e){if(e&&e[S.F2]()>0){if(R.isTenantKilled(e[S.FI]()))return!1;q[S.y5](e)}return!0},e.teardown=function(){q[S.oI]>0&&ey(eg(),0,!0,2,2),(0,i.Iuo)(J,function(e){e&&e.rm&&e.rm()}),J=[]},e.pause=function(){x=!0},e.resume=function(){x=!1,e[S.RB](0,4)},e[S.Zd]=function(e,t,r){e&&e[S.F2]()>0&&((0,i.hXl)(t)&&(t=1),V&&(t=em(t),r=2),ey([e],0,!1,t,r||0))}})}return e.__ieDyn=1,e}()},77766:(e,t,r)=>{"use strict";r.d(t,{BC:()=>i,Bd:()=>w,Gf:()=>p,Kp:()=>A,L7:()=>l,LB:()=>c,Mr:()=>h,N4:()=>o,O0:()=>C,OF:()=>v,VH:()=>_,Vb:()=>m,Xh:()=>u,YH:()=>y,Zf:()=>d,_G:()=>E,_s:()=>S,fL:()=>k,l$:()=>s,l6:()=>f,m5:()=>n,rv:()=>g,uY:()=>b,vG:()=>a,z5:()=>I});var n="",o="drop",i="send",a="requeue",s="rspFail",l="oth",c="no-cache, no-store",u="application/x-json-stream",d="cache-control",f="content-type",h="kill-tokens",p="kill-duration",m="time-delta-millis",g="client-version",v="client-id",b="time-delta-to-apply-millis",y="upload-time",w="apikey",S="AuthMsaDeviceTicket",C="WebAuthToken",I="AuthXToken",k="NoResponseBody",E="msfpc",_="trace",A="user"},192430:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(85435),o=r(647759),i=r(721830),a=function(){function e(){var t={};(0,n.A)(e,this,function(e){e[i.NO]=function(e,r){if(e&&r)try{var n,a,s=(n=e[i.sY](","),a=[],n&&(0,o.Iuo)(n,function(e){a[i.y5]((0,o.EHq)(e))}),a);if("this-request-only"===r)return s;for(var l=1e3*parseInt(r,10),c=0;c<s[i.oI];++c)t[s[c]]=(0,o.f0d)()+l}catch(e){}return[]},e[i.z1]=function(e){var r=(0,o.EHq)(e);return!!(void 0!==t[r]&&t[r]>(0,o.f0d)())||(delete t[r],!1)}})}return e.__ieDyn=1,e}()},736529:(e,t,r)=>{"use strict";r.d(t,{s:()=>A});var n=r(509471),o=r(85435),i=r(341436),a=r(647759),s=r(739426),l=r(272643),c=r(356746),u=r(874314),d=r(758355),f=r(437895),h=r(351420),p=r(867073),m=r(652639),g=r(659495),v=r(64176),b=r(769346),y=r(444355),w=r(77766),S=r(896568),C=r(484024),I=r(721830),k="eventsDiscarded",E=void 0,_=(0,a.ZHX)({eventsLimitInMem:{isVal:i.ei,v:1e4},immediateEventLimit:{isVal:i.ei,v:500},autoFlushEventsLimit:{isVal:i.ei,v:0},disableAutoBatchFlushLimit:!1,httpXHROverride:{isVal:function(e){return e&&e.sendPOST},v:E},overrideInstrumentationKey:E,overrideEndpointUrl:E,disableTelemetry:!1,ignoreMc1Ms0CookieProcessing:!1,setTimeoutOverride:E,clearTimeoutOverride:E,payloadPreprocessor:E,payloadListener:E,disableEventTimings:E,valueSanitizer:E,stringifyObjects:E,enableCompoundKey:E,disableOptimizeObj:!1,transports:E,unloadTransports:E,useSendBeacon:E,disableFetchKeepAlive:E,avoidOptions:!1,xhrTimeout:E,disableXhrSync:E,alwaysUseXhrOverride:!1,maxEventRetryAttempts:{isVal:a.EtT,v:6},maxUnloadEventRetryAttempts:{isVal:a.EtT,v:2},addNoResponse:E,excludeCsMetaData:E}),A=function(e){function t(){var r,n,m,E,A,T,P,O,R,x,M,N,F,L,z,D,B,U,H,q,j,$,W,V,G,K,X=e.call(this)||this;X.identifier="PostChannel",X.priority=1011,X.version="4.3.0";var Y=!1,Z=[],Q=!1,J=0,ee=0,et={},er=v.z3;return(0,o.A)(t,X,function(e,t){function o(){(0,l.Ds)(null,H),(0,l.sq)(null,H),(0,l.vF)(null,H)}function X(e){var t="";return e&&e[I.oI]&&(0,a.Iuo)(e,function(e){t&&(t+="\n"),t+=e}),t}function en(e){var t="";try{ea(e),t=R[I.kO](e)}catch(e){}return t}function eo(e){"beforeunload"!==(e||(0,a.zkX)().event).type&&(D=!0,R[I.EP](D)),ep(2,2)}function ei(e){D=!1,R[I.EP](D)}function ea(e){e.ext&&e.ext[w.VH]&&delete e.ext[w.VH],e.ext&&e.ext[w.Kp]&&e.ext[w.Kp].id&&delete e.ext[w.Kp].id,z&&(e.ext=(0,f.hW)(e.ext),e[I.OK]&&(e[I.OK]=(0,f.hW)(e[I.OK])),e[I.Cd]&&(e[I.Cd]=(0,f.hW)(e[I.Cd])))}function es(e,t){if(e[I.Es]||(e[I.Es]=0),e[I.wR]||(e[I.wR]=1),ea(e),e[I.jh]){if(P||Q)e[I.wR]=3,e[I.jh]=!1;else if(R){z&&(e=(0,f.hW)(e)),R[I.Zd](b.n.create(e[I.FI],[e]),!0===e[I.jh]?1:e[I.jh],3);return}}var r=e[I.wR],n=ee,o=E;4===r&&(n=J,o=m);var i=!1;if(n<o)i=!ev(e,t);else{var a=1,s=20;4===r&&(a=4,s=1),i=!0,function(e,t,r,n){for(;r<=t;){var o=em(e,t,!0);if(o&&o[I.F2]()>0){var i=o[I.sY](0,n),a=i[I.F2]();if(a>0)return 4===r?J-=a:ee-=a,ek(k,[i],h.x.QueueFull),!0}r++}return eb(),!1}(e[I.FI],e[I.wR],a,s)&&(i=!ev(e,t))}i&&eI(k,[e],h.x.QueueFull)}function el(e,t,r){var n=ey(e,t,r);return R[I.RB](t,r),n}function ec(){return ee>0}function eu(){if(F>=0&&ey(F,0,L)&&R[I.RB](0,L),J>0&&!T&&!Q){var e=et[er][2];e>=0&&(T=ef(function(){T=null,el(4,0,1),eu()},e))}var t=et[er][1];A||n||!(t>=0)||Q||(ec()?A=ef(function(){A=null,el(0===O?3:1,0,1),O++,O%=2,eu()},t):O=0)}function ed(){r=null,Y=!1,Z=[],n=null,Q=!1,J=0,m=500,ee=0,E=1e4,et={},er=v.z3,A=null,T=null,P=0,O=0,x={},M=0,V=!1,N=0,F=-1,L=null,z=!0,D=!1,B=6,U=2,H=null,G=null,K=!1,q=(0,C.D)(),R=new y.m(500,2,1,{requeue:eS,send:eE,sent:e_,drop:eA,rspFail:eT,oth:eP}),ew(),x[4]={batches:[],iKeyMap:{}},x[3]={batches:[],iKeyMap:{}},x[2]={batches:[],iKeyMap:{}},x[1]={batches:[],iKeyMap:{}},eO()}function ef(e,t){0===t&&P&&(t=1);var r=1e3;return P&&(r=(0,S.L)(P-1)),q.set(e,t*r)}function eh(){return null!==A&&(A.cancel(),A=null,O=0,!0)}function ep(e,t){eh(),n&&(n.cancel(),n=null),Q||el(1,e,t)}function em(e,t,r){var n=x[t];n||(n=x[t=1]);var o=n.iKeyMap[e];return!o&&r&&(o=b.n.create(e),n.batches[I.y5](o),n.iKeyMap[e]=o),o}function eg(t,r){R[I.VY]()&&!P&&(M>0&&ee>M&&(r=!0),r&&null==n&&e.flush(t,function(){},20))}function ev(e,t){z&&(e=(0,f.hW)(e));var r=e[I.wR],n=em(e[I.FI],r,!0);return!!n.addEvent(e)&&(4!==r?(ee++,t&&0===e[I.Es]&&eg(!e.sync,N>0&&n[I.F2]()>=N)):J++,!0)}function eb(){for(var e=0,t=0,r=function(r){var n=x[r];n&&n[I.ww]&&(0,a.Iuo)(n[I.ww],function(n){4===r?e+=n[I.F2]():t+=n[I.F2]()})},n=1;n<=4;n++)r(n);ee=t,J=e}function ey(t,r,n){var o=!1,i=0===r;return!i||R[I.VY]()?(0,s.r2)(e.core,function(){return"PostChannel._queueBatches"},function(){for(var e=[],r=4;r>=t;){var n=x[r];n&&n.batches&&n.batches[I.oI]>0&&((0,a.Iuo)(n[I.ww],function(t){R.addBatch(t)?o=o||t&&t[I.F2]()>0:e=e[I.ux](t[I.dp]()),4===r?J-=t[I.F2]():ee-=t[I.F2]()}),n[I.ww]=[],n.iKeyMap={}),r--}e[I.oI]>0&&eI(k,e,h.x.KillSwitch),o&&F>=t&&(F=-1,L=0)},function(){return{latency:t,sendType:r,sendReason:n}},!i):(F=F>=0?Math.min(F,t):t,L=Math.max(L,n)),o}function ew(){(et={})[v.z3]=[2,1,0],et[v.RI]=[6,3,0],et[v.ev]=[18,9,0]}function eS(t,r){var n=[],o=B;D&&(o=U),(0,a.Iuo)(t,function(t){t&&t[I.F2]()>0&&(0,a.Iuo)(t[I.dp](),function(t){t&&(t[I.jh]&&(t[I.wR]=4,t[I.jh]=!1),t[I.Es]<o?((0,i.u9)(t,e[I.Ju]),es(t,!1)):n[I.y5](t))})}),n[I.oI]>0&&eI(k,n,h.x.NonRetryableStatus),D&&ep(2,2)}function eC(t,r){var n=W||{},o=n[t];if(o)try{o.apply(n,r)}catch(r){(0,p.ZP)(e.diagLog(),1,74,t+" notification failed: "+r)}}function eI(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t&&t[I.oI]>0&&eC(e,[t][I.ux](r))}function ek(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t&&t[I.oI]>0&&(0,a.Iuo)(t,function(t){t&&t[I.F2]()>0&&eC(e,[t.events()][I.ux](r))})}function eE(e,t,r){e&&e[I.oI]>0&&eC("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==r])}function e_(e,t){ek("eventsSent",e,t),eu()}function eA(e,t){ek(k,e,t>=8e3&&t<=8999?t-8e3:h.x.Unknown)}function eT(e){ek(k,e,h.x.NonRetryableStatus),eu()}function eP(e,t){ek(k,e,h.x.Unknown),eu()}function eO(){N=$?0:Math.max(1500,E/6)}ed(),e._getDbgPlgTargets=function(){return[R,r]},e[I.mE]=function(n,a,f){(0,s.r2)(a,function(){return"PostChannel:initialize"},function(){t[I.mE](n,a,f),W=a.getNotifyMgr();try{H=(0,l.Hm)((0,c.Z)(e[I.Ju]),a.evtNamespace&&a.evtNamespace()),e._addHook((0,u.a)(n,function(t){var n,s=t.cfg;r=(0,d.i8)(null,s,a).getExtCfg(e[I.Ju],_),q=(0,C.D)(r[I.bg],r[I.i8]),z=!r[I.qT]&&(0,i.F2)(),j=r[I.ZH],n=a[I.t6],a[I.t6]=function(){var e=0;return j&&(e|=2),e|n.call(a)},E=r[I.hi],m=r.immediateEventLimit,M=r[I.bw],B=r.maxEventRetryAttempts,U=r.maxUnloadEventRetryAttempts,$=r[I._],eO(),G=r[I.GX],K=!!r[I.yH],V&&o();var c=s.disablePageUnloadEvents||[];V=(0,l.ee)(eo,c,H),V=(0,l.Fc)(eo,c,H)||V,V=(0,l.oS)(ei,s.disablePageShowEvents,H)||V})),R[I.mE](n,e.core,e)}catch(t){throw e.setInitialized(!1),t}},function(){return{theConfig:n,core:a,extensions:f}})},e.processTelemetry=function(t,r){(0,i.u9)(t,e[I.Ju]),r=r||e._getTelCtx(r),K||Y||(G&&(t[I.FI]=G),es(t,!0),D?ep(2,2):eu()),e.processNext(t,r)},e.getOfflineSupport=function(){try{var e=R&&R[I.sN]();if(R)return{getUrl:function(){return e?e.url:null},serialize:en,batch:X,shouldProcess:function(e){return!K},createPayload:function(e){return null},createOneDSPayload:function(e){if(R[I.r4])return R[I.r4](e,z)}}}catch(e){}return null},e._doTeardown=function(e,t){ep(2,2),Y=!0,R.teardown(),o(),ed()},e.setEventQueueLimits=function(e,t){r[I.hi]=E=(0,i.ei)(e)?e:1e4,r[I.bw]=M=(0,i.ei)(t)?t:0,eO();var n=ee>e;if(!n&&N>0)for(var o=1;!n&&o<=3;o++){var s=x[o];s&&s[I.ww]&&(0,a.Iuo)(s[I.ww],function(e){e&&e[I.F2]()>=N&&(n=!0)})}eg(!0,n)},e.pause=function(){eh(),Q=!0,R.pause()},e.resume=function(){Q=!1,R.resume(),eu()},e._loadTransmitProfiles=function(e){eh(),ew(),er=v.z3,eu(),(0,a.zav)(e,function(e,t){var r=t[I.oI];if(r>=2){var n=r>2?t[2]:0;if(t[I.Ic](0,r-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var o=t[0]/t[1];t[0]=Math.ceil(o)*t[1]}n>=0&&t[1]>=0&&n>t[1]&&(n=t[1]),t[I.y5](n),et[e]=t}})},e.flush=function(e,t,r){if(void 0===e&&(e=!0),!Q){if(r=r||1,e)t||(o=(0,g.Qo)(function(e){t=e})),null==n?(eh(),ey(1,0,r),n=ef(function(){n=null,function e(t,r){el(1,0,r),eb(),function e(t){R[I.cY]()?t():n=ef(function(){n=null,e(t)},.25)}(function(){t&&t(),Z[I.oI]>0?n=ef(function(){n=null,e(Z.shift(),r)},0):(n=null,eu())})}(t,r)},0)):Z[I.y5](t);else{var o,i=eh();el(1,1,r),t&&t(),i&&eu()}}return o},e.setMsaAuthTicket=function(e){R[I.nI](w._s,e)},e.setAuthPluginHeader=function(e){R[I.nI](w.O0,e)},e.removeAuthPluginHeader=function(){R.removeHeader(w.O0)},e.hasEvents=ec,e._setTransmitProfile=function(e){er!==e&&void 0!==et[e]&&(eh(),er=e,eu())},(0,f.o$)(e,function(){return R},["addResponseHandler"]),e[I.zd]=function(){P<4&&(P++,eh(),eu())},e._clearBackOff=function(){P&&(P=0,eh(),eu())}}),X}return(0,n.qU)(t,e),t.__ieDyn=1,t}(m.s)},896568:(e,t,r)=>{"use strict";function n(e){return!(e>=300&&e<500&&429!=e||501==e||505==e)}function o(e){return Math.min(Math.pow(2,e)*(Math.floor(1200*Math.random())+2400),6e5)}r.d(t,{L:()=>o,t:()=>n})},538898:(e,t,r)=>{"use strict";r.d(t,{h:()=>d});var n=r(85435),o=r(341436),i=r(739426),a=r(647759),s=r(769346),l=r(77766),c="metadata",u=/\./,d=function(){function e(t,r,d,f,h,p){var m="data",g="baseData",v=!!f,b={},y=!!p,w=h||o.Go;(0,n.A)(e,this,function(e){e.createPayload=function(e,t,r,n,o,i){return{apiKeys:[],payloadBlob:l.m5,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:r,isBeacon:n,sendType:i,sendReason:o}},e.appendPayload=function(r,n,o){var l=r&&n&&!r.overflow;return l&&(0,i.r2)(t,function(){return"Serializer:appendPayload"},function(){for(var t=n.events(),i=r.payloadBlob,l=r.numEvents,c=!1,u=[],d=[],f=r.isBeacon,h=f?65e3:3984588,p=f?65e3:2e6,m=0,g=0;m<t.length;){var v=t[m];if(v){if(l>=o){r.overflow=n.split(m);break}var b=e.getEventBlob(v);if(b&&b.length<=p){var y=b.length;if(i.length+y>h){r.overflow=n.split(m);break}i&&(i+="\n"),i+=b,++g>20&&((0,a.hKY)(i,0,1),g=0),c=!0,l++}else b?u.push(v):d.push(v),t.splice(m,1),m--}m++}if(u.length>0&&r.sizeExceed.push(s.n.create(n.iKey(),u)),d.length>0&&r.failedEvts.push(s.n.create(n.iKey(),d)),c){r.batches.push(n),r.payloadBlob=i,r.numEvents=l;var w=n.iKey();-1===(0,a.rDm)(r.apiKeys,w)&&r.apiKeys.push(w)}},function(){return{payload:r,theBatch:{iKey:n.iKey(),evts:n.events()},max:o}}),l},e.getEventBlob=function(e){try{return(0,i.r2)(t,function(){return"Serializer.getEventBlob"},function(){var t,r={};r.name=e.name,r.time=e.time,r.ver=e.ver,r.iKey="o:"+(0,o.EO)(e.iKey);var i={};y||(t=function(e,t,r){(function(e,t,r,n,o){if(o&&t){var i=e(o.value,o.kind,o.propertyType);if(i>-1){var s=t[c];s||(s=t[c]={f:{}});var l=s.f;if(l||(l=s.f={}),r)for(var u=0;u<r.length;u++){var d=r[u];l[d]||(l[d]={f:{}});var f=l[d].f;f||(f=l[d].f={}),l=f}l=l[n]={},(0,a.cyL)(o.value)?l.a={t:i}:l.t=i}}})(w,i,e,t,r)});var s=e.ext;s&&(r.ext=i,(0,a.zav)(s,function(e,t){var r=i[e]={};n(t,r,"ext."+e,!0,null,null,!0)}));var l=r[m]={};l.baseType=e.baseType;var u=l[g]={};return n(e.baseData,u,g,!1,[g],t,!0),n(e.data,l,m,!1,[],t,!0),JSON.stringify(r)},function(){return{item:e}})}catch(e){return null}};function n(e,t,i,s,l,c,f){(0,a.zav)(e,function(e,h){var p=null;if(h||(0,o.yD)(h)){var m,g,y=i,w=e,S=l,C=t;if(v&&!s&&u.test(e)){var I=e.split("."),k=I.length;if(k>1){S&&(S=S.slice());for(var E=0;E<k-1;E++){var _=I[E];C=C[_]=C[_]||{},y+="."+_,S&&S.push(_)}w=I[k-1]}}if(p=!(s&&(void 0===(g=b[m=y])&&(m.length>=7&&(g=(0,a.tGl)(m,"ext.metadata")||(0,a.tGl)(m,"ext.web")),b[m]=g),g))&&r&&r.handleField(y,w)?r.value(y,w,h,d):(0,o.TC)(w,h,d)){var A=p.value;if(C[w]=A,c&&c(S,w,p),f&&"object"==typeof A&&!(0,a.cyL)(A)){var T=S;T&&(T=T.slice()).push(w),n(h,A,y+"."+w,s,T,c,f)}}}})}})}return e.__ieDyn=1,e}()},484024:(e,t,r)=>{"use strict";r.d(t,{D:()=>o});var n=r(647759);function o(e,t){return{set:function(r,o){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];return(0,n.vKV)([e,t],r,o,i)}}}},721830:(e,t,r)=>{"use strict";r.d(t,{Az:()=>_,Cd:()=>eo,Dx:()=>v,EP:()=>X,Es:()=>eb,F2:()=>d,FI:()=>u,GR:()=>ea,GX:()=>em,Ic:()=>m,Ju:()=>ec,LS:()=>er,M_:()=>R,NE:()=>i,NO:()=>es,O6:()=>Q,OK:()=>ev,OL:()=>g,O_:()=>en,Oh:()=>a,RB:()=>G,RJ:()=>P,VY:()=>V,Vi:()=>x,Vq:()=>q,WW:()=>I,WZ:()=>s,X6:()=>E,Y6:()=>k,Yr:()=>N,ZH:()=>ed,Zd:()=>Z,_:()=>ep,aH:()=>C,b5:()=>n,bR:()=>b,bg:()=>w,bw:()=>eh,c1:()=>U,cO:()=>M,cY:()=>K,dc:()=>O,dg:()=>et,do:()=>ei,dp:()=>f,hD:()=>ee,hJ:()=>z,hi:()=>ef,i8:()=>S,jh:()=>ew,kO:()=>F,mE:()=>y,nI:()=>W,oI:()=>l,pI:()=>o,qT:()=>eu,qz:()=>B,r0:()=>T,r4:()=>D,sN:()=>L,sY:()=>p,t6:()=>J,tV:()=>H,ux:()=>c,wR:()=>ey,ww:()=>j,x:()=>$,y5:()=>h,yH:()=>eg,z1:()=>Y,zI:()=>A,zd:()=>el});var n="allowRequestSending",o="firstRequestSent",i="shouldAddClockSkewHeaders",a="getClockSkewHeaderValue",s="setClockSkew",l="length",c="concat",u="iKey",d="count",f="events",h="push",p="split",m="splice",g="toLowerCase",v="hdrs",b="useHdrs",y="initialize",w="setTimeoutOverride",S="clearTimeoutOverride",C="payloadPreprocessor",I="overrideEndpointUrl",k="avoidOptions",E="disableEventTimings",_="stringifyObjects",A="enableCompoundKey",T="disableXhrSync",P="disableFetchKeepAlive",O="addNoResponse",R="excludeCsMetaData",x="useSendBeacon",M="alwaysUseXhrOverride",N="unloadTransports",F="serializeOfflineEvt",L="getOfflineRequestDetails",z="createPayload",D="createOneDSPayload",B="payloadBlob",U="headers",H="_thePayload",q="urlString",j="batches",$="sendType",W="addHeader",V="canSendRequest",G="sendQueuedRequests",K="isCompletelyIdle",X="setUnloading",Y="isTenantKilled",Z="sendSynchronousBatch",Q="_transport",J="getWParam",ee="isBeacon",et="timings",er="isTeardown",en="isSync",eo="data",ei="timeout",ea="_sendReason",es="setKillSwitchTenants",el="_backOffTransmission",ec="identifier",eu="disableOptimizeObj",ed="ignoreMc1Ms0CookieProcessing",ef="eventsLimitInMem",eh="autoFlushEventsLimit",ep="disableAutoBatchFlushLimit",em="overrideInstrumentationKey",eg="disableTelemetry",ev="baseData",eb="sendAttempt",ey="latency",ew="sync"},463604:(e,t,r)=>{"use strict";r.d(t,{hW:()=>n,s6:()=>i,vR:()=>o});var n="function",o="prototype",i=Object;i[o]},509471:(e,t,r)=>{"use strict";r.d(t,{qU:()=>a});var n=r(647759),o=r(463604),i=(((0,n.mS$)()||{}).Symbol,((0,n.mS$)()||{}).Reflect,function(e,t){return(i=o.s6.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)});function a(e,t){function r(){this.constructor=e}typeof t!==o.hW&&null!==t&&(0,n.zkd)("Class extends value "+String(t)+" is not a constructor or null"),i(e,t),e[o.vR]=null===t?(0,n.sSX)(t):(r[o.vR]=t[o.vR],new r)}},85435:(e,t,r)=>{"use strict";r.d(t,{A:()=>M});var n,o=r(647759),i="constructor",a="prototype",s="function",l="_dynInstFuncs",c="_isDynProxy",u="_dynClass",d="_dynInstChk",f="_dfOpts",h="_unknown_",p="__proto__",m="_dyn"+p,g="__dynProto$Gbl",v="_dynInstProto",b="useBaseInst",y="setInstFuncs",w=Object,S=w.getPrototypeOf,C=w.getOwnPropertyNames,I=(0,o.mS$)(),k=I[g]||(I[g]={o:((n={})[y]=!0,n[b]=!0,n),n:1e3});function E(e){return e&&(e===w[a]||e===Array[a])}function _(e){return E(e)||e===Function[a]}function A(e){var t;if(e){if(S)return S(e);var r=e[p]||e[a]||(e[i]?e[i][a]:null);t=e[m]||r,(0,o.v0u)(e,m)||(delete e[v],t=e[m]=e[v]||e[m],e[v]=r)}return t}function T(e,t){var r=[];if(C)r=C(e);else for(var n in e)"string"==typeof n&&(0,o.v0u)(e,n)&&r.push(n);if(r&&r.length>0)for(var i=0;i<r.length;i++)t(r[i])}function P(e,t,r){return t!==i&&typeof e[t]===s&&(r||(0,o.v0u)(e,t))&&t!==p&&t!==a}function O(e){(0,o.zkd)("DynamicProto: "+e)}function R(e,t){for(var r=e.length-1;r>=0;r--)if(e[r]===t)return!0;return!1}function x(e,t){return(0,o.v0u)(e,a)?e.name||t||h:((e||{})[i]||{}).name||t||h}function M(e,t,r,n){(0,o.v0u)(e,a)||O("theClass is an invalid class definition.");var i,h=e[a];!function(e,t){if(S){for(var r=[],n=A(t);n&&!_(n)&&!R(r,n);){if(n===e)return!0;r.push(n),n=A(n)}return!1}return!0}(h,t)&&O("["+x(e)+"] not in hierarchy of ["+x(t)+"]");var p=null;(0,o.v0u)(h,u)?p=h[u]:(p="_dynCls$"+x(e,"_")+"$"+k.n,k.n++,h[u]=p);var m=M[f],g=!!m[b];g&&n&&void 0!==n[b]&&(g=!!n[b]);var v=(i=(0,o.sSX)(null),T(t,function(e){!i[e]&&P(t,e,!1)&&(i[e]=t[e])}),i),w=function(e,t,r,n){function i(e,t,r){var o=t[r];if(o[c]&&n){var i=e[l]||{};!1!==i[d]&&(o=(i[t[u]]||{})[r]||o)}return function(){return o.apply(e,arguments)}}var a=(0,o.sSX)(null);T(r,function(e){a[e]=i(t,r,e)});for(var s=A(e),f=[];s&&!_(s)&&!R(f,s);)T(s,function(e){!a[e]&&P(s,e,!S)&&(a[e]=i(t,s,e))}),f.push(s),s=A(s);return a}(h,t,v,g);r(t,w);var C=!!S&&!!m[y];C&&n&&(C=!!n[y]),function(e,t,r,n,i){if(!E(e)){var a=r[l]=r[l]||(0,o.sSX)(null);if(!E(a)){var f=a[t]=a[t]||(0,o.sSX)(null);!1!==a[d]&&(a[d]=!!i),E(f)||T(r,function(t){if(P(r,t,!1)&&r[t]!==n[t]&&(f[t]=r[t],delete r[t],!(0,o.v0u)(e,t)||e[t]&&!e[t][c])){var i;e[t]=((i=function(){var r,n;return((function(e,t,r,n){var i=null;if(e&&(0,o.v0u)(r,u)){var a=e[l]||(0,o.sSX)(null);if((i=(a[r[u]]||(0,o.sSX)(null))[t])||O("Missing ["+t+"] "+s),!i[d]&&!1!==a[d]){for(var c=!(0,o.v0u)(e,t),f=A(e),h=[];c&&f&&!_(f)&&!R(h,f);){var p=f[t];if(p){c=p===n;break}h.push(f),f=A(f)}try{c&&(e[t]=i),i[d]=1}catch(e){a[d]=!1}}}return i})(this,t,e,i)||(r=i,(n=e[t])===r&&(n=A(e)[t]),typeof n!==s&&O("["+t+"] is not a "+s),n)).apply(this,arguments)})[c]=1,i)}})}}}(h,p,t,v,!1!==C)}M[f]=k.o},575432:(e,t,r)=>{"use strict";r.d(t,{H:()=>e8});var n,o,i,a=r(647759),s="prototype",l=Object;l[s],((0,a.mS$)()||{}).Symbol,((0,a.mS$)()||{}).Reflect;var c=function(e,t){return(c=l.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},u="constructor",d="prototype",f="function",h="_dynInstFuncs",p="_isDynProxy",m="_dynClass",g="_dynInstChk",v="_dfOpts",b="_unknown_",y="__proto__",w="_dyn"+y,S="__dynProto$Gbl",C="_dynInstProto",I="useBaseInst",k="setInstFuncs",E=Object,_=E.getPrototypeOf,A=E.getOwnPropertyNames,T=(0,a.mS$)(),P=T[S]||(T[S]={o:((n={})[k]=!0,n[I]=!0,n),n:1e3});function O(e){return e&&(e===E[d]||e===Array[d])}function R(e){return O(e)||e===Function[d]}function x(e){var t;if(e){if(_)return _(e);var r=e[y]||e[d]||(e[u]?e[u][d]:null);t=e[w]||r,(0,a.v0u)(e,w)||(delete e[C],t=e[w]=e[C]||e[w],e[C]=r)}return t}function M(e,t){var r=[];if(A)r=A(e);else for(var n in e)"string"==typeof n&&(0,a.v0u)(e,n)&&r.push(n);if(r&&r.length>0)for(var o=0;o<r.length;o++)t(r[o])}function N(e,t,r){return t!==u&&typeof e[t]===f&&(r||(0,a.v0u)(e,t))&&t!==y&&t!==d}function F(e){(0,a.zkd)("DynamicProto: "+e)}function L(e,t){for(var r=e.length-1;r>=0;r--)if(e[r]===t)return!0;return!1}function z(e,t){return(0,a.v0u)(e,d)?e.name||t||b:((e||{})[u]||{}).name||t||b}function D(e,t,r,n){(0,a.v0u)(e,d)||F("theClass is an invalid class definition.");var o,i=e[d];!function(e,t){if(_){for(var r=[],n=x(t);n&&!R(n)&&!L(r,n);){if(n===e)return!0;r.push(n),n=x(n)}return!1}return!0}(i,t)&&F("["+z(e)+"] not in hierarchy of ["+z(t)+"]");var s=null;(0,a.v0u)(i,m)?s=i[m]:(s="_dynCls$"+z(e,"_")+"$"+P.n,P.n++,i[m]=s);var l=D[v],c=!!l[I];c&&n&&void 0!==n[I]&&(c=!!n[I]);var u=(o=(0,a.sSX)(null),M(t,function(e){!o[e]&&N(t,e,!1)&&(o[e]=t[e])}),o),b=function(e,t,r,n){function o(e,t,r){var o=t[r];if(o[p]&&n){var i=e[h]||{};!1!==i[g]&&(o=(i[t[m]]||{})[r]||o)}return function(){return o.apply(e,arguments)}}var i=(0,a.sSX)(null);M(r,function(e){i[e]=o(t,r,e)});for(var s=x(e),l=[];s&&!R(s)&&!L(l,s);)M(s,function(e){!i[e]&&N(s,e,!_)&&(i[e]=o(t,s,e))}),l.push(s),s=x(s);return i}(i,t,u,c);r(t,b);var y=!!_&&!!l[k];y&&n&&(y=!!n[k]),function(e,t,r,n,o){if(!O(e)){var i=r[h]=r[h]||(0,a.sSX)(null);if(!O(i)){var s=i[t]=i[t]||(0,a.sSX)(null);!1!==i[g]&&(i[g]=!!o),O(s)||M(r,function(t){if(N(r,t,!1)&&r[t]!==n[t]&&(s[t]=r[t],delete r[t],!(0,a.v0u)(e,t)||e[t]&&!e[t][p])){var o;e[t]=((o=function(){var r,n;return((function(e,t,r,n){var o=null;if(e&&(0,a.v0u)(r,m)){var i=e[h]||(0,a.sSX)(null);if((o=(i[r[m]]||(0,a.sSX)(null))[t])||F("Missing ["+t+"] "+f),!o[g]&&!1!==i[g]){for(var s=!(0,a.v0u)(e,t),l=x(e),c=[];s&&l&&!R(l)&&!L(c,l);){var u=l[t];if(u){s=u===n;break}c.push(l),l=x(l)}try{s&&(e[t]=o),o[g]=1}catch(e){i[g]=!1}}}return o})(this,t,e,o)||(r=o,(n=e[t])===r&&(n=x(e)[t]),typeof n!==f&&F("["+t+"] is not a "+f),n)).apply(this,arguments)})[p]=1,o)}})}}}(i,s,t,u,!1!==y)}D[v]=P.o;var B=r(341436),U=r(874314),H=r(758355),q=r(652639),j=r(695213),$=r(880432),W="locale",V="name",G=(0,$.o)({UserExt:[0,"user"],DeviceExt:[1,"device"],TraceExt:[2,"trace"],WebExt:[3,"web"],AppExt:[4,"app"],OSExt:[5,"os"],SdkExt:[6,"sdk"],IntWebExt:[7,"intweb"],UtcExt:[8,"utc"],LocExt:[9,"loc"],CloudExt:[10,"cloud"],DtExt:[11,"dt"]}),K=(0,$.o)({id:[0,"id"],ver:[1,"ver"],appName:[2,V],locale:[3,W],expId:[4,"expId"],env:[5,"env"]}),X=(0,$.o)({domain:[0,"domain"],browser:[1,"browser"],browserVer:[2,"browserVer"],screenRes:[3,"screenRes"],userConsent:[4,"userConsent"],consentDetails:[5,"consentDetails"]}),Y=(0,$.o)({locale:[0,W],localId:[1,"localId"],id:[2,"id"]}),Z=(0,$.o)({osName:[0,V],ver:[1,"ver"]}),Q=(0,$.o)({ver:[0,"ver"],seq:[1,"seq"],installId:[2,"installId"],epoch:[3,"epoch"]}),J=(0,$.o)({msfpc:[0,"msfpc"],anid:[1,"anid"],serviceName:[2,"serviceName"]}),ee=(0,$.o)({popSample:[0,"popSample"],eventFlags:[1,"eventFlags"]}),et=(0,$.o)({tz:[0,"tz"]}),er=(0,$.o)({sessionId:[0,"sesId"]}),en=(0,$.o)({localId:[0,"localId"],deviceClass:[1,"deviceClass"],make:[2,"make"],model:[3,"model"]}),eo=(0,$.o)({role:[0,"role"],roleInstance:[1,"roleInstance"],roleVer:[2,"roleVer"]}),ei=(0,$.o)({traceId:[0,"traceID"],traceName:[1,V],parentId:[2,"parentID"]}),ea=(0,$.o)({traceId:[0,"traceId"],spanId:[1,"spanId"],traceFlags:[2,"traceFlags"]}),es=r(445754),el=r(867073),ec=r(138484),eu=r(861405);function ed(){return void 0===o&&(o=!!eh(0)),o}function ef(){return ed()?eh(0):null}function eh(e){var t,r,n=null;try{var o=(0,a.mS$)();if(!o)return null;r=new Date,(n=0===e?o.localStorage:o.sessionStorage)&&(0,a.Tnt)(n.setItem)&&(n.setItem(r,r),t=n.getItem(r)!==r,n.removeItem(r),t&&(n=null))}catch(e){n=null}return n}function ep(){return this.getId()}function em(e){this.setId(e)}var eg=function(){function e(){D(e,this,function(e){e.setId=function(t){e.customId=t},e.getId=function(){return(0,a.KgX)(e.customId)?e.customId:e.automaticId}})}return e._staticInit=void(0,a.vF1)(e.prototype,"id",{g:ep,s:em}),e}(),ev="ai_session",eb=function(){function e(t,r,n){var i,s,l,c=(0,el.y0)(t),u=(0,ec.um)(t);D(e,this,function(t){var d=(0,U.a)(r,function(){l=r,t.config=l});function f(e){var r=t.automaticSession,n=e.split("|");n.length>0&&r.setId(n[0]);try{if(n.length>1){var o=+n[1];r.acquisitionDate=+new Date(o),r.acquisitionDate=r.acquisitionDate>0?r.acquisitionDate:0}if(n.length>2){var i=+n[2];r.renewalDate=+new Date(i),r.renewalDate=r.renewalDate>0?r.renewalDate:0}}catch(e){(0,el.ZP)(c,1,510,"Error parsing ai_session cookie, session will be reset: "+e)}0===r.renewalDate&&(0,el.ZP)(c,2,517,"AI session renewal date is 0, session will be reset.")}function h(){var e=t.automaticSession,r=new Date().getTime(),n=t.config.sessionAsGuid;!(0,a.b07)(n)&&n?(0,a.Lmq)(n)?e.setId((0,B.gj)()):e.setId((0,B.gj)(n)):e.setId((0,eu.Si)(l.idLength||22)),e.acquisitionDate=r,e.renewalDate=r,p(e.getId(),e.acquisitionDate,e.renewalDate),ed()||(0,el.ZP)(c,2,505,"Browser does not support local storage. Session durations will be inaccurate.")}function p(e,r,n){var o=r+t.config.sessionExpirationMs,a=n+t.config.sessionRenewalMs,l=new Date;o<a?l.setTime(o):l.setTime(a);var c=t.config.cookieDomain||null;u.set(s(),[e,r,n].join("|")+";expires="+l.toUTCString(),null,c),i=new Date().getTime()}n&&n.add(d),s=function(){return t.config.namePrefix?ev+t.config.namePrefix:ev},t.automaticSession=new eg,t.update=function(){t.automaticSession.getId()||function(){var e=u.get(s());if(e&&(0,a.Tnt)(e.split))f(e);else{var r=function(e,t){var r=ef();if(null!==r)try{return r.getItem(t)}catch(t){o=!1,(0,el.ZP)(e,1,503,"Browser failed read of local storage. "+t)}return null}(c,s());r&&f(r)}t.automaticSession.getId()||h()}();var r=t.automaticSession,n=t.config,l=new Date().getTime(),d=l-r.acquisitionDate>n.sessionExpirationMs,m=l-r.renewalDate>n.sessionRenewalMs;if(d||m)h();else{var g=i;(!g||l-g>e.cookieUpdateInterval)&&(r.renewalDate=l,p(r.getId(),r.acquisitionDate,r.renewalDate))}},t.backup=function(){var e,r,n,i=t.automaticSession;e=i.getId(),r=i.acquisitionDate,n=i.renewalDate,function(e,t,r){var n=ef();if(null!==n)try{n.setItem(t,r)}catch(t){o=!1,(0,el.ZP)(e,1,504,"Browser failed write to local storage. "+t)}}(c,s(),[e,r,n].join("|"))}})}return e.cookieUpdateInterval=6e4,e}(),ey=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];function ew(e,t){void 0===t&&(t=ey);var r=null;if(e)for(var n=e.split(","),o=0;o<n.length;o++)(function(e,t){if(void 0===t&&(t=ey),!e||e.length<4)return!1;for(var r=!1,n=e.substring(0,3).toString().toUpperCase(),o=0;o<t.length;o++)if(t[o]+":"===n&&e.length<=256){r=!0;break}return r})(n[o],t)&&(r?r+=","+n[o]:r=n[o]);return r}function eS(){return this.getExpId()}var eC=function(){function e(t,r,n){var o,i=null,s=ey.slice(0),l=null;D(e,this,function(e){if(c=(0,U.a)(t,function(){o=r&&r.getCookieMgr(),l=t||{},e.env=l.env||function(e){var t,r={},n=(0,a.YEm)();if(n){t=n&&n.querySelectorAll("meta");for(var o=0;o<t.length;o++){var i=t[o];i.name&&0===i.name.toLowerCase().indexOf(e)&&(r[i.name.replace(e,"")]=i.content)}}return r}("awa-").env}),n&&n.add(c),(0,a.Wtk)()){var c,u=(0,a.YEm)().documentElement;u&&(e.locale=u.lang)}function d(e){e!==i&&(i=ew(e,s))}e.getExpId=function(){return l.expId?d(l.expId):d((0,B.UM)(o,"Treatments")),i}})}return e.validateAppExpId=ew,e._staticInit=void(0,a.vF1)(e.prototype,"expId",{g:eS}),e}(),eI=function(){},ek=function(){};function eE(){return this.getMsfpc()}function e_(){return this.getAnid()}var eA=function(){var e;function t(e,r,n){var o;D(t,this,function(t){var i;i=(0,U.a)(e,function(){o=r&&r.getCookieMgr();var n=e||{};n.serviceName&&(t.serviceName=n.serviceName)}),n&&n.add(i),t.getMsfpc=function(){return(0,B.UM)(o,"MSFPC")},t.getAnid=function(){return(0,B.UM)(o,"ANON").slice(0,34)}})}return t._staticInit=(e=t.prototype,void((0,a.vF1)(e,"msfpc",{g:eE}),(0,a.vF1)(e,"anid",{g:e_}))),t}(),eT=function(){var e=new Date().getTimezoneOffset(),t=e%60,r=(e-t)/60,n="+";r>0&&(n="-"),r=Math.abs(r),t=Math.abs(t),this.tz=n+(r<10?"0"+r:r.toString())+":"+(t<10?"0"+t:t.toString())},eP={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(ipad|iphone|ipod)(?=.*like mac os x)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},eO={"5.1":"XP","6.0":"Vista","6.1":"7","6.2":"8","6.3":"8.1","10.0":"10"},eR="([\\d,_,.]+)",ex="Unknown",eM=[{r:eP.WINPHONE,os:"Windows Phone"},{r:eP.WINRT,os:"Windows RT"},{r:eP.WIN,os:"Windows"},{r:eP.IOS,os:"iOS"},{r:eP.ANDROID,os:"Android"},{r:eP.LINUX,os:"Linux"},{r:eP.CROS,os:"Chrome OS"},{s:"x11",os:"Unix"},{s:"blackberry",os:"BlackBerry"},{s:"symbian",os:"Symbian"},{s:"nokia",os:"Nokia"},{r:eP.OSX,os:"Mac OS X"}];function eN(e,t){var r=e.match(RegExp(t+" ([\\d,.]+)"));return r?eO[r[1]]?eO[r[1]]:r[1]:ex}function eF(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}var eL=function(e,t){var r=null,n=null,o=null,i=null,s=(0,U.a)(e,function(){if((e||{}).populateOperatingSystemInfo){var t=(0,a.w3n)()||{},o=e.userAgent||t.userAgent||"",i=(e.userAgentData||{}).platform||(t.userAgentData||{}).platform;if(o){var s=function(e){for(var t=0;t<eM.length;t++){var r=eM[t];if(r.r&&e.match(r.r)||r.s&&-1!==e.indexOf(r.s))return r.os}return ex}(o.toLowerCase());r=s,n="Windows"===s?eN(o,"Windows NT"):"Android"===s?eN(o,s):"Mac OS X"===s?function(e){var t=e.match(RegExp("Mac OS X "+eR));if(t){var r=t[1].replace(/_/g,".");if(r){var n=eF(r);return n?r.split(n)[0]:r}}return ex}(o):"iOS"===s?function(e){var t=e.match(RegExp("OS "+eR));if(t){var r=t[1].replace(/_/g,".");if(r){var n=eF(r);return n?r.split(n)[0]:r}}return ex}(o):ex}(!r||r===ex)&&(0,a.KgX)(i)&&(r=i)}});t&&t.add(s),(0,a.vF1)(this,"name",{s:function(e){o=e},g:function(){return o||r}}),(0,a.vF1)(this,"ver",{s:function(e){i=e},g:function(){return i||n}})},ez=r(235468),eD="MicrosoftApplicationsTelemetryDeviceId",eB=function(){function e(t,r,n){var o,i=0;D(e,this,function(e){e.seq=i,e.epoch=(0,eu.VN)(!1).toString(),e.getSequenceId=function(){return++i};var a=(0,U.a)(t,function(t){o=r&&r.getCookieMgr();var n=t.cfg.propertyStorageOverride;if(o.isEnabled()||n){var i,a=n?n.getProperty(eD)||"":(0,B.UM)(o,eD);a||(a=(0,ez.aq)()),i=a,n?n.setProperty(eD,i):o.set(eD,i,31536e3),e.installId=a}else o.purge(eD)});n&&n.add(a)})}return e.__ieDyn=1,e}(),eU=r(734150),eH=function(e,t,r,n,o){var i=this;i.traceId=t||(0,ez.cL)();var a=(0,U.a)(e,function(){if(e.enableDistributedTracing&&!r&&(r=(0,ez.cL)().substring(0,16)),i.parentId=i.parentId||r,e.enableApplicationInsightsTrace&&!n){var t=(0,eU.g$)();t&&t.pathname&&(n=t.pathname)}i.name=i.name||n});o&&o.add(a)},eq=r(437895),ej="setLocalId";function e$(){return this.getLocalId()}function eW(e){this[ej](e)}var eV=function(){function e(t,r,n,o){var i,s,l;D(e,this,function(c){if(u=(0,U.a)(r,function(){if(l=n&&n.getCookieMgr(),i=r,s=null,l&&l.isEnabled()&&(f(),i.enableApplicationInsightsUser)){var o=(0,B.UM)(l,e.userCookieName);if(o){var u=o.split(e.cookieSeparator);u.length>0&&(c.id=u[0])}if(!c.id){c.id=(0,eu.Si)(t&&!(0,a.b07)(t.idLength)?t.idLength:22);var d=(0,eq._u)(new Date);c.accountAcquisitionDate=d;var h=[c.id,d],p=i.cookieDomain?i.cookieDomain:void 0;l.set(e.userCookieName,h.join(e.cookieSeparator),31536e3,p)}}}),o&&o.add(u),"undefined"!=typeof navigator){var u,d=navigator;c.locale=d.userLanguage||d.language}function f(){if(!i.hashIdentifiers&&!i.dropIdentifiers){var e=(0,B.UM)(l,"MUID");e&&(s="t:"+e)}return s}c.getLocalId=function(){return s||f()},c[ej]=function(e){s=e}})}return e.cookieSeparator="|",e.userCookieName="ai_user",e._staticInit=void(0,a.vF1)(e.prototype,"localId",{g:e$,s:eW}),e}(),eG=function(e,t){var r=this;r.popSample=100;var n=(0,U.a)(e,function(){r.eventFlags=0,e.hashIdentifiers&&(r.eventFlags=1048576|r.eventFlags),e.dropIdentifiers&&(r.eventFlags=2097152|r.eventFlags),e.scrubIpOnly&&(r.eventFlags=4194304|r.eventFlags)});t&&t.add(n)},eK=["Required","Analytics","SocialMedia","Advertising"],eX="([\\d,.]+)",eY="Unknown",eZ="Edg/",eQ=[{ua:"OPR/",b:"Opera"},{ua:"PhantomJS",b:"PhantomJS"},{ua:"Edge",b:"Edge"},{ua:eZ,b:"Edge"},{ua:"Electron",b:"Electron"},{ua:"Chrome",b:"Chrome"},{ua:"Trident",b:"MSIE"},{ua:"MSIE ",b:"MSIE"},{ua:"Firefox",b:"Firefox"},{ua:"Safari",b:"Safari"},{ua:"SkypeShell",b:"SkypeShell"}],eJ=[{br:"Microsoft Edge",b:"Edge"},{br:"Google Chrome",b:"Chrome"},{br:"Opera",b:"Opera"}];function e0(e,t){return t.indexOf(e)>-1}function e1(){return this.getUserConsent()}var e2=function(){function e(t,r,n){(0,ec.um)(r);var o=t||{},i=null,s=null,l=null,c=null,u=null,d=null,f=null;D(e,this,function(e){r=(0,U.a)(t,function(){if((o=t).populateBrowserInfo){var e=o.userAgent,r=(o.userAgentData||{}).brands;if(e!==i||r!==s){if(!e||!r||0===r.length){var n=(0,a.w3n)();n&&(e=e||n.userAgent||"",r=r||(n.userAgentData||{}).brands)}(function(e,t){if((0,a.cyL)(t))try{for(var r=0;r<eJ.length;r++){var n=function(e,t){for(var r=0;r<t.length;r++)if(e==t[r].brand)return t[r].version;return null}(eJ[r].br,t);if(n){u=eJ[r].b,d=n;return}}}catch(e){}if(e){var o,i,s=function(e){if(e){for(var t=0;t<eQ.length;t++)if(e0(eQ[t].ua,e))return eQ[t].b}return eY}(e);u=s,d="MSIE"===s?function(e){var t=e.match(RegExp("MSIE "+eX));if(t)return t[1];var r=e.match(RegExp("rv:"+eX));if(r)return r[1]}(e):("Safari"===(o=s)?o="Version":"Edge"===o&&e0(eZ,e)&&(o="Edg"),(i=e.match(RegExp(o+"/"+eX)))||"Opera"===o&&(i=e.match(RegExp("OPR/"+eX)))?i[1]:eY)}})(e,r),i=e,s=r}}f=(0,a.Lmq)(o.gpcDataSharingOptIn)?o.gpcDataSharingOptIn:null}),n&&n.add(r);var r,h,p,m=(0,eU.g$)();if(m){var g=m.hostname;g&&(e.domain="file:"===m.protocol?"local":g)}var v=(h={h:0,w:0},(p=(0,a.zkX)())&&p.screen&&(h.h=screen.height,h.w=screen.width),h);e.screenRes=v.w+"X"+v.h,e.getUserConsent=function(){return!1},e.getUserConsentDetails=function(){var e=null;try{var t=o.callback;if(t&&t.userConsentDetails){var r=t.userConsentDetails();if(r){e=o.disableConsentDetailsSanitize?r:{};for(var n=0;n<eK.length;n++){var i=eK[n];e[i]=r[i]||!1}}}return null!==f&&((e=e||{}).GPC_DataSharingOptIn=!!f),e?JSON.stringify(e):null}catch(e){}},(0,a.lKJ)(e,{userConsent:{g:e.getUserConsent},browser:{s:function(e){l=e},g:function(){return l||u}},browserVer:{s:function(e){c=e},g:function(){return c||d}},gpcDataSharingOptIn:{g:function(){return f},s:function(e){f=(0,a.Lmq)(e)?e:null,o.gpcDataSharingOptIn=f}}})})}return e._staticInit=void(0,a.vF1)(e.prototype,"userConsent",{g:e1}),e}();function e3(e,t,r,n,o){var i=t.ext[G[e]];if(i)try{(0,a.zav)(n,function(e,t){if((0,a.KgX)(t)||(0,a.EtT)(t)||(0,a.Lmq)(t)){var n=i[r[e]];!o&&(n||(0,a.KgX)(n)||(0,a.EtT)(n)||(0,a.Lmq)(n))&&(t=n),i[r[e]]=t}})}catch(e){}return i}var e5=function(){function e(t,r,n,o){D(e,this,function(e){e.app=new eC(r,n,o),e.cloud=new eI,e.user=new eV(t,r,n,o),e.os=new eL(r,o),e.web=new e2(r,n,o);var i,s,l,c=new eB(t,n,o),u=new eA(r,n,o),d=new eG(r,o);e.loc=new eT,e.device=new ek;var f=new eb(n,r,o);e.session=new eg;var h=void 0,p=(i=new eH(r,h,h,h,o),s=v(),l=i||{},{getName:function(){return l.name},setName:function(e){s&&s.setName(e),l.name=e},getTraceId:function(){return l.traceId},setTraceId:function(e){s&&s.setTraceId(e),(0,es.hX)(e)&&(l.traceId=e)},getSpanId:function(){return l.parentId},setSpanId:function(e){s&&s.setSpanId(e),(0,es.wN)(e)&&(l.parentId=e)},getTraceFlags:function(){return l.traceFlags},setTraceFlags:function(e){s&&s.setTraceFlags(e),l.traceFlags=e}}),m=!(r||{}).eventContainExtFields;function g(){var t=e.session;if(t&&(0,a.KgX)(t.customId))return t.customId;f.update();var r=f.automaticSession;if(r){var n=r.getId();n&&(0,a.KgX)(n)&&(t.automaticId=n)}return t.automaticId}function v(){var e=p;return n&&n.getTraceCtx&&(e=n.getTraceCtx(!1)||p),e}e.getTraceCtx=function(){return p},e.getSessionId=g,e.applyApplicationContext=function(t){var r,n=e.app;e3(4,t,K,((r={})[0]=n.id,r[1]=n.ver,r[2]=n.name,r[3]=n.locale,r[4]=n.getExpId(),r[5]=n.env,r),m)},e.applyUserContext=function(t){var r,n=e.user;e3(0,t,Y,((r={})[1]=n.getLocalId(),r[0]=n.locale,r[2]=n.id,r),m)},e.applyWebContext=function(t){var r,n=e.web;e3(3,t,X,((r={})[0]=n.domain,r[1]=n.browser,r[2]=n.browserVer,r[3]=n.screenRes,r[5]=n.getUserConsentDetails(),r[4]=!1,r),m)},e.applyOsContext=function(t){var r,n=e.os;e3(5,t,Z,((r={})[0]=n.name,r[1]=n.ver,r),m)},e.applySdkContext=function(e){var t;e3(6,e,Q,((t={})[2]=c.installId,t[1]=c.getSequenceId(),t[3]=c.epoch,t),m)},e.applyIntWebContext=function(e){var t;e3(7,e,J,((t={})[0]=u.getMsfpc(),t[1]=u.getAnid(),t[2]=u.serviceName,t),m)},e.applyUtcContext=function(e){var t,r=((t={})[0]=d.popSample,t);d.eventFlags>0&&(r[1]=d.eventFlags),e3(8,e,ee,r,m)},e.applyLocContext=function(t){var r;e3(9,t,et,((r={})[0]=e.loc.tz,r),m)},e.applySessionContext=function(e){var t;e3(4,e,er,((t={})[0]=g(),t),m)},e.applyDeviceContext=function(t){var r,n=e.device;e3(1,t,en,((r={})[0]=n.localId,r[2]=n.make,r[3]=n.model,r[1]=n.deviceClass,r),m)},e.applyCloudContext=function(t){var r,n=e.cloud;e3(10,t,eo,((r={})[0]=n.role,r[1]=n.roleInstance,r[2]=n.roleVer,r),m)},e.applyAITraceContext=function(e){var t;if(r.enableApplicationInsightsTrace){var n=v();n&&e3(2,e,ei,((t={})[0]=n.getTraceId(),t[1]=n.getName(),t[2]=n.getSpanId(),t),!1)}},e.applyDistributedTraceContext=function(e){var t,r=v();if(r){var n=((t={})[0]=r.getTraceId(),t[1]=r.getSpanId(),t),o=r.getTraceFlags();(0,a.hXl)(o)||(n[2]=o),e3(11,e,ea,n,!1)}}})}return e.__ieDyn=1,e}(),e6=[G[4],G[0],G[3],G[5],G[6],G[7],G[8],G[9],G[1],G[2],G[11],G[10]],e4=(0,a.ZHX)({populateBrowserInfo:!1,populateOperatingSystemInfo:!1,userAgent:(0,j.ej)(),userAgentData:(0,j.NU)({brands:i,mobile:i,platform:i}),userConsentCookieName:(0,j.ej)(),userConsented:!1,serviceName:(0,j.ej)(),env:(0,j.ej)(),expId:(0,j.ej)(),sessionRenewalMs:18e5,sessionExpirationMs:864e5,sessionAsGuid:null,cookieDomain:(0,j.ej)(),namePrefix:(0,j.ej)(),enableApplicationInsightsTrace:!1,enableApplicationInsightsUser:!1,hashIdentifiers:!1,dropIdentifiers:!1,scrubIpOnly:!1,callback:(0,j.NU)({userConsentDetails:null}),gpcDataSharingOptIn:i,idLength:22,enableDistributedTracing:!1,eventContainExtFields:!1}),e8=function(e){function t(){var r,n,o,i=e.call(this)||this;return i.identifier="SystemPropertiesCollector",i.priority=3,i.version="4.3.0",D(t,i,function(e,t){function i(){r=null,n={}}i(),e.initialize=function(n,i,a){var s,l;t.initialize(n,i,a),s=e.identifier,l=e.core,e._addHook((0,U.a)(n,function(){o=(0,H.i8)(null,n,l).getExtCfg(s,e4)})),r=new e5(n,o,l,e._unloadHooks),l&&l.setTraceCtx&&l.setTraceCtx(r.getTraceCtx())},e.processTelemetry=function(t,i){(0,B.u9)(t,e.identifier),i=e._getTelCtx(i);var s,l,c=t.ext=t.ext?t.ext:{};t.data=t.data?t.data:{},(0,a.Iuo)(e6,function(e){c[e]=c[e]||{}}),r&&(r.applyUtcContext(t),r.applyApplicationContext(t),r.applyUserContext(t),r.applyWebContext(t),r.applyOsContext(t),r.applySdkContext(t),r.applyIntWebContext(t),r.applyLocContext(t),r.applySessionContext(t),r.applyDeviceContext(t),o.enableApplicationInsightsTrace&&r.applyAITraceContext(t),o.enableDistributedTracing&&r.applyDistributedTraceContext(t),r.applyCloudContext(t)),(0,a.Iuo)((0,a.cGk)(c),function(e){0===(0,a.cGk)(c[e]).length&&delete c[e]}),s=n,l=t.data,s&&(0,a.zav)(s,function(e,t){l[e]||(l[e]=t)}),e.processNext(t,i)},e.getPropertiesContext=function(){return r},e.setProperty=function(e,t){n[e]=t},e._doTeardown=function(e,t){var n=(e||{}).core();if(n&&n.getTraceCtx&&r){var o=n.getTraceCtx(!1);o&&o===r.getTraceCtx()&&n.setTraceCtx(null)}i()},e._getDbgPlgTargets=function(){return[o]}}),i}return function(e,t){function r(){this.constructor=e}"function"!=typeof t&&null!==t&&(0,a.zkd)("Class extends value "+String(t)+" is not a constructor or null"),c(e,t),e[s]=null===t?(0,a.sSX)(t):(r[s]=t[s],new r)}(t,e),t.__ieDyn=1,t}(q.s)},695213:(e,t,r)=>{"use strict";r.d(t,{NU:()=>i,ej:()=>a});var n=r(647759),o=r(78050);function i(e){return{mrg:!0,v:e}}function a(e){return{isVal:n.KgX,v:(0,n.oJg)(e||o.m5)}}},249725:(e,t,r)=>{"use strict";r.d(t,{q:()=>function e(t,r,s,l){i(l)?(c=l.isVal,u=l.set,p=l[o.XW],m=l[o.JQ],f=l.mrg,!(h=l.ref)&&(0,n.b07)(h)&&(h=!!f),d=a(t,r,l)):d=l,m&&t[o.JQ](r,s);var c,u,d,f,h,p,m,g,v=!0,b=r[s];(b||!(0,n.hXl)(b))&&(g=b,v=!1,c&&g!==d&&!c(g)&&(g=d,v=!0),u&&(v=(g=u(g,d,r))===d)),v?g=d?function e(t,r,s){var l,c=s;return s&&i(s)&&(c=a(t,r,s)),c&&(i(c)&&(c=e(t,r,c)),(0,n.cyL)(c)?(l=[])[o.oI]=c[o.oI]:(0,n.QdQ)(c)&&(l={}),l&&((0,n.zav)(c,function(n,o){o&&i(o)&&(o=e(t,r,o)),l[n]=o}),c=l)),c}(t,r,d):d:((0,n.QdQ)(g)||(0,n.cyL)(d))&&f&&d&&((0,n.QdQ)(d)||(0,n.cyL)(d))&&(0,n.zav)(d,function(r,n){e(t,g,r,n)}),t.set(r,s,g),h&&t.ref(r,s),p&&t[o.XW](r,s)}});var n=r(647759),o=r(793940);function i(e){return e&&(0,n.Gvm)(e)&&(e.isVal||e.fb||(0,n.KhI)(e,"v")||(0,n.KhI)(e,"mrg")||(0,n.KhI)(e,"ref")||e.set)}function a(e,t,r){var i,a=r.dfVal||n.O9V;if(t&&r.fb){var s=r.fb;(0,n.cyL)(s)||(s=[s]);for(var l=0;l<s[o.oI];l++){var c=s[l],u=t[c];if(a(u)?i=u:e&&(a(u=e.cfg[c])&&(i=u),e.set(e.cfg,(0,n.oJg)(c),u)),a(i))break}}return!a(i)&&a(r.v)&&(i=r.v),i}},874314:(e,t,r)=>{"use strict";r.d(t,{a:()=>f,e:()=>d});var n=r(647759),o=r(356746),i=r(78050),a=r(793940),s=r(249725),l=r(584917),c=r(256283),u=r(635609);function d(e,t,r,i){var d=function(e,t,r){var i,d,f=(0,u.QA)(t);if(f)return f;var h=(0,o.Z)("dyncfg",!0),p=t&&!1!==r?t:(0,u.Dy)(t),m=((i={uid:null,cfg:p})[a.Uw]=e,i[a.zs]=function(){d[a.zs]()},i.set=function(t,r,n){try{t=(0,l.av)(d,t,r,n)}catch(t){(0,l.Ds)(e,r,"Setting value",t)}return t[r]},i[a.h0]=function(e,t){return t&&(0,n.zav)(t,function(t,r){(0,s.q)(m,e,t,r)}),e},i[a.x6]=function(e){var t,r,o;return t=d,o={fn:r=e,rm:function(){o.fn=null,t=null,r=null}},(0,n.vF1)(o,"toJSON",{v:function(){return"WatcherHandler"+(o.fn?"":"[X]")}}),t.use(o,r),o},i.ref=function(e,t){var r;return(0,l.tF)(d,e,t,((r={})[0]=!0,r))[t]},i[a.XW]=function(e,t){var r;return(0,l.tF)(d,e,t,((r={})[1]=!0,r))[t]},i[a.JQ]=function(e,t){var r;return(0,l.tF)(d,e,t,((r={})[2]=!0,r))[t]},i._block=function(e,t){d.use(null,function(r){var o=d.upd;try{(0,n.b07)(t)||(d.upd=t),e(r)}finally{d.upd=o}})},i);return(0,n.vF1)(m,"uid",{c:!1,e:!1,w:!1,v:h}),d=(0,c.B)(m),(0,l.i5)(d,p,"config","Creating"),m}(r,e||{},i);return t&&d[a.h0](d.cfg,t),d}function f(e,t,r){var o,s=e[u.nM]||e;return s.cfg&&(s.cfg===e||s.cfg[u.nM]===s)?s[a.x6](t):(o=i.xW+(0,n.mmD)(e),r?(r[a.on](o),r[a.ih](2,108,o)):(0,u.If)(o),d(e,null,r)[a.x6](t))}},584917:(e,t,r)=>{"use strict";r.d(t,{Ds:()=>l,av:()=>u,i5:()=>f,tF:()=>d});var n=r(647759),o=r(78050),i=r(793940),a=r(635609),s=["push","pop","shift","unshift","splice"],l=function(e,t,r,o){e&&e[i.ih](3,108,"".concat(r," [").concat(t,"] failed - ")+(0,n.mmD)(o))};function c(e,t){var r=(0,n.kgX)(e,t);return r&&r.get}function u(e,t,r,s){if(t){var d=c(t,r);d&&d[e.prop]?t[r]=s:function(e,t,r,s){var d={n:r,h:[],trk:function(t){t&&t.fn&&(-1===(0,n.rDm)(d.h,t)&&d.h[i.y5](t),e.trk(t,d))},clr:function(e){var t=(0,n.rDm)(d.h,e);-1!==t&&d.h[i.Ic](t,1)}},h=!0,p=!1;function m(){h&&(p=p||(0,a.hF)(m,e,s),s&&!s[a.nM]&&p&&(s=f(e,s,r,"Converting")),h=!1);var t=e.act;return t&&d.trk(t),s}m[e.prop]={chng:function(){e.add(d)}},(0,n.vF1)(t,d.n,{g:m,s:function(g){if(s!==g){m[e.ro]&&!e.upd&&(0,a.If)("["+r+"] is read-only:"+(0,n.mmD)(t)),h&&(p=p||(0,a.hF)(m,e,s),h=!1);var v=p&&m[e.rf];if(p){if(v){(0,n.zav)(s,function(e){s[e]=g?g[e]:o.HP});try{(0,n.zav)(g,function(t,r){u(e,s,t,r)}),g=s}catch(t){l((e.hdlr||{})[i.Uw],r,"Assigning",t),p=!1}}else s&&s[a.nM]&&(0,n.zav)(s,function(t){var r=c(s,t);if(r){var n=r[e.prop];n&&n.chng()}})}if(g!==s){var b=g&&(0,a.hF)(m,e,g);!v&&b&&(g=f(e,g,r,"Converting")),s=g,p=b}e.add(d)}}})}(e,t,r,s)}return t}function d(e,t,r,n){if(t){var o=c(t,r),s=o&&!!o[e.prop],d=n&&n[0],f=n&&n[1],h=n&&n[2];if(!s){if(h)try{(0,a.V9)(t)}catch(t){l((e.hdlr||{})[i.Uw],r,"Blocking",t)}try{u(e,t,r,t[r]),o=c(t,r)}catch(t){l((e.hdlr||{})[i.Uw],r,"State",t)}}d&&(o[e.rf]=d),f&&(o[e.ro]=f),h&&(o[e.blkVal]=!0)}return t}function f(e,t,r,o){try{(0,n.zav)(t,function(r,n){u(e,t,r,n)}),!t[a.nM]&&((0,n.UxO)(t,a.nM,{get:function(){return e[i.K0]}}),(0,n.cyL)(t)&&(0,n.Iuo)(s,function(n){var o=t[n];t[n]=function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var s=o[i.y9](this,n);return f(e,t,r,"Patching"),s}}))}catch(t){l((e.hdlr||{})[i.Uw],r,o,t)}return t}},256283:(e,t,r)=>{"use strict";r.d(t,{B:()=>s});var n=r(647759),o=r(387110),i=r(793940),a="[[ai_";function s(e){var t,r,s=(0,n.jjc)(a+"get"+e.uid+"]]"),l=(0,n.jjc)(a+"ro"+e.uid+"]]"),c=(0,n.jjc)(a+"rf"+e.uid+"]]"),u=(0,n.jjc)(a+"blkVal"+e.uid+"]]"),d=(0,n.jjc)(a+"dtl"+e.uid+"]]"),f=null,h=null;function p(t,o){var a=r.act;try{r.act=t,t&&t[d]&&((0,n.Iuo)(t[d],function(e){e.clr(t)}),t[d]=[]),o({cfg:e.cfg,set:e.set.bind(e),setDf:e[i.h0].bind(e),ref:e.ref.bind(e),rdOnly:e[i.XW].bind(e)})}catch(t){var s=e[i.Uw];throw s&&s[i.ih](1,107,(0,n.mmD)(t)),t}finally{r.act=a||null}}function m(){if(f){var e=f;f=null,h&&h[i._w](),h=null;var t=[];if((0,n.Iuo)(e,function(e){if(e&&(e[d]&&((0,n.Iuo)(e[d],function(t){t.clr(e)}),e[d]=null),e.fn))try{p(e,e.fn)}catch(e){t[i.y5](e)}}),f)try{m()}catch(e){t[i.y5](e)}t[i.oI]>0&&(0,o.P)("Watcher error(s): ",t)}}return(t={prop:s,ro:l,rf:c})[i.JQ]=u,t[i.K0]=e,t.add=function(e){if(e&&e.h[i.oI]>0){f||(f=[]),h||(h=(0,n.dRz)(function(){h=null,m()},0));for(var t=0;t<e.h[i.oI];t++){var r=e.h[t];r&&-1===(0,n.rDm)(f,r)&&f[i.y5](r)}}},t[i.zs]=m,t.use=p,t.trk=function(e,t){if(e){var r=e[d]=e[d]||[];-1===(0,n.rDm)(r,t)&&r[i.y5](t)}},r=t}},635609:(e,t,r)=>{"use strict";r.d(t,{Dy:()=>function e(t){if(t){var r;if((0,n.cyL)(t)?(r=[])[o.oI]=t[o.oI]:(0,n.QdQ)(t)&&(r={}),r)return(0,n.zav)(t,function(t,n){r[t]=e(n)}),r}return t},If:()=>d,QA:()=>l,V9:()=>c,hF:()=>u,nM:()=>i});var n=r(647759),o=r(793940),i=(0,n.eCG)("[[ai_dynCfg_1]]"),a=(0,n.eCG)("[[ai_blkDynCfg_1]]"),s=(0,n.eCG)("[[ai_frcDynCfg_1]]");function l(e){if(e){var t=e[i]||e;if(t.cfg&&(t.cfg===e||t.cfg[i]===t))return t}return null}function c(e){if(e&&((0,n.QdQ)(e)||(0,n.cyL)(e)))try{e[a]=!0}catch(e){}return e}function u(e,t,r){var o=!1;return!r||e[t.blkVal]||(o=r[s])||r[a]||(o=(0,n.QdQ)(r)||(0,n.cyL)(r)),o}function d(e){(0,n.zkd)("InvalidAccess:"+e)}},880432:(e,t,r)=>{"use strict";r.d(t,{H:()=>o,o:()=>i});var n=r(647759),o=n.WSA,i=n.fn0},351420:(e,t,r)=>{"use strict";r.d(t,{x:()=>o});var n=r(880432),o=(0,n.H)({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5});(0,n.H)({Unknown:0,NonRetryableStatus:1,CleanStorage:2,MaxInStorageTimeExceeded:3})},32893:(e,t,r)=>{"use strict";r.d(t,{f:()=>n});var n=(0,r(880432).H)({NONE:0,PENDING:3,INACTIVE:1,ACTIVE:2})},387110:(e,t,r)=>{"use strict";r.d(t,{P:()=>a});var n,o=r(647759),i=r(793940);function a(e,t){n||(n=(0,o.aqQ)("AggregationError",function(e,t){t[i.oI]>1&&(e.errors=t[1])}));var r=e||"One or more errors occurred.";throw(0,o.Iuo)(t,function(e,t){r+="\n".concat(t," > ").concat((0,o.mmD)(e))}),new n(r,t||[])}},67345:(e,t,r)=>{"use strict";r.d(t,{_:()=>x});var n,o=r(533705),i=r(387657),a=r(659495),s=r(647759),l=r(874314),c=r(32893),u=r(793940),d=r(565875),f=r(126529),h=r(138484),p=r(356746),m=r(209689),g=r(867073),v=r(437895),b=r(78050),y=r(398274),w=r(739426),S=r(758355),C=r(623406),I=r(191752),k=r(155422),E=r(460699),_="Plugins must provide initialize method",A="SDK is still unloading...",T=(0,s.ZHX)(((n={cookieCfg:{}})[b.jy]={rdOnly:!0,ref:!0,v:[]},n[b.LZ]={rdOnly:!0,ref:!0,v:[]},n[b.Bw]={ref:!0,v:{}},n[b.Yd]=b.HP,n.loggingLevelConsole=0,n.diagnosticLogInterval=b.HP,n));function P(e,t){return new w.NS(t)}function O(e,t){var r=!1;return(0,s.Iuo)(t,function(t){if(t===e)return r=!0,-1}),r}function R(e,t){var r=null,n=-1;return(0,s.Iuo)(e,function(e,o){if(e.w===t)return r=e,n=o,-1}),{i:n,l:r}}var x=function(){function e(){var t,r,n,x,M,N,F,L,z,D,B,U,H,q,j,$,W,V,G,K,X,Y,Z,Q,J,ee,et,er,en,eo,ei,ea;(0,i.A)(e,this,function(e){function i(){en=!0,(0,s.hXl)(X)?(ee=c.f[u.Yq],(0,g.ZP)(n,1,112,"ikey can't be resolved from promises")):ee=c.f.ACTIVE,es()}function es(){r&&(e.releaseQueue(),e[u.h4]())}function el(e){return(!eo||!eo[u.XM])&&!ea&&(e||n&&n.queue[u.oI]>0)&&(ei||(ei=!0,eS(t[u.x6](function(e){var t=e.cfg.diagnosticLogInterval;t&&t>0||(t=1e4);var r=!1;eo&&(r=eo[u.XM],eo[u._w]()),(eo=(0,s.AHH)(eg,t)).unref(),eo[u.XM]=r}))),eo[u.XM]=!0),eo}function ec(){var e={};Q=[];var t=function(t){t&&(0,s.Iuo)(t,function(t){if(t[u.Ju]&&t[u.s]&&!e[t.identifier]){var r=t[u.Ju]+"="+t[u.s];Q[u.y5](r),e[t.identifier]=t}})};t(U),B&&(0,s.Iuo)(B,function(e){t(e)}),t(D)}function eu(){r=!1,(t=(0,l.e)({},T,e[u.Uw])).cfg[u.Bl]=1,(0,s.vF1)(e,"config",{g:function(){return t.cfg},s:function(t){e.updateCfg(t,!1)}}),(0,s.vF1)(e,"pluginVersionStringArr",{g:function(){return Q||ec(),Q}}),(0,s.vF1)(e,"pluginVersionString",{g:function(){return J||(Q||ec(),J=Q.join(";")),J||b.m5}}),(0,s.vF1)(e,"logger",{g:function(){return n||(n=new g.wq(t.cfg),t[u.Uw]=n),n},s:function(e){t[u.Uw]=e,n!==e&&((0,d.K)(n,!1),n=e)}}),e[u.Uw]=new g.wq(t.cfg),Z=[];var o=e.config[b.jy]||[];o.splice(0,o[u.oI]),(0,s.Yny)(o,Z),q=new I.l,x=[],(0,d.K)(M,!1),M=null,N=null,F=null,(0,d.K)(L,!1),L=null,z=null,D=[],B=null,U=null,H=!1,j=null,$=(0,p.Z)("AIBaseCore",!0),W=(0,k.P)(),K=null,X=null,V=(0,E.w)(),Y=[],J=null,Q=null,ea=!1,eo=null,ei=!1,ee=0,et=null,er=null,en=!1}function ed(){var r=(0,S.i8)(ep(),t.cfg,e);return r[u.by](el),r}function ef(t){var r,n,o,i,a,l,c,d=(r=e[u.Uw],n=f.i,o=D,a=[],l=[],c={},(0,s.Iuo)(o,function(e){((0,s.hXl)(e)||(0,s.hXl)(e[u.mE]))&&(0,s.$8)(_);var t=e[b.Vo],o=e[u.Ju];e&&t&&((0,s.hXl)(c[t])?c[t]=o:(0,g.OG)(r,"Two extensions have same priority #"+t+" - "+c[t]+", "+o)),!t||t<n?a[u.y5](e):l[u.y5](e)}),(i={})[b.eT]=a,i[b.LZ]=l,i);z=null,J=null,Q=null,U=(B||[])[0]||[],U=(0,C.Xc)((0,s.Yny)(U,d[b.LZ]));var h=(0,s.Yny)((0,C.Xc)(d[b.eT]),U);Z=(0,s.N6t)(h);var p=e.config[b.jy]||[];p.splice(0,p[u.oI]),(0,s.Yny)(p,Z);var m=ed();U&&U[u.oI]>0&&(0,C.pI)(m[u.$o](U),h),(0,C.pI)(m,h),t&&eb(t)}function eh(e){var t=null,r=null,n=[];return(0,s.Iuo)(Z,function(t){if(t[u.Ju]===e&&t!==q)return r=t,-1;t.getChannel&&n[u.y5](t)}),!r&&n[u.oI]>0&&(0,s.Iuo)(n,function(t){if(!(r=t.getChannel(e)))return -1}),r&&(t={plugin:r,setEnabled:function(e){(0,C.Cr)(r)[b.Hr]=!e},isEnabled:function(){var e=(0,C.Cr)(r);return!e[u.Ik]&&!e[b.Hr]},remove:function(e,t){void 0===e&&(e=!0);var n,o=[r];em(o,((n={reason:1})[u.tI]=e,n),function(e){e&&ef({reason:32,removed:o}),t&&t(e)})}}),t}function ep(){if(!z){var r=(Z||[]).slice();-1===(0,s.rDm)(r,q)&&r[u.y5](q),z=(0,S.PV)((0,C.Xc)(r),t.cfg,e)}return z}function em(r,n,o){if(r&&r[u.oI]>0){var i=(0,S.PV)(r,t.cfg,e),a=(0,S.tS)(i,e);a[u.by](function(){var e=!1,t=[];(0,s.Iuo)(D,function(n,o){O(n,r)?e=!0:t[u.y5](n)}),D=t,J=null,Q=null;var n=[];B&&((0,s.Iuo)(B,function(t,o){var i=[];(0,s.Iuo)(t,function(t){O(t,r)?e=!0:i[u.y5](t)}),n[u.y5](i)}),B=n),o&&o(e),el()}),a[u.$5](n)}else o(!1)}function eg(){if(n&&n.queue){var t=n.queue.slice(0);n.queue[u.oI]=0,(0,s.Iuo)(t,function(t){var r,n=((r={})[u.RS]=j||"InternalMessageId: "+t[u.JR],r[u.FI]=X,r[u.fA]=(0,v._u)(new Date),r.baseType=g.WD.dataType,r.baseData={message:t[u.pM]},r);e.track(n)})}}function ev(e,t,r,n){var o=1,i=!1,a=null;function l(){o--,i&&0===o&&(a&&a[u._w](),a=null,t&&t(i),t=null)}return n=n||5e3,U&&U[u.oI]>0&&ed()[u.$o](U).iterate(function(t){if(t.flush){o++;var i=!1;t.flush(e,function(){i=!0,l()},r)||i||(e&&null==a?a=(0,s.dRz)(function(){a=null,l()},n):l())}}),i=!0,l(),!0}function eb(t){var r=(0,S.nU)(ep(),e);r[u.by](el),e._updateHook&&!0===e._updateHook(r,t)||r[u.$5](t)}function ey(t){var r=e[u.Uw];r?((0,g.ZP)(r,2,73,t),el()):(0,s.$8)(t)}function ew(t){var r=e[u.RF]();r&&r[b.Yp]([t],2)}function eS(e){V.add(e)}eu(),e._getDbgPlgTargets=function(){return[Z,x]},e[u.tZ]=function(){return r},e.activeStatus=function(){return ee},e._setPendingStatus=function(){ee=3},e[u.mE]=function(d,f,h,p){H&&(0,s.$8)(A),e[u.tZ]()&&(0,s.$8)("Core cannot be initialized more than once"),d=(t=(0,l.e)(d,T,h||e[u.Uw],!1)).cfg,eS(t[u.x6](function(e){var t=e.cfg;if(3!==ee){er=t.initInMemoMaxSize||100;var o=t[u.sl],l=t.endpointUrl;if((0,s.hXl)(o)){X=null,ee=c.f[u.Yq];var f="Please provide instrumentation key";r?((0,g.ZP)(n,1,100,f),es()):(0,s.$8)(f);return}var h=[];if((0,s.$XS)(o)?(h[u.y5](o),X=null):X=o,(0,s.$XS)(l)?(h[u.y5](l),et=null):et=l,h[u.oI]){en=!1,ee=3;var p=(0,v.Gh)(t.initTimeOut)?t.initTimeOut:5e4,m=(0,a.Ov)(h);(0,s.dRz)(function(){en||i()},p),(0,a.Dv)(m,function(e){try{if(en)return;if(!e.rejected){var t=e[u.pF];if(t&&t[u.oI]){var r=t[0];if(X=r&&r[u.pF],t[u.oI]>1){var n=t[1];et=n&&n[u.pF]}}X&&(d[u.sl]=X,d.endpointUrl=et)}i()}catch(e){en||i()}})}else i();var y=e.ref(e.cfg,b.Bw);(0,s.zav)(y,function(t){e.ref(y,t)})}})),M=p,w=t,S=V,C=M&&e[u.RF](),I=G,S.add(w[u.x6](function(e){var t=e.cfg.disableDbgExt;!0===t&&I&&(C[u.h3](I),I=null),C&&!I&&!0!==t&&(I=(0,m.M)(e.cfg),C[u.vR](I))})),G=I,eS(t[u.x6](function(t){if(t.cfg.enablePerfMgr){var r=t.cfg[b.Yd];y!==r&&(r||(r=P),(0,v.c2)(t.cfg,b.Yd,r),y=r,F=null),!N&&!F&&(0,s.Tnt)(r)&&(F=r(e,e[u.RF]()))}else F=null,y=null})),e[u.Uw]=h;var y,w,S,C,I,k,E,_,O=d[b.jy];if((D=[])[u.y5].apply(D,(0,o.vz)((0,o.vz)([],f,!1),O,!1)),B=d[b.LZ],ef(null),U&&0!==U[u.oI]||(0,s.$8)("No "+b.LZ+" available"),B&&B[u.oI]>1){var R=e[u.AP]("TeeChannelController");R&&R.plugin||(0,g.ZP)(n,1,28,"TeeChannel required")}k=d,E=Y,_=n,(0,s.Iuo)(E,function(e){var t=(0,l.a)(k,e.w,_);delete e.w,e.rm=function(){t.rm()}}),Y=null,r=!0,ee===c.f.ACTIVE&&es()},e.getChannels=function(){var e=[];return U&&(0,s.Iuo)(U,function(t){e[u.y5](t)}),(0,s.N6t)(e)},e.track=function(t){(0,w.r2)(e[b.kI](),function(){return"AppInsightsCore:track"},function(){null===t&&(ew(t),(0,s.$8)("Invalid telemetry item")),!t[u.RS]&&(0,s.hXl)(t[u.RS])&&(ew(t),(0,s.$8)("telemetry name required")),t[u.FI]=t[u.FI]||X,t[u.fA]=t[u.fA]||(0,v._u)(new Date),t.ver=t.ver||"4.0",!H&&e[u.tZ]()&&ee===c.f.ACTIVE?ed()[u.$5](t):ee!==c.f[u.Yq]&&x[u.oI]<=er&&x[u.y5](t)},function(){return{item:t}},!t.sync)},e[u.DI]=ed,e[u.RF]=function(){return M||(M=new y.h(t.cfg),e._notificationManager=M),M},e[u.vR]=function(t){e.getNotifyMgr()[u.vR](t)},e[u.h3]=function(e){M&&M[u.h3](e)},e.getCookieMgr=function(){return L||(L=(0,h.xN)(t.cfg,e[u.Uw])),L},e.setCookieMgr=function(e){L!==e&&((0,d.K)(L,!1),L=e)},e[b.kI]=function(){return N||F||(0,w.Z4)()},e.setPerfMgr=function(e){N=e},e.eventCnt=function(){return x[u.oI]},e.releaseQueue=function(){if(r&&x[u.oI]>0){var e=x;x=[],2===ee?(0,s.Iuo)(e,function(e){e[u.FI]=e[u.FI]||X,ed()[u.$5](e)}):(0,g.ZP)(n,2,20,"core init status is not active")}},e[u.h4]=function(e){return j=e||null,ea=!1,eo&&eo[u._w](),el(!0)},e[u.Di]=function(){ea=!0,eo&&eo[u._w](),eg()},(0,v.o$)(e,function(){return q},["addTelemetryInitializer"]),e[u.M5]=function(t,o,i){void 0===t&&(t=!0),r||(0,s.$8)("SDK is not initialized"),H&&(0,s.$8)(A);var l,c,f=((l={reason:50})[u.tI]=t,l.flushComplete=!1,l);t&&!o&&(c=(0,a.Qo)(function(e){o=e}));var h=(0,S.tS)(ep(),e);function p(t){f.flushComplete=t,H=!0,W.run(h,f),e[u.Di](),h[u.$5](f)}return h[u.by](function(){V.run(e[u.Uw]),(0,d.k)([L,M,n],t,function(){eu(),o&&o(f)})},e),eg(),ev(t,p,6,i)||p(!1),c},e[u.AP]=eh,e.addPlugin=function(e,t,r,n){if(!e){n&&n(!1),ey(_);return}var o=eh(e[u.Ju]);if(o&&!t){n&&n(!1),ey("Plugin ["+e[u.Ju]+"] is already loaded!");return}var i={reason:16};function a(t){D[u.y5](e),i.added=[e],ef(i),n&&n(!0)}if(o){var s=[o.plugin];em(s,{reason:2,isAsync:!!r},function(e){e?(i.removed=s,i.reason|=32,a(!0)):n&&n(!1)})}else a(!1)},e.updateCfg=function(r,n){if(void 0===n&&(n=!0),e[u.tZ]()){r=(o={reason:1,cfg:t.cfg,oldCfg:(0,s.zwS)({},t.cfg),newConfig:(0,s.zwS)({},r),merge:n}).newConfig;var o,i=t.cfg;r[b.jy]=i[b.jy],r[b.LZ]=i[b.LZ]}t._block(function(e){var t=e.cfg;(function e(t,r,n,o){n&&(0,s.zav)(n,function(n,i){o&&(0,s.QdQ)(i)&&(0,s.QdQ)(r[n])&&e(t,r[n],i,o),o&&(0,s.QdQ)(i)&&(0,s.QdQ)(r[n])?e(t,r[n],i,o):t.set(r,n,i)})})(e,t,r,n),n||(0,s.zav)(t,function(n){(0,s.KhI)(r,n)||e.set(t,n,b.HP)}),e[u.h0](t,T)},!0),t[u.zs](),o&&eb(o)},e.evtNamespace=function(){return $},e.flush=ev,e.getTraceCtx=function(e){return K||(K=(0,C.u7)()),K},e.setTraceCtx=function(e){K=e||null},e.addUnloadHook=eS,(0,v.RF)(e,"addUnloadCb",function(){return W},"add"),e.onCfgChange=function(n){var o,i,a,c;return r?o=(0,l.a)(t.cfg,n,e[u.Uw]):((a=R(i=Y,n).l)||(a={w:n,rm:function(){var e=R(i,n);-1!==e.i&&i[u.Ic](e.i,1)}},i[u.y5](a)),o=a),c=o,(0,s.vF1)({rm:function(){c.rm()}},"toJSON",{v:function(){return"aicore::onCfgChange<"+JSON.stringify(c)+">"}})},e.getWParam=function(){return(0,s.Wtk)()||t.cfg.enableWParam?0:-1}})}return e.__ieDyn=1,e}()},565875:(e,t,r)=>{"use strict";r.d(t,{K:()=>a,k:()=>function e(t,r,i){var s;return i||(s=(0,n.Qo)(function(e){i=e})),t&&(0,o.R3R)(t)>0?(0,n.Dv)(a(t[0],r),function(){e((0,o.KVm)(t,1),r,i)}):i(),s}});var n=r(659495),o=r(647759),i=r(793940);function a(e,t){if(e&&e[i.M5])return e[i.M5](t)}},652639:(e,t,r)=>{"use strict";r.d(t,{s:()=>g});var n,o=r(387657),i=r(647759),a=r(874314),s=r(793940),l=r(867073),c=r(437895),u=r(78050),d=r(758355),f=r(155422),h=r(460699),p="getPlugin",m=((n={})[u.Bw]={isVal:c.Gh,v:{}},n),g=function(){function e(){var t,r,n,g,v,b=this;function y(e){void 0===e&&(e=null);var t=e;if(!t){var o=r||(0,d.i8)(null,{},b[u.eT]);t=n&&n[p]?o[s.$o](null,n[p]):o[s.$o](null,n)}return t}function w(e,t,o){(0,a.e)(e,m,(0,l.y0)(t)),!o&&t&&(o=t[s.DI]()[s.uR]());var i=n;n&&n[p]&&(i=n[p]()),b[u.eT]=t,r=(0,d.i8)(o,e,t,i)}function S(){t=!1,b[u.eT]=null,r=null,n=null,v=(0,h.w)(),g=(0,f.P)()}S(),(0,o.A)(e,b,function(e){e[s.mE]=function(e,r,n,o){w(e,r,o),t=!0},e[s.Ik]=function(t,r){var o,i,a=e[u.eT];if(a&&(!t||a===t[u.eT]())){var l=!1,c=t||(0,d.tS)(null,a,n&&n[p]?n[p]():n),f=r||((o={reason:0})[s.tI]=!1,o);return e[s.tn]&&!0===e[s.tn](c,f,h)?i=!0:h(),i}function h(){l||(l=!0,g.run(c,r),v.run(c[s.e4]()),!0===i&&c[s.$5](f),S())}},e[s.HC]=function(t,r){var o,i=e[u.eT];if(i&&(!t||i===t[u.eT]())){var a=!1,l=t||(0,d.nU)(null,i,n&&n[p]?n[p]():n);return e._doUpdate&&!0===e._doUpdate(l,r||{reason:0},c)?o=!0:c(),o}function c(){a||(a=!0,w(l.getCfg(),l.core(),l[s.uR]()))}},(0,c.RF)(e,"_addUnloadCb",function(){return g},"add"),(0,c.RF)(e,"_addHook",function(){return v},"add"),(0,i.vF1)(e,"_unloadHooks",{g:function(){return v}})}),b[s.e4]=function(e){return y(e)[s.e4]()},b[s.tZ]=function(){return t},b.setInitialized=function(e){t=e},b[s.YH]=function(e){n=e},b[s.$5]=function(e,t){t?t[s.$5](e):n&&(0,i.Tnt)(n[u.qT])&&n[u.qT](e,null)},b._getTelCtx=y}return e.__ieDyn=1,e}()},126529:(e,t,r)=>{"use strict";r.d(t,{i:()=>n,x:()=>o});var n=500,o="Microsoft_ApplicationInsights_BypassAjaxInstrumentation"},138484:(e,t,r)=>{"use strict";r.d(t,{um:()=>R,xN:()=>x});var n,o,i,a=r(647759),s=r(695213),l=r(874314),c=r(793940),u=r(867073),d=r(734150),f=r(437895),h=r(78050),p="toGMTString",m="toUTCString",g="cookie",v="expires",b="isCookieUseDisabled",y="disableCookiesUsage",w="_ckMgr",S=null,C=null,I=null,k={},E={},_=((n={cookieCfg:(0,s.NU)(((o={})[h.Fk]={fb:"cookieDomain",dfVal:f.Gh},o.path={fb:"cookiePath",dfVal:f.Gh},o.enabled=h.HP,o.ignoreCookies=h.HP,o.blockedCookies=h.HP,o)),cookieDomain:h.HP,cookiePath:h.HP})[y]=h.HP,n);function A(){i||(i=(0,a.nRs)(function(){return(0,a.YEm)()}))}function T(e){return!e||e.isEnabled()}function P(e,t){return!!(t&&e&&(0,a.cyL)(e.ignoreCookies))&&-1!==(0,a.rDm)(e.ignoreCookies,t)}function O(e,t){var r=t[c.XM];if((0,a.hXl)(r)){var n=void 0;(0,a.b07)(e[b])||(n=!e[b]),(0,a.b07)(e[y])||(n=!e[y]),r=n}return r}function R(e,t){if(e)r=e.getCookieMgr();else if(t){var r,n,o,i=t.cookieCfg;r=i&&i[w]?i[w]:x(t)}return r||(n=(e||{})[c.Uw],(o=x[w]||E[w])||(o=x[w]=x(t,n),E[w]=o),r=o),r}function x(e,t){e=(0,l.e)(e||E,null,t).cfg,s=(0,l.a)(e,function(t){t[c.h0](t.cfg,_),o=(n=t.ref(t.cfg,"cookieCfg"))[h.QW]||"/",i=n[h.Fk],u=!1!==O(e,n),g=n.getCookie||z,b=n.setCookie||D,y=n.delCookie||D},t);var r,n,o,i,s,u,g,b,y,S=((r={isEnabled:function(){var r=!1!==O(e,n)&&u&&M(t),o=E[w];return r&&o&&S!==o&&(r=T(o)),r},setEnabled:function(e){u=!1!==e,n[c.XM]=e},set:function(e,t,r,s,l){var u,g=!1;if(T(S)&&(u=n,!(e&&u&&(0,a.cyL)(u.blockedCookies)&&-1!==(0,a.rDm)(u.blockedCookies,e)||P(u,e)))){var y,w={},I=(0,a.EHq)(t||h.m5),k=(0,a.HzD)(I,";");if(-1!==k&&(I=(0,a.EHq)((0,a.ZWZ)(t,k)),w=N((0,a.P0f)(t,k+1))),(0,f.KY)(w,h.Fk,s||i,a.zzB,a.b07),!(0,a.hXl)(r)){var E=(0,d.lT)();if((0,a.b07)(w[v])){var _=(0,a.f0d)()+1e3*r;if(_>0){var A=new Date;A.setTime(_),(0,f.KY)(w,v,F(A,E?p:m)||F(A,E?p:m)||h.m5,a.zzB)}}E||(0,f.KY)(w,"max-age",h.m5+r,null,a.b07)}var O=(0,d.g$)();O&&"https:"===O[c.Qg]&&((0,f.KY)(w,"secure",null,null,a.b07),null===C&&(y=((0,a.w3n)()||{})[c.tX],C=!((0,a.KgX)(y)&&((0,f.Ju)(y,"CPU iPhone OS 12")||(0,f.Ju)(y,"iPad; CPU OS 12")||(0,f.Ju)(y,"Macintosh; Intel Mac OS X 10_14")&&(0,f.Ju)(y,"Version/")&&(0,f.Ju)(y,"Safari")||(0,f.Ju)(y,"Macintosh; Intel Mac OS X 10_14")&&(0,a.Cv9)(y,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||(0,f.Ju)(y,"Chrome/5")||(0,f.Ju)(y,"Chrome/6")||(0,f.Ju)(y,"UnrealEngine")&&!(0,f.Ju)(y,"Chrome")||(0,f.Ju)(y,"UCBrowser/12")||(0,f.Ju)(y,"UCBrowser/11")))),C&&(0,f.KY)(w,"SameSite","None",null,a.b07)),(0,f.KY)(w,h.QW,l||o,null,a.b07),b(e,L(I,w)),g=!0}return g},get:function(e){var t=h.m5;return T(S)&&!P(n,e)&&(t=g(e)),t},del:function(e,t){var r=!1;return T(S)&&(r=S.purge(e,t)),r},purge:function(e,r){var n,o=!1;if(M(t)){var i=((n={})[h.QW]=r||"/",n[v]="Thu, 01 Jan 1970 00:00:01 GMT",n);(0,d.lT)()||(i["max-age"]="0"),y(e,L(h.m5,i)),o=!0}return o}})[c.M5]=function(e){s&&s.rm(),s=null},r);return S[w]=S,S}function M(e){if(null===S){S=!1,i||A();try{var t=i.v||{};S=void 0!==t[g]}catch(t){(0,u.ZP)(e,2,68,"Cannot access document.cookie - "+(0,f.lL)(t),{exception:(0,a.mmD)(t)})}}return S}function N(e){var t={};if(e&&e[c.oI]){var r=(0,a.EHq)(e)[c.sY](";");(0,a.Iuo)(r,function(e){if(e=(0,a.EHq)(e||h.m5)){var r=(0,a.HzD)(e,"=");-1===r?t[e]=null:t[(0,a.EHq)((0,a.ZWZ)(e,r))]=(0,a.EHq)((0,a.P0f)(e,r+1))}})}return t}function F(e,t){return(0,a.Tnt)(e[t])?e[t]():null}function L(e,t){var r=e||h.m5;return(0,a.zav)(t,function(e,t){r+="; "+e+((0,a.hXl)(t)?h.m5:"="+t)}),r}function z(e){var t=h.m5;if(i||A(),i.v){var r=i.v[g]||h.m5;I!==r&&(k=N(r),I=r),t=(0,a.EHq)(k[e]||h.m5)}return t}function D(e,t){i||A(),i.v&&(i.v[g]=e+"="+t)}},235468:(e,t,r)=>{"use strict";r.d(t,{aq:()=>a,cL:()=>s});var n=r(647759),o=r(78050),i=r(861405);function a(){var e=s();return(0,n.P0f)(e,0,8)+"-"+(0,n.P0f)(e,8,12)+"-"+(0,n.P0f)(e,12,16)+"-"+(0,n.P0f)(e,16,20)+"-"+(0,n.P0f)(e,20)}function s(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r=o.m5,a=0;a<4;a++)r+=t[15&(e=(0,i.VN)())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var s=t[8+(3&(0,i.VN)())|0];return(0,n.hKY)(r,0,8)+(0,n.hKY)(r,9,4)+"4"+(0,n.hKY)(r,13,3)+s+(0,n.hKY)(r,16,3)+(0,n.hKY)(r,19,12)}},356746:(e,t,r)=>{"use strict";r.d(t,{T:()=>h,Z:()=>f});var n=r(647759),o=r(793940),i=r(437895),a=r(78050),s=r(861405),l="3.3.0",c="."+(0,s.Si)(6),u=0;function d(e){return 1===e[o.re]||9===e[o.re]||!+e[o.re]}function f(e,t){return void 0===t&&(t=!1),(0,i.cH)(e+u+++(t?"."+l:a.m5)+c)}function h(e){var t={id:f("_aiData-"+(e||a.m5)+"."+l),accept:function(e){return d(e)},get:function(e,r,o,a){var s=e[t.id];return s?s[(0,i.cH)(r)]:(a&&((s=function(e,t){var r=t[e.id];if(!r){r={};try{d(t)&&(0,n.vF1)(t,e.id,{e:!1,v:r})}catch(e){}}return r}(t,e))[(0,i.cH)(r)]=o),o)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}},209689:(e,t,r)=>{"use strict";r.d(t,{$:()=>c,M:()=>u});var n,o=r(647759),i=r(793940),a=r(78050),s=[a.fc,a.Yp,a.dI,a.l0],l=null;function c(e){var t,r=l;return r||!0===e.disableDbgExt||(r=l||((t=(0,o.zS2)("Microsoft"))&&(l=t.ApplicationInsights),l)),r?r.ChromeDbgExt:null}function u(e){if(!n){n={};for(var t=0;t<s[i.oI];t++)n[s[t]]=function(e,t){return function(){var r=arguments,n=c(t);if(n){var o=n.listener;o&&o[e]&&o[e][i.y9](o,r)}}}(s[t],e)}return n}},867073:(e,t,r)=>{"use strict";r.d(t,{OG:()=>w,WD:()=>g,ZP:()=>y,wq:()=>b,y0:()=>v});var n,o=r(387657),i=r(647759),a=r(874314),s=r(793940),l=r(209689),c=r(734150),u=r(78050),d="warnToConsole",f={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},h=((n={})[0]=null,n[1]="errorToConsole",n[2]=d,n[3]="debugToConsole",n);function p(e){return e?'"'+e[s.W7](/\"/g,u.m5)+'"':u.m5}function m(e,t){var r=(0,c.U5)();if(r){var n="log";r[e]&&(n=e),(0,i.Tnt)(r[n])&&r[n](t)}}var g=function(){function e(e,t,r,n){void 0===r&&(r=!1),this[s.JR]=e,this[s.pM]=(r?"AI: ":"AI (Internal): ")+e;var o=u.m5;(0,c.Z)()&&(o=(0,c.hm)().stringify(n));var i=(t?" message:"+p(t):u.m5)+(n?" props:"+p(o):u.m5);this[s.pM]+=i}return e.dataType="MessageData",e}();function v(e,t){return(e||{})[s.Uw]||new b(t)}var b=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var r,n,c,u,p,v=0,b={};(0,o.A)(e,this,function(e){var o;function y(t,r){if(!(v>=c)){var o=!0,i="AITR_"+r[s.JR];if(b[i]?o=!1:b[i]=!0,o&&(t<=n&&(e.queue[s.y5](r),v++,w(1===t?"error":"warn",r)),v===c)){var a="Internal events throttle limit per PageView reached for this app.",l=new g(23,a,!1);e.queue[s.y5](l),1===t?e.errorToConsole(a):e[s.on](a)}}}function w(e,r){var n=(0,l.$)(t||{});n&&n[s.e4]&&n[s.e4](e,r)}o=t||{},p=(0,a.a)((0,a.e)(o,f,e).cfg,function(e){var t=e.cfg;r=t[s.Bl],n=t.loggingLevelTelemetry,c=t.maxMessageLimit,u=t.enableDebug}),e.consoleLoggingLevel=function(){return r},e[s.ih]=function(t,n,o,a,l){void 0===l&&(l=!1);var c=new g(n,o,l,a);if(u)throw(0,i.mmD)(c);var f=h[t]||d;if((0,i.b07)(c[s.pM]))w("throw"+(1===t?"Critical":"Warning"),c);else{if(l){var p=+c[s.JR];!b[p]&&r>=t&&(e[f](c[s.pM]),b[p]=!0)}else r>=t&&e[f](c[s.pM]);y(t,c)}},e.debugToConsole=function(e){m("debug",e),w("warning",e)},e[s.on]=function(e){m("warn",e),w("warning",e)},e.errorToConsole=function(e){m("error",e),w("error",e)},e.resetInternalMessageCount=function(){v=0,b={}},e[s.sx]=y,e[s.M5]=function(e){p&&p.rm(),p=null}})}return e.__ieDyn=1,e}();function y(e,t,r,n,o,i){void 0===i&&(i=!1),(e||new b)[s.ih](t,r,n,o,i)}function w(e,t){(e||new b)[s.on](t)}},734150:(e,t,r)=>{"use strict";r.d(t,{MY:()=>y,PV:()=>E,R7:()=>k,U5:()=>g,Uf:()=>I,Z:()=>v,g$:()=>m,hm:()=>b,iN:()=>w,lT:()=>C,lV:()=>S,xk:()=>_});var n=r(650506),o=r(647759),i=r(793940),a=r(437895),s=r(78050),l="JSON",c="XMLHttpRequest",u=null,d=null,f=null,h=null;function p(e,t){var r=!1;if(e){try{if(!(r=t in e)){var i=e[n.vR];i&&(r=t in i)}}catch(e){}if(!r)try{var a=new e;r=!(0,o.b07)(a[t])}catch(e){}}return r}function m(e){return typeof location===n._1&&location?location:(0,o.zS2)("location")}function g(){return typeof console!==n.bA?console:(0,o.zS2)("console")}function v(){return!!(typeof JSON===n._1&&JSON||null!==(0,o.zS2)(l))}function b(){return v()?JSON||(0,o.zS2)(l):null}function y(){return(0,o.zS2)("crypto")}function w(){return(0,o.zS2)("msCrypto")}function S(){var e=(0,o.w3n)();return!!e&&!!e.product&&"ReactNative"===e.product}function C(){var e=(0,o.w3n)();if(e&&(e[i.tX]!==d||null===u)){var t=((d=e[i.tX])||s.m5)[i.OL]();u=(0,a.Ju)(t,"msie")||(0,a.Ju)(t,"trident/")}return u}function I(e){return(null===h||!1===e)&&(h=(0,o.w9M)()&&!!(0,o.w3n)().sendBeacon),h}function k(e){var t=!1;try{t=!!(0,o.zS2)("fetch");var r=(0,o.zS2)("Request");t&&e&&r&&(t=p(r,"keepalive"))}catch(e){}return t}function E(){return null===f&&(f=typeof XDomainRequest!==n.bA)&&_()&&(f=f&&!p((0,o.zS2)(c),"withCredentials")),f}function _(){var e=!1;try{e=!!(0,o.zS2)(c)}catch(e){}return e}},272643:(e,t,r)=>{"use strict";r.d(t,{Ds:()=>F,Fc:()=>function e(t,r,o){var i=P(v,o),a=x([h],t,r,i);return r&&-1!==(0,n.rDm)(r,f)||(a=x([f],function(e){var r=(0,n.YEm)();t&&r&&"hidden"===r.visibilityState&&t(e)},r,i)||a),!a&&r&&(a=e(t,null,o)),a},Hm:()=>P,ML:()=>R,ee:()=>N,mB:()=>O,oS:()=>function e(t,r,o){var i=P(b,o),a=x([p],t,r,i);return(a=x([f],function(e){var r=(0,n.YEm)();t&&r&&"visible"===r.visibilityState&&t(e)},r,i)||a)||!r||(a=e(t,null,o)),a},sq:()=>L,vF:()=>z});var n=r(647759),o=r(793940),i=r(356746),a=r(78050),s="attachEvent",l="addEventListener",c="detachEvent",u="removeEventListener",d="events",f="visibilitychange",h="pagehide",p="pageshow",m="unload",g="beforeunload",v=(0,i.Z)("aiEvtPageHide"),b=(0,i.Z)("aiEvtPageShow"),y=/\.[\.]+/g,w=/[\.]+$/,S=1,C=(0,i.T)("events"),I=/^([^.]*)(?:\.(.+)|)/;function k(e){return e&&e[o.W7]?e[o.W7](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,a.m5):e}function E(e,t){if(t){var r,i=a.m5;(0,n.cyL)(t)?(i=a.m5,(0,n.Iuo)(t,function(e){(e=k(e))&&("."!==e[0]&&(e="."+e),i+=e)})):i=k(t),i&&("."!==i[0]&&(i="."+i),e=(e||a.m5)+i)}var s=I.exec(e||a.m5)||[];return(r={})[o.QM]=s[1],r.ns=(s[2]||a.m5).replace(y,".").replace(w,a.m5)[o.sY](".").sort().join("."),r}function _(e,t,r){void 0===r&&(r=!0);var n=C.get(e,d,{},r),o=n[t];return o||(o=n[t]=[]),o}function A(e,t,r,n){e&&t&&t[o.QM]&&(e[u]?e[u](t[o.QM],r,n):e[c]&&e[c]("on"+t[o.QM],r))}function T(e,t,r,n){for(var i=t[o.oI];i--;){var a=t[i];a&&(!r.ns||r.ns===a.evtName.ns)&&(!n||n(a))&&(A(e,a.evtName,a[o.Yo],a.capture),t[o.Ic](i,1))}}function P(e,t){return t?E("xx",(0,n.cyL)(t)?[e].concat(t):[e,t]).ns[o.sY]("."):e}function O(e,t,r,n,i){void 0===i&&(i=!1);var a,c=!1;if(e)try{var u,d,f=E(t,n);if(u=i,d=!1,e&&f&&f[o.QM]&&r&&(e[l]?(e[l](f[o.QM],r,u),d=!0):e[s]&&(e[s]("on"+f[o.QM],r),d=!0)),(c=d)&&C.accept(e)){var h=((a={guid:S++,evtName:f})[o.Yo]=r,a.capture=i,a);_(e,f.type)[o.y5](h)}}catch(e){}return c}function R(e,t,r,i,a){if(void 0===a&&(a=!1),e)try{var s=E(t,i),l=!1;(function(e,t,r){if(t[o.QM])T(e,_(e,t[o.QM]),t,r);else{var i=C.get(e,d,{});(0,n.zav)(i,function(n,o){T(e,o,t,r)}),0===(0,n.cGk)(i)[o.oI]&&C.kill(e,d)}})(e,s,function(e){return(!!s.ns&&!r||e[o.Yo]===r)&&(l=!0,!0)}),l||A(e,s,r,a)}catch(e){}}function x(e,t,r,i){var a=!1;return t&&e&&e[o.oI]>0&&(0,n.Iuo)(e,function(e){if(e&&(!r||-1===(0,n.rDm)(r,e))){var o,s,l;o=!1,(s=(0,n.zkX)())&&(o=O(s,e,t,i),o=O(s.body,e,t,i)||o),(l=(0,n.YEm)())&&(o=O(l,e,t,i)||o),a=o||a}}),a}function M(e,t,r){e&&(0,n.cyL)(e)&&(0,n.Iuo)(e,function(e){if(e){var o,i;(o=(0,n.zkX)())&&(R(o,e,t,r),R(o.body,e,t,r)),(i=(0,n.YEm)())&&R(i,e,t,r)}})}function N(e,t,r){var i,a;return i=[g,m,h],a=!1,e&&i&&(0,n.cyL)(i)&&!(a=x(i,e,t,r))&&t&&t[o.oI]>0&&(a=x(i,e,null,r)),a}function F(e,t){M([g,m,h],e,t)}function L(e,t){var r=P(v,t);M([h],e,r),M([f],null,r)}function z(e,t){var r=P(b,t);M([p],e,r),M([f],null,r)}},437895:(e,t,r)=>{"use strict";r.d(t,{Gh:()=>u,H$:()=>E,HU:()=>S,Ju:()=>f,KY:()=>m,Lo:()=>w,RF:()=>v,_u:()=>h,c2:()=>g,cH:()=>d,hW:()=>y,jL:()=>I,lL:()=>p,o$:()=>b,r4:()=>C,w3:()=>A});var n=r(647759),o=r(650506),i=r(793940),a=r(78050),s=/-([a-z])/g,l=/([^\w\d_$])/g,c=/^(\d+[\w\d_$])/;function u(e){return!(0,n.hXl)(e)}function d(e){var t=e;return t&&(0,n.KgX)(t)&&(t=(t=(t=t[i.W7](s,function(e,t){return t.toUpperCase()}))[i.W7](l,"_"))[i.W7](c,function(e,t){return"_"+t})),t}function f(e,t){return!!e&&!!t&&-1!==(0,n.HzD)(e,t)}function h(e){return e&&e.toISOString()||""}function p(e){return(0,n.bJ7)(e)?e[i.RS]:a.m5}function m(e,t,r,n,o){var i=r;return e&&(i=e[t])!==r&&(!o||o(i))&&(!n||n(r))&&(i=r,e[t]=i),i}function g(e,t,r){var o;return e?!(o=e[t])&&(0,n.hXl)(o)&&(o=(0,n.b07)(r)?{}:r,e[t]=o):o=(0,n.b07)(r)?{}:r,o}function v(e,t,r,o,a){var s,l;e&&t&&r&&(!1!==a||(0,n.b07)(e[t]))&&(e[t]=(s=null,l=null,(0,n.Tnt)(r)?s=r:l=r,function(){var e=arguments;if(s&&(l=s()),l)return l[o][i.y9](l,e)}))}function b(e,t,r,o){return e&&t&&(0,n.Gvm)(e)&&(0,n.cyL)(r)&&(0,n.Iuo)(r,function(r){(0,n.KgX)(r)&&v(e,r,t,r,o)}),e}function y(e){return e&&n.vE3&&(e=(0,o.s6)((0,n.vE3)({},e))),e}function w(e){try{return e.responseText}catch(e){}return null}function S(e,t){return e?"XDomainRequest,Response:"+w(e):t}function C(e,t){return e?"XMLHttpRequest,Status:"+e[i.cV]+",Response:"+w(e)||0:t}function I(e,t){return t&&((0,n.EtT)(t)?e=[t].concat(e):(0,n.cyL)(t)&&(e=t.concat(e))),e}Object.getPrototypeOf;var k="withCredentials";function E(e,t,r,n,o,i){function a(e,t,r){try{e[t]=r}catch(e){}}void 0===n&&(n=!1),void 0===o&&(o=!1);var s=new XMLHttpRequest;return n&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",n),r&&a(s,k,r),s.open(e,t,!o),r&&a(s,k,r),!o&&i&&a(s,"timeout",i),s}function _(e,t,r){if(!e[r]&&t&&t[i.Az]){var o=t[i.Az](r);o&&(e[r]=(0,n.EHq)(o))}return e}function A(e,t){var r={};return e[i.wJ]?r=function(e){var t={};if((0,n.KgX)(e)){var r=(0,n.EHq)(e)[i.sY](/[\r\n]+/);(0,n.Iuo)(r,function(e){if(e){var r=e.indexOf(": ");if(-1!==r){var o=(0,n.EHq)(e.substring(0,r))[i.OL](),a=(0,n.EHq)(e.substring(r+1));t[o]=a}else t[(0,n.EHq)(e)]=1}})}return t}(e[i.wJ]()):t&&(r=_(r,e,"time-delta-millis"),r=_(r,e,"kill-duration"),r=_(r,e,"kill-duration-seconds")),r}},78050:(e,t,r)=>{"use strict";r.d(t,{Bw:()=>c,Ev:()=>y,Fk:()=>S,HP:()=>n,Hr:()=>l,LZ:()=>i,QW:()=>C,Vj:()=>b,Vo:()=>f,Yd:()=>s,Yp:()=>p,dI:()=>m,eT:()=>a,fc:()=>h,jy:()=>u,kI:()=>w,l0:()=>g,m5:()=>o,qT:()=>d,s4:()=>v,xW:()=>I});var n=void 0,o="",i="channels",a="core",s="createPerfMgr",l="disabled",c="extensionConfig",u="extensions",d="processTelemetry",f="priority",h="eventsSent",p="eventsDiscarded",m="eventsSendRequest",g="perfEvent",v="offlineEventsStored",b="offlineBatchSent",y="offlineBatchDrop",w="getPerfMgr",S="domain",C="path",I="Not dynamic - "},398274:(e,t,r)=>{"use strict";r.d(t,{h:()=>f});var n=r(387657),o=r(659495),i=r(647759),a=r(874314),s=r(793940),l=r(78050),c={perfEvtsSendAll:!1};function u(e){e.h=null;var t=e.cb;e.cb=[],(0,i.Iuo)(t,function(e){(0,i.gBW)(e.fn,[e.arg])})}function d(e,t,r,n){(0,i.Iuo)(e,function(e){e&&e[t]&&(r?(r.cb[s.y5]({fn:n,arg:e}),r.h=r.h||(0,i.dRz)(u,0,r)):(0,i.gBW)(n,[e]))})}var f=function(){function e(t){this.listeners=[];var r,u,f=[],h={h:null,cb:[]};u=(0,a.e)(t,c)[s.x6](function(e){r=!!e.cfg.perfEvtsSendAll}),(0,n.A)(e,this,function(e){(0,i.vF1)(e,"listeners",{g:function(){return f}}),e[s.vR]=function(e){f[s.y5](e)},e[s.h3]=function(e){for(var t=(0,i.rDm)(f,e);t>-1;)f[s.Ic](t,1),t=(0,i.rDm)(f,e)},e[l.fc]=function(e){d(f,l.fc,h,function(t){t[l.fc](e)})},e[l.Yp]=function(e,t){d(f,l.Yp,h,function(r){r[l.Yp](e,t)})},e[l.dI]=function(e,t){d(f,l.dI,t?h:null,function(r){r[l.dI](e,t)})},e[l.l0]=function(e){e&&(r||!e[s.Zu]())&&d(f,l.l0,null,function(t){e[s.tI]?(0,i.dRz)(function(){return t[l.l0](e)},0):t[l.l0](e)})},e[l.s4]=function(e){e&&e[s.oI]&&d(f,l.s4,h,function(t){t[l.s4](e)})},e[l.Vj]=function(e){e&&e[s.Cd]&&d(f,l.Vj,h,function(t){t[l.Vj](e)})},e[l.Ev]=function(e,t){if(e>0){var r=t||0;d(f,l.Ev,h,function(t){t[l.Ev](e,r)})}},e[s.M5]=function(e){var t,r=function(){u&&u.rm(),u=null,f=[],h.h&&h.h[s._w](),h.h=null,h.cb=[]};if(d(f,"unload",null,function(r){var n=r[s.M5](e);n&&(t||(t=[]),t[s.y5](n))}),t)return(0,o.Qo)(function(e){return(0,o.Dv)((0,o.Xf)(t),function(){r(),e()})});r()}})}return e.__ieDyn=1,e}()},739426:(e,t,r)=>{"use strict";r.d(t,{NS:()=>u,Z4:()=>h,r2:()=>f});var n=r(387657),o=r(647759),i=r(793940),a=r(78050),s="ParentContextKey",l="ChildrenContextKey",c=function(){function e(t,r,n){var a,c=this;c.start=(0,o.f0d)(),c[i.RS]=t,c[i.tI]=n,c[i.Zu]=function(){return!1},(0,o.Tnt)(r)&&(0,o.vF1)(c,"payload",{g:function(){return!a&&(0,o.Tnt)(r)&&(a=r(),r=null),a}}),c[i.O_]=function(t){return t?t===e[s]||t===e[l]?c[t]:(c.ctx||{})[t]:null},c[i.e_]=function(t,r){t&&(t===e[s]?(c[t]||(c[i.Zu]=function(){return!0}),c[t]=r):t===e[l]?c[t]=r:(c.ctx=c.ctx||{})[t]=r)},c[i.Ru]=function(){var t=0,r=c[i.O_](e[l]);if((0,o.cyL)(r))for(var n=0;n<r[i.oI];n++){var a=r[n];a&&(t+=a[i.fA])}c[i.fA]=(0,o.f0d)()-c.start,c.exTime=c[i.fA]-t,c[i.Ru]=function(){}}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),u=function(){function e(t){this.ctx={},(0,n.A)(e,this,function(e){e.create=function(e,t,r){return new c(e,t,r)},e.fire=function(e){e&&(e[i.Ru](),t&&(0,o.Tnt)(t[a.l0])&&t[a.l0](e))},e[i.e_]=function(t,r){t&&((e.ctx=e.ctx||{})[t]=r)},e[i.O_]=function(t){return(e.ctx||{})[t]}})}return e.__ieDyn=1,e}(),d="CoreUtils.doPerf";function f(e,t,r,n,o){if(e){var u=e;if(u[a.kI]&&(u=u[a.kI]()),u){var f=void 0,h=u[i.O_](d);try{if(f=u.create(t(),n,o)){if(h&&f[i.e_]&&(f[i.e_](c[s],h),h[i.O_]&&h[i.e_])){var p=h[i.O_](c[l]);p||(p=[],h[i.e_](c[l],p)),p[i.y5](f)}return u[i.e_](d,f),r(f)}}catch(e){f&&f[i.e_]&&f[i.e_]("exception",e)}finally{f&&u.fire(f),u[i.e_](d,h)}}}return r()}function h(){return null}},758355:(e,t,r)=>{"use strict";r.d(t,{PV:()=>g,i8:()=>m,nU:()=>function e(t,r,o){var s=(0,i.e)(r.config),l=p(t,s,r,o).ctx;return l[a.$5]=function(e){return l.iterate(function(t){(0,n.Tnt)(t[a.HC])&&t[a.HC](l,e)})},l[a.$o]=function(t,o){return void 0===t&&(t=null),(0,n.cyL)(t)&&(t=g(t,s.cfg,r,o)),e(t||l[a.uR](),r,o)},l},tS:()=>function e(t,r,o){var s=(0,i.e)(r.config),l=p(t,s,r,o),c=l.ctx;return c[a.$5]=function(e){var t=l._next();return t&&t[a.M5](c,e),!t},c[a.$o]=function(t,o){return void 0===t&&(t=null),(0,n.cyL)(t)&&(t=g(t,s.cfg,r,o)),e(t||c[a.uR](),r,o)},c}});var n=r(647759),o=r(249725),i=r(874314),a=r(793940),s=r(867073),l=(r(437895),r(78050)),c=r(739426),u=r(623406),d="_hasRun",f="_getTelCtx",h=0;function p(e,t,r,c){var u=null,d=[];t||(t=(0,i.e)({},null,r[a.Uw])),null!==c&&(u=c?function(e,t,r){for(;e;){if(e[a.AP]()===r)return e;e=e[a.uR]()}return g([r],t.config||{},t)}(e,r,c):e);var f={_next:function(){var e=u;if(u=e?e[a.uR]():null,!e){var t=d;t&&t[a.oI]>0&&((0,n.Iuo)(t,function(e){try{e.func.call(e.self,e.args)}catch(e){(0,s.ZP)(r[a.Uw],2,73,"Unexpected Exception during onComplete - "+(0,n.mmD)(e))}}),d=[])}return e},ctx:{core:function(){return r},diagLog:function(){return(0,s.y0)(r,t.cfg)},getCfg:function(){return t.cfg},getExtCfg:function(e,r){var i=h(e,!0);return r&&(0,n.zav)(r,function(e,r){if((0,n.hXl)(i[e])){var a=t.cfg[e];(a||!(0,n.hXl)(a))&&(i[e]=a)}(0,o.q)(t,i,e,r)}),t[a.h0](i,r)},getConfig:function(e,r,o){void 0===o&&(o=!1);var i,a=h(e,!1),s=t.cfg;return a&&(a[r]||!(0,n.hXl)(a[r]))?i=a[r]:(s[r]||!(0,n.hXl)(s[r]))&&(i=s[r]),i||!(0,n.hXl)(i)?i:o},hasNext:function(){return!!u},getNext:function(){return u},setNext:function(e){u=e},iterate:function(e){for(var t;t=f._next();){var r=t[a.AP]();r&&e(r)}},onComplete:function(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];e&&d[a.y5]({func:e,self:(0,n.b07)(t)?f.ctx:t,args:r})}}};function h(e,r){var n=null,o=t.cfg;if(o&&e){var i=o[l.Bw];!i&&r&&(i={}),o[l.Bw]=i,(i=t.ref(o,l.Bw))&&((n=i[e])||!r||(n={}),i[e]=n,n=t.ref(i,e))}return n}return f}function m(e,t,r,o){var s=(0,i.e)(t),c=p(e,s,r,o),u=c.ctx;return u[a.$5]=function(e){var t=c._next();return t&&t[l.qT](e,u),!t},u[a.$o]=function(e,t){return void 0===e&&(e=null),(0,n.cyL)(e)&&(e=g(e,s.cfg,r,t)),m(e||u[a.uR](),s.cfg,r,t)},u}function g(e,t,r,o){var i=null,p=!o;if((0,n.cyL)(e)&&e[a.oI]>0){var v=null;(0,n.Iuo)(e,function(e){if(p||o!==e||(p=!0),p&&e&&(0,n.Tnt)(e[l.qT])){var g=function(e,t,r){var o,i=null,p=(0,n.Tnt)(e[l.qT]),g=(0,n.Tnt)(e[a.YH]),v={getPlugin:function(){return e},getNext:function(){return i},processTelemetry:function(o,s){var c;b(s=s||(e&&(0,n.Tnt)(e[f])&&(c=e[f]()),c||(c=m(v,t,r)),c),function(t){if(!e||!p)return!1;var r=(0,u.Cr)(e);return!r[a.Ik]&&!r[l.Hr]&&(g&&e[a.YH](i),e[l.qT](o,t),!0)},"processTelemetry",function(){return{item:o}},!o.sync)||s[a.$5](o)},unload:function(t,r){b(t,function(){var n=!1;if(e){var o=(0,u.Cr)(e),i=e[l.eT]||o[l.eT];e&&(!i||i===t.core())&&!o[a.Ik]&&(o[l.eT]=null,o[a.Ik]=!0,o[a.tZ]=!1,e[a.Ik]&&!0===e[a.Ik](t,r)&&(n=!0))}return n},"unload",function(){},r[a.tI])||t[a.$5](r)},update:function(t,r){b(t,function(){var n=!1;if(e){var o=(0,u.Cr)(e),i=e[l.eT]||o[l.eT];e&&(!i||i===t.core())&&!o[a.Ik]&&e[a.HC]&&!0===e[a.HC](t,r)&&(n=!0)}return n},"update",function(){},!1)||t[a.$5](r)},_id:o=e?e[a.Ju]+"-"+e[l.Vo]+"-"+h++:"Unknown-0-"+h++,_setNext:function(e){i=e}};function b(t,r,u,f,h){var p=!1,m=e?e[a.Ju]:"TelemetryPluginChain",g=t[d];return g||(g=t[d]={}),t.setNext(i),e&&(0,c.r2)(t[l.eT](),function(){return m+":"+u},function(){g[o]=!0;try{var e=i?i._id:l.m5;e&&(g[e]=!1),p=r(t)}catch(e){var c=!i||g[i._id];c&&(p=!0),i&&c||(0,s.ZP)(t[a.e4](),1,73,"Plugin ["+m+"] failed during "+u+" - "+(0,n.mmD)(e)+", run flags: "+(0,n.mmD)(g))}},f,h),p}return(0,n.N6t)(v)}(e,t,r);i||(i=g),v&&v._setNext(g),v=g}})}return o&&!i?g([o],t,r):i}},861405:(e,t,r)=>{"use strict";r.d(t,{Si:()=>d,VN:()=>u});var n=r(647759),o=r(793940),i=r(734150),a=r(78050),s=!1,l=0x75bcd15,c=0x3ade68b1;function u(e){var t,r=0,o=(0,i.MY)()||(0,i.iN)();return o&&o.getRandomValues&&(r=0xffffffff&o.getRandomValues(new Uint32Array(1))[0]),0===r&&(0,i.lT)()&&(s||function(){try{var e,t=0x7fffffff&(0,n.f0d)();(e=(0x100000000*Math.random()^t)+t)<0&&(e>>>=0),l=0x75bcd15+e&0xffffffff,c=0x3ade68b1-e&0xffffffff,s=!0}catch(e){}}(),r=0xffffffff&(t=(((c=36969*(65535&c)+(c>>16)&0xffffffff)<<16)+(65535&(l=18e3*(65535&l)+(l>>16)&0xffffffff))>>>0&0xffffffff|0)>>>0)),0===r&&(r=Math.floor(0x100000000*Math.random()|0)),e||(r>>>=0),r}function d(e){void 0===e&&(e=22);for(var t=u()>>>0,r=0,n=a.m5;n[o.oI]<e;)r++,n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===r&&(t=(u()<<2&0xffffffff|3&t)>>>0,r=0);return n}},446650:(e,t,r)=>{"use strict";r.d(t,{v:()=>h});var n=r(387657),o=r(659495),i=r(647759),a=r(793940),s=r(126529),l=r(867073),c=r(734150),u=r(437895),d="&NoResponseBody=true",f="POST",h=function(){function e(){var t,r,h,p,m,g,v,b,y,w,S,C,I,k=0;(0,n.A)(e,this,function(e,n){var E=!0;function _(e,t){(0,l.ZP)(h,2,26,"Failed to send telemetry.",{message:e}),T(t,400,{})}function A(e){_("No endpoint url is provided for the batch",e)}function T(e,t,r,n){try{e&&e(t,r,n)}catch(e){}}function P(e,t){var r=(0,i.w3n)(),n=e[a.Vq];if(!n)return A(t),!0;n=e[a.Vq]+(C?d:"");var o=e[a.Cd],s=p?o:new Blob([o],{type:"text/plain;charset=UTF-8"});return r.sendBeacon(n,s)}function O(e,t,r){var n=e[a.Cd];try{if(n){if(P(e,t))T(t,200,{},"");else{var o=m&&m.beaconOnRetry;o&&(0,i.Tnt)(o)?o(e,t,P):(v&&v[a.L](e,t,!0),(0,l.ZP)(h,2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}}catch(e){p&&(0,l.OG)(h,"Failed to send telemetry using sendBeacon API. Ex:"+(0,i.mmD)(e)),T(t,p?0:400,{},"")}}function R(e,r,n){var s,l,c,d=e[a.c1]||{};!n&&t&&(s=(0,o.Qo)(function(e,t){l=e,c=t})),p&&n&&e.disableXhrSync&&(n=!1);var h=e[a.Vq];if(!h){A(r),l&&l(!1);return}var g=(0,u.H$)(f,h,E,!0,n,e[a.do]);function v(t){var n=m&&m.xhrOnComplete;if(n&&(0,i.Tnt)(n))n(t,r,e);else{var o=(0,u.Lo)(t);T(r,t[a.cV],(0,u.w3)(t,p),o)}}return p||g[a.yy]("Content-type","application/json"),(0,i.Iuo)((0,i.cGk)(d),function(e){g[a.yy](e,d[e])}),g.onreadystatechange=function(){!p&&(v(g),4===g.readyState&&l&&l(!0))},g.onload=function(){p&&v(g)},g.onerror=function(e){T(r,p?g[a.cV]:400,(0,u.w3)(g,p),p?"":(0,u.r4)(g)),c&&c(e)},g.ontimeout=function(){T(r,p?g[a.cV]:500,(0,u.w3)(g,p),p?"":(0,u.r4)(g)),l&&l(!1)},g.send(e[a.Cd]),s}function x(e,r,n){var l,c,u,h,g=e[a.Vq],v=e[a.Cd],b=p?v:new Blob([v],{type:"application/json"}),y=new Headers,w=v[a.oI],S=!1,_=!1,P=e[a.c1]||{},O=((l={method:f,body:b})[s.x]=!0,l);e.headers&&(0,i.cGk)(e.headers)[a.oI]>0&&((0,i.Iuo)((0,i.cGk)(P),function(e){y.append(e,P[e])}),O[a.c1]=y),E&&p&&(O.credentials="include"),n&&(O.keepalive=!0,k+=w,p?2===e._sendReason&&(S=!0,C&&(g+=d)):S=!0);var R=new Request(g,O);try{R[s.x]=!0}catch(e){}if(!n&&t&&(c=(0,o.Qo)(function(e,t){u=e,h=t})),!g){A(r),u&&u(!1);return}function x(e){T(r,p?0:400,{},p?"":e)}function M(e,t,n){var o=e[a.cV],s=m.fetchOnComplete;s&&(0,i.Tnt)(s)?s(e,r,n||"",t):T(r,o,{},n||"")}try{(0,o.Dv)(fetch(p?g:R,p?O:null),function(t){if(n&&(k-=w,w=0),!_){if(_=!0,t.rejected)x(t.reason&&t.reason[a.pM]),h&&h(t.reason);else{var r=t[a.pF];try{p||r.ok?p&&!r.body?(M(r,null,""),u&&u(!0)):(0,o.Dv)(r.text(),function(t){M(r,e,t[a.pF]),u&&u(!0)}):(x(r.statusText),u&&u(!1))}catch(e){x((0,i.mmD)(e)),h&&h(e)}}}})}catch(e){!_&&(x((0,i.mmD)(e)),h&&h(e))}return S&&!_&&(_=!0,T(r,200,{}),u&&u(!0)),p&&!_&&e[a.do]>0&&I&&I.set(function(){!_&&(_=!0,T(r,500,{}),u&&u(!0))},e[a.do]),c}function M(e,t,r){var n=(0,i.zkX)(),o=new XDomainRequest,s=e[a.Cd];o.onload=function(){var r=(0,u.Lo)(o),n=m&&m.xdrOnComplete;n&&(0,i.Tnt)(n)?n(o,t,e):T(t,200,{},r)},o.onerror=function(){T(t,400,{},p?"":(0,u.HU)(o))},o.ontimeout=function(){T(t,500,{})},o.onprogress=function(){};var c=n&&n.location&&n.location[a.Qg]||"",d=e[a.Vq];if(!d){A(t);return}if(!p&&0!==d.lastIndexOf(c,0)){var g="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.";(0,l.ZP)(h,2,40,". "+g),_(g,t);return}var v=p?d:d[a.W7](/^(https?:)/,"");o.open(f,v),e[a.do]&&(o[a.do]=e[a.do]),o.send(s),p&&r?I&&I.set(function(){o.send(s)},0):o.send(s)}function N(){k=0,r=!1,t=!1,h=null,p=null,m=null,g=null,v=null,b=!1,y=!1,w=!1,S=!1,C=!1,I=null}N(),e[a.mE]=function(t,n){h=n,r&&(0,l.ZP)(h,1,28,"Sender is already initialized"),e.SetConfig(t),r=!0},e._getDbgPlgTargets=function(){return[r,p,g,t]},e.SetConfig=function(e){try{if(m=e.senderOnCompleteCallBack||{},g=!!e.disableCredentials,p=!!e.isOneDs,t=!!e.enableSendPromise,b=!!e.disableXhr,y=!!e.disableBeacon,w=!!e.disableBeaconSync,I=e.timeWrapper,C=!!e.addNoResponse,S=!!e.disableFetchKeepAlive,v={sendPOST:R},p||(E=!1),g){var r=(0,c.g$)();r&&r.protocol&&"file:"===r.protocol[a.OL]()&&(E=!1)}return!0}catch(e){}return!1},e.getSyncFetchPayload=function(){return k},e.getSenderInst=function(e,t){return e&&e[a.oI]?function(e,t){for(var r,n=0,o=null,i=0;null==o&&i<e[a.oI];)n=e[i],b||1!==n?2===n&&(0,c.R7)(t)&&(!t||!S)?o=x:3===n&&(0,c.Uf)()&&(t?!w:!y)&&(o=O):(0,c.PV)()?o=M:(0,c.xk)()&&(o=R),i++;return o?((r={_transport:n,_isSync:t})[a.L]=o,r):null}(e,t):null},e.getFallbackInst=function(){return v},e[a.tn]=function(e,t){N()}})}return e.__ieDyn=1,e}()},623406:(e,t,r)=>{"use strict";r.d(t,{Cr:()=>c,Xc:()=>d,pI:()=>u,u7:()=>f});var n=r(647759),o=r(793940),i=r(356746),a=r(78050),s=r(445754),l=(0,i.T)("plugin");function c(e){return l.get(e,"state",{},!0)}function u(e,t){for(var r,i=[],s=null,l=e[o.uR]();l;){var u=l[o.AP]();if(u){s&&s[o.YH]&&u[a.qT]&&s[o.YH](u);var d=!!(r=c(u))[o.tZ];u[o.tZ]&&(d=u[o.tZ]()),d||i[o.y5](u),s=u,l=l[o.uR]()}}(0,n.Iuo)(i,function(n){var i=e[a.eT]();n[o.mE](e.getCfg(),i,t,e[o.uR]()),r=c(n),n[a.eT]||r[a.eT]||(r[a.eT]=i),r[o.tZ]=!0,delete r[o.Ik]})}function d(e){return e.sort(function(e,t){var r=0;if(t){var n=t[a.qT];e[a.qT]?r=n?e[a.Vo]-t[a.Vo]:1:n&&(r=-1)}else r=e?1:-1;return r})}function f(e){var t={};return{getName:function(){return t[o.RS]},setName:function(r){e&&e.setName(r),t[o.RS]=r},getTraceId:function(){return t[o.P5]},setTraceId:function(r){e&&e.setTraceId(r),(0,s.hX)(r)&&(t[o.P5]=r)},getSpanId:function(){return t[o.wi]},setSpanId:function(r){e&&e.setSpanId(r),(0,s.wN)(r)&&(t[o.wi]=r)},getTraceFlags:function(){return t[o.Rr]},setTraceFlags:function(r){e&&e.setTraceFlags(r),t[o.Rr]=r}}}},191752:(e,t,r)=>{"use strict";r.d(t,{l:()=>d});var n=r(533705),o=r(387657),i=r(647759),a=r(793940),s=r(652639),l=r(867073),c=r(437895),u=r(78050),d=function(e){function t(){var r,n,s=e.call(this)||this;return s.identifier="TelemetryInitializerPlugin",s.priority=199,r=0,n=[],(0,o.A)(t,s,function(e,t){e.addTelemetryInitializer=function(e){var t,o;return t=n,o={id:r++,fn:e},(0,i.Yny)(t,o),{remove:function(){(0,i.Iuo)(t,function(e,r){if(e.id===o.id)return t[a.Ic](r,1),-1})}}},e[u.qT]=function(t,r){(function(e,t,r){for(var n=!1,o=e[a.oI],s=0;s<o;++s){var u=e[s];if(u)try{if(!1===u.fn[a.y9](null,[t])){n=!0;break}}catch(e){(0,l.ZP)(r,2,64,"Telemetry initializer failed: "+(0,c.lL)(e),{exception:(0,i.mmD)(e)},!0)}}return!n})(n,t,r?r[a.e4]():e[a.e4]())&&e[a.$5](t,r)},e[a.tn]=function(){r=0,n=[]}}),s}return(0,n.qU)(t,e),t.__ieDyn=1,t}(s.s)},155422:(e,t,r)=>{"use strict";r.d(t,{P:()=>a});var n=r(647759),o=r(793940),i=r(867073);function a(){var e=[];return{add:function(t){t&&e[o.y5](t)},run:function(t,r){(0,n.Iuo)(e,function(e){try{e(t,r)}catch(e){(0,i.ZP)(t[o.e4](),2,73,"Unexpected error calling unload handler - "+(0,n.mmD)(e))}}),e=[]}}}},460699:(e,t,r)=>{"use strict";r.d(t,{w:()=>l});var n,o,i=r(647759),a=r(793940),s=r(867073);function l(){var e=[];return{run:function(t){var r=e;e=[],(0,i.Iuo)(r,function(e){try{(e.rm||e.remove).call(e)}catch(e){(0,s.ZP)(t,2,73,"Unloading:"+(0,i.mmD)(e))}}),n&&r[a.oI]>n&&(o?o("doUnload",r):(0,s.ZP)(null,1,48,"Max unload hooks exceeded. An excessive number of unload hooks has been detected."))},add:function(t){t&&((0,i.Yny)(e,t),n&&e[a.oI]>n&&(o?o("Add",e):(0,s.ZP)(null,1,48,"Max unload hooks exceeded. An excessive number of unload hooks has been detected.")))}}}},445754:(e,t,r)=>{"use strict";r.d(t,{hX:()=>i,wN:()=>a});var n=r(793940);function o(e,t,r){return!!e&&e[n.oI]===t&&e!==r&&!!e.match(/^[\da-f]*$/i)}function i(e){return o(e,32,"00000000000000000000000000000000")}function a(e){return o(e,16,"0000000000000000")}},793940:(e,t,r)=>{"use strict";r.d(t,{$5:()=>R,$o:()=>U,AP:()=>A,Az:()=>ei,Bl:()=>B,Cd:()=>el,DI:()=>x,Di:()=>F,FI:()=>P,HC:()=>G,Ic:()=>m,Ik:()=>H,JQ:()=>o,JR:()=>q,Ju:()=>y,K0:()=>g,L:()=>ep,M5:()=>L,OL:()=>n,O_:()=>ec,P5:()=>eb,QM:()=>er,Qg:()=>Y,RF:()=>_,RS:()=>T,Rr:()=>ew,Ru:()=>ed,Uw:()=>f,Vq:()=>eh,W7:()=>ee,XM:()=>N,XW:()=>a,YH:()=>X,Yo:()=>en,Yq:()=>k,Zu:()=>es,_w:()=>v,by:()=>z,c1:()=>em,cV:()=>eo,cp:()=>ef,do:()=>eg,e4:()=>W,e_:()=>eu,fA:()=>O,h0:()=>u,h3:()=>w,h4:()=>M,ih:()=>c,mE:()=>b,oI:()=>i,on:()=>l,pF:()=>E,pM:()=>j,re:()=>J,s:()=>D,sY:()=>Q,sl:()=>I,sx:()=>et,tI:()=>$,tX:()=>Z,tZ:()=>C,tn:()=>V,uR:()=>K,vR:()=>S,wJ:()=>ea,wi:()=>ey,x6:()=>d,y5:()=>p,y9:()=>h,yy:()=>ev,zs:()=>s});var n="toLowerCase",o="blkVal",i="length",a="rdOnly",s="notify",l="warnToConsole",c="throwInternal",u="setDf",d="watch",f="logger",h="apply",p="push",m="splice",g="hdlr",v="cancel",b="initialize",y="identifier",w="removeNotificationListener",S="addNotificationListener",C="isInitialized",I="instrumentationKey",k="INACTIVE",E="value",_="getNotifyMgr",A="getPlugin",T="name",P="iKey",O="time",R="processNext",x="getProcessTelContext",M="pollInternalLogs",N="enabled",F="stopPollingInternalLogs",L="unload",z="onComplete",D="version",B="loggingLevelConsole",U="createNew",H="teardown",q="messageId",j="message",$="isAsync",W="diagLog",V="_doTeardown",G="update",K="getNext",X="setNextPlugin",Y="protocol",Z="userAgent",Q="split",J="nodeType",ee="replace",et="logInternalMessage",er="type",en="handler",eo="status",ei="getResponseHeader",ea="getAllResponseHeaders",es="isChildEvt",el="data",ec="getCtx",eu="setCtx",ed="complete",ef="itemsReceived",eh="urlString",ep="sendPOST",em="headers",eg="timeout",ev="setRequestHeader",eb="traceId",ey="spanId",ew="traceFlags"},650506:(e,t,r)=>{"use strict";r.d(t,{_1:()=>o,bA:()=>i,hW:()=>n,s6:()=>s,vR:()=>a});var n="function",o="object",i="undefined",a="prototype",s=Object;s[a]},533705:(e,t,r)=>{"use strict";r.d(t,{qU:()=>a,vz:()=>s});var n=r(647759),o=r(650506),i=(((0,n.mS$)()||{}).Symbol,((0,n.mS$)()||{}).Reflect,function(e,t){return(i=o.s6.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)});function a(e,t){function r(){this.constructor=e}typeof t!==o.hW&&null!==t&&(0,n.zkd)("Class extends value "+String(t)+" is not a constructor or null"),i(e,t),e[o.vR]=null===t?(0,n.sSX)(t):(r[o.vR]=t[o.vR],new r)}function s(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e}},387657:(e,t,r)=>{"use strict";r.d(t,{A:()=>M});var n,o=r(647759),i="constructor",a="prototype",s="function",l="_dynInstFuncs",c="_isDynProxy",u="_dynClass",d="_dynInstChk",f="_dfOpts",h="_unknown_",p="__proto__",m="_dyn"+p,g="__dynProto$Gbl",v="_dynInstProto",b="useBaseInst",y="setInstFuncs",w=Object,S=w.getPrototypeOf,C=w.getOwnPropertyNames,I=(0,o.mS$)(),k=I[g]||(I[g]={o:((n={})[y]=!0,n[b]=!0,n),n:1e3});function E(e){return e&&(e===w[a]||e===Array[a])}function _(e){return E(e)||e===Function[a]}function A(e){var t;if(e){if(S)return S(e);var r=e[p]||e[a]||(e[i]?e[i][a]:null);t=e[m]||r,(0,o.v0u)(e,m)||(delete e[v],t=e[m]=e[v]||e[m],e[v]=r)}return t}function T(e,t){var r=[];if(C)r=C(e);else for(var n in e)"string"==typeof n&&(0,o.v0u)(e,n)&&r.push(n);if(r&&r.length>0)for(var i=0;i<r.length;i++)t(r[i])}function P(e,t,r){return t!==i&&typeof e[t]===s&&(r||(0,o.v0u)(e,t))&&t!==p&&t!==a}function O(e){(0,o.zkd)("DynamicProto: "+e)}function R(e,t){for(var r=e.length-1;r>=0;r--)if(e[r]===t)return!0;return!1}function x(e,t){return(0,o.v0u)(e,a)?e.name||t||h:((e||{})[i]||{}).name||t||h}function M(e,t,r,n){(0,o.v0u)(e,a)||O("theClass is an invalid class definition.");var i,h=e[a];!function(e,t){if(S){for(var r=[],n=A(t);n&&!_(n)&&!R(r,n);){if(n===e)return!0;r.push(n),n=A(n)}return!1}return!0}(h,t)&&O("["+x(e)+"] not in hierarchy of ["+x(t)+"]");var p=null;(0,o.v0u)(h,u)?p=h[u]:(p="_dynCls$"+x(e,"_")+"$"+k.n,k.n++,h[u]=p);var m=M[f],g=!!m[b];g&&n&&void 0!==n[b]&&(g=!!n[b]);var v=(i=(0,o.sSX)(null),T(t,function(e){!i[e]&&P(t,e,!1)&&(i[e]=t[e])}),i),w=function(e,t,r,n){function i(e,t,r){var o=t[r];if(o[c]&&n){var i=e[l]||{};!1!==i[d]&&(o=(i[t[u]]||{})[r]||o)}return function(){return o.apply(e,arguments)}}var a=(0,o.sSX)(null);T(r,function(e){a[e]=i(t,r,e)});for(var s=A(e),f=[];s&&!_(s)&&!R(f,s);)T(s,function(e){!a[e]&&P(s,e,!S)&&(a[e]=i(t,s,e))}),f.push(s),s=A(s);return a}(h,t,v,g);r(t,w);var C=!!S&&!!m[y];C&&n&&(C=!!n[y]),function(e,t,r,n,i){if(!E(e)){var a=r[l]=r[l]||(0,o.sSX)(null);if(!E(a)){var f=a[t]=a[t]||(0,o.sSX)(null);!1!==a[d]&&(a[d]=!!i),E(f)||T(r,function(t){if(P(r,t,!1)&&r[t]!==n[t]&&(f[t]=r[t],delete r[t],!(0,o.v0u)(e,t)||e[t]&&!e[t][c])){var i;e[t]=((i=function(){var r,n;return((function(e,t,r,n){var i=null;if(e&&(0,o.v0u)(r,u)){var a=e[l]||(0,o.sSX)(null);if((i=(a[r[u]]||(0,o.sSX)(null))[t])||O("Missing ["+t+"] "+s),!i[d]&&!1!==a[d]){for(var c=!(0,o.v0u)(e,t),f=A(e),h=[];c&&f&&!_(f)&&!R(h,f);){var p=f[t];if(p){c=p===n;break}h.push(f),f=A(f)}try{c&&(e[t]=i),i[d]=1}catch(e){a[d]=!1}}}return i})(this,t,e,i)||(r=i,(n=e[t])===r&&(n=A(e)[t]),typeof n!==s&&O("["+t+"] is not a "+s),n)).apply(this,arguments)})[c]=1,i)}})}}}(h,p,t,v,!1!==C)}M[f]=k.o},274107:(e,t,r)=>{"use strict";function n(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)0>t.indexOf(n[o])&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function o(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})}r.d(t,{T:()=>n,s:()=>o}),"function"==typeof SuppressedError&&SuppressedError},866095:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function o(e){return"string"==typeof e&&n.test(e)}},58227:(e,t,r)=>{"use strict";r.d(t,{Jc:()=>O,S7:()=>k,TI:()=>_,Y_:()=>I,ef:()=>P,s_:()=>E,yx:()=>C});var n=r(274107),o=r(157061),i=r(788347),a=r(550966),s=r(623054),l=r(65999),c=r(383655),u=r(313059),d=r(805234),f=r(254812),h=r(377255),p=r(89522),m=r(226646),g=r(50607),v=r(70727),b=r(952095),y=r(634362),w=r(103920);let S=(0,c.tZ)("app");function C(e,t){return(0,d.Du)()?(S.extend("initialize")("window object undefined at initialization"),Promise.resolve()):(0,d.F2)(()=>new Promise(r=>{a.Y.initializeCalled||(a.Y.initializeCalled=!0,(0,s.kM)(),a.Y.initializePromise=(0,o.jH)(t,e).then(({context:e,clientType:t,runtimeConfig:r,clientSupportedSDKVersion:n=i.nN})=>{a.Y.frameContext=e,a.Y.hostClientType=t,a.Y.clientSupportedSDKVersion=n;try{T("Parsing %s",r);let e=JSON.parse(r);if(T("Checking if %o is a valid runtime object",null!=e?e:"null"),!e||!e.apiVersion)throw Error("Received runtime config is invalid");r&&(0,v.pn)(e)}catch(e){if(!(e instanceof SyntaxError))throw e;try{T("Attempting to parse %s as an SDK version",r),isNaN((0,d.dI)(r,i.nN))||(a.Y.clientSupportedSDKVersion=r);let e=JSON.parse(n);if(T("givenRuntimeConfig parsed to %o",null!=e?e:"null"),!e)throw Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");(0,v.pn)(e)}catch(e){if(!(e instanceof SyntaxError))throw e;(0,v.pn)((0,v.ff)(a.Y.clientSupportedSDKVersion,v.nS,v.Wz))}}a.Y.initializeCompleted=!0}),(0,h.initialize)(),(0,g.initialize)(),(0,w.initialize)(),(0,m.initialize)()),Array.isArray(t)&&(0,l.WX)(t),void 0!==a.Y.initializePromise?r(a.Y.initializePromise):T("GlobalVars.initializePromise is unexpectedly undefined")}),6e4,Error("SDK initialization timed out."))}function I(e){(0,o.x3)(e,f.Messages.AppLoaded,[b.r])}function k(e,t){(0,o.x3)(e,f.Messages.ExpectedFailure,[t.reason,t.message])}function E(e,t){(0,o.x3)(e,f.Messages.Failure,[t.reason,t.message])}function _(e){return(0,n.s)(this,void 0,void 0,function*(){if(a.Y.initializeCompleted)return A(e);if(!a.Y.initializePromise)throw Error(i.PH);return a.Y.initializePromise.then(()=>A(e))})}function A(e){return(0,n.s)(this,void 0,void 0,function*(){var t;return(0,l.Zn)(v.fA)&&(null===(t=v.fA.supports.app)||void 0===t?void 0:t.notifySuccessResponse)?(0,o.AR)(f.Messages.Success,[b.r],new y.c,e).then(()=>({hasFinishedSuccessfully:!0})):((0,o.x3)(e,f.Messages.Success,[b.r]),{hasFinishedSuccessfully:"unknown"})})}let T=S.extend("initializeHelper");function P(e,t){(0,u.h)(t)||(0,l.UF)(),(0,s.Io)(e,t)}function O(e,t){return new Promise(r=>{(0,l.Zn)(v.fA,p.E2.content,p.E2.sidePanel,p.E2.settings,p.E2.task,p.E2.stage,p.E2.meetingStage),r((0,o.Vi)(e,"executeDeepLink",t))})}},231494:(e,t,r)=>{"use strict";r.d(t,{kX:()=>l,uO:()=>i});var n=r(633277),o=r(805234);function i(e){if((0,o.t_)(e))throw Error(`Potential app id (${e}) is invalid; it contains script tags.`);if(!(e.length<s&&e.length>a))throw Error(`Potential app id (${e}) is invalid; its length ${e.length} is not within the length limits (${a}-${s}).`);if([...e].some(e=>{let t=e.charCodeAt(0);return t<32||t>126}))throw Error(`Potential app id (${e}) is invalid; it contains non-printable characters.`)}let a=4,s=256;function l(e){if(!(e instanceof n.l))throw Error(`Potential app id (${e}) is invalid; it is not an instance of AppId class.`)}},157061:(e,t,r)=>{"use strict";r.d(t,{bm:()=>C,_s:()=>M,AR:()=>x,jH:()=>k,tX:()=>N,gV:()=>P,Vi:()=>A,k$:()=>T,j0:()=>_,nq:()=>ea,x3:()=>F,b5:()=>O,cB:()=>E,LP:()=>eo});var n=r(274107),o=r(383655),i=r(995243),a=r(70727),s=r(416835),l=r(952095),c=r(550966),u=r(623054);class d{static storeCallbackInformation(e,t){d.callbackInformation.set(e,t)}static clearMessages(){d.callbackInformation.clear()}static deleteMessageInformation(e){d.callbackInformation.delete(e)}static handleOneWayPerformanceMetrics(e,t,r){let n=e.monotonicTimestamp;n&&r?(0,u.yE)({actionName:e.func,messageDelay:r-n,requestStartedAt:n}):t("Unable to send performance metrics for event %s",e.func)}static handlePerformanceMetrics(e,t,r,n){let o=d.callbackInformation.get(e);o&&t.monotonicTimestamp&&n?((0,u.yE)({actionName:o.name,messageDelay:n-t.monotonicTimestamp,requestStartedAt:o.calledAt}),d.deleteMessageInformation(e)):r("Unable to send performance metrics for callback %s with arguments %o",e.toString(),t.args)}}d.callbackInformation=new Map;let f=e=>{let{uuid:t}=e,r=(0,n.T)(e,["uuid"]),o=null==t?void 0:t.toString();return Object.assign(Object.assign({},r),{uuidAsString:o})},h=e=>{let{uuidAsString:t}=e;return Object.assign(Object.assign({},(0,n.T)(e,["uuidAsString"])),{uuid:t?new s.k(t):void 0})},p=e=>{let{uuidAsString:t}=e;return Object.assign(Object.assign({},(0,n.T)(e,["uuidAsString"])),{uuid:t?new s.k(t):void 0})},m=e=>{let{uuid:t}=e,r=(0,n.T)(e,["uuid"]),o=null==t?void 0:t.toString();return Object.assign(Object.assign({},r),{uuidAsString:o})},g=(0,o.tZ)("nestedAppAuthUtils"),v=g.extend("tryPolyfillWithNestedAppAuthBridge"),b=g.extend("createNestedAppAuthBridge");var y=r(805234),w=r(761862);let S=(0,o.tZ)("communication");class C{}class I{}function k(e,t){if(I.messageListener=e=>(function(e){return(0,n.s)(this,void 0,void 0,function*(){if(!e||!e.data||"object"!=typeof e.data)return void q("Unrecognized message format received by app, message being ignored. Message: %o",e);let t=e.source||e.originalEvent&&e.originalEvent.source,r=e.origin||e.originalEvent&&e.originalEvent.origin;return V(t,r).then(n=>{n?(c.Y.isFramelessWindow||C.parentWindow&&!C.parentWindow.closed&&t!==C.parentWindow?C.childWindow&&!C.childWindow.closed&&t!==C.childWindow||(C.childWindow=t,C.childOrigin=r):(C.parentWindow=t,C.parentOrigin=r),C.parentWindow&&C.parentWindow.closed&&(C.parentWindow=null,C.parentOrigin=null),C.childWindow&&C.childWindow.closed&&(C.childWindow=null,C.childOrigin=null),en(C.parentWindow),en(C.childWindow),t===C.parentWindow?Y(e):t===C.childWindow&&function(e){if("id"in e.data&&"func"in e.data){let t=h(e.data),[r,n]=(0,u.th)(t.func,t.args);r&&void 0!==n?(Z("Handler called in response to message %s from child. Returning response from handler to child, action: %s.",es(t),t.func),ei(t.id,t.uuid,Array.isArray(n)?n:[n])):(Z("No handler for message %s from child found; relaying message on to parent, action: %s. Relayed message will have a new id.",es(t),t.func),function(e){let t=H((0,o.N0)("v2","tasks.startTask"),e.func,e.args,!0);I.callbacks.set(t.uuid,(...t)=>{if(C.childWindow){let r=t.pop();Z("Message from parent being relayed to child, id: %s",es(e)),ei(e.id,e.uuid,t,r)}})}(t))}}(e)):q("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin, message: %o, source: %o, origin: %o",e,t,r)})})})(e),C.currentWindow=C.currentWindow||(0,y.cg)(),C.parentWindow=C.currentWindow.parent!==C.currentWindow.self?C.currentWindow.parent:C.currentWindow.opener,C.topWindow=C.currentWindow.top,(C.parentWindow||e)&&C.currentWindow.addEventListener("message",I.messageListener,!1),!C.parentWindow){let e=C.currentWindow;if(!e.nativeInterface)return Promise.reject(Error("Initialization Failed. No Parent window found."));c.Y.isFramelessWindow=!0,e.onNativeMessage=Y}try{return C.parentOrigin="*",O(t,"initialize",[l.r,a.sO,e]).then(([e,t,r,n])=>((function(e,t,r){var n;if(c.Y.isFramelessWindow)return void v("Cannot polyfill nestedAppAuthBridge as current window is frameless");if(!t)return void v("Cannot polyfill nestedAppAuthBridge as current window does not exist");let o=(()=>{try{return JSON.parse(e)}catch(e){return null}})();if(!o||!(null===(n=o.supports)||void 0===n?void 0:n.nestedAppAuth))return void v("Cannot polyfill nestedAppAuthBridge as current hub does not support nested app auth");if(t.nestedAppAuthBridge)return void v("nestedAppAuthBridge already exists on current window, skipping polyfill");let i=function(e,t){if(!e)return b("nestedAppAuthBridge cannot be created as current window does not exist"),null;let{onMessage:r,sendPostMessage:n}=t,o=e=>t=>r(t,e);return{addEventListener:(t,r)=>{"message"===t?e.addEventListener(t,o(r)):b(`Event ${t} is not supported by nestedAppAuthBridge`)},postMessage:e=>{let t=(()=>{try{return JSON.parse(e)}catch(e){return null}})();t&&"object"==typeof t&&"NestedAppAuthRequest"===t.messageType?n(e):b("Unrecognized data format received by app, message being ignored. Message: %o",e)},removeEventListener:(t,r)=>{e.removeEventListener(t,o(r))}}}(t,r);i&&(t.nestedAppAuthBridge=i)})(n,C.currentWindow,{onMessage:$,sendPostMessage:z}),{context:e,clientType:t,runtimeConfig:r,clientSupportedSDKVersion:n}))}finally{C.parentOrigin=null}}function E(){C.currentWindow&&C.currentWindow.removeEventListener("message",I.messageListener,!1),C.currentWindow=null,C.parentWindow=null,C.parentOrigin=null,C.childWindow=null,C.childOrigin=null,I.parentMessageQueue=[],I.childMessageQueue=[],I.nextMessageId=0,I.callbacks.clear(),I.promiseCallbacks.clear(),I.portCallbacks.clear(),I.legacyMessageIdsToUuidMap={},d.clearMessages()}function _(e,t,...r){return O(e,t,r).then(([e])=>e)}function A(e,t,...r){return O(e,t,r).then(([e,t])=>{if(!e)throw Error(t)})}function T(e,t,r,...n){return O(e,t,n).then(([e,t])=>{if(!e)throw Error(t||r)})}function P(e,t,...r){return O(e,t,r).then(([e,t])=>{if(e)throw e;return t})}function O(e,t,r){if(!(0,o.Bt)(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return new Promise(n=>{var o;n((o=H(e,t,r).uuid,new Promise(e=>{I.promiseCallbacks.set(o,e)})))})}function R(e){return e.map(e=>null!=e&&void 0!==e.serialize&&"function"==typeof e.serialize?e.serialize():e)}function x(e,t,r,o,a){var s;return(0,n.s)(this,void 0,void 0,function*(){let n=R(t),[l]=yield O(o,e,n);if(a&&a(l)||!a&&(0,i.hl)(l))throw Error(`${l.errorCode}, message: ${null!==(s=l.message)&&void 0!==s?s:"None"}`);if(r.validate(l))return r.deserialize(l);throw Error(`${i.O4.INTERNAL_ERROR}, message: Invalid response from host - ${JSON.stringify(l)}`)})}function M(e,t,r,o){var a;return(0,n.s)(this,void 0,void 0,function*(){let n=R(t),[s]=yield O(r,e,n);if(o&&o(s)||!o&&(0,i.hl)(s))throw Error(`${s.errorCode}, message: ${null!==(a=s.message)&&void 0!==a?a:"None"}`);if(void 0!==s)throw Error(`${i.O4.INTERNAL_ERROR}, message: Invalid response from host`)})}function N(e,t,r){var n;if(!(0,o.Bt)(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return n=H(e,t,r).uuid,new Promise((e,t)=>{I.portCallbacks.set(n,(r,n)=>{r instanceof MessagePort?e(r):t(n&&n.length>0?n[0]:Error("Host responded without port or error details."))})})}function F(e,t,r,n){let i;if(r instanceof Function?n=r:r instanceof Array&&(i=r),!(0,o.Bt)(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);let a=H(e,t,i);n&&I.callbacks.set(a.uuid,n)}I.parentMessageQueue=[],I.childMessageQueue=[],I.topMessageQueue=[],I.nextMessageId=0,I.callbacks=new Map,I.promiseCallbacks=new Map,I.portCallbacks=new Map,I.legacyMessageIdsToUuidMap={};let L=S.extend("sendNestedAuthRequestToTopWindow");function z(e){let t=C.topWindow,r=function(e){let t=I.nextMessageId++,r=new s.k;return I.legacyMessageIdsToUuidMap[t]=r,{id:t,uuid:r,func:"nestedAppAuth.execute",timestamp:Date.now(),monotonicTimestamp:(0,y.mI)(),args:[],data:e}}(e);return L("Message %s information: %o",es(r),{actionName:r.func}),B(t,r)}let D=S.extend("sendRequestToTargetWindowHelper");function B(e,t){let r=et(e),n=f(t);if(c.Y.isFramelessWindow)C.currentWindow&&C.currentWindow.nativeInterface&&(D("Sending message %s to %s via framelessPostMessage interface",es(n),r),C.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(n)));else{let o=ee(e);e&&o?(D("Sending message %s to %s via postMessage",es(n),r),e.postMessage(n,o)):(D("Adding message %s to %s message queue",es(n),r),J(e).push(t))}return t}let U=S.extend("sendMessageToParentHelper");function H(e,t,r,n){let o=C.parentWindow,i=function(e,t,r,n){let o=I.nextMessageId++,i=new s.k;return I.legacyMessageIdsToUuidMap[o]=i,{id:o,uuid:i,func:t,timestamp:Date.now(),monotonicTimestamp:(0,y.mI)(),args:r||[],apiVersionTag:e,isProxiedFromChild:null!=n&&n}}(e,t,r,n);return d.storeCallbackInformation(i.uuid,{name:t,calledAt:i.timestamp}),U("Message %s information: %o",es(i),{actionName:t,args:r}),B(o,i)}let q=S.extend("processIncomingMessage"),j=S.extend("processAuthBridgeMessage");function $(e,t){var r,n;if(!e||!e.data||"object"!=typeof e.data)return void j("Unrecognized message format received by app, message being ignored. Message: %o",e);let{args:o}=e.data,[,i]=null!=o?o:[],a=(()=>{try{return JSON.parse(i)}catch(e){return null}})();if(!a||"object"!=typeof a||"NestedAppAuthResponse"!==a.messageType)return void j("Unrecognized data format received by app, message being ignored. Message: %o",e);let s=e.source||(null===(r=null==e?void 0:e.originalEvent)||void 0===r?void 0:r.source),l=e.origin||(null===(n=null==e?void 0:e.originalEvent)||void 0===n?void 0:n.origin);s?V(s,l)?(C.topWindow&&!C.topWindow.closed&&s!==C.topWindow||(C.topWindow=s,C.topOrigin=l),C.topWindow&&C.topWindow.closed&&(C.topWindow=null,C.topOrigin=null),en(C.topWindow),t(i)):j("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin"):j("Message being ignored by app because it is coming for a target that is null")}let W=S.extend("shouldProcessIncomingMessage");function V(e,t){return(0,n.s)(this,void 0,void 0,function*(){if(C.currentWindow&&e===C.currentWindow)return W("Should not process message because it is coming from the current window"),!1;if(C.currentWindow&&C.currentWindow.location&&t&&t===C.currentWindow.location.origin)return!0;{let e;try{e=new URL(t)}catch(e){return W("Message has an invalid origin of %s",t),!1}let r=yield(0,w.T)(e);return r||W("Message has an invalid origin of %s",t),r}})}let G=S.extend("handleIncomingMessageFromParent");function K(e,t){if(t){let r=[...e].find(([e,r])=>e.toString()===t.toString());if(r)return r[0]}}function X(e,t){let r=K(t,e.uuid);r&&t.delete(r),e.uuid?I.legacyMessageIdsToUuidMap={}:delete I.legacyMessageIdsToUuidMap[e.id]}function Y(e){let t=(0,y.mI)();if("id"in e.data&&"number"==typeof e.data.id){let r=p(e.data),n=function(e){if(!e.uuid)return I.legacyMessageIdsToUuidMap[e.id];{let t=e.uuid,r=K(I.callbacks,t);if(r)return r;let n=K(I.promiseCallbacks,t);if(n)return n;let o=K(I.portCallbacks,t);if(o)return o}G("Received message %s that failed to produce a callbackId",es(e))}(r);if(n){let o=I.callbacks.get(n);G("Received a response from parent for message %s",n.toString()),d.handlePerformanceMetrics(n,r,G,t),o&&(G("Invoking the registered callback for message %s with arguments %o",n.toString(),r.args),o.apply(null,[...r.args,r.isPartialResponse]),!0===e.data.isPartialResponse||(G("Removing registered callback for message %s",n.toString()),X(r,I.callbacks)));let i=I.promiseCallbacks.get(n);i&&(G("Invoking the registered promise callback for message %s with arguments %o",n.toString(),r.args),i(r.args),G("Removing registered promise callback for message %s",n.toString()),X(r,I.promiseCallbacks));let a=I.portCallbacks.get(n);if(a){let t;G("Invoking the registered port callback for message %s with arguments %o",n.toString(),r.args),e.ports&&e.ports[0]instanceof MessagePort&&(t=e.ports[0]),a(t,r.args),G("Removing registered port callback for message %s",n.toString()),X(r,I.portCallbacks)}r.uuid&&(I.legacyMessageIdsToUuidMap={})}}else if("func"in e.data&&"string"==typeof e.data.func){let r=e.data;d.handleOneWayPerformanceMetrics(r,G,t),G('Received a message from parent %s, action: "%s"',es(r),r.func),(0,u.th)(r.func,r.args)}else G("Received an unknown message: %O",e)}let Z=S.extend("handleIncomingMessageFromChild");function Q(){return C.topWindow!==C.parentWindow}function J(e){return e===C.topWindow&&Q()?I.topMessageQueue:e===C.parentWindow?I.parentMessageQueue:e===C.childWindow?I.childMessageQueue:[]}function ee(e){return e===C.topWindow&&Q()?C.topOrigin:e===C.parentWindow?C.parentOrigin:e===C.childWindow?C.childOrigin:null}function et(e){return e===C.topWindow&&Q()?"top":e===C.parentWindow?"parent":e===C.childWindow?"child":null}let er=S.extend("flushMessageQueue");function en(e){let t=ee(e),r=J(e),n=et(e);for(;e&&t&&r.length>0;){let o=r.shift();if(o){let r=f(o);er("Flushing message %s from %s message queue via postMessage.",es(r),n),e.postMessage(r,t)}}}function eo(e,t){let r;r=C.currentWindow.setInterval(()=>{0===J(e).length&&(clearInterval(r),t())},100)}function ei(e,t,r,n){let o=C.childWindow,i=m({id:e,uuid:t,args:r||[],isPartialResponse:n}),a=ee(o);o&&a&&(Z("Sending message %s to %s via postMessage, args = %o",es(i),et(o),i.args),o.postMessage(i,a))}function ea(e,t){let r=C.childWindow,n={func:e,args:t||[]},o=ee(r);r&&o?r.postMessage(n,o):J(r).push(n)}function es(e){return"uuidAsString"in e?`${e.uuidAsString} (legacy id: ${e.id})`:"uuid"in e&&void 0!==e.uuid?`${e.uuid.toString()} (legacy id: ${e.id})`:`legacy id: ${e.id} (no uuid)`}},788347:(e,t,r)=>{"use strict";r.d(t,{gD:()=>m,ZW:()=>u,nN:()=>n,H0:()=>I,PH:()=>w,qx:()=>S,Cf:()=>C,ph:()=>f,nj:()=>s,gE:()=>a,s_:()=>l,SY:()=>d,K0:()=>i,rs:()=>c,$8:()=>h,$p:()=>y,F1:()=>b,xf:()=>v,_X:()=>g,kS:()=>p,Te:()=>o});let n="2.0.1",o="2.0.2",i="2.0.3",a="2.0.4",s="2.0.1",l="1.9.0",c="2.0.0",u="1.7.0",d="1.8.0",f="2.0.0",h="1.9.0",p=["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","teams.live.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","devspaces.skype.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","work.bing.com","www.bing.com","www.staging-bing-int.com","*.cloud.microsoft","*.m365.cloud.microsoft","chatuxmanager.svc.cloud.microsoft","copilot.microsoft.com","windows.msn.com","fa000000125.resources.office.net","fa000000129.resources.office.net","fa000000124.resources.office.net","fa000000128.resources.office.net","fa000000136.resources.office.net"],m=1500,g=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),v=/^https:\/\//,b="https",y="teams.microsoft.com",w="The library has not yet been initialized",S="The runtime has not yet been initialized",C="The runtime version is not supported",I="The call was not properly started"},738834:(e,t,r)=>{"use strict";r.d(t,{Fr:()=>g,GQ:()=>p,KP:()=>S,Xh:()=>h,a:()=>y,f8:()=>b,g8:()=>v,kE:()=>m,u3:()=>w});var n=r(65999),o=r(89522),i=r(70727),a=r(157061),s=r(550966),l=r(623054),c=r(383655),u=r(257103),d=r(935940),f=r(62339);let h="v2";function p(e,t){if((0,n.Zn)(i.fA,o.E2.content,o.E2.sidePanel,o.E2.task,o.E2.meetingStage),!(0,u.isSupported)())throw o.qP;(0,a.x3)(e,"tasks.updateTask",[t])}function m(e,t,r,s){if((0,n.Zn)(i.fA,o.E2.content,o.E2.sidePanel,o.E2.meetingStage),!(0,d.isSupported)())throw o.qP;s&&(0,l.ik)((0,c.N0)(h,"dialog.url.registerMessageForParentHandler"),"messageForParent",s);let u=(0,d.getDialogInfoFromUrlDialogInfo)(t);(0,a.x3)(e,"tasks.startTask",[u],(e,t)=>{null==r||r({err:e,result:t}),(0,l.Vl)("messageForParent")})}function g(e,t,r,s){if((0,n.Zn)(i.fA,o.E2.content,o.E2.sidePanel,o.E2.meetingStage),!(0,f.isSupported)())throw o.qP;s&&(0,l.ik)((0,c.N0)(h,"dialog.url.bot.registerMessageForParentHandler"),"messageForParent",s);let u=(0,d.getDialogInfoFromBotUrlDialogInfo)(t);(0,a.x3)(e,"tasks.startTask",[u],(e,t)=>{null==r||r({err:e,result:t}),(0,l.Vl)("messageForParent")})}function v(e,t,r){if((0,n.Zn)(i.fA,o.E2.task),!(0,d.isSupported)())throw o.qP;(0,a.x3)(e,"tasks.completeTask",[t,r?Array.isArray(r)?r:[r]:[]])}function b(e){return{card:e.card,height:e.size?e.size.height:o.zo.Small,width:e.size?e.size.width:o.zo.Small,title:e.title}}function y(e){let t=b(e);return t.completionBotId=e.completionBotId,t}let w=[];function S(e){s.Y.frameContext&&(s.Y.frameContext===o.E2.task?w.push(e):(0,l.Vl)("messageForChild"))}},550966:(e,t,r)=>{"use strict";r.d(t,{Y:()=>n});class n{}n.initializeCalled=!1,n.initializeCompleted=!1,n.additionalValidOrigins=[],n.initializePromise=void 0,n.isFramelessWindow=!1,n.frameContext=void 0,n.hostClientType=void 0,n.printCapabilityEnabled=!1},623054:(e,t,r)=>{"use strict";r.d(t,{$e:()=>C,H0:()=>k,Io:()=>w,VA:()=>T,Vl:()=>v,Xz:()=>h,YK:()=>P,aY:()=>y,bo:()=>b,ik:()=>g,kM:()=>f,th:()=>m,wT:()=>_,yE:()=>I});var n=r(274107),o=r(383655),i=r(70727),a=r(157061),s=r(65999),l=r(313059),c=r(944673);let u=(0,o.tZ)("handlers");class d{static initializeHandlers(){d.handlers.themeChange=S,d.handlers.load=E,d.handlers.beforeUnload=A,(0,c._initialize)()}static uninitializeHandlers(){d.handlers={},d.themeChangeHandler=null,d.loadHandler=null,d.beforeUnloadHandler=null,d.beforeSuspendOrTerminateHandler=null,d.resumeHandler=null}}function f(){d.initializeHandlers()}function h(){d.uninitializeHandlers()}d.handlers={},d.themeChangeHandler=null,d.loadHandler=null,d.beforeUnloadHandler=null,d.beforeSuspendOrTerminateHandler=null,d.resumeHandler=null,d.hostToAppPerformanceMetricsHandler=null;let p=u.extend("callHandler");function m(e,t){let r=d.handlers[e];return r?(p("Invoking the registered handler for message %s with arguments %o",e,t),[!0,r.apply(this,t)]):(a.bm.childWindow?(0,a.nq)(e,t):p("Handler for action message %s not found.",e),[!1,void 0])}function g(e,t,r,n=!0,o=[]){r?(d.handlers[t]=r,n&&(0,a.x3)(e,"registerHandler",[t,...o])):delete d.handlers[t]}function v(e){delete d.handlers[e]}function b(e){return null!=d.handlers[e]}function y(e,t,r,n,o){r&&(0,s.Zn)(i.fA,...n),o&&o(),g(e,t,r)}function w(e,t){d.themeChangeHandler=t,(0,l.h)(t)||(0,a.x3)(e,"registerHandler",["themeChange"])}function S(e){d.themeChangeHandler&&d.themeChangeHandler(e),a.bm.childWindow&&(0,a.nq)("themeChange",[e])}function C(e){d.hostToAppPerformanceMetricsHandler=e}function I(e){d.hostToAppPerformanceMetricsHandler&&d.hostToAppPerformanceMetricsHandler(e)}function k(e,t){d.loadHandler=t,(0,l.h)(t)||(0,a.x3)(e,"registerHandler",["load"])}function E(e){let t={entityId:e.entityId,contentUrl:new URL(e.contentUrl)};d.resumeHandler?(d.resumeHandler(t),a.bm.childWindow&&(0,a.nq)("load",[t])):d.loadHandler&&(d.loadHandler(e),a.bm.childWindow&&(0,a.nq)("load",[e]))}function _(e,t){d.beforeUnloadHandler=t,(0,l.h)(t)||(0,a.x3)(e,"registerHandler",["beforeUnload"])}function A(){return(0,n.s)(this,void 0,void 0,function*(){let e=()=>{(0,a.x3)((0,o.N0)("v2","handleBeforeUnload"),"readyToUnload",[])};d.beforeSuspendOrTerminateHandler?(yield d.beforeSuspendOrTerminateHandler(),a.bm.childWindow?(0,a.nq)("beforeUnload"):e()):d.beforeUnloadHandler&&d.beforeUnloadHandler(e)||(a.bm.childWindow?(0,a.nq)("beforeUnload"):e())})}function T(e){d.beforeSuspendOrTerminateHandler=e,(0,l.h)(e)||(0,a.x3)((0,o.N0)("v2","registerBeforeSuspendOrTerminateHandler"),"registerHandler",["beforeUnload"])}function P(e){d.resumeHandler=e,(0,l.h)(e)||(0,a.x3)((0,o.N0)("v2","registerOnResumeHandler"),"registerHandler",["load"])}},65999:(e,t,r)=>{"use strict";r.d(t,{UF:()=>h,WX:()=>v,Zn:()=>p,at:()=>g,wT:()=>m});var n=r(89522),o=r(995243),i=r(70727),a=r(788347),s=r(550966),l=r(383655),c=r(805234);let u=(0,l.tZ)("internal"),d=u.extend("ensureInitializeCalled"),f=u.extend("ensureInitialized");function h(){if(!s.Y.initializeCalled)throw d(a.PH),Error(a.PH)}function p(e,...t){if(!s.Y.initializeCompleted)throw f("%s. initializeCalled: %s",a.PH,s.Y.initializeCalled.toString()),Error(a.PH);if(t&&t.length>0){let e=!1;for(let r=0;r<t.length;r++)if(t[r]===s.Y.frameContext){e=!0;break}if(!e)throw Error(`This call is only allowed in following contexts: ${JSON.stringify(t)}. Current context: "${s.Y.frameContext}".`)}return(0,i.xb)(e)}function m(e=a.nN){let t=(0,c.dI)(s.Y.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0}function g(e=a.nN){if(!(s.Y.hostClientType==n.WK.android||s.Y.hostClientType==n.WK.ios||s.Y.hostClientType==n.WK.ipados||s.Y.hostClientType==n.WK.visionOS))throw{errorCode:o.O4.NOT_SUPPORTED_ON_PLATFORM};if(!m(e))throw{errorCode:o.O4.OLD_PLATFORM}}function v(e){let t=s.Y.additionalValidOrigins.concat(e.filter(e=>"string"==typeof e&&a.xf.test(e))),r={};t=t.filter(e=>!r[e]&&(r[e]=!0,!0)),s.Y.additionalValidOrigins=t}},65311:(e,t,r)=>{"use strict";r.d(t,{QR:()=>f,Sr:()=>h,iV:()=>d,kF:()=>c,qT:()=>s,sq:()=>p,vc:()=>l,wN:()=>u,x3:()=>a});var n=r(919607),o=r(788347),i=r(65999);function a(e,t){if(null==e||null==t||e.length<=0)return null;let r=null,n=1;return e.sort((e,t)=>e.sequence>t.sequence?1:-1),e.forEach(e=>{e.sequence==n&&(r=r?new Blob([r,e.file],{type:t}):new Blob([e.file],{type:t}),n++)}),r}function s(e,t){if(null==e||null==t)return null;let r=atob(e.chunk),n=Array(r.length);for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e);let o=new Blob([new Uint8Array(n)],{type:t});return{sequence:e.chunkSequence,file:o}}function l(e){var t;e&&(e.mediaType==n.MediaType.VideoAndImage||e.videoAndImageProps)?(0,i.at)(o.Te):e&&e.mediaType==n.MediaType.Video&&e.videoProps&&!e.videoProps.isFullScreenMode?(0,i.at)(o.K0):(null==e?void 0:e.mediaType)==n.MediaType.Image&&(null===(t=null==e?void 0:e.imageProps)||void 0===t?void 0:t.imageOutputFormats)&&(0,i.at)(o.gE)}function c(e){return!(e.mediaType!=n.MediaType.Video||!e.videoProps||!e.videoProps.videoController)}function u(e){return!(null==e||e.maxMediaCount>10)}function d(e,t,r){return null!=e&&null!=t&&t==n.FileFormat.ID&&null!=r}function f(e){return!(null==e||e.length<=0||e.length>10)}function h(e){return!e||!(null===e.timeOutIntervalInSec||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec<=0||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec>60)}function p(e){return!e||(!e.title||"string"==typeof e.title)&&(!e.setSelected||"object"==typeof e.setSelected)&&(!e.openOrgWideSearchInChatOrChannel||"boolean"==typeof e.openOrgWideSearchInChatOrChannel)&&(!e.singleSelect||"boolean"==typeof e.singleSelect)}},894754:(e,t,r)=>{"use strict";r.d(t,{Gb:()=>p,Gt:()=>b,Gx:()=>h,Hp:()=>w,K5:()=>m,Lv:()=>g,Sd:()=>v,VR:()=>f,ex:()=>y,jS:()=>_,je:()=>I,kX:()=>S,p$:()=>E,rP:()=>k,xG:()=>C});var n=r(633277),o=r(89522),i=r(667752),a=r(70727),s=r(157061),l=r(65999),c=r(944673),u=r(668954),d=r(103920);let f="v2";function h(e,t){return new Promise(r=>{if((0,l.Zn)(a.fA,o.E2.content,o.E2.sidePanel,o.E2.settings,o.E2.remove,o.E2.task,o.E2.stage,o.E2.meetingStage),!(0,i.isSupported)())throw o.qP;r((0,s.k$)(e,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",t))})}function p(e){return new Promise(t=>{if((0,l.Zn)(a.fA),!(0,c.isSupported)())throw o.qP;t((0,s.k$)(e,"navigateBack","Back navigation is not supported in the current client or context."))})}function m(e,t){return new Promise(r=>{if((0,l.Zn)(a.fA),!(0,u.isSupported)())throw o.qP;r((0,s.k$)(e,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",t))})}function g(e,t){if((0,l.Zn)(a.fA),!(0,i.isSupported)())throw o.qP;(0,s.x3)(e,"returnFocus",[t])}function v(e,t){return new Promise(r=>{if((0,l.Zn)(a.fA),!(0,u.isSupported)())throw o.qP;r((0,s.j0)(e,"getTabInstances",t))})}function b(e,t){return new Promise(r=>{if((0,l.Zn)(a.fA),!(0,u.isSupported)())throw o.qP;r((0,s.j0)(e,"getMruTabInstances",t))})}function y(e,t){if((0,l.Zn)(a.fA,o.E2.content,o.E2.sidePanel,o.E2.meetingStage),!(0,i.isSupported)())throw o.qP;(0,s.x3)(e,"shareDeepLink",[t.subPageId,t.subPageLabel,t.subPageWebUrl])}function w(e,t){if((0,l.Zn)(a.fA,o.E2.content),!(0,i.isSupported)())throw o.qP;(0,s.x3)(e,"setFrameContext",[t])}function S(e,t){if((0,l.Zn)(a.fA,o.E2.settings,o.E2.remove),!(0,d.isSupported)())throw o.qP;(0,s.x3)(e,"settings.setValidityState",[t])}function C(e){return new Promise(t=>{if((0,l.Zn)(a.fA,o.E2.content,o.E2.settings,o.E2.remove,o.E2.sidePanel),!(0,i.isSupported)())throw o.qP;t((0,s.j0)(e,"settings.getSettings"))})}function I(e,t){return new Promise(r=>{if((0,l.Zn)(a.fA,o.E2.content,o.E2.settings,o.E2.sidePanel),!(0,d.isSupported)())throw o.qP;r((0,s.Vi)(e,"settings.setSettings",t))})}function k(e){return e.appId instanceof n.l}function E(e){return Object.assign(Object.assign({},e),{appId:new n.l(e.appId),webUrl:e.webUrl?new URL(e.webUrl):void 0})}function _(e){return Object.assign(Object.assign({},e),{appId:e.appId.toString(),webUrl:e.webUrl?e.webUrl.toString():void 0})}},634362:(e,t,r)=>{"use strict";r.d(t,{c:()=>o,w:()=>n});class n{}class o extends n{validate(e){return!0}deserialize(e){return e}}},383655:(e,t,r)=>{"use strict";r.d(t,{N0:()=>f,tZ:()=>d,Bt:()=>h});var n,o,i={exports:{}},a=function(e){function t(e){let n,o,i,a=null;function s(...e){if(!s.enabled)return;let r=Number(new Date),o=r-(n||r);s.diff=o,s.prev=n,s.curr=r,n=r,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let i=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,n)=>{if("%%"===r)return"%";i++;let o=t.formatters[n];if("function"==typeof o){let t=e[i];r=o.call(s,t),e.splice(i,1),i--}return r}),t.formatArgs.call(s,e),(s.log||t.log).apply(s,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,r){let n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){let e=[...t.names.map(i),...t.skips.map(i).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];let n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(RegExp("^"+e.slice(1)+"$")):t.names.push(RegExp("^"+e+"$")))},t.enabled=function(e){let r,n;if("*"===e[e.length-1])return!0;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=function(){if(o)return n;function e(e,t,r,n){return Math.round(e/r)+" "+n+(t>=1.5*r?"s":"")}return o=1,n=function(t,r){r=r||{};var n,o,i=typeof t;if("string"===i&&t.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return 864e5*r;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*r;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(t);if("number"===i&&isFinite(t))return r.long?(n=Math.abs(t))>=864e5?e(t,n,864e5,"day"):n>=36e5?e(t,n,36e5,"hour"):n>=6e4?e(t,n,6e4,"minute"):n>=1e3?e(t,n,1e3,"second"):t+" ms":(o=Math.abs(t))>=864e5?Math.round(t/864e5)+"d":o>=36e5?Math.round(t/36e5)+"h":o>=6e4?Math.round(t/6e4)+"m":o>=1e3?Math.round(t/1e3)+"s":t+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}}(),t.destroy=function(){},Object.keys(e).forEach(r=>{t[r]=e[r]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t};!function(e,t){let r;t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(n++,"%c"===e&&(o=n))}),t.splice(o,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(r=!1,()=>{r||(r=!0)}),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=a(t);let{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(i,i.exports);var s=i.exports;let l=new(r(416835)).k,c=s.debug.formatArgs;s.debug.formatArgs=function(e){e[0]=`(${(new Date).toISOString()}): ${e[0]} [${l.toString()}]`,c.call(this,e)};let u=s.debug("teamsJs");function d(e){return u.extend(e)}function f(e,t){return`${e}_${t}`}function h(e){return/^v\d+_[\w.]+$/.test(e)}},313059:(e,t,r)=>{"use strict";function n(e){return null==e}r.d(t,{h:()=>n})},805234:(e,t,r)=>{"use strict";let n;r.d(t,{i:()=>eo,Tz:()=>Z,rn:()=>J,nF:()=>Q,dI:()=>X,aM:()=>et,ol:()=>function e(t){return Object.keys(t).forEach(r=>{null!==t[r]&&void 0!==t[r]&&"object"==typeof t[r]&&e(t[r])}),Object.freeze(t)},uH:()=>eu,Nl:()=>Y,_T:()=>ei,mI:()=>ep,_r:()=>K,t_:()=>ed,Du:()=>es,Hk:()=>er,ed:()=>function e(t,r=0){return!(r>1e3)&&(void 0===t||"boolean"==typeof t||"number"==typeof t||"bigint"==typeof t||"string"==typeof t||null===t||(Array.isArray(t)?t.every(t=>e(t,r+1)):!("object"!=typeof t||"[object Object]"!==Object.prototype.toString.call(t)||Object.getPrototypeOf(t)!==Object.prototype&&null!==Object.getPrototypeOf(t))&&Object.keys(t).every(n=>e(t[n],r+1))))},fG:()=>en,F2:()=>ee,cg:()=>ea,GZ:()=>el,wv:()=>ec,sb:()=>ef});var o=void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},i=[],a=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,l=!1;function c(){l=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0;t<64;++t)i[t]=e[t],a[e.charCodeAt(t)]=t;a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63}function u(e){var t;l||c();for(var r=e.length,n=r%3,o="",a=[],s=0,u=r-n;s<u;s+=16383)a.push(function(e,t,r){for(var n,o=[],a=t;a<r;a+=3)o.push(i[(n=(e[a]<<16)+(e[a+1]<<8)+e[a+2])>>18&63]+i[n>>12&63]+i[n>>6&63]+i[63&n]);return o.join("")}(e,s,s+16383>u?u:s+16383));return 1===n?(o+=i[(t=e[r-1])>>2],o+=i[t<<4&63],o+="=="):2===n&&(o+=i[(t=(e[r-2]<<8)+e[r-1])>>10],o+=i[t>>4&63],o+=i[t<<2&63],o+="="),a.push(o),a.join("")}function d(e,t,r,n,o){var i,a,s=8*o-n-1,l=(1<<s)-1,c=l>>1,u=-7,d=r?o-1:0,f=r?-1:1,h=e[t+d];for(d+=f,i=h&(1<<-u)-1,h>>=-u,u+=s;u>0;i=256*i+e[t+d],d+=f,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=n;u>0;a=256*a+e[t+d],d+=f,u-=8);if(0===i)i=1-c;else{if(i===l)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,n),i-=c}return(h?-1:1)*a*Math.pow(2,i-n)}function f(e,t,r,n,o,i){var a,s,l,c=8*i-o-1,u=(1<<c)-1,d=u>>1,f=23===o?5960464477539062e-23:0,h=n?0:i-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?f/l:f*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*l-1)*Math.pow(2,o),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,o),a=0));o>=8;e[r+h]=255&s,h+=p,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;e[r+h]=255&a,h+=p,a/=256,c-=8);e[r+h-p]|=128*m}var h={}.toString,p=Array.isArray||function(e){return"[object Array]"==h.call(e)};function m(){return v.TYPED_ARRAY_SUPPORT?0x7fffffff:0x3fffffff}function g(e,t){if(m()<t)throw RangeError("Invalid typed array length");return v.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=v.prototype:(null===e&&(e=new v(t)),e.length=t),e}function v(e,t,r){if(!(v.TYPED_ARRAY_SUPPORT||this instanceof v))return new v(e,t,r);if("number"==typeof e){if("string"==typeof t)throw Error("If encoding is specified then the first argument must be a string");return w(this,e)}return b(this,e,t,r)}function b(e,t,r,n){if("number"==typeof t)throw TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),v.TYPED_ARRAY_SUPPORT?(e=t).__proto__=v.prototype:e=S(e,t),e}(e,t,r,n):"string"==typeof t?function(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!v.isEncoding(r))throw TypeError('"encoding" must be a valid string encoding');var n=0|k(t,r),o=(e=g(e,n)).write(t,r);return o!==n&&(e=e.slice(0,o)),e}(e,t,r):function(e,t){if(I(t)){var r,n=0|C(t.length);return 0===(e=g(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?g(e,0):S(e,t);if("Buffer"===t.type&&p(t.data))return S(e,t.data)}throw TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function y(e){if("number"!=typeof e)throw TypeError('"size" argument must be a number');if(e<0)throw RangeError('"size" argument must not be negative')}function w(e,t){if(y(t),e=g(e,t<0?0:0|C(t)),!v.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function S(e,t){var r=t.length<0?0:0|C(t.length);e=g(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function C(e){if(e>=m())throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+m().toString(16)+" bytes");return 0|e}function I(e){return!(null==e||!e._isBuffer)}function k(e,t){if(I(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return B(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return U(e).length;default:if(n)return B(e).length;t=(""+t).toLowerCase(),n=!0}}function E(e,t,r){var n,o,i=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0)||(r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){var n,o=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>o)&&(r=o);for(var i="",a=t;a<r;++a)i+=(n=e[a])<16?"0"+n.toString(16):n.toString(16);return i}(this,t,r);case"utf8":case"utf-8":return P(this,t,r);case"ascii":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}(this,t,r);case"base64":return n=t,o=r,0===n&&o===this.length?u(this):u(this.slice(n,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}(this,t,r);default:if(i)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function _(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function A(e,t,r,n,o){if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),isNaN(r=+r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return -1;r=e.length-1}else if(r<0){if(!o)return -1;r=0}if("string"==typeof t&&(t=v.from(t,n)),I(t))return 0===t.length?-1:T(e,t,r,n,o);if("number"==typeof t)return t&=255,v.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):T(e,[t],r,n,o);throw TypeError("val must be string, number or Buffer")}function T(e,t,r,n,o){var i,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;a=2,s/=2,l/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var u=-1;for(i=r;i<s;i++)if(c(e,i)===c(t,-1===u?0:i-u)){if(-1===u&&(u=i),i-u+1===l)return u*a}else -1!==u&&(i-=i-u),u=-1}else for(r+l>s&&(r=s-l),i=r;i>=0;i--){for(var d=!0,f=0;f<l;f++)if(c(e,i+f)!==c(t,f)){d=!1;break}if(d)return i}return -1}function P(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i,a,s,l,c=e[o],u=null,d=c>239?4:c>223?3:c>191?2:1;if(o+d<=r)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(i=e[o+1]))&&(l=(31&c)<<6|63&i)>127&&(u=l);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(l=(15&c)<<12|(63&i)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),o+=d}return function(e){var t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=O));return r}(n)}v.TYPED_ARRAY_SUPPORT=void 0===o.TYPED_ARRAY_SUPPORT||o.TYPED_ARRAY_SUPPORT,m(),v.poolSize=8192,v._augment=function(e){return e.__proto__=v.prototype,e},v.from=function(e,t,r){return b(null,e,t,r)},v.TYPED_ARRAY_SUPPORT&&(v.prototype.__proto__=Uint8Array.prototype,v.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&v[Symbol.species]),v.alloc=function(e,t,r){return y(e),e<=0?g(null,e):void 0!==t?"string"==typeof r?g(null,e).fill(t,r):g(null,e).fill(t):g(null,e)},v.allocUnsafe=function(e){return w(null,e)},v.allocUnsafeSlow=function(e){return w(null,e)},v.isBuffer=function(e){return null!=e&&(!!e._isBuffer||q(e)||"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&q(e.slice(0,0)))},v.compare=function(e,t){if(!I(e)||!I(t))throw TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},v.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},v.concat=function(e,t){if(!p(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return v.alloc(0);if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var r,n=v.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var i=e[r];if(!I(i))throw TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o+=i.length}return n},v.byteLength=k,v.prototype._isBuffer=!0,v.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)_(this,t,t+1);return this},v.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},v.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},v.prototype.toString=function(){var e=0|this.length;return 0===e?"":0==arguments.length?P(this,0,e):E.apply(this,arguments)},v.prototype.equals=function(e){if(!I(e))throw TypeError("Argument must be a Buffer");return this===e||0===v.compare(this,e)},v.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},v.prototype.compare=function(e,t,r,n,o){if(!I(e))throw TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||r>e.length||n<0||o>this.length)throw RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return -1;if(t>=r)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(i,a),l=this.slice(n,o),c=e.slice(t,r),u=0;u<s;++u)if(l[u]!==c[u]){i=l[u],a=c[u];break}return i<a?-1:a<i?1:0},v.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},v.prototype.indexOf=function(e,t,r){return A(this,e,t,r,!0)},v.prototype.lastIndexOf=function(e,t,r){return A(this,e,t,r,!1)},v.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o,i,a,s,l,c,u,d,f,h,p=this.length-t;if((void 0===r||r>p)&&(r=p),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var m=!1;;)switch(n){case"hex":return function(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=t.length;if(i%2!=0)throw TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))break;e[r+a]=s}return a}(this,e,t,r);case"utf8":case"utf-8":return l=t,c=r,H(B(e,this.length-l),this,l,c);case"ascii":case"latin1":case"binary":return o=this,i=e,a=t,s=r,H(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(i),o,a,s);case"base64":return u=t,d=r,H(U(e),this,u,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f=t,h=r,H(function(e,t){for(var r,n,o=[],i=0;i<e.length&&!((t-=2)<0);++i)n=(r=e.charCodeAt(i))>>8,o.push(r%256),o.push(n);return o}(e,this.length-f),this,f,h);default:if(m)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),m=!0}},v.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;function R(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function x(e,t,r,n,o,i){if(!I(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw RangeError('"value" argument is out of bounds');if(r+n>e.length)throw RangeError("Index out of range")}function M(e,t,r,n){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-r,2);o<i;++o)e[r+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function N(e,t,r,n){t<0&&(t=0xffffffff+t+1);for(var o=0,i=Math.min(e.length-r,4);o<i;++o)e[r+o]=t>>>8*(n?o:3-o)&255}function F(e,t,r,n,o,i){if(r+n>e.length||r<0)throw RangeError("Index out of range")}function L(e,t,r,n,o){return o||F(e,0,r,4),f(e,t,r,n,23,4),r+4}function z(e,t,r,n,o){return o||F(e,0,r,8),f(e,t,r,n,52,8),r+8}v.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),v.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=v.prototype;else{var o=t-e;r=new v(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+e]}return r},v.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},v.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},v.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},v.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},v.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},v.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},v.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},v.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},v.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||R(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},v.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},v.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?0xffff0000|r:r},v.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?0xffff0000|r:r},v.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},v.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},v.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),d(this,e,!0,23,4)},v.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),d(this,e,!1,23,4)},v.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),d(this,e,!0,52,8)},v.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),d(this,e,!1,52,8)},v.prototype.writeUIntLE=function(e,t,r,n){e=+e,t|=0,r|=0,n||x(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},v.prototype.writeUIntBE=function(e,t,r,n){e=+e,t|=0,r|=0,n||x(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},v.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,1,255,0),v.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},v.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},v.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},v.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,4,0xffffffff,0),v.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},v.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,4,0xffffffff,0),v.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},v.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);x(this,e,t,r,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a|0)-s&255;return t+r},v.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);x(this,e,t,r,o-1,-o)}var i=r-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a|0)-s&255;return t+r},v.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,1,127,-128),v.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},v.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):M(this,e,t,!0),t+2},v.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):M(this,e,t,!1),t+2},v.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,4,0x7fffffff,-0x80000000),v.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},v.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||x(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),v.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},v.prototype.writeFloatLE=function(e,t,r){return L(this,e,t,!0,r)},v.prototype.writeFloatBE=function(e,t,r){return L(this,e,t,!1,r)},v.prototype.writeDoubleLE=function(e,t,r){return z(this,e,t,!0,r)},v.prototype.writeDoubleBE=function(e,t,r){return z(this,e,t,!1,r)},v.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("sourceStart out of bounds");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var o,i=n-r;if(this===e&&r<t&&t<n)for(o=i-1;o>=0;--o)e[o+t]=this[o+r];else if(i<1e3||!v.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+i),t);return i},v.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var o,i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!v.isEncoding(n))throw TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=I(e)?e:B(new v(e,n).toString()),s=a.length;for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var D=/[^+\/0-9A-Za-z-_]/g;function B(e,t){var r;t=t||1/0;for(var n=e.length,o=null,i=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!o){if(r>56319||a+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function U(e){return function(e){l||c();var t,r,n,o,i,u,d=e.length;if(d%4>0)throw Error("Invalid string. Length must be a multiple of 4");i="="===e[d-2]?2:"="===e[d-1]?1:0,u=new s(3*d/4-i),n=i>0?d-4:d;var f=0;for(t=0,r=0;t<n;t+=4,r+=3)o=a[e.charCodeAt(t)]<<18|a[e.charCodeAt(t+1)]<<12|a[e.charCodeAt(t+2)]<<6|a[e.charCodeAt(t+3)],u[f++]=o>>16&255,u[f++]=o>>8&255,u[f++]=255&o;return 2===i?(o=a[e.charCodeAt(t)]<<2|a[e.charCodeAt(t+1)]>>4,u[f++]=255&o):1===i&&(o=a[e.charCodeAt(t)]<<10|a[e.charCodeAt(t+1)]<<4|a[e.charCodeAt(t+2)]>>2,u[f++]=o>>8&255,u[f++]=255&o),u}(function(e){var t;if((e=((t=e).trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(D,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function q(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var j=r(89522),$={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let W=new Uint8Array(16),V=[];for(let e=0;e<256;++e)V.push((e+256).toString(16).slice(1));var G=r(866095);function K(e){return(e,t)=>{if(!e)throw Error(t)}}function X(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;let r=e.split("."),n=t.split(".");function o(e){return/^\d+$/.test(e)}if(!r.every(o)||!n.every(o))return NaN;for(;r.length<n.length;)r.push("0");for(;n.length<r.length;)n.push("0");for(let e=0;e<r.length;++e)if(Number(r[e])!=Number(n[e]))return Number(r[e])>Number(n[e])?1:-1;return 0}function Y(){return function(e,t,r){if($.randomUUID&&!e)return $.randomUUID();let o=(e=e||{}).random||(e.rng||function(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(W)})();return o[6]=15&o[6]|64,o[8]=63&o[8]|128,function(e,t=0){return V[e[t+0]]+V[e[t+1]]+V[e[t+2]]+V[e[t+3]]+"-"+V[e[t+4]]+V[e[t+5]]+"-"+V[e[t+6]]+V[e[t+7]]+"-"+V[e[t+8]]+V[e[t+9]]+"-"+V[e[t+10]]+V[e[t+11]]+V[e[t+12]]+V[e[t+13]]+V[e[t+14]]+V[e[t+15]]}(o)}()}function Z(e,t,...r){let n=e(...r);return n.then(e=>{t&&t(void 0,e)}).catch(e=>{t&&t(e)}),n}function Q(e,t,...r){let n=e(...r);return n.then(()=>{t&&t(null)}).catch(e=>{t&&t(e)}),n}function J(e,t,...r){let n=e(...r);return n.then(e=>{t&&t(null,e)}).catch(e=>{t&&t(e,null)}),n}function ee(e,t,r){return new Promise((n,o)=>{let i=setTimeout(o,t,r);e().then(e=>{clearTimeout(i),n(e)}).catch(e=>{clearTimeout(i),o(e)})})}function et(e){let t=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId.toString())+"/"+encodeURIComponent(e.pageId));return e.webUrl&&t.searchParams.append("webUrl",e.webUrl.toString()),(e.chatId||e.channelId||e.subPageId)&&t.searchParams.append("context",JSON.stringify({chatId:e.chatId,channelId:e.channelId,subEntityId:e.subPageId})),t.toString()}function er(e){return!(X(`${e.majorVersion}.${e.minorVersion}`,`${j.Hb.majorVersion}.${j.Hb.minorVersion}`)>=0)}function en(e){return"https:"===e.protocol}function eo(e,t){return new Promise((r,n)=>{if(e||n("MimeType cannot be null or empty."),t||n("Base64 string cannot be null or empty."),e.startsWith("image/")){let n=atob(t),o=new Uint8Array(n.length);for(let e=0;e<n.length;e++)o[e]=n.charCodeAt(e);r(new Blob([o],{type:e}))}r(new Blob([v.from(t,"base64").toString()],{type:e}))})}function ei(e){return new Promise((t,r)=>{0===e.size&&r(Error("Blob cannot be empty."));let n=new FileReader;n.onloadend=()=>{n.result?t(n.result.toString().split(",")[1]):r(Error("Failed to read the blob"))},n.onerror=()=>{r(n.error)},n.readAsDataURL(e)})}function ea(){if(es())throw Error("window object undefined at SSR check");return window}function es(){return"undefined"==typeof window}function el(e,t){if(ed(e)||!(e.length<256&&e.length>4)||!function(e){for(let t=0;t<e.length;t++){let r=e.charCodeAt(t);if(r<32||r>126)return!1}return!0}(e))throw t||Error("id is not valid.")}function ec(e,t){let r=e.toString().toLocaleLowerCase();if(ed(r))throw Error("Invalid Url");if(r.length>2048)throw Error("Url exceeds the maximum size of 2048 characters");if(!en(e))throw Error("Url should be a valid https url")}function eu(e){let t=document.createElement("a");return t.href=e,new URL(t.href)}function ed(e){return RegExp(`${/<script[^>]*>|&lt;script[^&]*&gt;|%3Cscript[^%]*%3E/gi.source}|${/<\/script[^>]*>|&lt;\/script[^&]*&gt;|%3C\/script[^%]*%3E/gi.source}`,"gi").test(e)}function ef(e){if(!e)throw Error("id must not be empty");if(!1===(0,G.A)(e))throw Error("id must be a valid UUID")}let eh=!!performance&&"now"in performance;function ep(){return eh?performance.now()+performance.timeOrigin:void 0}},761862:(e,t,r)=>{"use strict";r.d(t,{T:()=>h,w:()=>u});var n=r(274107),o=r(788347),i=r(550966),a=r(383655),s=r(805234);let l=[],c=(0,a.tZ)("validateOrigin");function u(){return(0,n.s)(this,void 0,void 0,function*(){yield d()})}function d(e=!1){return(0,n.s)(this,void 0,void 0,function*(){if(0!==l.length&&!e)return l;if((0,s.Du)())return l=o.kS,o.kS;{c("Initiating fetch call to acquire valid origins list from CDN");let e=new AbortController,t=setTimeout(()=>e.abort(),o.gD);return fetch(o._X,{signal:e.signal}).then(e=>{if(clearTimeout(t),!e.ok)throw Error("Invalid Response from Fetch Call");return c("Fetch call completed and retrieved valid origins list from CDN"),e.json().then(e=>{if(function(e){let t=JSON.parse(e);try{t=JSON.parse(e)}catch(e){return!1}if(!t.validOrigins)return!1;for(let e of t.validOrigins)try{new URL("https://"+e)}catch(t){return c("isValidOriginsFromCDN call failed to validate origin: %s",e),!1}return!0}(JSON.stringify(e)))return l=e.validOrigins;throw Error("Valid origins list retrieved from CDN is invalid")})}).catch(e=>("AbortError"===e.name?c(`validOrigins fetch call to CDN failed due to Timeout of ${o.gD} ms. Defaulting to fallback list`):c("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",e),l=o.kS))}})}function f(e,t){if("*."===e.substring(0,2)){let r=e.substring(1);if(t.length>r.length&&t.split(".").length===r.split(".").length&&t.substring(t.length-r.length)===r)return!0}else if(e===t)return!0;return!1}function h(e,t){return d(t).then(t=>{if(!(0,s.fG)(e))return c("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",e,e.protocol),!1;let r=e.host;if(t.some(e=>f(e,r)))return!0;for(let e of i.Y.additionalValidOrigins)if(f("https://"===e.substring(0,8)?e.substring(8):e,r))return!0;return c("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",e,t,i.Y.additionalValidOrigins),!1})}u()},829615:(e,t,r)=>{"use strict";r.r(t),r.d(t,{customTelemetry:()=>n,eligibility:()=>o});var n={};r.r(n),r.d(n,{isSupported:()=>f,sendCustomTelemetryData:()=>h});var o={};r.r(o),r.d(o,{getEligibilityInfo:()=>b,isSupported:()=>v});var i=r(274107),a=r(157061),s=r(65999),l=r(383655),c=r(805234),u=r(70727);let d=(0,l.tZ)("copilot");function f(){var e;return(0,s.Zn)(u.fA)&&!!(null===(e=u.fA.supports.copilot)||void 0===e?void 0:e.customTelemetry)}function h(e,t){var r;return void 0===t&&(t=null!==(r=(0,c.mI)())&&void 0!==r?r:Date.now()),(0,i.s)(this,void 0,void 0,function*(){return(0,s.Zn)(u.fA),d("Sending custom telemetry data to host for stage: %s to record timestamp: %s",e,t),(0,a._s)("copilot.customTelemetry.sendCustomTelemetryData",[e.toString(),t],(0,l.N0)("v2","copilot.customTelemetry.sendCustomTelemetryData"))})}var p=r(89522),m=r(995243);let g=(0,l.tZ)("copilot");function v(){var e,t;return(0,s.Zn)(u.fA)&&(!!(null===(e=u.fA.hostVersionsInfo)||void 0===e?void 0:e.appEligibilityInformation)||!!(null===(t=u.fA.supports.copilot)||void 0===t?void 0:t.eligibility))}function b(){var e,t;return(0,i.s)(this,void 0,void 0,function*(){if((0,s.Zn)(u.fA),!v())throw Error(`Error code: ${p.qP.errorCode}, message: Not supported on platform`);if(null===(e=u.fA.hostVersionsInfo)||void 0===e?void 0:e.appEligibilityInformation)return g("Eligibility information is already available on runtime."),u.fA.hostVersionsInfo.appEligibilityInformation;g("Eligibility information is not available on runtime. Requesting from host.");let r=yield(0,a.j0)((0,l.N0)("v2","copilot.eligibility.getEligibilityInfo"),"copilot.eligibility.getEligibilityInfo");if((0,m.hl)(r))throw Error(`Error code: ${r.errorCode}, message: ${null!==(t=r.message)&&void 0!==t?t:"Failed to get eligibility information from the host."}`);if(!(void 0!==r.ageGroup&&void 0!==r.cohort&&void 0!==r.userClassification&&void 0!==r.isCopilotEligible&&void 0!==r.isCopilotEnabledRegion&&void 0!==r.isOptedOutByAdmin&&(!r.featureSet||void 0!==r.featureSet.serverFeatures&&void 0!==r.featureSet.uxFeatures)))throw Error("Error deserializing eligibility information");return r})}},895212:(e,t,r)=>{"use strict";let n;r.r(t),r.d(t,{_clearDataLayerPort:()=>h,getDataLayerPort:()=>d,isSupported:()=>f});var o=r(274107),i=r(157061),a=r(65999),s=r(383655),l=r(89522),c=r(70727);let u=(0,s.tZ)("messageChannels.dataLayer");function d(){return(0,o.s)(this,void 0,void 0,function*(){if(n)return u("Returning dataLayer port from cache"),n;if(!f())throw l.qP;return n=yield(0,i.tX)((0,s.N0)("v1","messageChannels.dataLayer.getDataLayerPort"),"messageChannels.dataLayer.getDataLayerPort")})}function f(){var e;return!(!(0,a.Zn)(c.fA)||!(null===(e=c.fA.supports.messageChannels)||void 0===e?void 0:e.dataLayer))}function h(){n=void 0}},294826:(e,t,r)=>{"use strict";let n;r.r(t),r.d(t,{_clearTelemetryPort:()=>h,getTelemetryPort:()=>d,isSupported:()=>f});var o=r(274107),i=r(157061),a=r(65999),s=r(383655),l=r(89522),c=r(70727);let u=(0,s.tZ)("messageChannels.telemetry");function d(){return(0,o.s)(this,void 0,void 0,function*(){if(n)return u("Returning telemetry port from cache"),n;if(!f())throw l.qP;return n=yield(0,i.tX)((0,s.N0)("v1","messageChannels.telemetry.getTelemetryPort"),"messageChannels.telemetry.getTelemetryPort")})}function f(){var e;return!(!(0,a.Zn)(c.fA)||!(null===(e=c.fA.supports.messageChannels)||void 0===e?void 0:e.telemetry))}function h(){n=void 0}},254812:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ExpectedFailureReason:()=>o,FailedReason:()=>n,Messages:()=>C,_initialize:()=>_,_uninitialize:()=>A,getContext:()=>T,getFrameContext:()=>k,initialize:()=>E,isInitialized:()=>I,lifecycle:()=>i,notifyAppLoaded:()=>P,notifyExpectedFailure:()=>x,notifyFailure:()=>R,notifySuccess:()=>O,openLink:()=>F,registerHostToAppPerformanceMetricsHandler:()=>N,registerOnThemeChangeHandler:()=>M});var n,o,i={};r.r(i),r.d(i,{registerBeforeSuspendOrTerminateHandler:()=>v,registerOnResumeHandler:()=>b});var a=r(58227),s=r(157061),l=r(550966),c=r(623054),u=r(65999),d=r(383655),f=r(805234),h=r(633277),p=r(89522),m=r(952095),g=r(70727);function v(e){if(!e)throw Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");(0,u.Zn)(g.fA),(0,c.VA)(e)}function b(e){if(!e)throw Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");(0,u.Zn)(g.fA),(0,c.YK)(e)}var y=r(294826),w=r(895212);let S=(0,d.tZ)("app"),C={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"};function I(){return l.Y.initializeCompleted}function k(){return l.Y.frameContext}function E(e){return(0,a.yx)((0,d.N0)("v2","app.initialize"),e)}function _(e){s.bm.currentWindow=e}function A(){l.Y.initializeCalled&&((0,c.Xz)(),l.Y.initializeCalled=!1,l.Y.initializeCompleted=!1,l.Y.initializePromise=void 0,l.Y.additionalValidOrigins=[],l.Y.frameContext=void 0,l.Y.hostClientType=void 0,l.Y.isFramelessWindow=!1,(0,y._clearTelemetryPort)(),(0,w._clearDataLayerPort)(),(0,s.cB)())}function T(){return new Promise(e=>{(0,u.UF)(),e((0,s.j0)((0,d.N0)("v2","app.getContext"),"getContext"))}).then(e=>{var t;return{actionInfo:e.actionInfo,app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userClickTimeV2:e.userClickTimeV2,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:p.yA.teams,clientType:e.hostClientType?e.hostClientType:p.WK.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId},appLaunchId:e.appLaunchId,appId:e.appId?new h.l(e.appId):void 0,manifestVersion:e.manifestVersion},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:l.Y.frameContext,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,isBackgroundLoad:e.isBackgroundLoad,sourceOrigin:e.sourceOrigin},user:{id:null!==(t=e.userObjectId)&&void 0!==t?t:"",displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath||e.mySitePath||e.mySiteDomain?{teamSiteUrl:e.teamSiteUrl,teamSiteDomain:e.teamSiteDomain,teamSitePath:e.teamSitePath,teamSiteId:e.teamSiteId,mySitePath:e.mySitePath,mySiteDomain:e.mySiteDomain}:void 0,dialogParameters:e.dialogParameters||{}}})}function P(){(0,u.UF)(),(0,a.Y_)((0,d.N0)("v2","app.notifyAppLoaded"))}function O(){return(0,a.TI)((0,d.N0)("v2","app.notifySuccess"))}function R(e){(0,u.UF)(),(0,a.s_)((0,d.N0)("v2","app.notifyFailure"),e)}function x(e){(0,u.UF)(),(0,a.S7)((0,d.N0)("v2","app.notifyExpectedFailure"),e)}function M(e){(0,a.ef)((0,d.N0)("v2","app.registerOnThemeChangeHandler"),e)}function N(e){(0,c.$e)(e)}function F(e){return(0,a.Jc)((0,d.N0)("v2","app.openLink"),e)}(function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"})(n||(n={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(o||(o={})),S("teamsjs instance is version %s, starting at %s UTC (%s local)",m.r,(new Date).toISOString(),(new Date).toLocaleString()),function(){if((0,f.Du)())return;let e=document.getElementsByTagName("script"),t=e&&e[e.length-1]&&e[e.length-1].src,r="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";t&&0!==t.length?S("teamsjs is being used from %s. %s",t,r):S("teamsjs is being used from a script tag embedded directly in your html. %s",r)}()},633277:(e,t,r)=>{"use strict";r.d(t,{l:()=>o});var n=r(231494);class o{constructor(e){this.appIdAsString=e,(0,n.uO)(e)}serialize(){return this.toString()}toString(){return this.appIdAsString}}},377255:(e,t,r)=>{"use strict";let n,o,i;r.r(t),r.d(t,{DataResidency:()=>a,authenticate:()=>v,getAuthToken:()=>b,getUser:()=>y,initialize:()=>m,notifyFailure:()=>I,notifySuccess:()=>C,registerAuthenticationHandlers:()=>g});var a,s=r(157061),l=r(550966),c=r(623054),u=r(65999),d=r(383655),f=r(805234),h=r(89522),p=r(70727);function m(){(0,c.ik)((0,d.N0)("v1","authentication.registerAuthenticateSuccessHandler"),"authentication.authenticate.success",k,!1),(0,c.ik)((0,d.N0)("v1","authentication.registerAuthenticateFailureHandler"),"authentication.authenticate.failure",E,!1)}function g(e){i=e}function v(e){var t;let r=void 0!==e,a=r?e:i;if(!a)throw Error("No parameters are provided for authentication");return(0,u.Zn)(p.fA,h.E2.content,h.E2.sidePanel,h.E2.settings,h.E2.remove,h.E2.task,h.E2.stage,h.E2.meetingStage),(t=a.successCallback||a.failureCallback?(0,d.N0)("v1","authentication.authenticate"):(0,d.N0)("v2","authentication.authenticate"),new Promise((e,r)=>{if(l.Y.hostClientType!==h.WK.web){let r=(0,f.uH)(a.url);(0,f.wv)(r),e((0,s.b5)(t,"authentication.authenticate",[r.href,a.width,a.height,a.isExternal]).then(([e,t])=>{if(e)return t;throw Error(t)}))}else n={success:e,fail:r},function(e){w();let t=e.width||600,r=e.height||400;t=Math.min(t,s.bm.currentWindow.outerWidth-400),r=Math.min(r,s.bm.currentWindow.outerHeight-200);let n=(0,f.uH)(e.url.replace("{oauthRedirectMethod}","web"));(0,f.wv)(n);let i=void 0!==s.bm.currentWindow.screenLeft?s.bm.currentWindow.screenLeft:s.bm.currentWindow.screenX,a=void 0!==s.bm.currentWindow.screenTop?s.bm.currentWindow.screenTop:s.bm.currentWindow.screenY;i+=s.bm.currentWindow.outerWidth/2-t/2,a+=s.bm.currentWindow.outerHeight/2-r/2,s.bm.childWindow=s.bm.currentWindow.open(n.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+a+", left="+i+", width="+t+", height="+r),s.bm.childWindow?(S(),o=s.bm.currentWindow.setInterval(()=>{if(!s.bm.childWindow||s.bm.childWindow.closed)E("CancelledByUser");else{let e=s.bm.childOrigin;try{s.bm.childOrigin="*",(0,s.nq)("ping")}finally{s.bm.childOrigin=e}}},100),(0,c.ik)((0,d.N0)("v1","authentication.authenticationWindow.registerInitializeHandler"),"initialize",()=>[h.E2.authentication,l.Y.hostClientType]),(0,c.ik)((0,d.N0)("v1","authentication.authenticationWindow.registerNavigateCrossDomainHandler"),"navigateCrossDomain",()=>!1)):E("FailedToOpenWindow")}(a)})).then(e=>{try{return a&&a.successCallback?(a.successCallback(e),""):e}finally{r||(i=void 0)}}).catch(e=>{try{if(a&&a.failureCallback)return a.failureCallback(e.message),"";throw e}finally{r||(i=void 0)}})}function b(e){var t;return(0,u.UF)(),(t=e&&(e.successCallback||e.failureCallback)?(0,d.N0)("v1","authentication.getAuthToken"):(0,d.N0)("v2","authentication.getAuthToken"),new Promise(r=>{r((0,s.b5)(t,"authentication.getAuthToken",[null==e?void 0:e.resources,null==e?void 0:e.claims,null==e?void 0:e.silent,null==e?void 0:e.tenantId]))}).then(([e,t])=>{if(e)return t;throw Error(t)})).then(t=>e&&e.successCallback?(e.successCallback(t),""):t).catch(t=>{if(e&&e.failureCallback)return e.failureCallback(t.message),"";throw t})}function y(e){var t;return(0,u.UF)(),(t=e&&(e.successCallback||e.failureCallback)?(0,d.N0)("v1","authentication.getUser"):(0,d.N0)("v2","authentication.getUser"),new Promise(e=>{e((0,s.b5)(t,"authentication.getUser"))}).then(([e,t])=>{if(e)return t;throw t})).then(t=>e&&e.successCallback?(e.successCallback(t),null):t).catch(t=>{let r=`Error returned, code = ${t.errorCode}, message = ${t.message}`;if(e&&e.failureCallback)return e.failureCallback(r),null;throw Error(r)})}function w(){S();try{s.bm.childWindow&&s.bm.childWindow.close()}finally{s.bm.childWindow=null,s.bm.childOrigin=null}}function S(){o&&(clearInterval(o),o=0),(0,c.Vl)("initialize"),(0,c.Vl)("navigateCrossDomain")}function C(e,t){(0,u.Zn)(p.fA,h.E2.authentication);let r=(0,d.N0)(t?"v1":"v2","authentication.notifySuccess");(0,s.x3)(r,"authentication.authenticate.success",[e]),(0,s.LP)(s.bm.parentWindow,()=>setTimeout(()=>s.bm.currentWindow.close(),200))}function I(e,t){(0,u.Zn)(p.fA,h.E2.authentication);let r=(0,d.N0)(t?"v1":"v2","authentication.notifyFailure");(0,s.x3)(r,"authentication.authenticate.failure",[e]),(0,s.LP)(s.bm.parentWindow,()=>setTimeout(()=>s.bm.currentWindow.close(),200))}function k(e){try{n&&n.success(e)}finally{n=void 0,w()}}function E(e){try{n&&n.fail(Error(e))}finally{n=void 0,w()}}!function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(a||(a={}))},89522:(e,t,r)=>{"use strict";r.d(t,{Cu:()=>c,E2:()=>i,Hb:()=>f,JD:()=>p,P4:()=>m,WK:()=>n,YV:()=>a,bD:()=>h,h1:()=>s,qP:()=>d,yA:()=>o,zo:()=>l});var n,o,i,a,s,l,c,u=r(995243);(function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.macos="macos",e.visionOS="visionOS",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"})(n||(n={})),function(e){e.office="Office",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.orange="Orange",e.places="Places",e.teams="Teams",e.teamsModern="TeamsModern"}(o||(o={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(i||(i={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(a||(a={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(s||(s={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(l||(l={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(c||(c={}));let d={errorCode:u.O4.NOT_SUPPORTED_ON_PLATFORM},f={majorVersion:1,minorVersion:5},h={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},p=Error("Invalid input count: Must supply a valid image count (limit of 10)."),m=Error("Invalid response: Received more images than the specified max limit in the response.")},91349:(e,t,r)=>{"use strict";r.r(t),r.d(t,{bot:()=>n,isSupported:()=>p,open:()=>h});var n={};r.r(n),r.d(n,{isSupported:()=>f,open:()=>d});var o=r(157061),i=r(738834),a=r(65999),s=r(383655),l=r(805234),c=r(89522),u=r(70727);function d(e,t){if((0,a.Zn)(u.fA,c.E2.content,c.E2.sidePanel,c.E2.meetingStage),!f())throw c.qP;let r=(0,i.a)(e);(0,o.x3)((0,s.N0)(i.Xh,"dialog.adaptiveCard.bot.open"),"tasks.startTask",[r],(e,r)=>{null==t||t({err:e,result:r})})}function f(){let e=u.fA.hostVersionsInfo&&u.fA.hostVersionsInfo.adaptiveCardSchemaVersion&&!(0,l.Hk)(u.fA.hostVersionsInfo.adaptiveCardSchemaVersion);return(0,a.Zn)(u.fA)&&void 0!==(e&&u.fA.supports.dialog&&u.fA.supports.dialog.card&&u.fA.supports.dialog.card.bot)}function h(e,t){if((0,a.Zn)(u.fA,c.E2.content,c.E2.sidePanel,c.E2.meetingStage),!p())throw c.qP;let r=(0,i.f8)(e);(0,o.x3)((0,s.N0)(i.Xh,"dialog.adaptiveCard.open"),"tasks.startTask",[r],(e,r)=>{null==t||t({err:e,result:r})})}function p(){let e=u.fA.hostVersionsInfo&&u.fA.hostVersionsInfo.adaptiveCardSchemaVersion&&!(0,l.Hk)(u.fA.hostVersionsInfo.adaptiveCardSchemaVersion);return(0,a.Zn)(u.fA)&&void 0!==(e&&u.fA.supports.dialog&&u.fA.supports.dialog.card)}},226646:(e,t,r)=>{"use strict";r.r(t),r.d(t,{adaptiveCard:()=>l,initialize:()=>d,isSupported:()=>f,update:()=>c,url:()=>u});var n=r(738834),o=r(623054),i=r(65999),a=r(383655),s=r(70727),l=r(91349),c=r(257103),u=r(935940);function d(){(0,o.ik)((0,a.N0)(n.Xh,"dialog.registerMessageForChildHandler"),"messageForChild",n.KP,!1)}function f(){return!(!(0,i.Zn)(s.fA)||!s.fA.supports.dialog)}},257103:(e,t,r)=>{"use strict";r.r(t),r.d(t,{isSupported:()=>l,resize:()=>s});var n=r(738834),o=r(65999),i=r(383655),a=r(70727);function s(e){(0,n.GQ)((0,i.N0)(n.Xh,"dialog.update.resize"),e)}function l(){return!(!(0,o.Zn)(a.fA)||!a.fA.supports.dialog)&&!!a.fA.supports.dialog.update}},62339:(e,t,r)=>{"use strict";r.r(t),r.d(t,{isSupported:()=>l,open:()=>s});var n=r(738834),o=r(65999),i=r(383655),a=r(70727);function s(e,t,r){(0,n.Fr)((0,i.N0)(n.Xh,"dialog.url.bot.open"),e,t,r)}function l(){return(0,o.Zn)(a.fA)&&void 0!==(a.fA.supports.dialog&&a.fA.supports.dialog.url&&a.fA.supports.dialog.url.bot)}},935940:(e,t,r)=>{"use strict";r.r(t),r.d(t,{bot:()=>c,getDialogInfoFromBotUrlDialogInfo:()=>w,getDialogInfoFromUrlDialogInfo:()=>y,isSupported:()=>b,open:()=>g,parentCommunication:()=>n,submit:()=>v});var n={};r.r(n),r.d(n,{isSupported:()=>m,registerOnMessageFromParent:()=>p,sendMessageToDialog:()=>h,sendMessageToParentFromDialog:()=>f});var o=r(738834),i=r(65999),a=r(383655),s=r(89522),l=r(70727),c=r(62339),u=r(157061),d=r(623054);function f(e){if((0,i.Zn)(l.fA,s.E2.task),!m())throw s.qP;(0,u.x3)((0,a.N0)(o.Xh,"dialog.url.parentCommunication.sendMessageToParentFromDialog"),"messageForParent",[e])}function h(e){if((0,i.Zn)(l.fA,s.E2.content,s.E2.sidePanel,s.E2.meetingStage),!m())throw s.qP;(0,u.x3)((0,a.N0)(o.Xh,"dialog.url.parentCommunication.sendMessageToDialog"),"messageForChild",[e])}function p(e){if((0,i.Zn)(l.fA,s.E2.task),!m())throw s.qP;for((0,d.Vl)("messageForChild"),(0,d.ik)((0,a.N0)(o.Xh,"dialog.url.parentCommunication.registerMessageForChildHandler"),"messageForChild",e),o.u3.reverse();o.u3.length>0;)e(o.u3.pop())}function m(){var e,t;return(0,i.Zn)(l.fA)&&!!(null===(t=null===(e=l.fA.supports.dialog)||void 0===e?void 0:e.url)||void 0===t?void 0:t.parentCommunication)}function g(e,t,r){(0,o.kE)((0,a.N0)(o.Xh,"dialog.url.open"),e,t,r)}function v(e,t){(0,o.g8)((0,a.N0)(o.Xh,"dialog.url.submit"),e,t)}function b(){return(0,i.Zn)(l.fA)&&void 0!==(l.fA.supports.dialog&&l.fA.supports.dialog.url)}function y(e){return{url:e.url,height:e.size?e.size.height:s.zo.Small,width:e.size?e.size.width:s.zo.Small,title:e.title,fallbackUrl:e.fallbackUrl}}function w(e){let t=y(e);return t.completionBotId=e.completionBotId,t}},995243:(e,t,r)=>{"use strict";var n,o,i,a,s,l,c,u,d,f;function h(e){return void 0!==(null==e?void 0:e.errorCode)}r.d(t,{CO:()=>o,O4:()=>a,QY:()=>n,fw:()=>d,hl:()=>h,j5:()=>f,jw:()=>i,mW:()=>s}),function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(n||(n={})),(o||(o={})).M365Content="m365content",function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(i||(i={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(a||(a={})),function(e){e.GeoLocation="geolocation",e.Media="media"}(s||(s={})),function(e){e.BCAIS="bcais",e.BCWAF="bcwaf",e.BCWBF="bcwbf"}(l||(l={})),function(e){e.Faculty="faculty",e.Student="student",e.Other="other"}(c||(c={})),function(e){e.Adult="adult",e.MinorNoParentalConsentRequired="minorNoParentalConsentRequired",e.MinorWithoutParentalConsent="minorWithoutParentalConsent",e.MinorWithParentalConsent="minorWithParentalConsent",e.NonAdult="nonAdult"}(u||(u={})),function(e){e.HigherEducation="higherEducation",e.K12="k12",e.Other="other"}(d||(d={})),function(e){e.TextPlain="text/plain",e.TextHtml="text/html",e.ImagePNG="image/png",e.ImageJPEG="image/jpeg"}(f||(f={}))},919607:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CameraStartMode:()=>i,File:()=>I,FileFormat:()=>n,ImageOutputFormats:()=>c,ImageUriType:()=>l,Media:()=>T,MediaControllerEvent:()=>o,MediaType:()=>s,Source:()=>a,VideoController:()=>O,captureImage:()=>k,hasPermission:()=>E,requestPermission:()=>_,scanBarCode:()=>M,selectMedia:()=>R,viewImages:()=>x});var n,o,i,a,s,l,c,u=r(157061),d=r(788347),f=r(550966),h=r(623054),p=r(65999),m=r(65311),g=r(383655),v=r(313059),b=r(805234),y=r(89522),w=r(995243),S=r(70727);let C=(0,g.tZ)("media");!function(e){e.Base64="base64",e.ID="id"}(n||(n={}));class I{}function k(e){if(!e)throw Error("[captureImage] Callback cannot be null");((0,p.Zn)(S.fA,y.E2.content,y.E2.task),f.Y.isFramelessWindow)?(0,p.wT)(d.ZW)?(0,u.x3)((0,g.N0)("v1","media.captureImage"),"captureImage",e):e({errorCode:w.O4.OLD_PLATFORM},[]):e({errorCode:w.O4.NOT_SUPPORTED_ON_PLATFORM},[])}function E(){if((0,p.Zn)(S.fA,y.E2.content,y.E2.task),!A())throw y.qP;let e=w.mW.Media;return new Promise(t=>{t((0,u.gV)((0,g.N0)("v1","media.hasPermission"),"permissions.has",e))})}function _(){if((0,p.Zn)(S.fA,y.E2.content,y.E2.task),!A())throw y.qP;let e=w.mW.Media;return new Promise(t=>{t((0,u.gV)((0,g.N0)("v1","media.requestPermission"),"permissions.request",e))})}function A(){return!(!(0,p.Zn)(S.fA)||!S.fA.supports.permissions)}class T extends I{constructor(e){super(),e&&(this.content=e.content,this.format=e.format,this.mimeType=e.mimeType,this.name=e.name,this.preview=e.preview,this.size=e.size)}getMedia(e){if(!e)throw Error("[get Media] Callback cannot be null");((0,p.Zn)(S.fA,y.E2.content,y.E2.task),(0,p.wT)(d.SY))?(0,m.iV)(this.mimeType,this.format,this.content)?(0,p.wT)(d.ph)?this.getMediaViaCallback(e):this.getMediaViaHandler(e):e({errorCode:w.O4.INVALID_ARGUMENTS},new Blob):e({errorCode:w.O4.OLD_PLATFORM},new Blob)}getMediaViaCallback(e){let t={mediaMimeType:this.mimeType,assembleAttachment:[]},r=[this.content];(0,u.x3)((0,g.N0)("v1","media.getMedia"),"getMedia",r,function(r){if(e){if(r&&r.error)e(r.error,new Blob);else if(r&&r.mediaChunk){if(r.mediaChunk.chunkSequence<=0){let n=(0,m.x3)(t.assembleAttachment,t.mediaMimeType);e(r.error,null!=n?n:new Blob)}else{let e=(0,m.qT)(r.mediaChunk,t.mediaMimeType);e?t.assembleAttachment.push(e):C(`Received a null assemble attachment for when decoding chunk sequence ${r.mediaChunk.chunkSequence}; not including the chunk in the assembled file.`)}}else e({errorCode:w.O4.INTERNAL_ERROR,message:"data received is null"},new Blob)}})}getMediaViaHandler(e){let t=(0,b.Nl)(),r={mediaMimeType:this.mimeType,assembleAttachment:[]},n=[t,this.content];this.content&&!(0,v.h)(e)&&(0,u.x3)((0,g.N0)("v1","media.getMedia"),"getMedia",n),(0,h.ik)((0,g.N0)("v1","media.registerGetMediaRequestHandler"),"getMedia"+t,function(n){if(e){let o=JSON.parse(n);if(o.error)e(o.error,new Blob),(0,h.Vl)("getMedia"+t);else if(o.mediaChunk){if(o.mediaChunk.chunkSequence<=0){let n=(0,m.x3)(r.assembleAttachment,r.mediaMimeType);e(o.error,null!=n?n:new Blob),(0,h.Vl)("getMedia"+t)}else{let e=(0,m.qT)(o.mediaChunk,r.mediaMimeType);e&&r.assembleAttachment.push(e)}}else e({errorCode:w.O4.INTERNAL_ERROR,message:"data received is null"},new Blob),(0,h.Vl)("getMedia"+t)}})}}class P{constructor(e){this.controllerCallback=e}notifyEventToHost(e,t){(0,p.Zn)(S.fA,y.E2.content,y.E2.task);try{(0,p.at)(d.K0)}catch(e){return void(t&&t(e))}let r={mediaType:this.getMediaType(),mediaControllerEvent:e};(0,u.x3)((0,g.N0)("v1","media.controller"),"media.controller",[r],e=>{t&&t(e)})}stop(e){this.notifyEventToHost(o.StopRecording,e)}}class O extends P{getMediaType(){return s.Video}notifyEventToApp(e){this.controllerCallback&&e===o.StartRecording&&this.controllerCallback.onRecordingStarted&&this.controllerCallback.onRecordingStarted()}}function R(e,t){if(!t)throw Error("[select Media] Callback cannot be null");if((0,p.Zn)(S.fA,y.E2.content,y.E2.task),!(0,p.wT)(d.SY))return void t({errorCode:w.O4.OLD_PLATFORM},[]);try{(0,m.vc)(e)}catch(e){return void t(e,[])}if(!(0,m.wN)(e))return void t({errorCode:w.O4.INVALID_ARGUMENTS},[]);let r=[e];(0,u.x3)((0,g.N0)("v1","media.selectMedia"),"selectMedia",r,(r,n,o)=>{var i,a;if(o)return void((0,m.kF)(e)&&(null===(a=null===(i=null==e?void 0:e.videoProps)||void 0===i?void 0:i.videoController)||void 0===a||a.notifyEventToApp(o)));if(!n)return void t(r,[]);let s=[];for(let e of n)s.push(new T(e));t(r,s)})}function x(e,t){if(!t)throw Error("[view images] Callback cannot be null");if((0,p.Zn)(S.fA,y.E2.content,y.E2.task),!(0,p.wT)(d.SY))return void t({errorCode:w.O4.OLD_PLATFORM});if(!(0,m.QR)(e))return void t({errorCode:w.O4.INVALID_ARGUMENTS});let r=[e];(0,u.x3)((0,g.N0)("v1","media.viewImages"),"viewImages",r,t)}function M(e,t){if(!e)throw Error("[media.scanBarCode] Callback cannot be null");((0,p.Zn)(S.fA,y.E2.content,y.E2.task),f.Y.hostClientType!==y.WK.desktop&&f.Y.hostClientType!==y.WK.web&&f.Y.hostClientType!==y.WK.rigel&&f.Y.hostClientType!==y.WK.teamsRoomsWindows&&f.Y.hostClientType!==y.WK.teamsRoomsAndroid&&f.Y.hostClientType!==y.WK.teamsPhones&&f.Y.hostClientType!==y.WK.teamsDisplays)?(0,p.wT)(d.$8)?(0,m.Sr)(t)?(0,u.x3)((0,g.N0)("v1","media.scanBarCode"),"media.scanBarCode",[t],e):e({errorCode:w.O4.INVALID_ARGUMENTS},""):e({errorCode:w.O4.OLD_PLATFORM},""):e({errorCode:w.O4.NOT_SUPPORTED_ON_PLATFORM},"")}(function(e){e[e.StartRecording=1]="StartRecording",e[e.StopRecording=2]="StopRecording"})(o||(o={})),function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(i||(i={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(a||(a={})),function(e){e[e.Image=1]="Image",e[e.Video=2]="Video",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(s||(s={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(l||(l={})),function(e){e[e.IMAGE=1]="IMAGE",e[e.PDF=2]="PDF"}(c||(c={}))},50607:(e,t,r)=>{"use strict";let n,o,i;r.r(t),r.d(t,{DisplayMode:()=>a,MenuItem:()=>p,MenuListType:()=>s,initialize:()=>m,isSupported:()=>C,setNavBarMenu:()=>b,setUpViews:()=>g,showActionMenu:()=>w});var a,s,l=r(157061),c=r(623054),u=r(65999),d=r(383655),f=r(70727),h=r(89522);!function(e){e[e.ifRoom=0]="ifRoom",e[e.overflowOnly=1]="overflowOnly"}(a||(a={}));class p{constructor(){this.enabled=!0,this.selected=!1}}function m(){(0,c.ik)((0,d.N0)("v2","menus.registerNavBarMenuItemPressHandler"),"navBarMenuItemPress",y,!1),(0,c.ik)((0,d.N0)("v2","menus.registerActionMenuItemPressHandler"),"actionMenuItemPress",S,!1),(0,c.ik)((0,d.N0)("v2","menus.registerSetModuleViewHandler"),"setModuleView",v,!1)}function g(e,t){if((0,u.Zn)(f.fA),!C())throw h.qP;i=t,(0,l.x3)((0,d.N0)("v2","menus.setUpViews"),"setUpViews",[e])}function v(e){i&&i(e)||((0,u.Zn)(f.fA),(0,l.x3)((0,d.N0)("v2","menus.handleViewConfigItemPress"),"viewConfigItemPress",[e]))}function b(e,t){if((0,u.Zn)(f.fA),!C())throw h.qP;n=t,(0,l.x3)((0,d.N0)("v2","menus.setNavBarMenu"),"setNavBarMenu",[e])}function y(e){n&&n(e)||((0,u.Zn)(f.fA),(0,l.x3)((0,d.N0)("v2","menus.handleNavBarMenuItemPress"),"handleNavBarMenuItemPress",[e]))}function w(e,t){if((0,u.Zn)(f.fA),!C())throw h.qP;o=t,(0,l.x3)((0,d.N0)("v2","menus.showActionMenu"),"showActionMenu",[e])}function S(e){o&&o(e)||((0,u.Zn)(f.fA),(0,l.x3)((0,d.N0)("v2","menus.handleActionMenuItemPress"),"handleActionMenuItemPress",[e]))}function C(){return!(!(0,u.Zn)(f.fA)||!f.fA.supports.menus)}!function(e){e.dropDown="dropDown",e.popOver="popOver"}(s||(s={}))},34423:(e,t,r)=>{"use strict";r.r(t),r.d(t,{isNAAChannelRecommended:()=>s});var n=r(550966),o=r(65999),i=r(89522),a=r(70727);function s(){var e;return null!==(e=(0,o.Zn)(a.fA)&&(a.fA.isNAAChannelRecommended||!(!(0,o.Zn)(a.fA)||n.Y.hostClientType!==i.WK.android&&n.Y.hostClientType!==i.WK.ios&&n.Y.hostClientType!==i.WK.ipados&&n.Y.hostClientType!==i.WK.visionOS||!a.fA.isLegacyTeams||!a.fA.supports.nestedAppAuth)))&&void 0!==e&&e}},944673:(e,t,r)=>{"use strict";let n;r.r(t),r.d(t,{_initialize:()=>f,isSupported:()=>v,navigateBack:()=>h,registerBackButtonHandler:()=>p,registerBackButtonHandlerHelper:()=>m});var o=r(157061),i=r(623054),a=r(65999),s=r(894754),l=r(383655),c=r(313059),u=r(89522),d=r(70727);function f(){(0,i.ik)((0,l.N0)(s.VR,"pages.backStack.registerBackButtonPressHandler"),"backButtonPress",g,!1)}function h(){return(0,s.Gb)((0,l.N0)(s.VR,"pages.backStack.navigateBack"))}function p(e){m((0,l.N0)(s.VR,"pages.backStack.registerBackButtonHandler"),e,()=>{if(!(0,c.h)(e)&&!v())throw u.qP})}function m(e,t,r){(0,c.h)(t)||(0,a.Zn)(d.fA),r&&r(),n=t,(0,c.h)(t)||(0,o.x3)(e,"registerHandler",["backButton"])}function g(){n&&n()||(o.bm.childWindow?(0,o.nq)("backButtonPress",[]):h())}function v(){return!(!(0,a.Zn)(d.fA)||!d.fA.supports.pages)&&!!d.fA.supports.pages.backStack}},103920:(e,t,r)=>{"use strict";let n,o;r.r(t),r.d(t,{initialize:()=>h,isSupported:()=>E,registerChangeConfigHandler:()=>S,registerOnRemoveHandler:()=>b,registerOnRemoveHandlerHelper:()=>y,registerOnSaveHandler:()=>g,registerOnSaveHandlerHelper:()=>v,setConfig:()=>m,setValidityState:()=>p});var i=r(157061),a=r(623054),s=r(65999),l=r(894754),c=r(383655),u=r(313059),d=r(89522),f=r(70727);function h(){(0,a.ik)((0,c.N0)(l.VR,"pages.config.registerSettingsSaveHandler"),"settings.save",w,!1),(0,a.ik)((0,c.N0)(l.VR,"pages.config.registerSettingsRemoveHandler"),"settings.remove",I,!1)}function p(e){return(0,l.kX)((0,c.N0)(l.VR,"pages.config.setValidityState"),e)}function m(e){return(0,l.je)((0,c.N0)(l.VR,"pages.config.setConfig"),e)}function g(e){v((0,c.N0)(l.VR,"pages.config.registerOnSaveHandler"),e,()=>{if(!(0,u.h)(e)&&!E())throw d.qP})}function v(e,t,r){(0,u.h)(t)||(0,s.Zn)(f.fA,d.E2.settings),r&&r(),n=t,(0,u.h)(t)||(0,i.x3)(e,"registerHandler",["save"])}function b(e){y((0,c.N0)(l.VR,"pages.config.registerOnRemoveHandler"),e,()=>{if(!(0,u.h)(e)&&!E())throw d.qP})}function y(e,t,r){(0,u.h)(t)||(0,s.Zn)(f.fA,d.E2.remove,d.E2.settings),r&&r(),o=t,(0,u.h)(t)||(0,i.x3)(e,"registerHandler",["remove"])}function w(e){let t=new C(e);n?n(t):i.bm.childWindow?(0,i.nq)("settings.save",[e]):t.notifySuccess()}function S(e){(0,a.aY)((0,c.N0)(l.VR,"pages.config.registerChangeConfigHandler"),"changeSettings",e,[d.E2.content],()=>{if(!E())throw d.qP})}class C{constructor(e){this.notified=!1,this.result=e||{}}notifySuccess(){this.ensureNotNotified(),(0,i.x3)((0,c.N0)(l.VR,"pages.saveEvent.notifySuccess"),"settings.save.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),(0,i.x3)((0,c.N0)(l.VR,"pages.saveEvent.notifyFailure"),"settings.save.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw Error("The SaveEvent may only notify success or failure once.")}}function I(){let e=new k;o?o(e):i.bm.childWindow?(0,i.nq)("settings.remove",[]):e.notifySuccess()}class k{constructor(){this.notified=!1}notifySuccess(){this.ensureNotNotified(),(0,i.x3)((0,c.N0)(l.VR,"pages.removeEvent.notifySuccess"),"settings.remove.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),(0,i.x3)((0,c.N0)(l.VR,"pages.removeEvent.notifyFailure"),"settings.remove.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw Error("The removeEventType may only notify success or failure once.")}}function E(){return!(!(0,s.Zn)(f.fA)||!f.fA.supports.pages)&&!!f.fA.supports.pages.config}},667752:(e,t,r)=>{"use strict";r.r(t),r.d(t,{EnterFocusType:()=>n,ReturnFocusType:()=>o,appButton:()=>i,backStack:()=>I,config:()=>k,currentApp:()=>a,fullTrust:()=>s,getConfig:()=>L,initializeWithFrameContext:()=>F,isSupported:()=>H,navigateCrossDomain:()=>z,navigateToApp:()=>D,registerFocusEnterHandler:()=>M,registerFullScreenHandler:()=>U,returnFocus:()=>x,setCurrentFrame:()=>N,shareDeepLink:()=>B,tabs:()=>R});var n,o,i={};r.r(i),r.d(i,{isSupported:()=>C,onClick:()=>y,onHoverEnter:()=>w,onHoverLeave:()=>S});var a={};r.r(a),r.d(a,{isSupported:()=>A,navigateTo:()=>E,navigateToDefaultPage:()=>_});var s={};r.r(s),r.d(s,{enterFullscreen:()=>T,exitFullscreen:()=>P,isSupported:()=>O});var l=r(58227),c=r(157061),u=r(623054),d=r(65999),f=r(894754),h=r(383655),p=r(313059),m=r(805234),g=r(761862),v=r(89522),b=r(70727);function y(e){(0,u.aY)((0,h.N0)(f.VR,"pages.appButton.onClick"),"appButtonClick",e,[v.E2.content],()=>{if(!C())throw v.qP})}function w(e){(0,u.aY)((0,h.N0)(f.VR,"pages.appButton.onHoverEnter"),"appButtonHoverEnter",e,[v.E2.content],()=>{if(!C())throw v.qP})}function S(e){(0,u.aY)((0,h.N0)(f.VR,"pages.appButton.onHoverLeave"),"appButtonHoverLeave",e,[v.E2.content],()=>{if(!C())throw v.qP})}function C(){return!(!(0,d.Zn)(b.fA)||!b.fA.supports.pages)&&!!b.fA.supports.pages.appButton}var I=r(944673),k=r(103920);function E(e){return new Promise(t=>{if((0,d.Zn)(b.fA,v.E2.content,v.E2.sidePanel,v.E2.settings,v.E2.task,v.E2.stage,v.E2.meetingStage),!A())throw v.qP;t((0,c.gV)((0,h.N0)(f.VR,"pages.currentApp.navigateTo"),"pages.currentApp.navigateTo",e))})}function _(){return new Promise(e=>{if((0,d.Zn)(b.fA,v.E2.content,v.E2.sidePanel,v.E2.settings,v.E2.task,v.E2.stage,v.E2.meetingStage),!A())throw v.qP;e((0,c.gV)((0,h.N0)(f.VR,"pages.currentApp.navigateToDefaultPage"),"pages.currentApp.navigateToDefaultPage"))})}function A(){return!(!(0,d.Zn)(b.fA)||!b.fA.supports.pages)&&!!b.fA.supports.pages.currentApp}function T(){if((0,d.Zn)(b.fA,v.E2.content),!O())throw v.qP;(0,c.x3)((0,h.N0)(f.VR,"pages.fullTrust.enterFullscreen"),"enterFullscreen",[])}function P(){if((0,d.Zn)(b.fA,v.E2.content),!O())throw v.qP;(0,c.x3)((0,h.N0)(f.VR,"pages.fullTrust.exitFullscreen"),"exitFullscreen",[])}function O(){return!(!(0,d.Zn)(b.fA)||!b.fA.supports.pages)&&!!b.fA.supports.pages.fullTrust}var R=r(668954);function x(e){let t=(0,h.N0)(f.VR,"pages.returnFocus");if((0,d.Zn)(b.fA),!H())throw v.qP;if(void 0===e&&(0,c.x3)(t,"returnFocus",[!1]),"boolean"==typeof e)(0,c.x3)(t,"returnFocus",[e]);else switch(e){case o.PreviousLandmark:case o.GoToActivityFeed:(0,c.x3)(t,"returnFocus",[!1,e]);break;case o.NextLandmark:(0,c.x3)(t,"returnFocus",[!0,e])}}function M(e){(0,u.aY)((0,h.N0)(f.VR,"pages.registerFocusEnterHandler"),"focusEnter",e,[],()=>{if(!H())throw v.qP})}function N(e){(0,f.Hp)((0,h.N0)(f.VR,"pages.setCurrentFrame"),e)}function F(e,t,r){(0,g.w)(),(0,l.yx)((0,h.N0)(f.VR,"pages.initializeWithFrameContext"),r).then(()=>t&&t()),N(e)}function L(){return(0,f.xG)((0,h.N0)(f.VR,"pages.getConfig."))}function z(e){return(0,f.Gx)((0,h.N0)(f.VR,"pages.navigateCrossDomain"),e)}function D(e){return new Promise(t=>{if((0,d.Zn)(b.fA,v.E2.content,v.E2.sidePanel,v.E2.settings,v.E2.task,v.E2.stage,v.E2.meetingStage),!H())throw v.qP;let r=(0,h.N0)(f.VR,"pages.navigateToApp");if(b.fA.isLegacyTeams){let n=(0,f.rP)(e)?e:(0,f.p$)(e);t((0,c.Vi)(r,"executeDeepLink",(0,m.aM)(n)))}else{let n=(0,f.rP)(e)?(0,f.jS)(e):e;t((0,c.Vi)(r,"pages.navigateToApp",n))}})}function B(e){return(0,f.ex)((0,h.N0)(f.VR,"pages.shareDeepLink"),e)}function U(e){(0,u.aY)((0,h.N0)(f.VR,"pages.registerFullScreenHandler"),"fullScreenChange",e,[],()=>{if(!(0,p.h)(e)&&!H())throw v.qP})}function H(){return!(!(0,d.Zn)(b.fA)||!b.fA.supports.pages)}(function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.Read=2]="Read",e[e.Compose=3]="Compose"})(n||(n={})),function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.GoToActivityFeed=2]="GoToActivityFeed"}(o||(o={}))},668954:(e,t,r)=>{"use strict";r.r(t),r.d(t,{getMruTabInstances:()=>c,getTabInstances:()=>l,isSupported:()=>u,navigateToTab:()=>s});var n=r(65999),o=r(894754),i=r(383655),a=r(70727);function s(e){return(0,o.K5)((0,i.N0)(o.VR,"pages.tabs.navigateToTab"),e)}function l(e){return(0,o.Sd)((0,i.N0)(o.VR,"pages.tabs.getTabInstances"),e)}function c(e){return(0,o.Gt)((0,i.N0)(o.VR,"pages.tabs.getMruTabInstances"),e)}function u(){return!(!(0,n.Zn)(a.fA)||!a.fA.supports.pages)&&!!a.fA.supports.pages.tabs}},70727:(e,t,r)=>{"use strict";r.d(t,{Wz:()=>b,fA:()=>h,ff:()=>w,nS:()=>p,pn:()=>C,sO:()=>u,xb:()=>f});var n=r(274107),o=r(788347),i=r(550966),a=r(383655),s=r(805234),l=r(89522);let c=(0,a.tZ)("runtime"),u=4;function d(e){return e.apiVersion===u}function f(e){if(d(e))return!0;throw -1===e.apiVersion?Error(o.qx):Error(o.Cf)}let h={apiVersion:-1,supports:{}},p={apiVersion:4,isNAAChannelRecommended:!1,hostVersionsInfo:l.bD,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{},parentCommunication:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},m=[l.WK.desktop,l.WK.web,l.WK.rigel,l.WK.surfaceHub,l.WK.teamsRoomsWindows,l.WK.teamsRoomsAndroid,l.WK.teamsPhones,l.WK.teamsDisplays],g=[...m,l.WK.android,l.WK.ios,l.WK.ipados,l.WK.visionOS],v=[{versionToUpgradeFrom:1,upgradeToNextVersion:e=>{var t;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:void 0,url:e.supports.dialog,update:null===(t=e.supports.dialog)||void 0===t?void 0:t.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:e=>{let t=e.supports,r=(0,n.T)(t,["appNotification"]);return Object.assign(Object.assign({},e),{apiVersion:3,supports:r})}},{versionToUpgradeFrom:3,upgradeToNextVersion:e=>{var t,r,n,o,i;return{apiVersion:4,hostVersionsInfo:e.hostVersionsInfo,isNAAChannelRecommended:e.isNAAChannelRecommended,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:null===(t=e.supports.dialog)||void 0===t?void 0:t.card,url:{bot:null===(n=null===(r=e.supports.dialog)||void 0===r?void 0:r.url)||void 0===n?void 0:n.bot,parentCommunication:(null===(o=e.supports.dialog)||void 0===o?void 0:o.url)?{}:void 0},update:null===(i=e.supports.dialog)||void 0===i?void 0:i.update}:void 0})}}}],b={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:m}],"1.9.0":[{capability:{location:{}},hostClientTypes:g}],"2.0.0":[{capability:{people:{}},hostClientTypes:g},{capability:{sharing:{}},hostClientTypes:[l.WK.desktop,l.WK.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[l.WK.android,l.WK.desktop,l.WK.ios,l.WK.teamsRoomsAndroid,l.WK.teamsPhones,l.WK.teamsDisplays,l.WK.web]},{capability:{webStorage:{}},hostClientTypes:[l.WK.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[l.WK.android,l.WK.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[l.WK.android,l.WK.ios]}],"2.1.1":[{capability:{nestedAppAuth:{}},hostClientTypes:[l.WK.android,l.WK.ios,l.WK.ipados,l.WK.visionOS]}]},y=c.extend("generateBackCompatRuntimeConfig");function w(e,t,r){y("generating back compat runtime config for %s",e);let n=Object.assign({},t.supports);y("Supported capabilities in config before updating based on highestSupportedVersion: %o",n),Object.keys(r).forEach(t=>{(0,s.dI)(e,t)>=0&&r[t].forEach(e=>{void 0!==i.Y.hostClientType&&e.hostClientTypes.includes(i.Y.hostClientType)&&(n=function e(t,r){let n=Object.assign({},t);for(let o in r)Object.prototype.hasOwnProperty.call(r,o)&&("object"!=typeof r[o]||Array.isArray(r[o])?o in t||(n[o]=r[o]):n[o]=e(t[o]||{},r[o]));return n}(n,e.capability))})});let o={apiVersion:u,hostVersionsInfo:l.bD,isLegacyTeams:!0,supports:n};return y("Runtime config after updating based on highestSupportedVersion: %o",o),o}let S=c.extend("applyRuntimeConfig");function C(e){"string"==typeof e.apiVersion&&(S("Trying to apply runtime with string apiVersion, processing as v1: %o",e),e=Object.assign(Object.assign({},e),{apiVersion:1})),S("Fast-forwarding runtime %o",e);let t=function(e){let t=e;if(t.apiVersion<u&&v.forEach(e=>{t.apiVersion===e.versionToUpgradeFrom&&(t=e.upgradeToNextVersion(t))}),d(t))return t;throw Error("Received a runtime that could not be upgraded to the latest version")}(e);S("Applying runtime %o",t),h=(0,s.ol)(t)}},416835:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});var n=r(805234);class o{constructor(e=(0,n.Nl)()){this.uuid=e,(0,n.sb)(e)}toString(){return this.uuid}}},952095:(e,t,r)=>{"use strict";r.d(t,{r:()=>n});let n="2.34.0"},659495:(e,t,r)=>{"use strict";r.d(t,{Dv:()=>v,H0:()=>R,Ov:()=>B,Qo:()=>z,RC:()=>K,Xf:()=>D,_l:()=>M,c$:()=>O,ui:()=>x,yN:()=>b});var n,o,i,a,s,l,c,u,d,f,h,p=r(647759),m="Promise",g="rejected";function v(e,t){return b(e,function(e){return t?t({status:"fulfilled",rejected:!1,value:e}):e},function(e){return t?t({status:g,rejected:!0,reason:e}):e})}function b(e,t,r,n){var o,i,a,s=e;try{if((0,p.$XS)(e))(t||r)&&(s=e.then(t,r));else try{t&&(s=t(e))}catch(e){if(r)s=r(e);else throw e}}finally{n&&(o=s,i=n,a=o,i&&((0,p.$XS)(o)?o.finally?o.finally(i):o.then(function(e){return i(),e},function(e){throw i(),e}):i()))}return s}var y=["pending","resolving","resolved",g],w="dispatchEvent";function S(e){var t;return e&&e.createEvent&&(t=e.createEvent("Event")),!!t&&t.initEvent}var C="unhandledRejection",I=C.toLowerCase(),k=[],E=0;function _(e){return(0,p.Tnt)(e)?e.toString():(0,p.mmD)(e)}function A(e,t,r){var n,o,a=(0,p.KVm)(arguments,3),l=0,c=!1,u=[],d=E++,f=(k.length>0&&k[k.length-1],!1),h=null;function g(t,r){try{return k.push(d),f=!0,h&&h.cancel(),h=null,e(function(e,o){u.push(function(){try{var i=2===l?t:r,a=(0,p.b07)(i)?n:(0,p.Tnt)(i)?i(n):i;(0,p.$XS)(a)?a.then(e,o):i?e(a):3===l?o(a):e(a)}catch(e){o(e)}}),c&&b()},a)}finally{k.pop()}}function v(){return y[l]}function b(){if(u.length>0){var e=u.slice();u=[],f=!0,h&&h.cancel(),h=null,t(e)}}function A(e,t){return function(r){if(l===t){if(2===e&&(0,p.$XS)(r)){l=1,r.then(A(2,1),A(3,1));return}l=e,c=!0,n=r,b(),f||3!==e||h||(h=(0,p.dRz)(T,10))}}}function T(){if(!f){if(f=!0,(0,p.Lln)())process.emit(C,n,o);else{var e=(0,p.zkX)()||(0,p.mS$)();s||(s=(0,p.GuU)((0,p.gBW)(p.zS2,[m+"RejectionEvent"]).v)),function(e,t,r,n){var o=(0,p.YEm)();i||(i=(0,p.GuU)(!!(0,p.gBW)(S,[o]).v));var a=i.v?o.createEvent("Event"):n?new Event(t):{};if(r&&r(a),i.v&&a.initEvent(t,!1,!0),a&&e[w])e[w](a);else{var s=e["on"+t];if(s)s(a);else{var l=(0,p.zS2)("console");l&&(l.error||l.log)(t,(0,p.mmD)(a))}}}(e,I,function(e){return(0,p.vF1)(e,"promise",{g:function(){return o}}),e.reason=n,e},!!s.v)}}}return o={then:g,catch:function(e){return g(void 0,e)},finally:function(e){var t=e,r=e;return(0,p.Tnt)(e)&&(t=function(t){return e&&e(),t},r=function(t){throw e&&e(),t}),g(t,r)}},(0,p.UxO)(o,"state",{get:v}),(0,p.Lok)()&&(o[(0,p.Y0g)(11)]="IPromise"),o.toString=function(){return"IPromise "+v()+(c?" - "+_(n):"")},function(){(0,p.Tnt)(r)||(0,p.zkd)(m+": executor is not a function - "+_(r));var e=A(3,0);try{r.call(o,A(2,0),e)}catch(t){e(t)}}(),o}function T(e){return function(t){var r=(0,p.KVm)(arguments,1);return e(function(e,r){try{var n=[],o=1;(0,p.DA8)(t,function(t,i){t&&(o++,b(t,function(t){n[i]=t,0==--o&&e(n)},r))}),o--,0===o&&e(n)}catch(e){r(e)}},r)}}function P(e){(0,p.Iuo)(e,function(e){try{e()}catch(e){}})}function O(e,t){var r;return A(O,(r=(0,p.EtT)(t)?t:0,function(e){(0,p.dRz)(function(){P(e)},r)}),e,t)}var R=T(O),x=(n=O,function(e){var t=(0,p.KVm)(arguments,1);return(0,p.$XS)(e)?e:n(function(t){t(e)},t)}),M=(o=O,function(e){var t=(0,p.KVm)(arguments,1);return o(function(t,r){r(e)},t)});function N(e,t){l||(l=(0,p.GuU)((0,p.gBW)(p.zS2,[m]).v||null));var r=l.v;if(!r)return O(e);(0,p.Tnt)(e)||(0,p.zkd)(m+": executor is not a function - "+(0,p.mmD)(e));var n=0,o=new r(function(t,r){e(function(e){n=2,t(e)},function(e){n=3,r(e)})});return(0,p.UxO)(o,"state",{get:function(){return y[n]}}),o}function F(e){return A(F,P,e)}function L(e,t){var r,n=isUndefined(t)?c:t;return A(L,(n>=0&&(r={timeout:+n}),function(e){scheduleIdleCallback(function(t){P(e)},r)}),e,n)}function z(e,t){return u||(u=(0,p.GuU)(N)),u.v.call(this,e,t)}var D=T(z);function B(e,t){var r;return d||(r=z,d=(0,p.GuU)(function(e){var t=(0,p.KVm)(arguments,1);return r(function(t,r){var n=[],o=1;function i(e,r){o++,v(e,function(e){e.rejected?n[r]={status:g,reason:e.reason}:n[r]={status:"fulfilled",value:e.value},0==--o&&t(n)})}try{(0,p.cyL)(e)?(0,p.Iuo)(e,i):(0,p.xZI)(e)?(0,p.DA8)(e,i):(0,p.zkd)("Input is not an iterable"),o--,0===o&&t(n)}catch(e){r(e)}},t)})),d.v(e,t)}var U="reject",H="Rejected",q=0,j={};function $(){}function W(e,t,r){j[e]||(j[e]=(0,p.aqQ)(e));var n=(0,p.f0d)();return new j[e]("Task [".concat(t.id,"] ").concat(r||"","- ").concat(t.st?"Running":"Waiting",": ").concat((n-(t.st||t.cr)||"0")+" ms"))}function V(e,t){var r=(0,p.f0d)()-t;(0,p.Iuo)(e,function(e){(e&&!e.rj&&e.st&&e.st<r||!e.st&&e.cr&&e.cr<r)&&e&&e[U](e.rj||W("Aborted",e,"Stale "))})}function G(e,t){var r=(0,p.rDm)(e,t);-1!==r&&e.splice(r,1)}function K(e,t){var r,n,o,i,a=[],s=[],l=6e5,c=6e4,u=0,d=(t?t+".":"")+q++;e=e||z;var m=function(){var e=(0,p.R3R)(a)+(0,p.R3R)(s)>0;l>0&&(i||(i=(0,p.dRz)(function(){V(a,l),V(s,l),i&&(i.enabled=(0,p.R3R)(a)+(0,p.R3R)(s)>0)},c)).unref(),i&&(i.enabled=e))},g=function(e,t){return e.st=(0,p.f0d)(),a.push(e),m(),function(r,n){var o=function(t){e.rj=e.rj||t||W(H,e),e[U]=$,y(e),r=null,n&&n(t),n=null},i=e.id;if(e.rj)o(e.rj);else{e[U]=o;try{var a=t(i);e.to&&(0,p.$XS)(a)&&(e.t=(0,p.dRz)(function(){o(W("Timeout",e))},e.to)),b(a,function(t){y(e);try{r&&r(t)}catch(e){n&&n(e)}n=null,r=null},o)}catch(e){o(e)}}}},y=function(e){G(a,e),e.t&&e.t.cancel(),e.t=null,o&&o===e&&(o=null,(0,p.R3R)(a)+(0,p.R3R)(s)===0&&(i&&i.cancel(),i=null))},w={idle:!0,queue:function(t,r,n){var i,a,l=d+"."+u++;r&&(l+="-("+r+")");var c=((a={id:l,cr:(0,p.f0d)(),to:n})[U]=function(e){c.rj=e||W(H,c),c[U]=$},a);return o?c.p=(i=o,s.push(c),m(),e(function(e,r){v(i.p,function(){G(s,c),g(c,t)(e,r)})})):c.p=e(g(c,t)),o=c,c.p},setStaleTimeout:function(e,t){i&&i.cancel(),i=null,l=e,c=t||e/10,m()}};return(0,p.vF1)(w,"idle",{g:function(){return(0,p.R3R)(a)+(0,p.R3R)(s)===0}}),r=function(){return d},n=function(){return{l:o,r:a,w:s}},f=f||{toString:function(){return"[[SchedulerName]]"}},h=h||{toString:function(){return"[[SchedulerState]]"}},(0,p.UxO)(w,f,{get:r}),(0,p.UxO)(w,h,{get:n}),w}(0,p.Y0g)(11)},647759:(e,t,r)=>{"use strict";r.d(t,{$8:()=>eC,$XS:()=>ea,AHH:()=>tR,Cv9:()=>tI,DA8:()=>tr,EHq:()=>th,EtT:()=>en,GuU:()=>eV,Gvm:()=>ee,HzD:()=>tk,Iuo:()=>ti,KVm:()=>ts,KgX:()=>Q,KhI:()=>eu,Lln:()=>e3,Lmq:()=>eo,Lok:()=>e4,N6t:()=>eA,O9V:()=>Z,P0f:()=>eB,QdQ:()=>tp,R3R:()=>tS,SZ2:()=>K,Tnt:()=>J,UUD:()=>tC,UxO:()=>ep,Vdv:()=>eJ,WSA:()=>eP,Wtk:()=>eZ,Y0g:()=>e8,YEm:()=>eQ,Yny:()=>to,ZHX:()=>function e(t){return ek&&ed(t,function(t,r){(et(r)||ee(r))&&e(r)}),eA(t)},ZWZ:()=>eH,aqQ:()=>td,b07:()=>X,bJ7:()=>ei,cGk:()=>e_,cyL:()=>et,dRz:()=>tP,eCG:()=>e7,f0d:()=>tf,fn0:()=>eO,gBW:()=>W,hKY:()=>eU,hXl:()=>Y,isD:()=>em,jjc:()=>e9,kgX:()=>el,lKJ:()=>ev,mS$:()=>eX,mmD:()=>eS,nRs:()=>eW,oJg:()=>ew,rDm:()=>ta,sSX:()=>tl,tGl:()=>tE,v0u:()=>ec,vE3:()=>eE,vF1:()=>eg,vKV:()=>tO,w3n:()=>e2,w9M:()=>e1,xZI:()=>tt,zS2:()=>eY,zav:()=>ed,zkX:()=>e0,zkd:()=>eI,zwS:()=>tw,zzB:()=>es});var n,o,i,a,s,l,c,u,d,f,h,p,m,g,v,b,y,w,S,C,I,k,E=void 0,_="function",A="object",T="prototype",P="__proto__",O="undefined",R="constructor",x="Symbol",M="length",N="name",F="call",L="toString",z=Object||void 0,D=z[T],B=String||void 0,U=B[T],H=Math||void 0,q=Array||void 0,j=q[T],$=j.slice;function W(e,t){try{return{v:e.apply(this,t)}}catch(e){return{e:e}}}function V(e){return function(t){return typeof t===e}}function G(e){var t="[object "+e+"]";return function(e){return!!(e&&K(e)===t)}}function K(e){return D[L].call(e)}function X(e){return typeof e===O||e===O}function Y(e){return null===e||X(e)}function Z(e){return!!e||e!==E}var Q=V("string"),J=V(_);function ee(e){return!(!e&&Y(e))&&!!e&&typeof e===A}var et=q.isArray,er=G("Date"),en=V("number"),eo=V("boolean"),ei=G("Error");function ea(e){return!!(e&&e.then&&J(e.then))}function es(e){var t,r,n;return!(!e||(t=function(){return!(e&&0+e)},r=!e,(n=W(t)).e?r:n.v))}var el=z.getOwnPropertyDescriptor;function ec(e,t){return!!e&&D.hasOwnProperty[F](e,t)}var eu=(n=z.hasOwn,o=function(e,t){return ec(e,t)||!!el(e,t)},n||o);function ed(e,t,r){if(e&&ee(e)){for(var n in e)if(eu(e,n)&&-1===t[F](r||e,n,e[n]))break}}var ef={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};function eh(e){var t={};if(t[ef.c]=!0,t[ef.e]=!0,e.l){t.get=function(){return e.l.v};var r=el(e.l,"v");r&&r.set&&(t.set=function(t){e.l.v=t})}return ed(e,function(e,r){t[ef[e]]=X(r)?t[ef[e]]:r}),t}var ep=z.defineProperty,em=z.defineProperties;function eg(e,t,r){return ep(e,t,eh(r))}function ev(e,t){var r={};return ed(t,function(e,t){r[e]=eh(t)}),em(e,r)}function eb(e,t,r,n,o){var i={};return ed(e,function(e,n){ey(i,e,t?n:e,o),ey(i,n,r?n:e,o)}),n?n(i):i}function ey(e,t,r,n){ep(e,t,{value:r,enumerable:!0,writable:!!n})}var ew=B||void 0;function eS(e,t){var r="",n=D[L][F](e);"[object Error]"===n&&(e={stack:ew(e.stack),message:ew(e.message),name:ew(e.name)});try{r=(r=JSON.stringify(e,null,t?"number"==typeof t?t:4:E))&&r.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: ")||ew(e)}catch(e){r=" - "+eS(e,t)}return n+": "+r}function eC(e){throw Error(e)}function eI(e){throw TypeError(e)}var ek=z.freeze,eE=z.assign,e_=z.keys,eA=(i=function(e){return e},ek||i),eT=(a=z.getPrototypeOf,s=function(e){return e[P]||null},a||s);function eP(e){return eb(e,1,0,eA)}function eO(e){var t;return t={},ed(e,function(e,r){ey(t,e,r[1]),ey(t,r[0],r[1])}),eA(t)}var eR=eb({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12},0,0,eA),ex="__tsUtils$gblCfg";function eM(){var e;return typeof globalThis!==O&&(e=globalThis),e||typeof self===O||(e=self),e||typeof window===O||(e=window),e||typeof r.g===O||(e=r.g),e}function eN(){if(!f){var e=W(eM).v||{};f=e[ex]=e[ex]||{}}return f}var eF=eL;function eL(e,t,r){var n=t&&t[e];return function(t){var o=t&&t[e]||n;if(o||r){var i=arguments;return(o||r).apply(t,o?$[F](i,1):i)}eI('"'+ew(e)+'" not defined for '+eS(t))}}var ez=H.max,eD=eF("slice",U),eB=eF("substring",U),eU=eL("substr",U,function(e,t,r){return(Y(e)&&eI("Invalid "+eS(e)),r<0)?"":((t=t||0)<0&&(t=ez(t+e[M],0)),X(r))?eD(e,t):eD(e,t,t+r)});function eH(e,t){return eB(e,0,t)}var eq="_urid";function ej(e){var t={description:ew(e),toString:function(){return x+"("+e+")"}};return t._polyfill=!0,t}function e$(){m=eN()}function eW(e){var t={};return m||e$(),t.b=m.lzy,ep(t,"v",{configurable:!0,get:function(){var r=e();return m.lzy||ep(t,"v",{value:r}),t.b=m.lzy,r}}),t}function eV(e){return ep({toJSON:function(){return e}},"v",{value:e})}var eG="window";function eK(e,t){var r;return function(){return m||e$(),(!r||m.lzy)&&(r=eV(W(e,t).v)),r.v}}function eX(e){return m||e$(),(!g||!1===e||m.lzy)&&(g=eV(W(eM).v||null)),g.v}function eY(e,t){var r=g&&!1!==t?g.v:eX(t);return r&&r[e]?r[e]:e===eG?e0():null}function eZ(){return!!eQ()}var eQ=eK(eY,["document"]);function eJ(){return!!e0()}var e0=eK(eY,[eG]);function e1(){return!!e2()}var e2=eK(eY,["navigator"]),e3=eK(function(){return!!W(function(){return process&&(process.versions||{}).node}).v});function e5(){return v=eV(W(eY,[x]).v)}function e6(e){var t=(m.lzy?0:v)||e5();return t.v?t.v[e]:E}function e4(){return m||e$(),!!((m.lzy?0:v)||e5()).v}function e8(e,t){var r,n,o=eR[e];m||e$();var i=(m.lzy?0:v)||e5();return i.v?i.v[o||e]:t?E:(p||(p={}),(n=eR[e])&&(r=p[n]=p[n]||ej(x+"."+n)),r)}function e9(e,t){m||e$();var r=(m.lzy?0:v)||e5();return r.v?r.v(e):t?null:ej(e)}function e7(e){return m||e$(),((b=(m.lzy?0:b)||eV(W(e6,["for"]).v)).v||function(e){var t=function(){if(!h){var e=eN();h=e.gblSym=e.gblSym||{k:{},s:{}}}return h}();if(!eu(t.k,e)){var r=ej(e),n=e_(t.s).length;r[eq]=function(){return n+"_"+r[L]()},t.k[e]=r,t.s[r[eq]()]=ew(e)}return t.k[e]})(e)}function te(e){return!!e&&J(e.next)}function tt(e){return!(null===e||!Z(e))&&J(e[e8(3)])}function tr(e,t,r){if(e&&(te(e)||(y||(y=eV(e8(3))),e=e[y.v]?e[y.v]():null),te(e))){var n=E,o=E;try{for(var i=0;!(o=e.next()).done&&-1!==t[F](r||e,o.value,i,e);)i++}catch(t){n={e:t},e.throw&&(o=null,e.throw(n))}finally{try{o&&!o.done&&e.return&&e.return(o)}finally{if(n)throw n.e}}}}function tn(e,t,r){return e.apply(t,r)}function to(e,t){return!X(t)&&e&&(et(t)?tn(e.push,e,t):te(t)||tt(t)?tr(t,function(t){e.push(t)}):e.push(t)),e}function ti(e,t,r){if(e)for(var n=e[M]>>>0,o=0;o<n&&(!(o in e)||-1!==t[F](r||e,e[o],o,e));o++);}var ta=eF("indexOf",j);function ts(e,t,r){return(e&&e.slice||$).apply(e,$[F](arguments,1))}var tl=(l=z.create,c=function(e){if(!e)return{};var t=typeof e;function r(){}return t!==A&&t!==_&&eI("Prototype must be an Object or function: "+eS(e)),r[T]=e,new r},l||c);function tc(e,t){return(z.setPrototypeOf||function(e,t){var r;w||(w=eV(((r={})[P]=[],r instanceof Array))),w.v?e[P]=t:ed(t,function(t,r){return e[t]=r})})(e,t)}function tu(e,t){t&&(e[N]=t)}function td(e,t,r){var n=r||Error,o=n[T][N],i=Error.captureStackTrace;return function(e,t,r){function n(){this[R]=t,W(eg,[this,N,{v:e,c:!0,e:!1}])}return W(eg,[t,N,{v:e,c:!0,e:!1}]),(t=tc(t,r))[T]=null===r?tl(r):(n[T]=r[T],new n),t}(e,function(){var r=arguments;try{W(tu,[n,e]);var a=tn(n,this,$[F](r))||this;if(a!==this){var s=eT(this);s!==eT(a)&&tc(a,s)}return i&&i(a,this[R]),t&&t(a,r),a}finally{W(tu,[n,o])}},n)}function tf(){return(Date.now||function(){return new Date().getTime()})()}var th=eL("trim",U,(u=/^\s+|(?=\s)\s+$/g,function(e){return Y(e)&&eI("strTrim called ["+eS(e)+"]"),e&&e.replace&&(e=e.replace(u,"")),e}));function tp(e){if(!e||typeof e!==A)return!1;I||(I=!eJ()||e0());var t=!1;if(e!==I){C||(C=(S=Function[T][L])[F](z));try{var r=eT(e);(t=!r)||(ec(r,R)&&(r=r[R]),t=r&&typeof r===_&&S[F](r)===C)}catch(e){}}return t}function tm(e){return e.value&&ty(e),!0}var tg=[function(e){var t=e.value;if(et(t)){var r=e.result=[];return r.length=t.length,e.copyTo(r,t),!0}return!1},ty,function(e){return e.type===_},function(e){var t=e.value;return!!er(t)&&(e.result=new Date(t.getTime()),!0)}];function tv(e,t,r,n){var o,i,a=r.handler,s=r.path?n?r.path.concat(n):r.path:[],l={handler:r.handler,src:r.src,path:s},c=typeof t,u=!1,f=!1;t&&c===A?u=tp(t):f=null===t||(d||(d=["string","number","boolean",O,"symbol","bigint"]),c!==A&&-1!==d.indexOf(c));var h={type:c,isPrim:f,isPlain:u,value:t,result:t,path:s,origin:r.src,copy:function(t,n){return tv(e,t,n?l:r,n)},copyTo:function(t,r){return tb(e,t,r,l)}};return h.isPrim?a&&a[F](r,h)?h.result:t:(o=function(e){eg(h,"result",{g:function(){return e.v},s:function(t){e.v=t}});for(var t=0,n=a;!(n||(t<tg.length?tg[t++]:tm))[F](r,h);)n=null},ti(e,function(e){if(e.k===t)return i=e,-1}),i||(i={k:t,v:t},e.push(i),o(i)),i.v)}function tb(e,t,r,n){if(!Y(r))for(var o in r)t[o]=tv(e,r[o],n,o);return t}function ty(e){var t=e.value;if(t&&e.isPlain){var r=e.result={};return e.copyTo(r,t),!0}return!1}function tw(e,t,r,n,o,i,a){var s,l;return s=tv([],e,{handler:void 0,src:e})||{},l=$[F](arguments),ti(l,function(e){tb([],s,e,{handler:void 0,src:e,path:[]})}),s}var tS=function(e){return e[M]};function tC(){var e=(m||e$(),(!k||m.lzy)&&(k=eV(W(eY,["performance"]).v)),k.v);return e&&e.now?e.now():tf()}var tI=eL("endsWith",U,function(e,t,r){Q(e)||eI("'"+eS(e)+"' is not a string");var n=Q(t)?t:ew(t),o=!X(r)&&r<e[M]?r:e[M];return eB(e,o-n[M],o)===n}),tk=eF("indexOf",U),tE=eL("startsWith",U,function(e,t,r){Q(e)||eI("'"+eS(e)+"' is not a string");var n=Q(t)?t:ew(t),o=r>0?r:0;return eB(e,o,o+n[M])===n}),t_="unref",tA="hasRef";function tT(e,t,r){var n=et(t),o=n?t.length:0,i=(o>0?t[0]:n?E:t)||setTimeout,a=(o>1?t[1]:E)||clearTimeout,s=r[0];r[0]=function(){l.dn(),tn(s,E,$[F](arguments))};var l=function(e,t,r){var n,o=!0,i=e?t(null):null;function a(){return o=!1,i&&i[t_]&&i[t_](),n}function s(){i&&r(i),i=null}function l(){return i=t(i),o||a(),n}return(n={cancel:s,refresh:l})[tA]=function(){return i&&i[tA]?i[tA]():o},n.ref=function(){return o=!0,i&&i.ref&&i.ref(),n},n[t_]=a,{h:n=ep(n,"enabled",{get:function(){return!!i},set:function(e){!e&&i&&s(),e&&!i&&l()}}),dn:function(){i=null}}}(e,function(e){if(e){if(e.refresh)return e.refresh(),e;tn(a,E,[e])}return tn(i,E,r)},function(e){tn(a,E,[e])});return l.h}function tP(e,t){return tT(!0,E,$[F](arguments))}function tO(e,t,r){return tT(!0,e,$[F](arguments,1))}function tR(e,t){return tT(!1,E,$[F](arguments))}},556425:e=>{function t(e){this.message=e}t.prototype=Error(),t.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var r=String(e).replace(/=+$/,"");if(r.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,o,i=0,a=0,s="";o=r.charAt(a++);~o&&(n=i%4?64*n+o:o,i++%4)&&(s+=String.fromCharCode(255&n>>(-2*i&6))))o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return s}},436373:(e,t,r)=>{var n=r(556425);e.exports=function(e){var t,r=e.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw"Illegal base64url string!"}try{return t=r,decodeURIComponent(n(t).replace(/(.)/g,function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}catch(e){return n(r)}}},486353:(e,t,r)=>{"use strict";var n=r(436373);function o(e){this.message=e}o.prototype=Error(),o.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new o("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(n(e.split(".")[r]))}catch(e){throw new o("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=o},29227:(e,t,r)=>{"use strict";function n(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("number"==typeof e?"[MobX] minified error nr: "+e+(r.length?" "+r.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+e)}r.r(t),r.d(t,{$mobx:()=>ee,FlowCancellationError:()=>tJ,ObservableMap:()=>rj,ObservableSet:()=>rV,Reaction:()=>tS,_allowStateChanges:()=>eJ,_allowStateChangesInsideComputed:()=>tD,_allowStateReadsEnd:()=>ta,_allowStateReadsStart:()=>ti,_autoAction:()=>tz,_endAction:()=>eQ,_getAdministration:()=>ne,_getGlobalState:()=>th,_interceptReads:()=>t8,_isComputingDerivation:()=>e7,_resetGlobalState:()=>tp,_startAction:()=>eZ,action:()=>tL,autorun:()=>tU,comparer:()=>eo,computed:()=>e$,configure:()=>tK,createAtom:()=>en,defineProperty:()=>rd,entries:()=>rs,extendObservable:()=>tX,flow:()=>t3,flowResult:()=>t6,get:()=>ru,getAtom:()=>r7,getDebugName:()=>nt,getDependencyTree:()=>tY,getObserverTree:()=>tZ,has:()=>rc,intercept:()=>t9,isAction:()=>tB,isBoxedObservable:()=>e3,isComputed:()=>re,isComputedProp:()=>rt,isFlow:()=>t4,isFlowCancellationError:()=>t0,isObservable:()=>rn,isObservableArray:()=>rU,isObservableMap:()=>r$,isObservableObject:()=>r0,isObservableProp:()=>ro,isObservableSet:()=>rG,keys:()=>ri,makeAutoObservable:()=>rP,makeObservable:()=>rA,observable:()=>eU,observe:()=>rh,onBecomeObserved:()=>t$,onBecomeUnobserved:()=>tW,onReactionError:()=>tC,override:()=>el,ownKeys:()=>rf,reaction:()=>tj,remove:()=>rl,runInAction:()=>tD,set:()=>function e(t,r,o){if(2==arguments.length&&!rG(t)){tv();var i=r;try{for(var a in i)e(t,a,i[a])}finally{tb()}return}r0(t)?t[ee].set_(r,o):r$(t)?t.set(r,o):rG(t)?t.add(r):rU(t)?("number"!=typeof r&&(r=parseInt(r,10)),r<0&&n("Invalid index: '"+r+"'"),tv(),r>=t.length&&(t.length=r+1),t[r]=o,tb()):n(8)},spy:()=>tA,toJS:()=>rm,trace:()=>rg,transaction:()=>rv,untracked:()=>tr,values:()=>ra,when:()=>rb});var o,i,a,s,l,c,u,d,f,h,p={};function m(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:p}var g=Object.assign,v=Object.getOwnPropertyDescriptor,b=Object.defineProperty,y=Object.prototype,w=[];Object.freeze(w);var S={};Object.freeze(S);var C="undefined"!=typeof Proxy,I=Object.toString();function k(){C||n("Proxy not available")}function E(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var _=function(){};function A(e){return"function"==typeof e}function T(e){switch(typeof e){case"string":case"symbol":case"number":return!0}return!1}function P(e){return null!==e&&"object"==typeof e}function O(e){if(!P(e))return!1;var t=Object.getPrototypeOf(e);if(null==t)return!0;var r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r.toString()===I}function R(e){var t=null==e?void 0:e.constructor;return!!t&&("GeneratorFunction"===t.name||"GeneratorFunction"===t.displayName)}function x(e,t,r){b(e,t,{enumerable:!1,writable:!0,configurable:!0,value:r})}function M(e,t,r){b(e,t,{enumerable:!1,writable:!1,configurable:!0,value:r})}function N(e,t){var r="isMobX"+e;return t.prototype[r]=!0,function(e){return P(e)&&!0===e[r]}}function F(e){return e instanceof Map}function L(e){return e instanceof Set}var z=void 0!==Object.getOwnPropertySymbols,D="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:z?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function B(e){return null===e?null:"object"==typeof e?""+e:e}function U(e,t){return y.hasOwnProperty.call(e,t)}var H=Object.getOwnPropertyDescriptors||function(e){var t={};return D(e).forEach(function(r){t[r]=v(e,r)}),t};function q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n.key),n)}}function j(e,t,r){return t&&q(e.prototype,t),r&&q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $(){return($=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function W(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,V(e,t)}function V(e,t){return(V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function G(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function X(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return K(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K(e,void 0)}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Y=Symbol("mobx-stored-annotations");function Z(e){return Object.assign(function(t,r){if(J(r))return e.decorate_20223_(t,r);Q(t,r,e)},e)}function Q(e,t,r){U(e,Y)||x(e,Y,$({},e[Y])),r.annotationType_===es||(e[Y][t]=r)}function J(e){return"object"==typeof e&&"string"==typeof e.kind}var ee=Symbol("mobx administration"),et=function(){function e(e){void 0===e&&(e="Atom"),this.name_=void 0,this.isPendingUnobservation_=!1,this.isBeingObserved_=!1,this.observers_=new Set,this.diffValue_=0,this.lastAccessedBy_=0,this.lowestObserverState_=l.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=e}var t=e.prototype;return t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(e){return e()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(e){return e()})},t.reportObserved=function(){return ty(this)},t.reportChanged=function(){tv(),tw(this),tb()},t.toString=function(){return this.name_},e}(),er=N("Atom",et);function en(e,t,r){void 0===t&&(t=_),void 0===r&&(r=_);var n=new et(e);return t!==_&&t$(n,t),r!==_&&tW(n,r),n}var eo={identity:function(e,t){return e===t},structural:function(e,t){return no(e,t)},default:function(e,t){return Object.is?Object.is(e,t):e===t?0!==e||1/e==1/t:e!=e&&t!=t},shallow:function(e,t){return no(e,t,1)}};function ei(e,t,r){return rr(e)?e:Array.isArray(e)?eU.array(e,{name:r}):O(e)?eU.object(e,void 0,{name:r}):F(e)?eU.map(e,{name:r}):L(e)?eU.set(e,{name:r}):"function"!=typeof e||tB(e)||t4(e)?e:R(e)?t3(e):tz(r,e)}function ea(e){return e}var es="override",el=Z({annotationType_:es,make_:function(e,t){return 0},extend_:function(e,t,r,o){n("'"+this.annotationType_+"' can only be used with 'makeObservable'")},decorate_20223_:function(e,t){}});function ec(e,t){return{annotationType_:e,options_:t,make_:eu,extend_:ed,decorate_20223_:ef}}function eu(e,t,r,n){if(null!=(o=this.options_)&&o.bound)return null===this.extend_(e,t,r,!1)?0:1;if(n===e.target_)return null===this.extend_(e,t,r,!1)?0:2;if(tB(r.value))return 1;var o,i=eh(e,this,t,r,!1);return b(n,t,i),2}function ed(e,t,r,n){var o=eh(e,this,t,r);return e.defineProperty_(t,o,n)}function ef(e,t){var r,o,i,a,s,l,c=t.kind,u=t.name,d=t.addInitializer,f=this;if("field"==c){d(function(){Q(this,u,f)});return}if("method"==c)return tB(e)||(r=e,e=eX(null!=(o=null==(i=f.options_)?void 0:i.name)?o:u.toString(),r,null!=(a=null==(s=f.options_)?void 0:s.autoAction)&&a)),null!=(l=this.options_)&&l.bound&&d(function(){var e=this[u].bind(this);e.isMobxAction=!0,this[u]=e}),e;n("Cannot apply '"+f.annotationType_+"' to '"+String(u)+"' (kind: "+c+"):\n'"+f.annotationType_+"' can only be used on properties with a function value.")}function eh(e,t,r,n,o){void 0===o&&(o=tf.safeDescriptors),t.annotationType_,n.value;var i,a,s,l,c,u,d,f,h=n.value;return null!=(i=t.options_)&&i.bound&&(h=h.bind(null!=(f=e.proxy_)?f:e.target_)),{value:eX(null!=(a=null==(s=t.options_)?void 0:s.name)?a:r.toString(),h,null!=(l=null==(c=t.options_)?void 0:c.autoAction)&&l,null!=(u=t.options_)&&u.bound?null!=(d=e.proxy_)?d:e.target_:void 0),configurable:!o||e.isPlainObject_,enumerable:!1,writable:!o}}function ep(e,t){return{annotationType_:e,options_:t,make_:em,extend_:eg,decorate_20223_:ev}}function em(e,t,r,n){if(n===e.target_)return null===this.extend_(e,t,r,!1)?0:2;if(null!=(o=this.options_)&&o.bound&&(!U(e.target_,t)||!t4(e.target_[t]))&&null===this.extend_(e,t,r,!1))return 0;if(t4(r.value))return 1;var o,i=eb(e,this,t,r,!1,!1);return b(n,t,i),2}function eg(e,t,r,n){var o,i=eb(e,this,t,r,null==(o=this.options_)?void 0:o.bound);return e.defineProperty_(t,i,n)}function ev(e,t){var r,n=t.name,o=t.addInitializer;return t4(e)||(e=t3(e)),null!=(r=this.options_)&&r.bound&&o(function(){var e=this[n].bind(this);e.isMobXFlow=!0,this[n]=e}),e}function eb(e,t,r,n,o,i){void 0===i&&(i=tf.safeDescriptors),t.annotationType_,n.value;var a,s=n.value;return t4(s)||(s=t3(s)),o&&((s=s.bind(null!=(a=e.proxy_)?a:e.target_)).isMobXFlow=!0),{value:s,configurable:!i||e.isPlainObject_,enumerable:!1,writable:!i}}function ey(e,t){return{annotationType_:e,options_:t,make_:ew,extend_:eS,decorate_20223_:eC}}function ew(e,t,r){return null===this.extend_(e,t,r,!1)?0:1}function eS(e,t,r,n){return this.annotationType_,r.get,e.defineComputedProperty_(t,$({},this.options_,{get:r.get,set:r.set}),n)}function eC(e,t){var r=this,n=t.name;return(0,t.addInitializer)(function(){var t=rZ(this)[ee],o=$({},r.options_,{get:e,context:this});o.name||(o.name="ObservableObject."+n.toString()),t.values_.set(n,new e5(o))}),function(){return this[ee].getObservablePropValue_(n)}}function eI(e,t){return{annotationType_:e,options_:t,make_:ek,extend_:eE,decorate_20223_:e_}}function ek(e,t,r){return null===this.extend_(e,t,r,!1)?0:1}function eE(e,t,r,n){var o,i;return this.annotationType_,e.defineObservableProperty_(t,r.value,null!=(o=null==(i=this.options_)?void 0:i.enhancer)?o:ei,n)}function e_(e,t){var r=this,n=t.kind,o=t.name,i=new WeakSet;function a(e,t){var n,a,s=rZ(e)[ee],l=new e2(t,null!=(n=null==(a=r.options_)?void 0:a.enhancer)?n:ei,"ObservableObject."+o.toString(),!1);s.values_.set(o,l),i.add(e)}if("accessor"==n)return{get:function(){return i.has(this)||a(this,e.get.call(this)),this[ee].getObservablePropValue_(o)},set:function(e){return i.has(this)||a(this,e),this[ee].setObservablePropValue_(o,e)},init:function(e){return i.has(this)||a(this,e),e}}}var eA=eT();function eT(e){return{annotationType_:"true",options_:e,make_:eP,extend_:eO,decorate_20223_:eR}}function eP(e,t,r,n){if(r.get)return e$.make_(e,t,r,n);if(r.set){var o,i,a,s,l,c=eX(t.toString(),r.set);return n===e.target_?null===e.defineProperty_(t,{configurable:!tf.safeDescriptors||e.isPlainObject_,set:c})?0:2:(b(n,t,{configurable:!0,set:c}),2)}if(n!==e.target_&&"function"==typeof r.value)return R(r.value)?(null!=(s=this.options_)&&s.autoBind?t3.bound:t3).make_(e,t,r,n):(null!=(a=this.options_)&&a.autoBind?tz.bound:tz).make_(e,t,r,n);var u=(null==(o=this.options_)?void 0:o.deep)===!1?eU.ref:eU;return"function"==typeof r.value&&null!=(i=this.options_)&&i.autoBind&&(r.value=r.value.bind(null!=(l=e.proxy_)?l:e.target_)),u.make_(e,t,r,n)}function eO(e,t,r,n){var o,i,a;return r.get?e$.extend_(e,t,r,n):r.set?e.defineProperty_(t,{configurable:!tf.safeDescriptors||e.isPlainObject_,set:eX(t.toString(),r.set)},n):("function"==typeof r.value&&null!=(o=this.options_)&&o.autoBind&&(r.value=r.value.bind(null!=(a=e.proxy_)?a:e.target_)),((null==(i=this.options_)?void 0:i.deep)===!1?eU.ref:eU).extend_(e,t,r,n))}function eR(e,t){n("'"+this.annotationType_+"' cannot be used as a decorator")}var ex={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(ex);var eM=eI("observable"),eN=eI("observable.ref",{enhancer:ea}),eF=eI("observable.shallow",{enhancer:function(e,t,r){return null==e||r0(e)||rU(e)||r$(e)||rG(e)?e:Array.isArray(e)?eU.array(e,{name:r,deep:!1}):O(e)?eU.object(e,void 0,{name:r,deep:!1}):F(e)?eU.map(e,{name:r,deep:!1}):L(e)?eU.set(e,{name:r,deep:!1}):void 0}}),eL=eI("observable.struct",{enhancer:function(e,t){return no(e,t)?t:e}}),ez=Z(eM);function eD(e){var t,r,n;return!0===e.deep?ei:!1===e.deep?ea:(t=e.defaultDecorator)&&null!=(r=null==(n=t.options_)?void 0:n.enhancer)?r:ei}function eB(e,t,r){if(J(t))return eM.decorate_20223_(e,t);if(T(t)){Q(e,t,eM);return}return rr(e)?e:O(e)?eU.object(e,t,r):Array.isArray(e)?eU.array(e,t):F(e)?eU.map(e,t):L(e)?eU.set(e,t):"object"==typeof e&&null!==e?e:eU.box(e,t)}g(eB,ez);var eU=g(eB,{box:function(e,t){var r=t||ex;return new e2(e,eD(r),r.name,!0,r.equals)},array:function(e,t){var r=t||ex;return(!1===tf.useProxies||!1===r.proxy?function(e,t,r){return new r4(e,t,r)}:function(e,t,r,n){return void 0===r&&(r="ObservableArray"),void 0===n&&(n=!1),k(),nr(function(){var o=new rM(r,t,n,!1);M(o.values_,ee,o);var i=new Proxy(o.values_,rx);return o.proxy_=i,e&&e.length&&o.spliceWithArray_(0,0,e),i})})(e,eD(r),r.name)},map:function(e,t){var r=t||ex;return new rj(e,eD(r),r.name)},set:function(e,t){var r=t||ex;return new rV(e,eD(r),r.name)},object:function(e,t,r){return nr(function(){var n,o,i;return tX(!1===tf.useProxies||(null==r?void 0:r.proxy)===!1?rZ({},r):(n={},k(),null!=(i=(o=(n=rZ(n,r))[ee]).proxy_)?i:o.proxy_=new Proxy(n,rw)),e,t)})},ref:Z(eN),shallow:Z(eF),deep:ez,struct:Z(eL)}),eH="computed",eq=ey(eH),ej=ey("computed.struct",{equals:eo.structural}),e$=function(e,t){if(J(t))return eq.decorate_20223_(e,t);if(T(t))return Q(e,t,eq);if(O(e))return Z(ey(eH,e));var r=O(t)?t:{};return r.get=e,r.name||(r.name=e.name||""),new e5(r)};Object.assign(e$,eq),e$.struct=Z(ej);var eW=0,eV=1,eG=null!=(o=null==(i=v(function(){},"name"))?void 0:i.configurable)&&o,eK={value:"action",configurable:!0,writable:!1,enumerable:!1};function eX(e,t,r,n){function o(){return eY(e,r,t,n||this,arguments)}return void 0===r&&(r=!1),o.isMobxAction=!0,o.toString=function(){return t.toString()},eG&&(eK.value=e,b(o,"name",eK)),o}function eY(e,t,r,n,o){var i=eZ(e,t,n,o);try{return r.apply(n,o)}catch(e){throw i.error_=e,e}finally{eQ(i)}}function eZ(e,t,r,n){var o=tf.trackingDerivation,i=!t||!o;tv();var a=tf.allowStateChanges;i&&(tn(),a=e0(!0));var s={runAsAction_:i,prevDerivation_:o,prevAllowStateChanges_:a,prevAllowStateReads_:ti(!0),notifySpy_:!1,startTime_:0,actionId_:eV++,parentActionId_:eW};return eW=s.actionId_,s}function eQ(e){eW!==e.actionId_&&n(30),eW=e.parentActionId_,void 0!==e.error_&&(tf.suppressReactionErrors=!0),e1(e.prevAllowStateChanges_),ta(e.prevAllowStateReads_),tb(),e.runAsAction_&&to(e.prevDerivation_),tf.suppressReactionErrors=!1}function eJ(e,t){var r=e0(e);try{return t()}finally{e1(r)}}function e0(e){var t=tf.allowStateChanges;return tf.allowStateChanges=e,t}function e1(e){tf.allowStateChanges=e}a=Symbol.toPrimitive;var e2=function(e){function t(t,r,n,o,i){var a;return void 0===n&&(n="ObservableValue"),void 0===o&&(o=!0),void 0===i&&(i=eo.default),(a=e.call(this,n)||this).enhancer=void 0,a.name_=void 0,a.equals=void 0,a.hasUnreportedChange_=!1,a.interceptors_=void 0,a.changeListeners_=void 0,a.value_=void 0,a.dehancer=void 0,a.enhancer=r,a.name_=n,a.equals=i,a.value_=r(t,void 0,n),a}W(t,e);var r=t.prototype;return r.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},r.set=function(e){this.value_,(e=this.prepareNewValue_(e))!==tf.UNCHANGED&&this.setNewValue_(e)},r.prepareNewValue_=function(e){if(rS(this)){var t=rI(this,{object:this,type:rR,newValue:e});if(!t)return tf.UNCHANGED;e=t.newValue}return e=this.enhancer(e,this.value_,this.name_),this.equals(this.value_,e)?tf.UNCHANGED:e},r.setNewValue_=function(e){var t=this.value_;this.value_=e,this.reportChanged(),rk(this)&&r_(this,{type:rR,object:this,newValue:e,oldValue:t})},r.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},r.intercept_=function(e){return rC(this,e)},r.observe_=function(e,t){return t&&e({observableKind:"value",debugObjectName:this.name_,object:this,type:rR,newValue:this.value_,oldValue:void 0}),rE(this,e)},r.raw=function(){return this.value_},r.toJSON=function(){return this.get()},r.toString=function(){return this.name_+"["+this.value_+"]"},r.valueOf=function(){return B(this.get())},r[a]=function(){return this.valueOf()},t}(et),e3=N("ObservableValue",e2);s=Symbol.toPrimitive;var e5=function(){function e(e){this.dependenciesState_=l.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.isBeingObserved_=!1,this.isPendingUnobservation_=!1,this.observers_=new Set,this.diffValue_=0,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=l.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new e4(null),this.name_=void 0,this.triggeredBy_=void 0,this.isComputing_=!1,this.isRunningSetter_=!1,this.derivation=void 0,this.setter_=void 0,this.isTracing_=c.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,e.get||n(31),this.derivation=e.get,this.name_=e.name||"ComputedValue",e.set&&(this.setter_=eX("ComputedValue-setter",e.set)),this.equals_=e.equals||(e.compareStructural||e.struct?eo.structural:eo.default),this.scope_=e.context,this.requiresReaction_=e.requiresReaction,this.keepAlive_=!!e.keepAlive}var t=e.prototype;return t.onBecomeStale_=function(){this.lowestObserverState_===l.UP_TO_DATE_&&(this.lowestObserverState_=l.POSSIBLY_STALE_,this.observers_.forEach(function(e){e.dependenciesState_===l.UP_TO_DATE_&&(e.dependenciesState_=l.POSSIBLY_STALE_,e.onBecomeStale_())}))},t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(e){return e()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(e){return e()})},t.get=function(){if(this.isComputing_&&n(32,this.name_,this.derivation),0!==tf.inBatch||0!==this.observers_.size||this.keepAlive_){if(ty(this),e9(this)){var e,t=tf.trackingContext;this.keepAlive_&&!t&&(tf.trackingContext=this),this.trackAndCompute()&&(e=this,e.lowestObserverState_!==l.STALE_&&(e.lowestObserverState_=l.STALE_,e.observers_.forEach(function(t){t.dependenciesState_===l.POSSIBLY_STALE_?t.dependenciesState_=l.STALE_:t.dependenciesState_===l.UP_TO_DATE_&&(e.lowestObserverState_=l.UP_TO_DATE_)}))),tf.trackingContext=t}}else e9(this)&&(this.warnAboutUntrackedRead_(),tv(),this.value_=this.computeValue_(!1),tb());var r=this.value_;if(e8(r))throw r.cause;return r},t.set=function(e){if(this.setter_){this.isRunningSetter_&&n(33,this.name_),this.isRunningSetter_=!0;try{this.setter_.call(this.scope_,e)}finally{this.isRunningSetter_=!1}}else n(34,this.name_)},t.trackAndCompute=function(){var e=this.value_,t=this.dependenciesState_===l.NOT_TRACKING_,r=this.computeValue_(!0),n=t||e8(e)||e8(r)||!this.equals_(e,r);return n&&(this.value_=r),n},t.computeValue_=function(e){this.isComputing_=!0;var t,r=e0(!1);if(e)t=te(this,this.derivation,this.scope_);else if(!0===tf.disableErrorBoundaries)t=this.derivation.call(this.scope_);else try{t=this.derivation.call(this.scope_)}catch(e){t=new e4(e)}return e1(r),this.isComputing_=!1,t},t.suspend_=function(){this.keepAlive_||(tt(this),this.value_=void 0)},t.observe_=function(e,t){var r=this,n=!0,o=void 0;return tU(function(){var i=r.get();if(!n||t){var a=tn();e({observableKind:"computed",debugObjectName:r.name_,type:rR,object:r,newValue:i,oldValue:o}),to(a)}n=!1,o=i})},t.warnAboutUntrackedRead_=function(){},t.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},t.valueOf=function(){return B(this.get())},t[s]=function(){return this.valueOf()},e}(),e6=N("ComputedValue",e5);(function(e){e[e.NOT_TRACKING_=-1]="NOT_TRACKING_",e[e.UP_TO_DATE_=0]="UP_TO_DATE_",e[e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",e[e.STALE_=2]="STALE_"})(l||(l={})),function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"}(c||(c={}));var e4=function(e){this.cause=void 0,this.cause=e};function e8(e){return e instanceof e4}function e9(e){switch(e.dependenciesState_){case l.UP_TO_DATE_:return!1;case l.NOT_TRACKING_:case l.STALE_:return!0;case l.POSSIBLY_STALE_:for(var t=ti(!0),r=tn(),n=e.observing_,o=n.length,i=0;i<o;i++){var a=n[i];if(e6(a)){if(tf.disableErrorBoundaries)a.get();else try{a.get()}catch(e){return to(r),ta(t),!0}if(e.dependenciesState_===l.STALE_)return to(r),ta(t),!0}}return ts(e),to(r),ta(t),!1}}function e7(){return null!==tf.trackingDerivation}function te(e,t,r){var n,o=ti(!0);ts(e),e.newObserving_=Array(e.observing_.length+100),e.unboundDepsCount_=0,e.runId_=++tf.runId;var i=tf.trackingDerivation;if(tf.trackingDerivation=e,tf.inBatch++,!0===tf.disableErrorBoundaries)n=t.call(r);else try{n=t.call(r)}catch(e){n=new e4(e)}return tf.inBatch--,tf.trackingDerivation=i,function(e){for(var t=e.observing_,r=e.observing_=e.newObserving_,n=l.UP_TO_DATE_,o=0,i=e.unboundDepsCount_,a=0;a<i;a++){var s=r[a];0===s.diffValue_&&(s.diffValue_=1,o!==a&&(r[o]=s),o++),s.dependenciesState_>n&&(n=s.dependenciesState_)}for(r.length=o,e.newObserving_=null,i=t.length;i--;){var c=t[i];0===c.diffValue_&&tm(c,e),c.diffValue_=0}for(;o--;){var u=r[o];1===u.diffValue_&&(u.diffValue_=0,u.observers_.add(e),u.lowestObserverState_>e.dependenciesState_&&(u.lowestObserverState_=e.dependenciesState_))}n!==l.UP_TO_DATE_&&(e.dependenciesState_=n,e.onBecomeStale_())}(e),ta(o),n}function tt(e){var t=e.observing_;e.observing_=[];for(var r=t.length;r--;)tm(t[r],e);e.dependenciesState_=l.NOT_TRACKING_}function tr(e){var t=tn();try{return e()}finally{to(t)}}function tn(){var e=tf.trackingDerivation;return tf.trackingDerivation=null,e}function to(e){tf.trackingDerivation=e}function ti(e){var t=tf.allowStateReads;return tf.allowStateReads=e,t}function ta(e){tf.allowStateReads=e}function ts(e){if(e.dependenciesState_!==l.UP_TO_DATE_){e.dependenciesState_=l.UP_TO_DATE_;for(var t=e.observing_,r=t.length;r--;)t[r].lowestObserverState_=l.UP_TO_DATE_}}var tl=["mobxGuid","spyListeners","enforceActions","computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","allowStateReads","disableErrorBoundaries","runId","UNCHANGED","useProxies"],tc=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},tu=!0,td=!1,tf=function(){var e=m();return(e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(tu=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==new tc().version&&(tu=!1),tu)?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new tc):(setTimeout(function(){td||n(35)},1),new tc)}();function th(){return tf}function tp(){var e=new tc;for(var t in e)-1===tl.indexOf(t)&&(tf[t]=e[t]);tf.allowStateChanges=!tf.enforceActions}function tm(e,t){e.observers_.delete(t),0===e.observers_.size&&tg(e)}function tg(e){!1===e.isPendingUnobservation_&&(e.isPendingUnobservation_=!0,tf.pendingUnobservations.push(e))}function tv(){tf.inBatch++}function tb(){if(0==--tf.inBatch){tk();for(var e=tf.pendingUnobservations,t=0;t<e.length;t++){var r=e[t];r.isPendingUnobservation_=!1,0===r.observers_.size&&(r.isBeingObserved_&&(r.isBeingObserved_=!1,r.onBUO()),r instanceof e5&&r.suspend_())}tf.pendingUnobservations=[]}}function ty(e){var t=tf.trackingDerivation;return null!==t?(t.runId_!==e.lastAccessedBy_&&(e.lastAccessedBy_=t.runId_,t.newObserving_[t.unboundDepsCount_++]=e,!e.isBeingObserved_&&tf.trackingContext&&(e.isBeingObserved_=!0,e.onBO())),e.isBeingObserved_):(0===e.observers_.size&&tf.inBatch>0&&tg(e),!1)}function tw(e){e.lowestObserverState_!==l.STALE_&&(e.lowestObserverState_=l.STALE_,e.observers_.forEach(function(e){e.dependenciesState_===l.UP_TO_DATE_&&e.onBecomeStale_(),e.dependenciesState_=l.STALE_}))}var tS=function(){function e(e,t,r,n){void 0===e&&(e="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=l.NOT_TRACKING_,this.diffValue_=0,this.runId_=0,this.unboundDepsCount_=0,this.isDisposed_=!1,this.isScheduled_=!1,this.isTrackPending_=!1,this.isRunning_=!1,this.isTracing_=c.NONE,this.name_=e,this.onInvalidate_=t,this.errorHandler_=r,this.requiresObservable_=n}var t=e.prototype;return t.onBecomeStale_=function(){this.schedule_()},t.schedule_=function(){this.isScheduled_||(this.isScheduled_=!0,tf.pendingReactions.push(this),tk())},t.isScheduled=function(){return this.isScheduled_},t.runReaction_=function(){if(!this.isDisposed_){tv(),this.isScheduled_=!1;var e=tf.trackingContext;if(tf.trackingContext=this,e9(this)){this.isTrackPending_=!0;try{this.onInvalidate_()}catch(e){this.reportExceptionInDerivation_(e)}}tf.trackingContext=e,tb()}},t.track=function(e){if(!this.isDisposed_){tv(),this.isRunning_=!0;var t=tf.trackingContext;tf.trackingContext=this;var r=te(this,e,void 0);tf.trackingContext=t,this.isRunning_=!1,this.isTrackPending_=!1,this.isDisposed_&&tt(this),e8(r)&&this.reportExceptionInDerivation_(r.cause),tb()}},t.reportExceptionInDerivation_=function(e){var t=this;if(this.errorHandler_){this.errorHandler_(e,this);return}if(tf.disableErrorBoundaries)throw e;tf.suppressReactionErrors,tf.globalReactionErrorHandlers.forEach(function(r){return r(e,t)})},t.dispose=function(){this.isDisposed_||(this.isDisposed_=!0,this.isRunning_||(tv(),tt(this),tb()))},t.getDisposer_=function(e){var t=this,r=function r(){t.dispose(),null==e||null==e.removeEventListener||e.removeEventListener("abort",r)};return null==e||null==e.addEventListener||e.addEventListener("abort",r),r[ee]=this,r},t.toString=function(){return"Reaction["+this.name_+"]"},t.trace=function(e){void 0===e&&(e=!1)},e}();function tC(e){return tf.globalReactionErrorHandlers.push(e),function(){var t=tf.globalReactionErrorHandlers.indexOf(e);t>=0&&tf.globalReactionErrorHandlers.splice(t,1)}}var tI=function(e){return e()};function tk(){tf.inBatch>0||tf.isRunningReactions||tI(tE)}function tE(){tf.isRunningReactions=!0;for(var e=tf.pendingReactions,t=0;e.length>0;){100==++t&&e.splice(0);for(var r=e.splice(0),n=0,o=r.length;n<o;n++)r[n].runReaction_()}tf.isRunningReactions=!1}var t_=N("Reaction",tS);function tA(e){return function(){}}var tT="action",tP="autoAction",tO="<unnamed action>",tR=ec(tT),tx=ec("action.bound",{bound:!0}),tM=ec(tP,{autoAction:!0}),tN=ec("autoAction.bound",{autoAction:!0,bound:!0});function tF(e){return function(t,r){return A(t)?eX(t.name||tO,t,e):A(r)?eX(t,r,e):J(r)?(e?tM:tR).decorate_20223_(t,r):T(r)?Q(t,r,e?tM:tR):T(t)?Z(ec(e?tP:tT,{name:t,autoAction:e})):void 0}}var tL=tF(!1);Object.assign(tL,tR);var tz=tF(!0);function tD(e){return eY(e.name||tO,!1,e,this,void 0)}function tB(e){return A(e)&&!0===e.isMobxAction}function tU(e,t){void 0===t&&(t=S);var r,n,o,i,a,s,l=null!=(r=null==(n=t)?void 0:n.name)?r:"Autorun";if(t.scheduler||t.delay){var c=tq(t),u=!1;s=new tS(l,function(){u||(u=!0,c(function(){u=!1,s.isDisposed_||s.track(d)}))},t.onError,t.requiresObservable)}else s=new tS(l,function(){this.track(d)},t.onError,t.requiresObservable);function d(){e(s)}return null!=(o=t)&&null!=(i=o.signal)&&i.aborted||s.schedule_(),s.getDisposer_(null==(a=t)?void 0:a.signal)}Object.assign(tz,tM),tL.bound=Z(tx),tz.bound=Z(tN);var tH=function(e){return e()};function tq(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:tH}function tj(e,t,r){void 0===r&&(r=S);var n,o,i,a,s,l,c,u=null!=(o=r.name)?o:"Reaction",d=tL(u,r.onError?(n=r.onError,function(){try{return t.apply(this,arguments)}catch(e){n.call(this,e)}}):t),f=!r.scheduler&&!r.delay,h=tq(r),p=!0,m=!1,g=r.compareStructural?eo.structural:r.equals||eo.default,v=new tS(u,function(){p||f?b():m||(m=!0,h(b))},r.onError,r.requiresObservable);function b(){if(m=!1,!v.isDisposed_){var t=!1;v.track(function(){var r=eJ(!1,function(){return e(v)});t=p||!g(l,r),c=l,l=r}),p&&r.fireImmediately?d(l,c,v):!p&&t&&d(l,c,v),p=!1}}return null!=(i=r)&&null!=(a=i.signal)&&a.aborted||v.schedule_(),v.getDisposer_(null==(s=r)?void 0:s.signal)}function t$(e,t,r){return tV("onBO",e,t,r)}function tW(e,t,r){return tV("onBUO",e,t,r)}function tV(e,t,r,n){var o="function"==typeof n?r7(t,r):r7(t),i=A(n)?n:r,a=e+"L";return o[a]?o[a].add(i):o[a]=new Set([i]),function(){var e=o[a];e&&(e.delete(i),0===e.size&&delete o[a])}}var tG="always";function tK(e){!0===e.isolateGlobalState&&function(){if((tf.pendingReactions.length||tf.inBatch||tf.isRunningReactions)&&n(36),td=!0,tu){var e=m();0==--e.__mobxInstanceCount&&(e.__mobxGlobals=void 0),tf=new tc}}();var t,r,o=e.useProxies,i=e.enforceActions;if(void 0!==o&&(tf.useProxies=o===tG||"never"!==o&&"undefined"!=typeof Proxy),"ifavailable"===o&&(tf.verifyProxies=!0),void 0!==i){var a=i===tG?tG:"observed"===i;tf.enforceActions=a,tf.allowStateChanges=!0!==a&&a!==tG}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(t){t in e&&(tf[t]=!!e[t])}),tf.allowStateReads=!tf.observableRequiresReaction,e.reactionScheduler&&(t=e.reactionScheduler,r=tI,tI=function(e){return t(function(){return r(e)})})}function tX(e,t,r,n){var o=H(t);return nr(function(){var t=rZ(e,n)[ee];D(o).forEach(function(e){t.extend_(e,o[e],!r||!(e in r)||r[e])})}),e}function tY(e,t){return function e(t){var r={name:t.name_};return t.observing_&&t.observing_.length>0&&(r.dependencies=Array.from(new Set(t.observing_)).map(e)),r}(r7(e,t))}function tZ(e,t){return function e(t){var r={name:t.name_};return t.observers_&&t.observers_.size>0&&(r.observers=Array.from(t.observers_).map(e)),r}(r7(e,t))}var tQ=0;function tJ(){this.message="FLOW_CANCELLED"}function t0(e){return e instanceof tJ}tJ.prototype=Object.create(Error.prototype);var t1=ep("flow"),t2=ep("flow.bound",{bound:!0}),t3=Object.assign(function(e,t){if(J(t))return t1.decorate_20223_(e,t);if(T(t))return Q(e,t,t1);var r=e.name||"<unnamed flow>",n=function(){var t,n=arguments,o=++tQ,i=tL(r+" - runid: "+o+" - init",e).apply(this,n),a=void 0,s=new Promise(function(e,n){var s=0;function l(e){var t;a=void 0;try{t=tL(r+" - runid: "+o+" - yield "+s++,i.next).call(i,e)}catch(e){return n(e)}u(t)}function c(e){var t;a=void 0;try{t=tL(r+" - runid: "+o+" - yield "+s++,i.throw).call(i,e)}catch(e){return n(e)}u(t)}function u(t){if(A(null==t?void 0:t.then)){t.then(u,n);return}return t.done?e(t.value):(a=Promise.resolve(t.value)).then(l,c)}t=n,l(void 0)});return s.cancel=tL(r+" - runid: "+o+" - cancel",function(){try{a&&t5(a);var e=i.return(void 0),r=Promise.resolve(e.value);r.then(_,_),t5(r),t(new tJ)}catch(e){t(e)}}),s};return n.isMobXFlow=!0,n},t1);function t5(e){A(e.cancel)&&e.cancel()}function t6(e){return e}function t4(e){return(null==e?void 0:e.isMobXFlow)===!0}function t8(e,t,r){var n;return r$(e)||rU(e)||e3(e)?n=ne(e):r0(e)&&(n=ne(e,t)),n.dehancer="function"==typeof t?t:r,function(){n.dehancer=void 0}}function t9(e,t,r){return A(r)?ne(e,t).intercept_(r):ne(e).intercept_(t)}function t7(e,t){return void 0===t?e6(e):!!(!1!==r0(e)&&e[ee].values_.has(t))&&e6(r7(e,t))}function re(e){return t7(e)}function rt(e,t){return t7(e,t)}function rr(e,t){return!!e&&(void 0!==t?!!r0(e)&&e[ee].values_.has(t):r0(e)||!!e[ee]||er(e)||t_(e)||e6(e))}function rn(e){return rr(e)}function ro(e,t){return rr(e,t)}function ri(e){return r0(e)?e[ee].keys_():r$(e)||rG(e)?Array.from(e.keys()):rU(e)?e.map(function(e,t){return t}):void n(5)}function ra(e){return r0(e)?ri(e).map(function(t){return e[t]}):r$(e)?ri(e).map(function(t){return e.get(t)}):rG(e)?Array.from(e.values()):rU(e)?e.slice():void n(6)}function rs(e){return r0(e)?ri(e).map(function(t){return[t,e[t]]}):r$(e)?ri(e).map(function(t){return[t,e.get(t)]}):rG(e)?Array.from(e.entries()):rU(e)?e.map(function(e,t){return[t,e]}):void n(7)}function rl(e,t){r0(e)?e[ee].delete_(t):r$(e)?e.delete(t):rG(e)?e.delete(t):rU(e)?("number"!=typeof t&&(t=parseInt(t,10)),e.splice(t,1)):n(9)}function rc(e,t){return r0(e)?e[ee].has_(t):r$(e)?e.has(t):rG(e)?e.has(t):rU(e)?t>=0&&t<e.length:void n(10)}function ru(e,t){if(rc(e,t)){if(r0(e))return e[ee].get_(t);if(r$(e))return e.get(t);if(rU(e))return e[t];n(11)}}function rd(e,t,r){if(r0(e))return e[ee].defineProperty_(t,r);n(39)}function rf(e){if(r0(e))return e[ee].ownKeys_();n(38)}function rh(e,t,r,n){return A(r)?ne(e,t).observe_(r,n):ne(e).observe_(t,r)}function rp(e,t,r){return e.set(t,r),r}function rm(e,t){return function e(t,r){if(null==t||"object"!=typeof t||t instanceof Date||!rr(t))return t;if(e3(t)||e6(t))return e(t.get(),r);if(r.has(t))return r.get(t);if(rU(t)){var n=rp(r,t,Array(t.length));return t.forEach(function(t,o){n[o]=e(t,r)}),n}if(rG(t)){var o=rp(r,t,new Set);return t.forEach(function(t){o.add(e(t,r))}),o}if(r$(t)){var i=rp(r,t,new Map);return t.forEach(function(t,n){i.set(n,e(t,r))}),i}var a=rp(r,t,{});return rf(t).forEach(function(n){y.propertyIsEnumerable.call(t,n)&&(a[n]=e(t[n],r))}),a}(e,new Map)}function rg(){}function rv(e,t){void 0===t&&(t=void 0),tv();try{return e.apply(t)}finally{tb()}}function rb(e,t,r){return 1==arguments.length||t&&"object"==typeof t?function(e,t){if(null!=t&&null!=(r=t.signal)&&r.aborted)return Object.assign(Promise.reject(Error("WHEN_ABORTED")),{cancel:function(){return null}});var r,n,o,i=new Promise(function(r,i){var a,s=ry(e,r,$({},t,{onError:i}));n=function(){s(),i(Error("WHEN_CANCELLED"))},o=function(){s(),i(Error("WHEN_ABORTED"))},null==t||null==(a=t.signal)||null==a.addEventListener||a.addEventListener("abort",o)}).finally(function(){var e;return null==t?void 0:null==(e=t.signal)?void 0:null==e.removeEventListener?void 0:e.removeEventListener("abort",o)});return i.cancel=n,i}(e,t):ry(e,t,r||{})}function ry(e,t,r){if("number"==typeof r.timeout){var n,o=Error("WHEN_TIMEOUT");n=setTimeout(function(){if(!a[ee].isDisposed_){if(a(),r.onError)r.onError(o);else throw o}},r.timeout)}r.name="When";var i=eX("When-effect",t),a=tU(function(t){eJ(!1,e)&&(t.dispose(),n&&clearTimeout(n),i())},r);return a}t3.bound=Z(t2);var rw={has:function(e,t){return e[ee].has_(t)},get:function(e,t){return e[ee].get_(t)},set:function(e,t,r){var n;return!!T(t)&&(null==(n=e[ee].set_(t,r,!0))||n)},deleteProperty:function(e,t){var r;return!!T(t)&&(null==(r=e[ee].delete_(t,!0))||r)},defineProperty:function(e,t,r){var n;return null==(n=e[ee].defineProperty_(t,r))||n},ownKeys:function(e){return e[ee].ownKeys_()},preventExtensions:function(e){n(13)}};function rS(e){return void 0!==e.interceptors_&&e.interceptors_.length>0}function rC(e,t){var r=e.interceptors_||(e.interceptors_=[]);return r.push(t),E(function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)})}function rI(e,t){var r=tn();try{for(var o=[].concat(e.interceptors_||[]),i=0,a=o.length;i<a&&((t=o[i](t))&&!t.type&&n(14),t);i++);return t}finally{to(r)}}function rk(e){return void 0!==e.changeListeners_&&e.changeListeners_.length>0}function rE(e,t){var r=e.changeListeners_||(e.changeListeners_=[]);return r.push(t),E(function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)})}function r_(e,t){var r=tn(),n=e.changeListeners_;if(n){n=n.slice();for(var o=0,i=n.length;o<i;o++)n[o](t);to(r)}}function rA(e,t,r){return nr(function(){var n=rZ(e,r)[ee];null!=t||(U(e,Y)||x(e,Y,$({},e[Y])),t=e[Y]),D(t).forEach(function(e){return n.make_(e,t[e])})}),e}var rT=Symbol("mobx-keys");function rP(e,t,r){return O(e)?tX(e,e,t,r):(nr(function(){var n=rZ(e,r)[ee];if(!e[rT]){var o=Object.getPrototypeOf(e),i=new Set([].concat(D(e),D(o)));i.delete("constructor"),i.delete(ee),x(o,rT,i)}e[rT].forEach(function(e){return n.make_(e,!t||!(e in t)||t[e])})}),e)}var rO="splice",rR="update",rx={get:function(e,t){var r=e[ee];return t===ee?r:"length"===t?r.getArrayLength_():"string"!=typeof t||isNaN(t)?U(rN,t)?rN[t]:e[t]:r.get_(parseInt(t))},set:function(e,t,r){var n=e[ee];return"length"===t&&n.setArrayLength_(r),"symbol"==typeof t||isNaN(t)?e[t]=r:n.set_(parseInt(t),r),!0},preventExtensions:function(){n(15)}},rM=function(){function e(e,t,r,n){void 0===e&&(e="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=r,this.legacyMode_=n,this.atom_=new et(e),this.enhancer_=function(e,r){return t(e,r,"ObservableArray[..]")}}var t=e.prototype;return t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.dehanceValues_=function(e){return void 0!==this.dehancer&&e.length>0?e.map(this.dehancer):e},t.intercept_=function(e){return rC(this,e)},t.observe_=function(e,t){return void 0===t&&(t=!1),t&&e({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),rE(this,e)},t.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},t.setArrayLength_=function(e){("number"!=typeof e||isNaN(e)||e<0)&&n("Out of range: "+e);var t=this.values_.length;if(e!==t){if(e>t){for(var r=Array(e-t),o=0;o<e-t;o++)r[o]=void 0;this.spliceWithArray_(t,0,r)}else this.spliceWithArray_(e,t-e)}},t.updateArrayLength_=function(e,t){e!==this.lastKnownLength_&&n(16),this.lastKnownLength_+=t,this.legacyMode_&&t>0&&r9(e+t+1)},t.spliceWithArray_=function(e,t,r){var n=this;this.atom_;var o=this.values_.length;if(void 0===e?e=0:e>o?e=o:e<0&&(e=Math.max(0,o+e)),t=1==arguments.length?o-e:null==t?0:Math.max(0,Math.min(t,o-e)),void 0===r&&(r=w),rS(this)){var i=rI(this,{object:this.proxy_,type:rO,index:e,removedCount:t,added:r});if(!i)return w;t=i.removedCount,r=i.added}if(r=0===r.length?r:r.map(function(e){return n.enhancer_(e,void 0)}),this.legacyMode_){var a=r.length-t;this.updateArrayLength_(o,a)}var s=this.spliceItemsIntoValues_(e,t,r);return(0!==t||0!==r.length)&&this.notifyArraySplice_(e,r,s),this.dehanceValues_(s)},t.spliceItemsIntoValues_=function(e,t,r){if(r.length<1e4){var n;return(n=this.values_).splice.apply(n,[e,t].concat(r))}var o=this.values_.slice(e,e+t),i=this.values_.slice(e+t);this.values_.length+=r.length-t;for(var a=0;a<r.length;a++)this.values_[e+a]=r[a];for(var s=0;s<i.length;s++)this.values_[e+r.length+s]=i[s];return o},t.notifyArrayChildUpdate_=function(e,t,r){var n=!this.owned_&&!1,o=rk(this),i=o||n?{observableKind:"array",object:this.proxy_,type:rR,debugObjectName:this.atom_.name_,index:e,newValue:t,oldValue:r}:null;this.atom_.reportChanged(),o&&r_(this,i)},t.notifyArraySplice_=function(e,t,r){var n=!this.owned_&&!1,o=rk(this),i=o||n?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:rO,index:e,removed:r,added:t,removedCount:r.length,addedCount:t.length}:null;this.atom_.reportChanged(),o&&r_(this,i)},t.get_=function(e){if(!this.legacyMode_||!(e>=this.values_.length))return this.atom_.reportObserved(),this.dehanceValue_(this.values_[e])},t.set_=function(e,t){var r=this.values_;if(this.legacyMode_&&e>r.length&&n(17,e,r.length),e<r.length){this.atom_;var o=r[e];if(rS(this)){var i=rI(this,{type:rR,object:this.proxy_,index:e,newValue:t});if(!i)return;t=i.newValue}(t=this.enhancer_(t,o))!==o&&(r[e]=t,this.notifyArrayChildUpdate_(e,t,o))}else{for(var a=Array(e+1-r.length),s=0;s<a.length-1;s++)a[s]=void 0;a[a.length-1]=t,this.spliceWithArray_(r.length,0,a)}},e}(),rN={clear:function(){return this.splice(0)},replace:function(e){var t=this[ee];return t.spliceWithArray_(0,t.values_.length,e)},toJSON:function(){return this.slice()},splice:function(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];var i=this[ee];switch(arguments.length){case 0:return[];case 1:return i.spliceWithArray_(e);case 2:return i.spliceWithArray_(e,t)}return i.spliceWithArray_(e,t,n)},spliceWithArray:function(e,t,r){return this[ee].spliceWithArray_(e,t,r)},push:function(){for(var e=this[ee],t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.spliceWithArray_(e.values_.length,0,r),e.values_.length},pop:function(){return this.splice(Math.max(this[ee].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=this[ee],t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.spliceWithArray_(0,0,r),e.values_.length},reverse:function(){return tf.trackingDerivation&&n(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){tf.trackingDerivation&&n(37,"sort");var e=this.slice();return e.sort.apply(e,arguments),this.replace(e),this},remove:function(e){var t=this[ee],r=t.dehanceValues_(t.values_).indexOf(e);return r>-1&&(this.splice(r,1),!0)}};function rF(e,t){"function"==typeof Array.prototype[e]&&(rN[e]=t(e))}function rL(e){return function(){var t=this[ee];t.atom_.reportObserved();var r=t.dehanceValues_(t.values_);return r[e].apply(r,arguments)}}function rz(e){return function(t,r){var n=this,o=this[ee];return o.atom_.reportObserved(),o.dehanceValues_(o.values_)[e](function(e,o){return t.call(r,e,o,n)})}}function rD(e){return function(){var t=this,r=this[ee];r.atom_.reportObserved();var n=r.dehanceValues_(r.values_),o=arguments[0];return arguments[0]=function(e,r,n){return o(e,r,n,t)},n[e].apply(n,arguments)}}rF("at",rL),rF("concat",rL),rF("flat",rL),rF("includes",rL),rF("indexOf",rL),rF("join",rL),rF("lastIndexOf",rL),rF("slice",rL),rF("toString",rL),rF("toLocaleString",rL),rF("toSorted",rL),rF("toSpliced",rL),rF("with",rL),rF("every",rz),rF("filter",rz),rF("find",rz),rF("findIndex",rz),rF("findLast",rz),rF("findLastIndex",rz),rF("flatMap",rz),rF("forEach",rz),rF("map",rz),rF("some",rz),rF("toReversed",rz),rF("reduce",rD),rF("reduceRight",rD);var rB=N("ObservableArrayAdministration",rM);function rU(e){return P(e)&&rB(e[ee])}var rH={},rq="delete";u=Symbol.iterator,d=Symbol.toStringTag;var rj=function(){function e(e,t,r){var o=this;void 0===t&&(t=ei),void 0===r&&(r="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[ee]=rH,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=t,this.name_=r,A(Map)||n(18),nr(function(){o.keysAtom_=en("ObservableMap.keys()"),o.data_=new Map,o.hasMap_=new Map,e&&o.merge(e)})}var t=e.prototype;return t.has_=function(e){return this.data_.has(e)},t.has=function(e){var t=this;if(!tf.trackingDerivation)return this.has_(e);var r=this.hasMap_.get(e);if(!r){var n=r=new e2(this.has_(e),ea,"ObservableMap.key?",!1);this.hasMap_.set(e,n),tW(n,function(){return t.hasMap_.delete(e)})}return r.get()},t.set=function(e,t){var r=this.has_(e);if(rS(this)){var n=rI(this,{type:r?rR:"add",object:this,newValue:t,name:e});if(!n)return this;t=n.newValue}return r?this.updateValue_(e,t):this.addValue_(e,t),this},t.delete=function(e){var t=this;if(this.keysAtom_,rS(this)&&!rI(this,{type:rq,object:this,name:e}))return!1;if(this.has_(e)){var r=rk(this),n=r?{observableKind:"map",debugObjectName:this.name_,type:rq,object:this,oldValue:this.data_.get(e).value_,name:e}:null;return rv(function(){var r;t.keysAtom_.reportChanged(),null==(r=t.hasMap_.get(e))||r.setNewValue_(!1),t.data_.get(e).setNewValue_(void 0),t.data_.delete(e)}),r&&r_(this,n),!0}return!1},t.updateValue_=function(e,t){var r=this.data_.get(e);if((t=r.prepareNewValue_(t))!==tf.UNCHANGED){var n=rk(this),o=n?{observableKind:"map",debugObjectName:this.name_,type:rR,object:this,oldValue:r.value_,name:e,newValue:t}:null;r.setNewValue_(t),n&&r_(this,o)}},t.addValue_=function(e,t){var r=this;this.keysAtom_,rv(function(){var n,o=new e2(t,r.enhancer_,"ObservableMap.key",!1);r.data_.set(e,o),t=o.value_,null==(n=r.hasMap_.get(e))||n.setNewValue_(!0),r.keysAtom_.reportChanged()});var n=rk(this),o=n?{observableKind:"map",debugObjectName:this.name_,type:"add",object:this,name:e,newValue:t}:null;n&&r_(this,o)},t.get=function(e){return this.has(e)?this.dehanceValue_(this.data_.get(e).get()):this.dehanceValue_(void 0)},t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},t.values=function(){var e=this,t=this.keys();return na({next:function(){var r=t.next(),n=r.done,o=r.value;return{done:n,value:n?void 0:e.get(o)}}})},t.entries=function(){var e=this,t=this.keys();return na({next:function(){var r=t.next(),n=r.done,o=r.value;return{done:n,value:n?void 0:[o,e.get(o)]}}})},t[u]=function(){return this.entries()},t.forEach=function(e,t){for(var r,n=X(this);!(r=n()).done;){var o=r.value,i=o[0],a=o[1];e.call(t,a,i,this)}},t.merge=function(e){var t=this;return r$(e)&&(e=new Map(e)),rv(function(){O(e)?(function(e){var t=Object.keys(e);if(!z)return t;var r=Object.getOwnPropertySymbols(e);return r.length?[].concat(t,r.filter(function(t){return y.propertyIsEnumerable.call(e,t)})):t})(e).forEach(function(r){return t.set(r,e[r])}):Array.isArray(e)?e.forEach(function(e){var r=e[0],n=e[1];return t.set(r,n)}):F(e)?(e.constructor!==Map&&n(19,e),e.forEach(function(e,r){return t.set(r,e)})):null!=e&&n(20,e)}),this},t.clear=function(){var e=this;rv(function(){tr(function(){for(var t,r=X(e.keys());!(t=r()).done;){var n=t.value;e.delete(n)}})})},t.replace=function(e){var t=this;return rv(function(){for(var r,o=function(e){if(F(e)||r$(e))return e;if(Array.isArray(e))return new Map(e);if(!O(e))return n(21,e);var t=new Map;for(var r in e)t.set(r,e[r]);return t}(e),i=new Map,a=!1,s=X(t.data_.keys());!(r=s()).done;){var l=r.value;if(!o.has(l)){if(t.delete(l))a=!0;else{var c=t.data_.get(l);i.set(l,c)}}}for(var u,d=X(o.entries());!(u=d()).done;){var f=u.value,h=f[0],p=f[1],m=t.data_.has(h);if(t.set(h,p),t.data_.has(h)){var g=t.data_.get(h);i.set(h,g),m||(a=!0)}}if(!a){if(t.data_.size!==i.size)t.keysAtom_.reportChanged();else for(var v=t.data_.keys(),b=i.keys(),y=v.next(),w=b.next();!y.done;){if(y.value!==w.value){t.keysAtom_.reportChanged();break}y=v.next(),w=b.next()}}t.data_=i}),this},t.toString=function(){return"[object ObservableMap]"},t.toJSON=function(){return Array.from(this)},t.observe_=function(e,t){return rE(this,e)},t.intercept_=function(e){return rC(this,e)},j(e,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:d,get:function(){return"Map"}}]),e}(),r$=N("ObservableMap",rj),rW={};f=Symbol.iterator,h=Symbol.toStringTag;var rV=function(){function e(e,t,r){var o=this;void 0===t&&(t=ei),void 0===r&&(r="ObservableSet"),this.name_=void 0,this[ee]=rW,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=r,A(Set)||n(22),this.enhancer_=function(e,n){return t(e,n,r)},nr(function(){o.atom_=en(o.name_),e&&o.replace(e)})}var t=e.prototype;return t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.clear=function(){var e=this;rv(function(){tr(function(){for(var t,r=X(e.data_.values());!(t=r()).done;){var n=t.value;e.delete(n)}})})},t.forEach=function(e,t){for(var r,n=X(this);!(r=n()).done;){var o=r.value;e.call(t,o,o,this)}},t.add=function(e){var t=this;if(this.atom_,rS(this)&&!rI(this,{type:"add",object:this,newValue:e}))return this;if(!this.has(e)){rv(function(){t.data_.add(t.enhancer_(e,void 0)),t.atom_.reportChanged()});var r=rk(this),n=r?{observableKind:"set",debugObjectName:this.name_,type:"add",object:this,newValue:e}:null;r&&r_(this,n)}return this},t.delete=function(e){var t=this;if(rS(this)&&!rI(this,{type:rq,object:this,oldValue:e}))return!1;if(this.has(e)){var r=rk(this),n=r?{observableKind:"set",debugObjectName:this.name_,type:rq,object:this,oldValue:e}:null;return rv(function(){t.atom_.reportChanged(),t.data_.delete(e)}),r&&r_(this,n),!0}return!1},t.has=function(e){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(e))},t.entries=function(){var e=0,t=Array.from(this.keys()),r=Array.from(this.values());return na({next:function(){var n=e;return e+=1,n<r.length?{value:[t[n],r[n]],done:!1}:{done:!0}}})},t.keys=function(){return this.values()},t.values=function(){this.atom_.reportObserved();var e=this,t=0,r=Array.from(this.data_.values());return na({next:function(){return t<r.length?{value:e.dehanceValue_(r[t++]),done:!1}:{done:!0}}})},t.replace=function(e){var t=this;return rG(e)&&(e=new Set(e)),rv(function(){Array.isArray(e)?(t.clear(),e.forEach(function(e){return t.add(e)})):L(e)?(t.clear(),e.forEach(function(e){return t.add(e)})):null!=e&&n("Cannot initialize set from "+e)}),this},t.observe_=function(e,t){return rE(this,e)},t.intercept_=function(e){return rC(this,e)},t.toJSON=function(){return Array.from(this)},t.toString=function(){return"[object ObservableSet]"},t[f]=function(){return this.values()},j(e,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:h,get:function(){return"Set"}}]),e}(),rG=N("ObservableSet",rV),rK=Object.create(null),rX="remove",rY=function(){function e(e,t,r,n){void 0===t&&(t=new Map),void 0===n&&(n=eA),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=e,this.values_=t,this.name_=r,this.defaultAnnotation_=n,this.keysAtom_=new et("ObservableObject.keys"),this.isPlainObject_=O(this.target_)}var t=e.prototype;return t.getObservablePropValue_=function(e){return this.values_.get(e).get()},t.setObservablePropValue_=function(e,t){var r=this.values_.get(e);if(r instanceof e5)return r.set(t),!0;if(rS(this)){var n=rI(this,{type:rR,object:this.proxy_||this.target_,name:e,newValue:t});if(!n)return null;t=n.newValue}if((t=r.prepareNewValue_(t))!==tf.UNCHANGED){var o=rk(this),i=o?{type:rR,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:r.value_,name:e,newValue:t}:null;r.setNewValue_(t),o&&r_(this,i)}return!0},t.get_=function(e){return tf.trackingDerivation&&!U(this.target_,e)&&this.has_(e),this.target_[e]},t.set_=function(e,t,r){return(void 0===r&&(r=!1),U(this.target_,e))?this.values_.has(e)?this.setObservablePropValue_(e,t):r?Reflect.set(this.target_,e,t):(this.target_[e]=t,!0):this.extend_(e,{value:t,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,r)},t.has_=function(e){if(!tf.trackingDerivation)return e in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var t=this.pendingKeys_.get(e);return t||(t=new e2(e in this.target_,ea,"ObservableObject.key?",!1),this.pendingKeys_.set(e,t)),t.get()},t.make_=function(e,t){if(!0===t&&(t=this.defaultAnnotation_),!1!==t){if(!(e in this.target_)){var r;if(null!=(r=this.target_[Y])&&r[e])return;n(1,t.annotationType_,this.name_+"."+e.toString())}for(var o=this.target_;o&&o!==y;){var i=v(o,e);if(i){var a=t.make_(this,e,i,o);if(0===a)return;if(1===a)break}o=Object.getPrototypeOf(o)}r1(this,t,e)}},t.extend_=function(e,t,r,n){if(void 0===n&&(n=!1),!0===r&&(r=this.defaultAnnotation_),!1===r)return this.defineProperty_(e,t,n);var o=r.extend_(this,e,t,n);return o&&r1(this,r,e),o},t.defineProperty_=function(e,t,r){void 0===r&&(r=!1),this.keysAtom_;try{tv();var n=this.delete_(e);if(!n)return n;if(rS(this)){var o=rI(this,{object:this.proxy_||this.target_,name:e,type:"add",newValue:t.value});if(!o)return null;var i=o.newValue;t.value!==i&&(t=$({},t,{value:i}))}if(r){if(!Reflect.defineProperty(this.target_,e,t))return!1}else b(this.target_,e,t);this.notifyPropertyAddition_(e,t.value)}finally{tb()}return!0},t.defineObservableProperty_=function(e,t,r,n){void 0===n&&(n=!1),this.keysAtom_;try{tv();var o=this.delete_(e);if(!o)return o;if(rS(this)){var i=rI(this,{object:this.proxy_||this.target_,name:e,type:"add",newValue:t});if(!i)return null;t=i.newValue}var a=rJ(e),s={configurable:!tf.safeDescriptors||this.isPlainObject_,enumerable:!0,get:a.get,set:a.set};if(n){if(!Reflect.defineProperty(this.target_,e,s))return!1}else b(this.target_,e,s);var l=new e2(t,r,"ObservableObject.key",!1);this.values_.set(e,l),this.notifyPropertyAddition_(e,l.value_)}finally{tb()}return!0},t.defineComputedProperty_=function(e,t,r){void 0===r&&(r=!1),this.keysAtom_;try{tv();var n=this.delete_(e);if(!n)return n;if(rS(this)&&!rI(this,{object:this.proxy_||this.target_,name:e,type:"add",newValue:void 0}))return null;t.name||(t.name="ObservableObject.key"),t.context=this.proxy_||this.target_;var o=rJ(e),i={configurable:!tf.safeDescriptors||this.isPlainObject_,enumerable:!1,get:o.get,set:o.set};if(r){if(!Reflect.defineProperty(this.target_,e,i))return!1}else b(this.target_,e,i);this.values_.set(e,new e5(t)),this.notifyPropertyAddition_(e,void 0)}finally{tb()}return!0},t.delete_=function(e,t){if(void 0===t&&(t=!1),this.keysAtom_,!U(this.target_,e))return!0;if(rS(this)&&!rI(this,{object:this.proxy_||this.target_,name:e,type:rX}))return null;try{tv();var r,n,o,i=rk(this),a=this.values_.get(e),s=void 0;if(!a&&i&&(s=null==(o=v(this.target_,e))?void 0:o.value),t){if(!Reflect.deleteProperty(this.target_,e))return!1}else delete this.target_[e];if(a&&(this.values_.delete(e),a instanceof e2&&(s=a.value_),tw(a)),this.keysAtom_.reportChanged(),null==(r=this.pendingKeys_)||null==(n=r.get(e))||n.set(e in this.target_),i){var l={type:rX,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:s,name:e};i&&r_(this,l)}}finally{tb()}return!0},t.observe_=function(e,t){return rE(this,e)},t.intercept_=function(e){return rC(this,e)},t.notifyPropertyAddition_=function(e,t){var r,n,o=rk(this);if(o){var i=o?{type:"add",observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:e,newValue:t}:null;o&&r_(this,i)}null==(r=this.pendingKeys_)||null==(n=r.get(e))||n.set(!0),this.keysAtom_.reportChanged()},t.ownKeys_=function(){return this.keysAtom_.reportObserved(),D(this.target_)},t.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},e}();function rZ(e,t){if(U(e,ee))return e;var r,n,o=null!=(n=null==t?void 0:t.name)?n:"ObservableObject",i=new rY(e,new Map,String(o),t?null!=(r=t.defaultDecorator)?r:eT(t):void 0);return x(e,ee,i),e}var rQ=N("ObservableObjectAdministration",rY);function rJ(e){return rK[e]||(rK[e]={get:function(){return this[ee].getObservablePropValue_(e)},set:function(t){return this[ee].setObservablePropValue_(e,t)}})}function r0(e){return!!P(e)&&rQ(e[ee])}function r1(e,t,r){var n;null==(n=e.target_[Y])||delete n[r]}var r2=r8(0),r3=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)["0"]=1,!1===e}(),r5=0,r6=function(){};!function(e,t){Object.setPrototypeOf?Object.setPrototypeOf(e.prototype,t):void 0!==e.prototype.__proto__?e.prototype.__proto__=t:e.prototype=t}(r6,Array.prototype);var r4=function(e,t,r){function n(t,r,n,o){var i;return void 0===n&&(n="ObservableArray"),void 0===o&&(o=!1),i=e.call(this)||this,nr(function(){var e=new rM(n,r,o,!0);e.proxy_=G(i),M(G(i),ee,e),t&&t.length&&i.spliceWithArray(0,0,t),r3&&Object.defineProperty(G(i),"0",r2)}),i}W(n,e);var o=n.prototype;return o.concat=function(){this[ee].atom_.reportObserved();for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Array.prototype.concat.apply(this.slice(),t.map(function(e){return rU(e)?e.slice():e}))},o[r]=function(){var e=this,t=0;return na({next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0,value:void 0}}})},j(n,[{key:"length",get:function(){return this[ee].getArrayLength_()},set:function(e){this[ee].setArrayLength_(e)}},{key:t,get:function(){return"Array"}}]),n}(r6,Symbol.toStringTag,Symbol.iterator);function r8(e){return{enumerable:!1,configurable:!0,get:function(){return this[ee].get_(e)},set:function(t){this[ee].set_(e,t)}}}function r9(e){if(e>r5){for(var t,r=r5;r<e+100;r++)t=r,b(r4.prototype,""+t,r8(t));r5=e}}function r7(e,t){if("object"==typeof e&&null!==e){if(rU(e))return void 0!==t&&n(23),e[ee].atom_;if(rG(e))return e.atom_;if(r$(e)){if(void 0===t)return e.keysAtom_;var r=e.data_.get(t)||e.hasMap_.get(t);return r||n(25,t,nt(e)),r}if(r0(e)){if(!t)return n(26);var o=e[ee].values_.get(t);return o||n(27,t,nt(e)),o}if(er(e)||e6(e)||t_(e))return e}else if(A(e)&&t_(e[ee]))return e[ee];n(28)}function ne(e,t){return(e||n(29),void 0!==t)?ne(r7(e,t)):er(e)||e6(e)||t_(e)||r$(e)||rG(e)?e:e[ee]?e[ee]:void n(24,e)}function nt(e,t){var r;if(void 0!==t)r=r7(e,t);else{if(tB(e))return e.name;r=r0(e)||r$(e)||rG(e)?ne(e):r7(e)}return r.name_}function nr(e){var t=tn(),r=e0(!0);tv();try{return e()}finally{tb(),e1(r),to(t)}}Object.entries(rN).forEach(function(e){var t=e[0],r=e[1];"concat"!==t&&x(r4.prototype,t,r)}),r9(1e3);var nn=y.toString;function no(e,t,r){return void 0===r&&(r=-1),function e(t,r,n,o,i){if(t===r)return 0!==t||1/t==1/r;if(null==t||null==r)return!1;if(t!=t)return r!=r;var a=typeof t;if("function"!==a&&"object"!==a&&"object"!=typeof r)return!1;var s=nn.call(t);if(s!==nn.call(r))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+t==""+r;case"[object Number]":if(+t!=+t)return+r!=+r;return 0==+t?1/+t==1/r:+t==+r;case"[object Date]":case"[object Boolean]":return+t==+r;case"[object Symbol]":return"undefined"!=typeof Symbol&&Symbol.valueOf.call(t)===Symbol.valueOf.call(r);case"[object Map]":case"[object Set]":n>=0&&n++}t=ni(t),r=ni(r);var l="[object Array]"===s;if(!l){if("object"!=typeof t||"object"!=typeof r)return!1;var c=t.constructor,u=r.constructor;if(c!==u&&!(A(c)&&c instanceof c&&A(u)&&u instanceof u)&&"constructor"in t&&"constructor"in r)return!1}if(0===n)return!1;n<0&&(n=-1),i=i||[];for(var d=(o=o||[]).length;d--;)if(o[d]===t)return i[d]===r;if(o.push(t),i.push(r),l){if((d=t.length)!==r.length)return!1;for(;d--;)if(!e(t[d],r[d],n-1,o,i))return!1}else{var f,h=Object.keys(t);if(d=h.length,Object.keys(r).length!==d)return!1;for(;d--;)if(!(U(r,f=h[d])&&e(t[f],r[f],n-1,o,i)))return!1}return o.pop(),i.pop(),!0}(e,t,r)}function ni(e){return rU(e)?e.slice():F(e)||r$(e)||L(e)||rG(e)?Array.from(e.entries()):e}function na(e){return e[Symbol.iterator]=ns,e}function ns(){return this}["Symbol","Map","Set"].forEach(function(e){void 0===m()[e]&&n("MobX requires global '"+e+"' to be available or polyfilled")}),"object"==typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:tA,extras:{getDebugName:nt},$mobx:ee})},579100:e=>{"use strict";var t={};function r(e){var r;return t[e]?e:t[r=e.toLowerCase().replace("_","-")]||t[r=r.split("-")[0]]?r:null}function n(e,n){var o=r(e);if(!o)return -1;if(!t[o].cFn)return 0;var i=String(n),a=0>i.indexOf(".")?"":i.split(".")[1],s=a.length,l=+i.split(".")[0],c=0===a.length?0:+a.replace(/0+$/,"");return t[o].cFn(+n,l,s,+a,c)}function o(e,n){var o=r(e);if(!o)return -1;if(!t[o].oFn)return 0;var i=String(n),a=0>i.indexOf(".")?"":i.split(".")[1],s=a.length,l=+i.split(".")[0],c=0===a.length?0:+a.replace(/0+$/,"");return t[o].oFn(+n,l,s,+a,c)}e.exports=function(e,o){var i=r(e);return i?t[i].c[n(i,o)]:null},e.exports.indexOf=n,e.exports.forms=function(e){var n=r(e);return t[n]?t[n].c:null},e.exports.ordinal=function(e,n){var i=r(e);return t[i]?t[i].o[o(i,n)]:null},e.exports.ordinal.indexOf=o,e.exports.ordinal.forms=function(e){var n=r(e);return t[n]?t[n].o:null};var i=["zero","one","two","few","many","other"];function a(e){return i[e]}function s(e,r){var n;for(n=0,r.c=r.c?r.c.map(a):["other"],r.o=r.o?r.o.map(a):["other"];n<e.length;n++)t[e[n]]=r}function l(e,t,r){return e<=r&&r<=t&&r%1==0}function c(e,t){return e.indexOf(t)>=0}s(["af","an","asa","bem","bez","bg","brx","ce","cgg","chr","ckb","dv","ee","el","eo","es","eu","fo","fur","gsw","ha","haw","jgo","jmc","kaj","kcg","kkj","kl","ks","ksb","ku","ky","lb","lg","mas","mgo","ml","mn","nah","nb","nd","nn","nnh","no","nr","ny","nyn","om","os","pap","ps","rm","rof","rwk","saq","sd","sdh","seh","sn","so","ss","ssy","st","syr","ta","te","teo","tig","tn","tr","ts","ug","uz","ve","vo","vun","wae","xh","xog"],{c:[1,5],cFn:function(e){return 1===e?0:1}}),s(["ak","bho","guw","ln","mg","nso","pa","ti","wa"],{c:[1,5],cFn:function(e){return l(0,1,e)?0:1}}),s(["am","fa","kn","zu"],{c:[1,5],cFn:function(e,t){return 0===t||1===e?0:1}}),s(["ar","ars"],{c:[0,1,2,3,4,5],cFn:function(e){var t=e%100;return 0===e?0:1===e?1:2===e?2:l(3,10,t)?3:l(11,99,t)?4:5}}),s(["as","bn"],{c:[1,5],cFn:function(e,t){return 0===t||1===e?0:1},o:[1,2,3,4,5],oFn:function(e){return c([1,5,7,8,9,10],e)?0:c([2,3],e)?1:4===e?2:6===e?3:4}}),s(["ast","de","et","fi","fy","gl","ia","io","ji","nl","pt-pt","sw","ur","yi"],{c:[1,5],cFn:function(e,t,r){return 1===t&&0===r?0:1}}),s(["az"],{c:[1,5],cFn:function(e){return 1===e?0:1},o:[1,3,4,5],oFn:function(e,t){var r=t%10,n=t%100;return c([1,2,5,7,8],r)||c([20,50,70,80],n)?0:c([3,4],r)||c([100,200,300,400,500,600,700,800,900],t%1e3)?1:0===t||6===r||c([40,60,90],n)?2:3}}),s(["be"],{c:[1,3,4,5],cFn:function(e){var t=e%10,r=e%100;return 1===t&&11!==r?0:l(2,4,t)&&!l(12,14,r)?1:0===t||l(5,9,t)||l(11,14,r)?2:3},o:[3,5],oFn:function(e){return c([2,3],e%10)&&!c([12,13],e%100)?0:1}}),s(["bm","bo","dz","id","ig","ii","in","ja","jbo","jv","jw","kde","kea","km","ko","lkt","my","nqo","osa","root","sah","ses","sg","su","th","to","wo","yo","yue","zh"],{}),s(["br"],{c:[1,2,3,4,5],cFn:function(e){var t=e%10,r=e%100;return 1!==t||c([11,71,91],r)?2!==t||c([12,72,92],r)?!l(3,4,t)&&9!==t||l(10,19,r)||l(70,79,r)||l(90,99,r)?0!==e&&0==e%1e6?3:4:2:1:0}}),s(["bs","hr","sh","sr"],{c:[1,3,5],cFn:function(e,t,r,n){var o=t%10,i=t%100,a=n%10,s=n%100;return 0===r&&1===o&&11!==i||1===a&&11!==s?0:0===r&&l(2,4,o)&&!l(12,14,i)||l(2,4,a)&&!l(12,14,s)?1:2}}),s(["ca"],{c:[1,5],cFn:function(e,t,r){return 1===t&&0===r?0:1},o:[1,2,3,5],oFn:function(e){return c([1,3],e)?0:2===e?1:4===e?2:3}}),s(["ceb"],{c:[1,5],cFn:function(e,t,r,n){return 0===r&&c([1,2,3],t)||0===r&&!c([4,6,9],t%10)||0!==r&&!c([4,6,9],n%10)?0:1}}),s(["cs","sk"],{c:[1,3,4,5],cFn:function(e,t,r){return 1===t&&0===r?0:l(2,4,t)&&0===r?1:0!==r?2:3}}),s(["cy"],{c:[0,1,2,3,4,5],cFn:function(e){return 0===e?0:1===e?1:2===e?2:3===e?3:6===e?4:5},o:[0,1,2,3,4,5],oFn:function(e){return c([0,7,8,9],e)?0:1===e?1:2===e?2:c([3,4],e)?3:c([5,6],e)?4:5}}),s(["da"],{c:[1,5],cFn:function(e,t,r,n,o){return 1===e||0!==o&&c([0,1],t)?0:1}}),s(["dsb","hsb"],{c:[1,2,3,5],cFn:function(e,t,r,n){var o=t%100,i=n%100;return 0===r&&1===o||1===i?0:0===r&&2===o||2===i?1:0===r&&l(3,4,o)||l(3,4,i)?2:3}}),s(["en"],{c:[1,5],cFn:function(e,t,r){return 1===t&&0===r?0:1},o:[1,2,3,5],oFn:function(e){var t=e%10,r=e%100;return 1===t&&11!==r?0:2===t&&12!==r?1:3===t&&13!==r?2:3}}),s(["ff","kab"],{c:[1,5],cFn:function(e,t){return c([0,1],t)?0:1}}),s(["fil","tl"],{c:[1,5],cFn:function(e,t,r,n){return 0===r&&c([1,2,3],t)||0===r&&!c([4,6,9],t%10)||0!==r&&!c([4,6,9],n%10)?0:1},o:[1,5],oFn:function(e){return 1===e?0:1}}),s(["fr","hy"],{c:[1,5],cFn:function(e,t){return c([0,1],t)?0:1},o:[1,5],oFn:function(e){return 1===e?0:1}}),s(["ga"],{c:[1,2,3,4,5],cFn:function(e){return 1===e?0:2===e?1:l(3,6,e)?2:l(7,10,e)?3:4},o:[1,5],oFn:function(e){return 1===e?0:1}}),s(["gd"],{c:[1,2,3,5],cFn:function(e){return c([1,11],e)?0:c([2,12],e)?1:l(3,10,e)||l(13,19,e)?2:3},o:[1,2,3,5],oFn:function(e){return c([1,11],e)?0:c([2,12],e)?1:c([3,13],e)?2:3}}),s(["gu","hi"],{c:[1,5],cFn:function(e,t){return 0===t||1===e?0:1},o:[1,2,3,4,5],oFn:function(e){return 1===e?0:c([2,3],e)?1:4===e?2:6===e?3:4}}),s(["gv"],{c:[1,2,3,4,5],cFn:function(e,t,r){var n=t%10;return 0===r&&1===n?0:0===r&&2===n?1:0===r&&c([0,20,40,60,80],t%100)?2:0!==r?3:4}}),s(["he","iw"],{c:[1,2,4,5],cFn:function(e,t,r){var n=e%10;return 1===t&&0===r?0:2===t&&0===r?1:0!==r||l(0,10,e)||0!==n?3:2}}),s(["hu"],{c:[1,5],cFn:function(e){return 1===e?0:1},o:[1,5],oFn:function(e){return c([1,5],e)?0:1}}),s(["is"],{c:[1,5],cFn:function(e,t,r,n,o){return 0===o&&1==t%10&&11!=t%100||0!==o?0:1}}),s(["it","sc","scn"],{c:[1,5],cFn:function(e,t,r){return 1===t&&0===r?0:1},o:[4,5],oFn:function(e){return c([11,8,80,800],e)?0:1}}),s(["iu","naq","se","sma","smi","smj","smn","sms"],{c:[1,2,5],cFn:function(e){return 1===e?0:2===e?1:2}}),s(["ka"],{c:[1,5],cFn:function(e){return 1===e?0:1},o:[1,4,5],oFn:function(e,t){var r=t%100;return 1===t?0:0===t||l(2,20,r)||40===r||60===r||80===r?1:2}}),s(["kk"],{c:[1,5],cFn:function(e){return 1===e?0:1},o:[4,5],oFn:function(e){var t=e%10;return 6===t||9===t||0===t&&0!==e?0:1}}),s(["ksh"],{c:[0,1,5],cFn:function(e){return 0===e?0:1===e?1:2}}),s(["kw"],{c:[0,1,2,3,4,5],cFn:function(e){var t=e%100,r=e%1e5;return 0===e?0:1===e?1:c([2,22,42,62,82],t)||0==e%1e3&&(l(1e3,2e4,r)||4e4===r||6e4===r||8e4===r)||0!==e&&1e5==e%1e6?2:c([3,23,43,63,83],t)?3:1!==e&&c([1,21,41,61,81],t)?4:5},o:[1,4,5],oFn:function(e){var t=e%100;return l(1,4,e)||l(1,4,t)||l(21,24,t)||l(41,44,t)||l(61,64,t)||l(81,84,t)?0:5===e||5===t?1:2}}),s(["lag"],{c:[0,1,5],cFn:function(e,t){return 0===e?0:c([0,1],t)&&0!==e?1:2}}),s(["lo","ms","vi"],{o:[1,5],oFn:function(e){return 1===e?0:1}}),s(["lt"],{c:[1,3,4,5],cFn:function(e,t,r,n){var o=e%10,i=e%100;return 1!==o||l(11,19,i)?l(2,9,o)&&!l(11,19,i)?1:0!==n?2:3:0}}),s(["lv","prg"],{c:[0,1,5],cFn:function(e,t,r,n){var o=e%10,i=e%100,a=n%100,s=n%10;return 0===o||l(11,19,i)||2===r&&l(11,19,a)?0:1===o&&11!==i||2===r&&1===s&&11!==a||2!==r&&1===s?1:2}}),s(["mk"],{c:[1,5],cFn:function(e,t,r,n){return 0===r&&1==t%10&&11!=t%100||1==n%10&&11!=n%100?0:1},o:[1,2,4,5],oFn:function(e,t){var r=t%10,n=t%100;return 1===r&&11!==n?0:2===r&&12!==n?1:c([7,8],r)&&!c([17,18],n)?2:3}}),s(["mo","ro"],{c:[1,3,5],cFn:function(e,t,r){return 1===t&&0===r?0:0!==r||0===e||l(2,19,e%100)?1:2},o:[1,5],oFn:function(e){return 1===e?0:1}}),s(["mr"],{c:[1,5],cFn:function(e){return 1===e?0:1},o:[1,2,3,5],oFn:function(e){return 1===e?0:c([2,3],e)?1:4===e?2:3}}),s(["mt"],{c:[1,3,4,5],cFn:function(e){var t=e%100;return 1===e?0:0===e||l(2,10,t)?1:l(11,19,t)?2:3}}),s(["ne"],{c:[1,5],cFn:function(e){return 1===e?0:1},o:[1,5],oFn:function(e){return l(1,4,e)?0:1}}),s(["or"],{c:[1,5],cFn:function(e){return 1===e?0:1},o:[1,2,3,4,5],oFn:function(e){return 1===e||5===e||l(7,9,e)?0:c([2,3],e)?1:4===e?2:6===e?3:4}}),s(["pl"],{c:[1,3,4,5],cFn:function(e,t,r){var n=t%10,o=t%100;return 1===t&&0===r?0:0===r&&l(2,4,n)&&!l(12,14,o)?1:0===r&&1!==t&&l(0,1,n)||0===r&&l(5,9,n)||0===r&&l(12,14,o)?2:3}}),s(["pt"],{c:[1,5],cFn:function(e,t){return l(0,1,t)?0:1}}),s(["ru"],{c:[1,3,4,5],cFn:function(e,t,r){var n=t%10,o=t%100;return 0===r&&1===n&&11!==o?0:0===r&&l(2,4,n)&&!l(12,14,o)?1:0===r&&0===n||0===r&&l(5,9,n)||0===r&&l(11,14,o)?2:3}}),s(["shi"],{c:[1,3,5],cFn:function(e,t){return 0===t||1===e?0:l(2,10,e)?1:2}}),s(["si"],{c:[1,5],cFn:function(e,t,r,n){return c([0,1],e)||0===t&&1===n?0:1}}),s(["sl"],{c:[1,2,3,5],cFn:function(e,t,r){var n=t%100;return 0===r&&1===n?0:0===r&&2===n?1:0===r&&l(3,4,n)||0!==r?2:3}}),s(["sq"],{c:[1,5],cFn:function(e){return 1===e?0:1},o:[1,4,5],oFn:function(e){return 1===e?0:4==e%10&&14!=e%100?1:2}}),s(["sv"],{c:[1,5],cFn:function(e,t,r){return 1===t&&0===r?0:1},o:[1,5],oFn:function(e){return c([1,2],e%10)&&!c([11,12],e%100)?0:1}}),s(["tk"],{c:[1,5],cFn:function(e){return 1===e?0:1},o:[3,5],oFn:function(e){return c([6,9],e%10)||10===e?0:1}}),s(["tzm"],{c:[1,5],cFn:function(e){return l(0,1,e)||l(11,99,e)?0:1}}),s(["uk"],{c:[1,3,4,5],cFn:function(e,t,r){var n=t%10,o=t%100;return 0===r&&1===n&&11!==o?0:0===r&&l(2,4,n)&&!l(12,14,o)?1:0===r&&0===n||0===r&&l(5,9,n)||0===r&&l(11,14,o)?2:3},o:[3,5],oFn:function(e){return 3==e%10&&13!=e%100?0:1}})},857288:e=>{"use strict";e.exports=function(e,t,r,n){t=t||"&",r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var i=/\+/g;e=e.split(t);var a=1e3;n&&"number"==typeof n.maxKeys&&(a=n.maxKeys);var s=e.length;a>0&&s>a&&(s=a);for(var l=0;l<s;++l){var c,u,d,f,h=e[l].replace(i,"%20"),p=h.indexOf(r);(p>=0?(c=h.substr(0,p),u=h.substr(p+1)):(c=h,u=""),d=decodeURIComponent(c),f=decodeURIComponent(u),Object.prototype.hasOwnProperty.call(o,d))?Array.isArray(o[d])?o[d].push(f):o[d]=[o[d],f]:o[d]=f}return o}},610304:e=>{"use strict";var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,r,n,o){return(r=r||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e)?Object.keys(e).map(function(o){var i=encodeURIComponent(t(o))+n;return Array.isArray(e[o])?e[o].map(function(e){return i+encodeURIComponent(t(e))}).join(r):i+encodeURIComponent(t(e[o]))}).join(r):o?encodeURIComponent(t(o))+n+encodeURIComponent(t(e)):""}},989212:(e,t,r)=>{"use strict";t.decode=t.parse=r(857288),t.encode=t.stringify=r(610304)},370077:(e,t,r)=>{"use strict";var n,o,i,a,s,l,c=r(603722),u=r(763528);function d(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f=new Set,h={};function p(e,t){m(e,t),m(e+"Capture",t)}function m(e,t){for(h[e]=t,e=0;e<t.length;e++)f.add(t[e])}var g=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),v=Object.prototype.hasOwnProperty,b=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},w={};function S(e,t,r,n,o,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){C[e]=new S(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];C[t]=new S(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){C[e]=new S(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){C[e]=new S(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){C[e]=new S(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){C[e]=new S(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){C[e]=new S(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){C[e]=new S(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){C[e]=new S(e,5,!1,e.toLowerCase(),null,!1,!1)});var I=/[\-:]([a-z])/g;function k(e){return e[1].toUpperCase()}function E(e,t,r,n){var o,i=C.hasOwnProperty(t)?C[t]:null;(null!==i?0!==i.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null==t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":if(n)return!1;if(null!==r)return!r.acceptsBooleans;return"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e;default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,i,n)&&(r=null),n||null===i?(o=t,(!!v.call(w,o)||!v.call(y,o)&&(b.test(o)?w[o]=!0:(y[o]=!0,!1)))&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r))):i.mustUseProperty?e[i.propertyName]=null===r?3!==i.type&&"":r:(t=i.attributeName,n=i.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(I,k);C[t]=new S(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(I,k);C[t]=new S(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(I,k);C[t]=new S(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){C[e]=new S(e,1,!1,e.toLowerCase(),null,!1,!1)}),C.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){C[e]=new S(e,1,!1,e.toLowerCase(),null,!0,!0)});var _=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for("react.element"),T=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),M=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var B=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var U=Symbol.iterator;function H(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=U&&e[U]||e["@@iterator"])?e:null}var q,j=Object.assign;function $(e){if(void 0===q)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);q=t&&t[1]||""}return"\n"+q+e}var W=!1;function V(e,t){if(!e||W)return"";W=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t){if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var n=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){n=e}e.call(t.prototype)}}else{try{throw Error()}catch(e){n=e}e()}}catch(t){if(t&&n&&"string"==typeof t.stack){for(var o=t.stack.split("\n"),i=n.stack.split("\n"),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(1!==a||1!==s)do if(a--,0>--s||o[a]!==i[s]){var l="\n"+o[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=s)break}}}finally{W=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?$(e):""}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function K(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function X(e){e._valueTracker||(e._valueTracker=function(e){var t=K(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==r&&"function"==typeof r.get&&"function"==typeof r.set){var o=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Y(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=K(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function Z(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var r=t.checked;return j({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function J(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=G(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function ee(e,t){null!=(t=t.checked)&&E(e,"checked",t,!1)}function et(e,t){ee(e,t);var r=G(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n){e.removeAttribute("value");return}t.hasOwnProperty("value")?en(e,t.type,r):t.hasOwnProperty("defaultValue")&&en(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function er(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function en(e,t,r){("number"!==t||Z(e.ownerDocument)!==e)&&(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var eo=Array.isArray;function ei(e,t,r,n){if(e=e.options,t){t={};for(var o=0;o<r.length;o++)t["$"+r[o]]=!0;for(r=0;r<e.length;r++)o=t.hasOwnProperty("$"+e[r].value),e[r].selected!==o&&(e[r].selected=o),o&&n&&(e[r].defaultSelected=!0)}else{for(o=0,r=""+G(r),t=null;o<e.length;o++){if(e[o].value===r){e[o].selected=!0,n&&(e[o].defaultSelected=!0);return}null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function ea(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(d(91));return j({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function es(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(d(92));if(eo(r)){if(1<r.length)throw Error(d(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:G(r)}}function el(e,t){var r=G(t.value),n=G(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function ec(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function eu(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ed(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?eu(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ef,eh=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,r,n,o){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,o)})}:e}(function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ef=ef||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ef.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ep(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType){r.nodeValue=t;return}}e.textContent=t}var em={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eg=["Webkit","ms","Moz","O"];function ev(e,t,r){return null==t||"boolean"==typeof t||""===t?"":r||"number"!=typeof t||0===t||em.hasOwnProperty(e)&&em[e]?(""+t).trim():t+"px"}function eb(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),o=ev(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,o):e[r]=o}}Object.keys(em).forEach(function(e){eg.forEach(function(t){em[t=t+e.charAt(0).toUpperCase()+e.substring(1)]=em[e]})});var ey=j({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ew(e,t){if(t){if(ey[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(d(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(d(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(d(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(d(62))}}function eS(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eC=null;function eI(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ek=null,eE=null,e_=null;function eA(e){if(e=nF(e)){if("function"!=typeof ek)throw Error(d(280));var t=e.stateNode;t&&(t=nz(t),ek(e.stateNode,e.type,t))}}function eT(e){eE?e_?e_.push(e):e_=[e]:eE=e}function eP(){if(eE){var e=eE,t=e_;if(e_=eE=null,eA(e),t)for(e=0;e<t.length;e++)eA(t[e])}}function eO(e,t){return e(t)}function eR(){}var ex=!1;function eM(e,t,r){if(ex)return e(t,r);ex=!0;try{return eO(e,t,r)}finally{ex=!1,(null!==eE||null!==e_)&&(eR(),eP())}}function eN(e,t){var r=e.stateNode;if(null===r)return null;var n=nz(r);if(null===n)return null;switch(r=n[t],t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break;default:e=!1}if(e)return null;if(r&&"function"!=typeof r)throw Error(d(231,t,typeof r));return r}var eF=!1;if(g)try{var eL={};Object.defineProperty(eL,"passive",{get:function(){eF=!0}}),window.addEventListener("test",eL,eL),window.removeEventListener("test",eL,eL)}catch(e){eF=!1}function ez(e,t,r,n,o,i,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(e){this.onError(e)}}var eD=!1,eB=null,eU=!1,eH=null,eq={onError:function(e){eD=!0,eB=e}};function ej(e,t,r,n,o,i,a,s,l){eD=!1,eB=null,ez.apply(eq,arguments)}function e$(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do 0!=(4098&(t=e).flags)&&(r=t.return),e=t.return;while(e)}return 3===t.tag?r:null}function eW(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function eV(e){if(e$(e)!==e)throw Error(d(188))}function eG(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=e$(e)))throw Error(d(188));return t!==e?null:e}for(var r=e,n=t;;){var o=r.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(n=o.return)){r=n;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===r)return eV(o),e;if(i===n)return eV(o),t;i=i.sibling}throw Error(d(188))}if(r.return!==n.return)r=o,n=i;else{for(var a=!1,s=o.child;s;){if(s===r){a=!0,r=o,n=i;break}if(s===n){a=!0,n=o,r=i;break}s=s.sibling}if(!a){for(s=i.child;s;){if(s===r){a=!0,r=i,n=o;break}if(s===n){a=!0,n=i,r=o;break}s=s.sibling}if(!a)throw Error(d(189))}}if(r.alternate!==n)throw Error(d(190))}if(3!==r.tag)throw Error(d(188));return r.stateNode.current===r?e:t}(e))?function e(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var r=e(t);if(null!==r)return r;t=t.sibling}return null}(e):null}var eK=u.unstable_scheduleCallback,eX=u.unstable_cancelCallback,eY=u.unstable_shouldYield,eZ=u.unstable_requestPaint,eQ=u.unstable_now,eJ=u.unstable_getCurrentPriorityLevel,e0=u.unstable_ImmediatePriority,e1=u.unstable_UserBlockingPriority,e2=u.unstable_NormalPriority,e3=u.unstable_LowPriority,e5=u.unstable_IdlePriority,e6=null,e4=null,e8=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(e9(e)/e7|0)|0},e9=Math.log,e7=Math.LN2,te=64,tt=4194304;function tr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 0x1000000:case 0x2000000:case 0x4000000:return 0x7c00000&e;case 0x8000000:return 0x8000000;case 0x10000000:return 0x10000000;case 0x20000000:return 0x20000000;case 0x40000000:return 0x40000000;default:return e}}function tn(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,o=e.suspendedLanes,i=e.pingedLanes,a=0xfffffff&r;if(0!==a){var s=a&~o;0!==s?n=tr(s):0!=(i&=a)&&(n=tr(i))}else 0!=(a=r&~o)?n=tr(a):0!==i&&(n=tr(i));if(0===n)return 0;if(0!==t&&t!==n&&0==(t&o)&&((o=n&-n)>=(i=t&-t)||16===o&&0!=(4194240&i)))return t;if(0!=(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)o=1<<(r=31-e8(t)),n|=e[r],t&=~o;return n}function to(e){return 0!=(e=-0x40000001&e.pendingLanes)?e:0x40000000&e?0x40000000:0}function ti(){var e=te;return 0==(4194240&(te<<=1))&&(te=64),e}function ta(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ts(e,t,r){e.pendingLanes|=t,0x20000000!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-e8(t)]=r}function tl(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-e8(r),o=1<<n;o&t|e[n]&t&&(e[n]|=t),r&=~o}}var tc=0;function tu(e){return 1<(e&=-e)?4<e?0!=(0xfffffff&e)?16:0x20000000:4:1}var td,tf,th,tp,tm,tg=!1,tv=[],tb=null,ty=null,tw=null,tS=new Map,tC=new Map,tI=[],tk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tE(e,t){switch(e){case"focusin":case"focusout":tb=null;break;case"dragenter":case"dragleave":ty=null;break;case"mouseover":case"mouseout":tw=null;break;case"pointerover":case"pointerout":tS.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":tC.delete(t.pointerId)}}function t_(e,t,r,n,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[o]},null!==t&&null!==(t=nF(t))&&tf(t)):(e.eventSystemFlags|=n,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o)),e}function tA(e){var t=nN(e.target);if(null!==t){var r=e$(t);if(null!==r){if(13===(t=r.tag)){if(null!==(t=eW(r))){e.blockedOn=t,tm(e.priority,function(){th(r)});return}}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=3===r.tag?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function tT(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=tB(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=nF(r))&&tf(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);eC=n,r.target.dispatchEvent(n),eC=null,t.shift()}return!0}function tP(e,t,r){tT(e)&&r.delete(t)}function tO(){tg=!1,null!==tb&&tT(tb)&&(tb=null),null!==ty&&tT(ty)&&(ty=null),null!==tw&&tT(tw)&&(tw=null),tS.forEach(tP),tC.forEach(tP)}function tR(e,t){e.blockedOn===t&&(e.blockedOn=null,tg||(tg=!0,u.unstable_scheduleCallback(u.unstable_NormalPriority,tO)))}function tx(e){function t(t){return tR(t,e)}if(0<tv.length){tR(tv[0],e);for(var r=1;r<tv.length;r++){var n=tv[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==tb&&tR(tb,e),null!==ty&&tR(ty,e),null!==tw&&tR(tw,e),tS.forEach(t),tC.forEach(t),r=0;r<tI.length;r++)(n=tI[r]).blockedOn===e&&(n.blockedOn=null);for(;0<tI.length&&null===(r=tI[0]).blockedOn;)tA(r),null===r.blockedOn&&tI.shift()}var tM=_.ReactCurrentBatchConfig,tN=!0;function tF(e,t,r,n){var o=tc,i=tM.transition;tM.transition=null;try{tc=1,tz(e,t,r,n)}finally{tc=o,tM.transition=i}}function tL(e,t,r,n){var o=tc,i=tM.transition;tM.transition=null;try{tc=4,tz(e,t,r,n)}finally{tc=o,tM.transition=i}}function tz(e,t,r,n){if(tN){var o=tB(e,t,r,n);if(null===o)na(e,t,n,tD,r),tE(e,n);else if(function(e,t,r,n,o){switch(t){case"focusin":return tb=t_(tb,e,t,r,n,o),!0;case"dragenter":return ty=t_(ty,e,t,r,n,o),!0;case"mouseover":return tw=t_(tw,e,t,r,n,o),!0;case"pointerover":var i=o.pointerId;return tS.set(i,t_(tS.get(i)||null,e,t,r,n,o)),!0;case"gotpointercapture":return i=o.pointerId,tC.set(i,t_(tC.get(i)||null,e,t,r,n,o)),!0}return!1}(o,e,t,r,n))n.stopPropagation();else if(tE(e,n),4&t&&-1<tk.indexOf(e)){for(;null!==o;){var i=nF(o);if(null!==i&&td(i),null===(i=tB(e,t,r,n))&&na(e,t,n,tD,r),i===o)break;o=i}null!==o&&n.stopPropagation()}else na(e,t,n,null,r)}}var tD=null;function tB(e,t,r,n){if(tD=null,null!==(e=nN(e=eI(n)))){if(null===(t=e$(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=eW(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}return tD=e,null}function tU(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(eJ()){case e0:return 1;case e1:return 4;case e2:case e3:return 16;case e5:return 0x20000000;default:return 16}default:return 16}}var tH=null,tq=null,tj=null;function t$(){if(tj)return tj;var e,t,r=tq,n=r.length,o="value"in tH?tH.value:tH.textContent,i=o.length;for(e=0;e<n&&r[e]===o[e];e++);var a=n-e;for(t=1;t<=a&&r[n-t]===o[i-t];t++);return tj=o.slice(e,1<t?1-t:void 0)}function tW(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function tV(){return!0}function tG(){return!1}function tK(e){function t(t,r,n,o,i){for(var a in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?tV:tG,this.isPropagationStopped=tG,this}return j(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=tV)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=tV)},persist:function(){},isPersistent:tV}),t}var tX,tY,tZ,tQ={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tJ=tK(tQ),t0=j({},tQ,{view:0,detail:0}),t1=tK(t0),t2=j({},t0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==tZ&&(tZ&&"mousemove"===e.type?(tX=e.screenX-tZ.screenX,tY=e.screenY-tZ.screenY):tY=tX=0,tZ=e),tX)},movementY:function(e){return"movementY"in e?e.movementY:tY}}),t3=tK(t2),t5=tK(j({},t2,{dataTransfer:0})),t6=tK(j({},t0,{relatedTarget:0})),t4=tK(j({},tQ,{animationName:0,elapsedTime:0,pseudoElement:0})),t8=tK(j({},tQ,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),t9=tK(j({},tQ,{data:0})),t7={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},re={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=rt[e])&&!!t[e]}function rn(){return rr}var ro=tK(j({},t0,{key:function(e){if(e.key){var t=t7[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tW(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?re[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rn,charCode:function(e){return"keypress"===e.type?tW(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tW(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),ri=tK(j({},t2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),ra=tK(j({},t0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rn})),rs=tK(j({},tQ,{propertyName:0,elapsedTime:0,pseudoElement:0})),rl=tK(j({},t2,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),rc=[9,13,27,32],ru=g&&"CompositionEvent"in window,rd=null;g&&"documentMode"in document&&(rd=document.documentMode);var rf=g&&"TextEvent"in window&&!rd,rh=g&&(!ru||rd&&8<rd&&11>=rd),rp=!1;function rm(e,t){switch(e){case"keyup":return -1!==rc.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rg(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var rv=!1,rb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ry(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!rb[e.type]:"textarea"===t}function rw(e,t,r,n){eT(n),0<(t=nl(t,"onChange")).length&&(r=new tJ("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var rS=null,rC=null;function rI(e){ne(e,0)}function rk(e){if(Y(nL(e)))return e}function rE(e,t){if("change"===e)return t}var r_=!1;if(g){if(g){var rA="oninput"in document;if(!rA){var rT=document.createElement("div");rT.setAttribute("oninput","return;"),rA="function"==typeof rT.oninput}n=rA}else n=!1;r_=n&&(!document.documentMode||9<document.documentMode)}function rP(){rS&&(rS.detachEvent("onpropertychange",rO),rC=rS=null)}function rO(e){if("value"===e.propertyName&&rk(rC)){var t=[];rw(t,rC,e,eI(e)),eM(rI,t)}}function rR(e,t,r){"focusin"===e?(rP(),rS=t,rC=r,rS.attachEvent("onpropertychange",rO)):"focusout"===e&&rP()}function rx(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return rk(rC)}function rM(e,t){if("click"===e)return rk(t)}function rN(e,t){if("input"===e||"change"===e)return rk(t)}var rF="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function rL(e,t){if(rF(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var o=r[n];if(!v.call(t,o)||!rF(e[o],t[o]))return!1}return!0}function rz(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function rD(e,t){var r,n=rz(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=rz(n)}}function rB(){for(var e=window,t=Z();t instanceof e.HTMLIFrameElement;){try{var r="string"==typeof t.contentWindow.location.href}catch(e){r=!1}if(r)e=t.contentWindow;else break;t=Z(e.document)}return t}function rU(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var rH=g&&"documentMode"in document&&11>=document.documentMode,rq=null,rj=null,r$=null,rW=!1;function rV(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;rW||null==rq||rq!==Z(n)||(n="selectionStart"in(n=rq)&&rU(n)?{start:n.selectionStart,end:n.selectionEnd}:{anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},r$&&rL(r$,n)||(r$=n,0<(n=nl(rj,"onSelect")).length&&(t=new tJ("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=rq)))}function rG(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var rK={animationend:rG("Animation","AnimationEnd"),animationiteration:rG("Animation","AnimationIteration"),animationstart:rG("Animation","AnimationStart"),transitionend:rG("Transition","TransitionEnd")},rX={},rY={};function rZ(e){if(rX[e])return rX[e];if(!rK[e])return e;var t,r=rK[e];for(t in r)if(r.hasOwnProperty(t)&&t in rY)return rX[e]=r[t];return e}g&&(rY=document.createElement("div").style,"AnimationEvent"in window||(delete rK.animationend.animation,delete rK.animationiteration.animation,delete rK.animationstart.animation),"TransitionEvent"in window||delete rK.transitionend.transition);var rQ=rZ("animationend"),rJ=rZ("animationiteration"),r0=rZ("animationstart"),r1=rZ("transitionend"),r2=new Map,r3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function r5(e,t){r2.set(e,t),p(t,[e])}for(var r6=0;r6<r3.length;r6++){var r4=r3[r6];r5(r4.toLowerCase(),"on"+(r4[0].toUpperCase()+r4.slice(1)))}r5(rQ,"onAnimationEnd"),r5(rJ,"onAnimationIteration"),r5(r0,"onAnimationStart"),r5("dblclick","onDoubleClick"),r5("focusin","onFocus"),r5("focusout","onBlur"),r5(r1,"onTransitionEnd"),m("onMouseEnter",["mouseout","mouseover"]),m("onMouseLeave",["mouseout","mouseover"]),m("onPointerEnter",["pointerout","pointerover"]),m("onPointerLeave",["pointerout","pointerover"]),p("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),p("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),p("onBeforeInput",["compositionend","keypress","textInput","paste"]),p("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),p("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),p("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var r8="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),r9=new Set("cancel close invalid load scroll toggle".split(" ").concat(r8));function r7(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,o,i,a,s,l){if(ej.apply(this,arguments),eD){if(eD){var c=eB;eD=!1,eB=null}else throw Error(d(198));eU||(eU=!0,eH=c)}}(n,t,void 0,e),e.currentTarget=null}function ne(e,t){t=0!=(4&t);for(var r=0;r<e.length;r++){var n=e[r],o=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var a=n.length-1;0<=a;a--){var s=n[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==i&&o.isPropagationStopped())break e;r7(o,s,c),i=l}else for(a=0;a<n.length;a++){if(l=(s=n[a]).instance,c=s.currentTarget,s=s.listener,l!==i&&o.isPropagationStopped())break e;r7(o,s,c),i=l}}}if(eU)throw e=eH,eU=!1,eH=null,e}function nt(e,t){var r=t[nR];void 0===r&&(r=t[nR]=new Set);var n=e+"__bubble";r.has(n)||(ni(t,e,2,!1),r.add(n))}function nr(e,t,r){var n=0;t&&(n|=4),ni(r,e,n,t)}var nn="_reactListening"+Math.random().toString(36).slice(2);function no(e){if(!e[nn]){e[nn]=!0,f.forEach(function(t){"selectionchange"!==t&&(r9.has(t)||nr(t,!1,e),nr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[nn]||(t[nn]=!0,nr("selectionchange",!1,t))}}function ni(e,t,r,n){switch(tU(t)){case 1:var o=tF;break;case 4:o=tL;break;default:o=tz}r=o.bind(null,t,r,e),o=void 0,eF&&("touchstart"===t||"touchmove"===t||"wheel"===t)&&(o=!0),n?void 0!==o?e.addEventListener(t,r,{capture:!0,passive:o}):e.addEventListener(t,r,!0):void 0!==o?e.addEventListener(t,r,{passive:o}):e.addEventListener(t,r,!1)}function na(e,t,r,n,o){var i=n;if(0==(1&t)&&0==(2&t)&&null!==n)e:for(;;){if(null===n)return;var a=n.tag;if(3===a||4===a){var s=n.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===a)for(a=n.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===o||8===l.nodeType&&l.parentNode===o))return;a=a.return}for(;null!==s;){if(null===(a=nN(s)))return;if(5===(l=a.tag)||6===l){n=i=a;continue e}s=s.parentNode}}n=n.return}eM(function(){var n=i,o=eI(r),a=[];e:{var s=r2.get(e);if(void 0!==s){var l=tJ,c=e;switch(e){case"keypress":if(0===tW(r))break e;case"keydown":case"keyup":l=ro;break;case"focusin":c="focus",l=t6;break;case"focusout":c="blur",l=t6;break;case"beforeblur":case"afterblur":l=t6;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=t3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=t5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=ra;break;case rQ:case rJ:case r0:l=t4;break;case r1:l=rs;break;case"scroll":l=t1;break;case"wheel":l=rl;break;case"copy":case"cut":case"paste":l=t8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=ri}var u=0!=(4&t),d=!u&&"scroll"===e,f=u?null!==s?s+"Capture":null:s;u=[];for(var h,p=n;null!==p;){var m=(h=p).stateNode;if(5===h.tag&&null!==m&&(h=m,null!==f&&null!=(m=eN(p,f))&&u.push(ns(p,m,h))),d)break;p=p.return}0<u.length&&(s=new l(s,c,null,r,o),a.push({event:s,listeners:u}))}}if(0==(7&t)){if(s="mouseover"===e||"pointerover"===e,l="mouseout"===e||"pointerout"===e,!(s&&r!==eC&&(c=r.relatedTarget||r.fromElement)&&(nN(c)||c[nO]))&&(l||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,l?(c=r.relatedTarget||r.toElement,l=n,null!==(c=c?nN(c):null)&&(d=e$(c),c!==d||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(u=t3,m="onMouseLeave",f="onMouseEnter",p="mouse",("pointerout"===e||"pointerover"===e)&&(u=ri,m="onPointerLeave",f="onPointerEnter",p="pointer"),d=null==l?s:nL(l),h=null==c?s:nL(c),(s=new u(m,p+"leave",l,r,o)).target=d,s.relatedTarget=h,m=null,nN(o)===n&&((u=new u(f,p+"enter",c,r,o)).target=h,u.relatedTarget=d,m=u),d=m,l&&c)t:{for(u=l,f=c,p=0,h=u;h;h=nc(h))p++;for(h=0,m=f;m;m=nc(m))h++;for(;0<p-h;)u=nc(u),p--;for(;0<h-p;)f=nc(f),h--;for(;p--;){if(u===f||null!==f&&u===f.alternate)break t;u=nc(u),f=nc(f)}u=null}else u=null;null!==l&&nu(a,s,l,u,!1),null!==c&&null!==d&&nu(a,d,c,u,!0)}e:{if("select"===(l=(s=n?nL(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g,v=rE;else if(ry(s)){if(r_)v=rN;else{v=rx;var b=rR}}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(v=rM);if(v&&(v=v(e,n))){rw(a,v,r,o);break e}b&&b(e,s,n),"focusout"===e&&(b=s._wrapperState)&&b.controlled&&"number"===s.type&&en(s,"number",s.value)}switch(b=n?nL(n):window,e){case"focusin":(ry(b)||"true"===b.contentEditable)&&(rq=b,rj=n,r$=null);break;case"focusout":r$=rj=rq=null;break;case"mousedown":rW=!0;break;case"contextmenu":case"mouseup":case"dragend":rW=!1,rV(a,r,o);break;case"selectionchange":if(rH)break;case"keydown":case"keyup":rV(a,r,o)}if(ru)t:{switch(e){case"compositionstart":var y="onCompositionStart";break t;case"compositionend":y="onCompositionEnd";break t;case"compositionupdate":y="onCompositionUpdate";break t}y=void 0}else rv?rm(e,r)&&(y="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(y="onCompositionStart");y&&(rh&&"ko"!==r.locale&&(rv||"onCompositionStart"!==y?"onCompositionEnd"===y&&rv&&(g=t$()):(tq="value"in(tH=o)?tH.value:tH.textContent,rv=!0)),0<(b=nl(n,y)).length&&(y=new t9(y,e,null,r,o),a.push({event:y,listeners:b}),g?y.data=g:null!==(g=rg(r))&&(y.data=g))),(g=rf?function(e,t){switch(e){case"compositionend":return rg(t);case"keypress":if(32!==t.which)return null;return rp=!0," ";case"textInput":return" "===(e=t.data)&&rp?null:e;default:return null}}(e,r):function(e,t){if(rv)return"compositionend"===e||!ru&&rm(e,t)?(e=t$(),tj=tq=tH=null,rv=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return rh&&"ko"!==t.locale?null:t.data}}(e,r))&&0<(n=nl(n,"onBeforeInput")).length&&(o=new t9("onBeforeInput","beforeinput",null,r,o),a.push({event:o,listeners:n}),o.data=g)}ne(a,t)})}function ns(e,t,r){return{instance:e,listener:t,currentTarget:r}}function nl(e,t){for(var r=t+"Capture",n=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=eN(e,r))&&n.unshift(ns(e,i,o)),null!=(i=eN(e,t))&&n.push(ns(e,i,o))),e=e.return}return n}function nc(e){if(null===e)return null;do e=e.return;while(e&&5!==e.tag)return e||null}function nu(e,t,r,n,o){for(var i=t._reactName,a=[];null!==r&&r!==n;){var s=r,l=s.alternate,c=s.stateNode;if(null!==l&&l===n)break;5===s.tag&&null!==c&&(s=c,o?null!=(l=eN(r,i))&&a.unshift(ns(r,l,s)):o||null!=(l=eN(r,i))&&a.push(ns(r,l,s))),r=r.return}0!==a.length&&e.push({event:t,listeners:a})}var nd=/\r\n?/g,nf=/\u0000|\uFFFD/g;function nh(e){return("string"==typeof e?e:""+e).replace(nd,"\n").replace(nf,"")}function np(e,t,r){if(t=nh(t),nh(e)!==t&&r)throw Error(d(425))}function nm(){}var ng=null,nv=null;function nb(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ny="function"==typeof setTimeout?setTimeout:void 0,nw="function"==typeof clearTimeout?clearTimeout:void 0,nS="function"==typeof Promise?Promise:void 0,nC="function"==typeof queueMicrotask?queueMicrotask:void 0!==nS?function(e){return nS.resolve(null).then(e).catch(nI)}:ny;function nI(e){setTimeout(function(){throw e})}function nk(e,t){var r=t,n=0;do{var o=r.nextSibling;if(e.removeChild(r),o&&8===o.nodeType){if("/$"===(r=o.data)){if(0===n){e.removeChild(o),tx(t);return}n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++}r=o}while(r)tx(t)}function nE(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function n_(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var nA=Math.random().toString(36).slice(2),nT="__reactFiber$"+nA,nP="__reactProps$"+nA,nO="__reactContainer$"+nA,nR="__reactEvents$"+nA,nx="__reactListeners$"+nA,nM="__reactHandles$"+nA;function nN(e){var t=e[nT];if(t)return t;for(var r=e.parentNode;r;){if(t=r[nO]||r[nT]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=n_(e);null!==e;){if(r=e[nT])return r;e=n_(e)}return t}r=(e=r).parentNode}return null}function nF(e){return(e=e[nT]||e[nO])&&(5===e.tag||6===e.tag||13===e.tag||3===e.tag)?e:null}function nL(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(d(33))}function nz(e){return e[nP]||null}var nD=[],nB=-1;function nU(e){return{current:e}}function nH(e){0>nB||(e.current=nD[nB],nD[nB]=null,nB--)}function nq(e,t){nD[++nB]=e.current,e.current=t}var nj={},n$=nU(nj),nW=nU(!1),nV=nj;function nG(e,t){var r=e.type.contextTypes;if(!r)return nj;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in r)i[o]=t[o];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function nK(e){return null!=(e=e.childContextTypes)}function nX(){nH(nW),nH(n$)}function nY(e,t,r){if(n$.current!==nj)throw Error(d(168));nq(n$,t),nq(nW,r)}function nZ(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!=typeof n.getChildContext)return r;for(var o in n=n.getChildContext())if(!(o in t))throw Error(d(108,function(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return function e(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case P:return"Fragment";case T:return"Portal";case R:return"Profiler";case O:return"StrictMode";case F:return"Suspense";case L:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case M:return(t.displayName||"Context")+".Consumer";case x:return(t._context.displayName||"Context")+".Provider";case N:var r=t.render;return(t=t.displayName)||(t=""!==(t=r.displayName||r.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case z:return null!==(r=t.displayName||null)?r:e(t.type)||"Memo";case D:r=t._payload,t=t._init;try{return e(t(r))}catch(e){}}return null}(t);case 8:return t===O?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}(e)||"Unknown",o));return j({},r,n)}function nQ(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||nj,nV=n$.current,nq(n$,e),nq(nW,nW.current),!0}function nJ(e,t,r){var n=e.stateNode;if(!n)throw Error(d(169));r?(e=nZ(e,t,nV),n.__reactInternalMemoizedMergedChildContext=e,nH(nW),nH(n$),nq(n$,e)):nH(nW),nq(nW,r)}var n0=null,n1=!1,n2=!1;function n3(e){null===n0?n0=[e]:n0.push(e)}function n5(){if(!n2&&null!==n0){n2=!0;var e=0,t=tc;try{var r=n0;for(tc=1;e<r.length;e++){var n=r[e];do n=n(!0);while(null!==n)}n0=null,n1=!1}catch(t){throw null!==n0&&(n0=n0.slice(e+1)),eK(e0,n5),t}finally{tc=t,n2=!1}}return null}var n6=[],n4=0,n8=null,n9=0,n7=[],oe=0,ot=null,or=1,on="";function oo(e,t){n6[n4++]=n9,n6[n4++]=n8,n8=e,n9=t}function oi(e,t,r){n7[oe++]=or,n7[oe++]=on,n7[oe++]=ot,ot=e;var n=or;e=on;var o=32-e8(n)-1;n&=~(1<<o),r+=1;var i=32-e8(t)+o;if(30<i){var a=o-o%5;i=(n&(1<<a)-1).toString(32),n>>=a,o-=a,or=1<<32-e8(t)+o|r<<o|n,on=i+e}else or=1<<i|r<<o|n,on=e}function oa(e){null!==e.return&&(oo(e,1),oi(e,1,0))}function os(e){for(;e===n8;)n8=n6[--n4],n6[n4]=null,n9=n6[--n4],n6[n4]=null;for(;e===ot;)ot=n7[--oe],n7[oe]=null,on=n7[--oe],n7[oe]=null,or=n7[--oe],n7[oe]=null}var ol=null,oc=null,ou=!1,od=null;function of(e,t){var r=sG(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function oh(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ol=e,oc=nE(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ol=e,oc=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==ot?{id:or,overflow:on}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:0x40000000},(r=sG(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ol=e,oc=null,!0);default:return!1}}function op(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function om(e){if(ou){var t=oc;if(t){var r=t;if(!oh(e,t)){if(op(e))throw Error(d(418));t=nE(r.nextSibling);var n=ol;t&&oh(e,t)?of(n,r):(e.flags=-4097&e.flags|2,ou=!1,ol=e)}}else{if(op(e))throw Error(d(418));e.flags=-4097&e.flags|2,ou=!1,ol=e}}}function og(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ol=e}function ov(e){if(e!==ol)return!1;if(!ou)return og(e),ou=!0,!1;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nb(e.type,e.memoizedProps)),t&&(t=oc)){if(op(e))throw ob(),Error(d(418));for(;t;)of(e,t),t=nE(t.nextSibling)}if(og(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(d(317));e:{for(t=0,e=e.nextSibling;e;){if(8===e.nodeType){var t,r=e.data;if("/$"===r){if(0===t){oc=nE(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}oc=null}}else oc=ol?nE(e.stateNode.nextSibling):null;return!0}function ob(){for(var e=oc;e;)e=nE(e.nextSibling)}function oy(){oc=ol=null,ou=!1}function ow(e){null===od?od=[e]:od.push(e)}var oS=_.ReactCurrentBatchConfig;function oC(e,t){if(e&&e.defaultProps)for(var r in t=j({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}var oI=nU(null),ok=null,oE=null,o_=null;function oA(){o_=oE=ok=null}function oT(e){var t=oI.current;nH(oI),e._currentValue=t}function oP(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function oO(e,t){ok=e,o_=oE=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(aa=!0),e.firstContext=null)}function oR(e){var t=e._currentValue;if(o_!==e){if(e={context:e,memoizedValue:t,next:null},null===oE){if(null===ok)throw Error(d(308));oE=e,ok.dependencies={lanes:0,firstContext:e}}else oE=oE.next=e}return t}var ox=null;function oM(e){null===ox?ox=[e]:ox.push(e)}function oN(e,t,r,n){var o=t.interleaved;return null===o?(r.next=r,oM(t)):(r.next=o.next,o.next=r),t.interleaved=r,oF(e,n)}function oF(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var oL=!1;function oz(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oD(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function oB(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function oU(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!=(2&a3)){var o=n.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),n.pending=t,oF(e,r)}return null===(o=n.interleaved)?(t.next=t,oM(n)):(t.next=o.next,o.next=t),n.interleaved=t,oF(e,r)}function oH(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&r))){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,tl(e,r)}}function oq(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var o=null,i=null;if(null!==(r=r.firstBaseUpdate)){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===i?o=i=a:i=i.next=a,r=r.next}while(null!==r)null===i?o=i=t:i=i.next=t}else o=i=t;r={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function oj(e,t,r,n){var o=e.updateQueue;oL=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?i=c:a.next=c,a=l;var u=e.alternate;null!==u&&(s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l)}if(null!==i){var d=o.baseState;for(a=0,u=c=l=null,s=i;;){var f=s.lane,h=s.eventTime;if((n&f)===f){null!==u&&(u=u.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,m=s;switch(f=t,h=r,m.tag){case 1:if("function"==typeof(p=m.payload)){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null==(f="function"==typeof(p=m.payload)?p.call(h,d,f):p))break e;d=j({},d,f);break e;case 2:oL=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(f=o.effects)?o.effects=[s]:f.push(s))}else h={eventTime:h,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=h,l=d):u=u.next=h,a|=f;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(f=s).next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}if(null===u&&(l=d),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do a|=o.lane,o=o.next;while(o!==t)}else null===i&&(o.shared.lanes=0);st|=a,e.lanes=a,e.memoizedState=d}}function o$(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],o=n.callback;if(null!==o){if(n.callback=null,n=r,"function"!=typeof o)throw Error(d(191,o));o.call(n)}}}var oW=(new c.Component).refs;function oV(e,t,r,n){r=null==(r=r(n,t=e.memoizedState))?t:j({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var oG={isMounted:function(e){return!!(e=e._reactInternals)&&e$(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=sy(),o=sw(e),i=oB(n,o);i.payload=t,null!=r&&(i.callback=r),null!==(t=oU(e,i,o))&&(sS(t,e,o,n),oH(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=sy(),o=sw(e),i=oB(n,o);i.tag=1,i.payload=t,null!=r&&(i.callback=r),null!==(t=oU(e,i,o))&&(sS(t,e,o,n),oH(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=sy(),n=sw(e),o=oB(r,n);o.tag=2,null!=t&&(o.callback=t),null!==(t=oU(e,o,n))&&(sS(t,e,n,r),oH(t,e,n))}};function oK(e,t,r,n,o,i,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,i,a):!t.prototype||!t.prototype.isPureReactComponent||!rL(r,n)||!rL(o,i)}function oX(e,t,r){var n=!1,o=nj,i=t.contextType;return"object"==typeof i&&null!==i?i=oR(i):(o=nK(t)?nV:n$.current,i=(n=null!=(n=t.contextTypes))?nG(e,o):nj),t=new t(r,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=oG,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function oY(e,t,r,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&oG.enqueueReplaceState(t,t.state,null)}function oZ(e,t,r,n){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs=oW,oz(e);var i=t.contextType;"object"==typeof i&&null!==i?o.context=oR(i):(i=nK(t)?nV:n$.current,o.context=nG(e,i)),o.state=e.memoizedState,"function"==typeof(i=t.getDerivedStateFromProps)&&(oV(e,t,i,r),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&oG.enqueueReplaceState(o,o.state,null),oj(e,r,o,n),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4194308)}function oQ(e,t,r){if(null!==(e=r.ref)&&"function"!=typeof e&&"object"!=typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(d(309));var n=r.stateNode}if(!n)throw Error(d(147,e));var o=n,i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=o.refs;t===oW&&(t=o.refs={}),null===e?delete t[i]:t[i]=e})._stringRef=i,t)}if("string"!=typeof e)throw Error(d(284));if(!r._owner)throw Error(d(290,e))}return e}function oJ(e,t){throw Error(d(31,"[object Object]"===(e=Object.prototype.toString.call(t))?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function o0(e){return(0,e._init)(e._payload)}function o1(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=sX(e,t)).index=0,e.sibling=null,e}function i(t,r,n){return(t.index=n,e)?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function s(e,t,r,n){return null===t||6!==t.tag?(t=sJ(r,e.mode,n)).return=e:(t=o(t,r)).return=e,t}function l(e,t,r,n){var i=r.type;return i===P?u(e,t,r.props.children,n,r.key):(null!==t&&(t.elementType===i||"object"==typeof i&&null!==i&&i.$$typeof===D&&o0(i)===t.type)?(n=o(t,r.props)).ref=oQ(e,t,r):(n=sY(r.type,r.key,r.props,null,e.mode,n)).ref=oQ(e,t,r),n.return=e,n)}function c(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?(t=s0(r,e.mode,n)).return=e:(t=o(t,r.children||[])).return=e,t}function u(e,t,r,n,i){return null===t||7!==t.tag?(t=sZ(r,e.mode,n,i)).return=e:(t=o(t,r)).return=e,t}function f(e,t,r){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=sJ(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case A:return(r=sY(t.type,t.key,t.props,null,e.mode,r)).ref=oQ(e,null,t),r.return=e,r;case T:return(t=s0(t,e.mode,r)).return=e,t;case D:return f(e,(0,t._init)(t._payload),r)}if(eo(t)||H(t))return(t=sZ(t,e.mode,r,null)).return=e,t;oJ(e,t)}return null}function h(e,t,r,n){var o=null!==t?t.key:null;if("string"==typeof r&&""!==r||"number"==typeof r)return null!==o?null:s(e,t,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case A:return r.key===o?l(e,t,r,n):null;case T:return r.key===o?c(e,t,r,n):null;case D:return h(e,t,(o=r._init)(r._payload),n)}if(eo(r)||H(r))return null!==o?null:u(e,t,r,n,null);oJ(e,r)}return null}function p(e,t,r,n,o){if("string"==typeof n&&""!==n||"number"==typeof n)return s(t,e=e.get(r)||null,""+n,o);if("object"==typeof n&&null!==n){switch(n.$$typeof){case A:return l(t,e=e.get(null===n.key?r:n.key)||null,n,o);case T:return c(t,e=e.get(null===n.key?r:n.key)||null,n,o);case D:return p(e,t,r,(0,n._init)(n._payload),o)}if(eo(n)||H(n))return u(t,e=e.get(r)||null,n,o,null);oJ(t,n)}return null}return function s(l,c,u,m){if("object"==typeof u&&null!==u&&u.type===P&&null===u.key&&(u=u.props.children),"object"==typeof u&&null!==u){switch(u.$$typeof){case A:e:{for(var g=u.key,v=c;null!==v;){if(v.key===g){if((g=u.type)===P){if(7===v.tag){r(l,v.sibling),(c=o(v,u.props.children)).return=l,l=c;break e}}else if(v.elementType===g||"object"==typeof g&&null!==g&&g.$$typeof===D&&o0(g)===v.type){r(l,v.sibling),(c=o(v,u.props)).ref=oQ(l,v,u),c.return=l,l=c;break e}r(l,v);break}t(l,v),v=v.sibling}u.type===P?((c=sZ(u.props.children,l.mode,m,u.key)).return=l,l=c):((m=sY(u.type,u.key,u.props,null,l.mode,m)).ref=oQ(l,c,u),m.return=l,l=m)}return a(l);case T:e:{for(v=u.key;null!==c;){if(c.key===v){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){r(l,c.sibling),(c=o(c,u.children||[])).return=l,l=c;break e}r(l,c);break}t(l,c),c=c.sibling}(c=s0(u,l.mode,m)).return=l,l=c}return a(l);case D:return s(l,c,(v=u._init)(u._payload),m)}if(eo(u))return function(o,a,s,l){for(var c=null,u=null,d=a,m=a=0,g=null;null!==d&&m<s.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=h(o,d,s[m],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(o,d),a=i(v,a,m),null===u?c=v:u.sibling=v,u=v,d=g}if(m===s.length)return r(o,d),ou&&oo(o,m),c;if(null===d){for(;m<s.length;m++)null!==(d=f(o,s[m],l))&&(a=i(d,a,m),null===u?c=d:u.sibling=d,u=d);return ou&&oo(o,m),c}for(d=n(o,d);m<s.length;m++)null!==(g=p(d,o,m,s[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),a=i(g,a,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(o,e)}),ou&&oo(o,m),c}(l,c,u,m);if(H(u))return function(o,a,s,l){var c=H(s);if("function"!=typeof c)throw Error(d(150));if(null==(s=c.call(s)))throw Error(d(151));for(var u=c=null,m=a,g=a=0,v=null,b=s.next();null!==m&&!b.done;g++,b=s.next()){m.index>g?(v=m,m=null):v=m.sibling;var y=h(o,m,b.value,l);if(null===y){null===m&&(m=v);break}e&&m&&null===y.alternate&&t(o,m),a=i(y,a,g),null===u?c=y:u.sibling=y,u=y,m=v}if(b.done)return r(o,m),ou&&oo(o,g),c;if(null===m){for(;!b.done;g++,b=s.next())null!==(b=f(o,b.value,l))&&(a=i(b,a,g),null===u?c=b:u.sibling=b,u=b);return ou&&oo(o,g),c}for(m=n(o,m);!b.done;g++,b=s.next())null!==(b=p(m,o,g,b.value,l))&&(e&&null!==b.alternate&&m.delete(null===b.key?g:b.key),a=i(b,a,g),null===u?c=b:u.sibling=b,u=b);return e&&m.forEach(function(e){return t(o,e)}),ou&&oo(o,g),c}(l,c,u,m);oJ(l,u)}return"string"==typeof u&&""!==u||"number"==typeof u?(u=""+u,null!==c&&6===c.tag?(r(l,c.sibling),(c=o(c,u)).return=l):(r(l,c),(c=sJ(u,l.mode,m)).return=l),a(l=c)):r(l,c)}}var o2=o1(!0),o3=o1(!1),o5={},o6=nU(o5),o4=nU(o5),o8=nU(o5);function o9(e){if(e===o5)throw Error(d(174));return e}function o7(e,t){switch(nq(o8,t),nq(o4,e),nq(o6,o5),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ed(null,"");break;default:t=ed(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}nH(o6),nq(o6,t)}function ie(){nH(o6),nH(o4),nH(o8)}function it(e){o9(o8.current);var t=o9(o6.current),r=ed(t,e.type);t!==r&&(nq(o4,e),nq(o6,r))}function ir(e){o4.current===e&&(nH(o6),nH(o4))}var io=nU(0);function ii(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ia=[];function is(){for(var e=0;e<ia.length;e++)ia[e]._workInProgressVersionPrimary=null;ia.length=0}var il=_.ReactCurrentDispatcher,ic=_.ReactCurrentBatchConfig,iu=0,id=null,ih=null,ip=null,im=!1,ig=!1,iv=0,ib=0;function iy(){throw Error(d(321))}function iw(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!rF(e[r],t[r]))return!1;return!0}function iS(e,t,r,n,o,i){if(iu=i,id=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,il.current=null===e||null===e.memoizedState?i5:i6,e=r(n,o),ig){i=0;do{if(ig=!1,iv=0,25<=i)throw Error(d(301));i+=1,ip=ih=null,t.updateQueue=null,il.current=i4,e=r(n,o)}while(ig)}if(il.current=i3,t=null!==ih&&null!==ih.next,iu=0,ip=ih=id=null,im=!1,t)throw Error(d(300));return e}function iC(){var e=0!==iv;return iv=0,e}function iI(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ip?id.memoizedState=ip=e:ip=ip.next=e,ip}function ik(){if(null===ih){var e=id.alternate;e=null!==e?e.memoizedState:null}else e=ih.next;var t=null===ip?id.memoizedState:ip.next;if(null!==t)ip=t,ih=e;else{if(null===e)throw Error(d(310));e={memoizedState:(ih=e).memoizedState,baseState:ih.baseState,baseQueue:ih.baseQueue,queue:ih.queue,next:null},null===ip?id.memoizedState=ip=e:ip=ip.next=e}return ip}function iE(e,t){return"function"==typeof t?t(e):t}function i_(e){var t=ik(),r=t.queue;if(null===r)throw Error(d(311));r.lastRenderedReducer=e;var n=ih,o=n.baseQueue,i=r.pending;if(null!==i){if(null!==o){var a=o.next;o.next=i.next,i.next=a}n.baseQueue=o=i,r.pending=null}if(null!==o){i=o.next,n=n.baseState;var s=a=null,l=null,c=i;do{var u=c.lane;if((iu&u)===u)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(s=l=f,a=n):l=l.next=f,id.lanes|=u,st|=u}c=c.next}while(null!==c&&c!==i)null===l?a=n:l.next=s,rF(n,t.memoizedState)||(aa=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(null!==(e=r.interleaved)){o=e;do i=o.lane,id.lanes|=i,st|=i,o=o.next;while(o!==e)}else null===o&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function iA(e){var t=ik(),r=t.queue;if(null===r)throw Error(d(311));r.lastRenderedReducer=e;var n=r.dispatch,o=r.pending,i=t.memoizedState;if(null!==o){r.pending=null;var a=o=o.next;do i=e(i,a.action),a=a.next;while(a!==o)rF(i,t.memoizedState)||(aa=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function iT(){}function iP(e,t){var r=id,n=ik(),o=t(),i=!rF(n.memoizedState,o);if(i&&(n.memoizedState=o,aa=!0),n=n.queue,iH(ix.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||null!==ip&&1&ip.memoizedState.tag){if(r.flags|=2048,iL(9,iR.bind(null,r,n,o,t),void 0,null),null===a5)throw Error(d(349));0!=(30&iu)||iO(r,t,o)}return o}function iO(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=id.updateQueue)?(t={lastEffect:null,stores:null},id.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function iR(e,t,r,n){t.value=r,t.getSnapshot=n,iM(t)&&iN(e)}function ix(e,t,r){return r(function(){iM(t)&&iN(e)})}function iM(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!rF(e,r)}catch(e){return!0}}function iN(e){var t=oF(e,1);null!==t&&sS(t,e,1,-1)}function iF(e){var t=iI();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:iE,lastRenderedState:e},t.queue=e,e=e.dispatch=iJ.bind(null,id,e),[t.memoizedState,e]}function iL(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=id.updateQueue)?(t={lastEffect:null,stores:null},id.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function iz(){return ik().memoizedState}function iD(e,t,r,n){var o=iI();id.flags|=e,o.memoizedState=iL(1|t,r,void 0,void 0===n?null:n)}function iB(e,t,r,n){var o=ik();n=void 0===n?null:n;var i=void 0;if(null!==ih){var a=ih.memoizedState;if(i=a.destroy,null!==n&&iw(n,a.deps)){o.memoizedState=iL(t,r,i,n);return}}id.flags|=e,o.memoizedState=iL(1|t,r,i,n)}function iU(e,t){return iD(8390656,8,e,t)}function iH(e,t){return iB(2048,8,e,t)}function iq(e,t){return iB(4,2,e,t)}function ij(e,t){return iB(4,4,e,t)}function i$(e,t){return"function"==typeof t?(t(e=e()),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function iW(e,t,r){return r=null!=r?r.concat([e]):null,iB(4,4,i$.bind(null,t,e),r)}function iV(){}function iG(e,t){var r=ik();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&iw(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function iK(e,t){var r=ik();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&iw(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function iX(e,t,r){return 0==(21&iu)?(e.baseState&&(e.baseState=!1,aa=!0),e.memoizedState=r):(rF(r,t)||(r=ti(),id.lanes|=r,st|=r,e.baseState=!0),t)}function iY(e,t){var r=tc;tc=0!==r&&4>r?r:4,e(!0);var n=ic.transition;ic.transition={};try{e(!1),t()}finally{tc=r,ic.transition=n}}function iZ(){return ik().memoizedState}function iQ(e,t,r){var n=sw(e);r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},i0(e)?i1(t,r):null!==(r=oN(e,t,r,n))&&(sS(r,e,n,sy()),i2(r,t,n))}function iJ(e,t,r){var n=sw(e),o={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(i0(e))i1(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=i(a,r);if(o.hasEagerState=!0,o.eagerState=s,rF(s,a)){var l=t.interleaved;null===l?(o.next=o,oM(t)):(o.next=l.next,l.next=o),t.interleaved=o;return}}catch(e){}finally{}null!==(r=oN(e,t,o,n))&&(sS(r,e,n,o=sy()),i2(r,t,n))}}function i0(e){var t=e.alternate;return e===id||null!==t&&t===id}function i1(e,t){ig=im=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function i2(e,t,r){if(0!=(4194240&r)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,tl(e,r)}}var i3={readContext:oR,useCallback:iy,useContext:iy,useEffect:iy,useImperativeHandle:iy,useInsertionEffect:iy,useLayoutEffect:iy,useMemo:iy,useReducer:iy,useRef:iy,useState:iy,useDebugValue:iy,useDeferredValue:iy,useTransition:iy,useMutableSource:iy,useSyncExternalStore:iy,useId:iy,unstable_isNewReconciler:!1},i5={readContext:oR,useCallback:function(e,t){return iI().memoizedState=[e,void 0===t?null:t],e},useContext:oR,useEffect:iU,useImperativeHandle:function(e,t,r){return r=null!=r?r.concat([e]):null,iD(4194308,4,i$.bind(null,t,e),r)},useLayoutEffect:function(e,t){return iD(4194308,4,e,t)},useInsertionEffect:function(e,t){return iD(4,2,e,t)},useMemo:function(e,t){var r=iI();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=iI();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=iQ.bind(null,id,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},iI().memoizedState=e},useState:iF,useDebugValue:iV,useDeferredValue:function(e){return iI().memoizedState=e},useTransition:function(){var e=iF(!1),t=e[0];return e=iY.bind(null,e[1]),iI().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=id,o=iI();if(ou){if(void 0===r)throw Error(d(407));r=r()}else{if(r=t(),null===a5)throw Error(d(349));0!=(30&iu)||iO(n,t,r)}o.memoizedState=r;var i={value:r,getSnapshot:t};return o.queue=i,iU(ix.bind(null,n,i,e),[e]),n.flags|=2048,iL(9,iR.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=iI(),t=a5.identifierPrefix;if(ou){var r=on,n=or;t=":"+t+"R"+(r=(n&~(1<<32-e8(n)-1)).toString(32)+r),0<(r=iv++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=ib++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},i6={readContext:oR,useCallback:iG,useContext:oR,useEffect:iH,useImperativeHandle:iW,useInsertionEffect:iq,useLayoutEffect:ij,useMemo:iK,useReducer:i_,useRef:iz,useState:function(){return i_(iE)},useDebugValue:iV,useDeferredValue:function(e){return iX(ik(),ih.memoizedState,e)},useTransition:function(){return[i_(iE)[0],ik().memoizedState]},useMutableSource:iT,useSyncExternalStore:iP,useId:iZ,unstable_isNewReconciler:!1},i4={readContext:oR,useCallback:iG,useContext:oR,useEffect:iH,useImperativeHandle:iW,useInsertionEffect:iq,useLayoutEffect:ij,useMemo:iK,useReducer:iA,useRef:iz,useState:function(){return iA(iE)},useDebugValue:iV,useDeferredValue:function(e){var t=ik();return null===ih?t.memoizedState=e:iX(t,ih.memoizedState,e)},useTransition:function(){return[iA(iE)[0],ik().memoizedState]},useMutableSource:iT,useSyncExternalStore:iP,useId:iZ,unstable_isNewReconciler:!1};function i8(e,t){try{var r="",n=t;do r+=function(e){switch(e.tag){case 5:return $(e.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}(n),n=n.return;while(n)var o=r}catch(e){o="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:o,digest:null}}function i9(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}var i7="function"==typeof WeakMap?WeakMap:Map;function ae(e,t,r){(r=oB(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){sc||(sc=!0,su=n)},r}function at(e,t,r){(r=oB(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"==typeof n){var o=t.value;r.payload=function(){return n(o)},r.callback=function(){}}var i=e.stateNode;return null!==i&&"function"==typeof i.componentDidCatch&&(r.callback=function(){"function"!=typeof n&&(null===sd?sd=new Set([this]):sd.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function ar(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new i7;var o=new Set;n.set(t,o)}else void 0===(o=n.get(t))&&(o=new Set,n.set(t,o));o.has(r)||(o.add(r),e=sq.bind(null,e,t,r),t.then(e,e))}function an(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e)return null}function ao(e,t,r,n,o){return 0==(1&e.mode)?e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=oB(-1,1)).tag=2,oU(r,t,1))),r.lanes|=1):(e.flags|=65536,e.lanes=o),e}var ai=_.ReactCurrentOwner,aa=!1;function as(e,t,r,n){t.child=null===e?o3(t,null,r,n):o2(t,e.child,r,n)}function al(e,t,r,n,o){r=r.render;var i=t.ref;return(oO(t,o),n=iS(e,t,r,n,i,o),r=iC(),null===e||aa)?(ou&&r&&oa(t),t.flags|=1,as(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,aA(e,t,o))}function ac(e,t,r,n,o){if(null===e){var i=r.type;return"function"!=typeof i||sK(i)||void 0!==i.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=sY(r.type,null,n,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,au(e,t,i,n,o))}if(i=e.child,0==(e.lanes&o)){var a=i.memoizedProps;if((r=null!==(r=r.compare)?r:rL)(a,n)&&e.ref===t.ref)return aA(e,t,o)}return t.flags|=1,(e=sX(i,n)).ref=t.ref,e.return=t,t.child=e}function au(e,t,r,n,o){if(null!==e){var i=e.memoizedProps;if(rL(i,n)&&e.ref===t.ref){if(aa=!1,t.pendingProps=n=i,0==(e.lanes&o))return t.lanes=e.lanes,aA(e,t,o);0!=(131072&e.flags)&&(aa=!0)}}return ah(e,t,r,n,o)}function ad(e,t,r){var n=t.pendingProps,o=n.children,i=null!==e?e.memoizedState:null;if("hidden"===n.mode){if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},nq(a9,a8),a8|=r;else{if(0==(0x40000000&r))return e=null!==i?i.baseLanes|r:r,t.lanes=t.childLanes=0x40000000,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,nq(a9,a8),a8|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==i?i.baseLanes:r,nq(a9,a8),a8|=n}}else null!==i?(n=i.baseLanes|r,t.memoizedState=null):n=r,nq(a9,a8),a8|=n;return as(e,t,o,r),t.child}function af(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ah(e,t,r,n,o){var i=nK(r)?nV:n$.current;return(i=nG(t,i),oO(t,o),r=iS(e,t,r,n,i,o),n=iC(),null===e||aa)?(ou&&n&&oa(t),t.flags|=1,as(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,aA(e,t,o))}function ap(e,t,r,n,o){if(nK(r)){var i=!0;nQ(t)}else i=!1;if(oO(t,o),null===t.stateNode)a_(e,t),oX(t,r,n),oZ(t,r,n,o),n=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,c=r.contextType;c="object"==typeof c&&null!==c?oR(c):nG(t,c=nK(r)?nV:n$.current);var u=r.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof a.getSnapshotBeforeUpdate;d||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==n||l!==c)&&oY(t,a,n,c),oL=!1;var f=t.memoizedState;a.state=f,oj(t,n,a,o),l=t.memoizedState,s!==n||f!==l||nW.current||oL?("function"==typeof u&&(oV(t,r,u,n),l=t.memoizedState),(s=oL||oK(t,r,s,n,f,l,c))?(d||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4194308)):("function"==typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=s):("function"==typeof a.componentDidMount&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,oD(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:oC(t.type,s),a.props=c,d=t.pendingProps,f=a.context,l="object"==typeof(l=r.contextType)&&null!==l?oR(l):nG(t,l=nK(r)?nV:n$.current);var h=r.getDerivedStateFromProps;(u="function"==typeof h||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==d||f!==l)&&oY(t,a,n,l),oL=!1,f=t.memoizedState,a.state=f,oj(t,n,a,o);var p=t.memoizedState;s!==d||f!==p||nW.current||oL?("function"==typeof h&&(oV(t,r,h,n),p=t.memoizedState),(c=oL||oK(t,r,c,n,f,p,l)||!1)?(u||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(n,p,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,p,l)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),a.props=n,a.state=p,a.context=l,n=c):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return am(e,t,r,n,i,o)}function am(e,t,r,n,o,i){af(e,t);var a=0!=(128&t.flags);if(!n&&!a)return o&&nJ(t,r,!1),aA(e,t,i);n=t.stateNode,ai.current=t;var s=a&&"function"!=typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&a?(t.child=o2(t,e.child,null,i),t.child=o2(t,null,s,i)):as(e,t,s,i),t.memoizedState=n.state,o&&nJ(t,r,!0),t.child}function ag(e){var t=e.stateNode;t.pendingContext?nY(e,t.pendingContext,t.pendingContext!==t.context):t.context&&nY(e,t.context,!1),o7(e,t.containerInfo)}function av(e,t,r,n,o){return oy(),ow(o),t.flags|=256,as(e,t,r,n),t.child}var ab={dehydrated:null,treeContext:null,retryLane:0};function ay(e){return{baseLanes:e,cachePool:null,transitions:null}}function aw(e,t,r){var n,o=t.pendingProps,i=io.current,a=!1,s=0!=(128&t.flags);if((n=s)||(n=(null===e||null!==e.memoizedState)&&0!=(2&i)),n?(a=!0,t.flags&=-129):(null===e||null!==e.memoizedState)&&(i|=1),nq(io,1&i),null===e)return(om(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated))?(0==(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=0x40000000,null):(s=o.children,e=o.fallback,a?(o=t.mode,a=t.child,s={mode:"hidden",children:s},0==(1&o)&&null!==a?(a.childLanes=0,a.pendingProps=s):a=sQ(s,o,0,null),e=sZ(e,o,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=ay(r),t.memoizedState=ab,e):aS(t,s));if(null!==(i=e.memoizedState)&&null!==(n=i.dehydrated))return function(e,t,r,n,o,i,a){if(r)return 256&t.flags?(t.flags&=-257,aC(e,t,a,n=i9(Error(d(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=n.fallback,o=t.mode,n=sQ({mode:"visible",children:n.children},o,0,null),i=sZ(i,o,a,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,0!=(1&t.mode)&&o2(t,e.child,null,a),t.child.memoizedState=ay(a),t.memoizedState=ab,i);if(0==(1&t.mode))return aC(e,t,a,null);if("$!"===o.data){if(n=o.nextSibling&&o.nextSibling.dataset)var s=n.dgst;return n=s,aC(e,t,a,n=i9(i=Error(d(419)),n,void 0))}if(s=0!=(a&e.childLanes),aa||s){if(null!==(n=a5)){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 0x1000000:case 0x2000000:case 0x4000000:o=32;break;case 0x20000000:o=0x10000000;break;default:o=0}0!==(o=0!=(o&(n.suspendedLanes|a))?0:o)&&o!==i.retryLane&&(i.retryLane=o,oF(e,o),sS(n,e,o,-1))}return sN(),aC(e,t,a,n=i9(Error(d(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=s$.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,oc=nE(o.nextSibling),ol=t,ou=!0,od=null,null!==e&&(n7[oe++]=or,n7[oe++]=on,n7[oe++]=ot,or=e.id,on=e.overflow,ot=t),t=aS(t,n.children),t.flags|=4096,t)}(e,t,s,o,n,i,r);if(a){a=o.fallback,s=t.mode,n=(i=e.child).sibling;var l={mode:"hidden",children:o.children};return 0==(1&s)&&t.child!==i?((o=t.child).childLanes=0,o.pendingProps=l,t.deletions=null):(o=sX(i,l)).subtreeFlags=0xe00000&i.subtreeFlags,null!==n?a=sX(n,a):(a=sZ(a,s,r,null),a.flags|=2),a.return=t,o.return=t,o.sibling=a,t.child=o,o=a,a=t.child,s=null===(s=e.child.memoizedState)?ay(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=e.childLanes&~r,t.memoizedState=ab,o}return e=(a=e.child).sibling,o=sX(a,{mode:"visible",children:o.children}),0==(1&t.mode)&&(o.lanes=r),o.return=t,o.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=o,t.memoizedState=null,o}function aS(e,t){return(t=sQ({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function aC(e,t,r,n){return null!==n&&ow(n),o2(t,e.child,null,r),e=aS(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function aI(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),oP(e.return,t,r)}function ak(e,t,r,n,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=o)}function aE(e,t,r){var n=t.pendingProps,o=n.revealOrder,i=n.tail;if(as(e,t,n.children,r),0!=(2&(n=io.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&aI(e,r,t);else if(19===e.tag)aI(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(nq(io,n),0==(1&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(o=null,r=t.child;null!==r;)null!==(e=r.alternate)&&null===ii(e)&&(o=r),r=r.sibling;null===(r=o)?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),ak(t,!1,o,r,i);break;case"backwards":for(r=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ii(e)){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}ak(t,!0,r,null,i);break;case"together":ak(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function a_(e,t){0==(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function aA(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),st|=t.lanes,0==(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(d(153));if(null!==t.child){for(r=sX(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=sX(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function aT(e,t){if(!ou)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function aP(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var o=e.child;null!==o;)r|=o.lanes|o.childLanes,n|=0xe00000&o.subtreeFlags,n|=0xe00000&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags,n|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}o=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},i=function(){},a=function(e,t,r,n){var o=e.memoizedProps;if(o!==n){e=t.stateNode,o9(o6.current);var i,a=null;switch(r){case"input":o=Q(e,o),n=Q(e,n),a=[];break;case"select":o=j({},o,{value:void 0}),n=j({},n,{value:void 0}),a=[];break;case"textarea":o=ea(e,o),n=ea(e,n),a=[];break;default:"function"!=typeof o.onClick&&"function"==typeof n.onClick&&(e.onclick=nm)}for(c in ew(r,n),r=null,o)if(!n.hasOwnProperty(c)&&o.hasOwnProperty(c)&&null!=o[c]){if("style"===c){var s=o[c];for(i in s)s.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(h.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null))}for(c in n){var l=n[c];if(s=null!=o?o[c]:void 0,n.hasOwnProperty(c)&&l!==s&&(null!=l||null!=s)){if("style"===c){if(s){for(i in s)!s.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&s[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(c,r)),r=l}else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,s=s?s.__html:void 0,null!=l&&s!==l&&(a=a||[]).push(c,l)):"children"===c?"string"!=typeof l&&"number"!=typeof l||(a=a||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(h.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&nt("scroll",e),a||s===l||(a=[])):(a=a||[]).push(c,l))}}r&&(a=a||[]).push("style",r);var c=a;(t.updateQueue=c)&&(t.flags|=4)}},s=function(e,t,r,n){r!==n&&(t.flags|=4)};var aO=!1,aR=!1,ax="function"==typeof WeakSet?WeakSet:Set,aM=null;function aN(e,t){var r=e.ref;if(null!==r){if("function"==typeof r)try{r(null)}catch(r){sH(e,t,r)}else r.current=null}}function aF(e,t,r){try{r()}catch(r){sH(e,t,r)}}var aL=!1;function az(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var o=n=n.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,void 0!==i&&aF(t,r,i)}o=o.next}while(o!==n)}}function aD(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function aB(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"==typeof t?t(e):t.current=e}}function aU(e){return 5===e.tag||3===e.tag||4===e.tag}function aH(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||aU(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags||null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}var aq=null,aj=!1;function a$(e,t,r){for(r=r.child;null!==r;)aW(e,t,r),r=r.sibling}function aW(e,t,r){if(e4&&"function"==typeof e4.onCommitFiberUnmount)try{e4.onCommitFiberUnmount(e6,r)}catch(e){}switch(r.tag){case 5:aR||aN(r,t);case 6:var n=aq,o=aj;aq=null,a$(e,t,r),aq=n,aj=o,null!==aq&&(aj?(e=aq,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):aq.removeChild(r.stateNode));break;case 18:null!==aq&&(aj?(e=aq,r=r.stateNode,8===e.nodeType?nk(e.parentNode,r):1===e.nodeType&&nk(e,r),tx(e)):nk(aq,r.stateNode));break;case 4:n=aq,o=aj,aq=r.stateNode.containerInfo,aj=!0,a$(e,t,r),aq=n,aj=o;break;case 0:case 11:case 14:case 15:if(!aR&&null!==(n=r.updateQueue)&&null!==(n=n.lastEffect)){o=n=n.next;do{var i=o,a=i.destroy;i=i.tag,void 0!==a&&(0!=(2&i)?aF(r,t,a):0!=(4&i)&&aF(r,t,a)),o=o.next}while(o!==n)}a$(e,t,r);break;case 1:if(!aR&&(aN(r,t),"function"==typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(e){sH(r,t,e)}a$(e,t,r);break;case 21:default:a$(e,t,r);break;case 22:1&r.mode?(aR=(n=aR)||null!==r.memoizedState,a$(e,t,r),aR=n):a$(e,t,r)}}function aV(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new ax),t.forEach(function(t){var n=sW.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))})}}function aG(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var o=r[n];try{var i=t,a=i;e:for(;null!==a;){switch(a.tag){case 5:aq=a.stateNode,aj=!1;break e;case 3:case 4:aq=a.stateNode.containerInfo,aj=!0;break e}a=a.return}if(null===aq)throw Error(d(160));aW(e,i,o),aq=null,aj=!1;var s=o.alternate;null!==s&&(s.return=null),o.return=null}catch(e){sH(o,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)aK(t,e),t=t.sibling}function aK(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(aG(t,e),aX(e),4&n){try{az(3,e,e.return),aD(3,e)}catch(t){sH(e,e.return,t)}try{az(5,e,e.return)}catch(t){sH(e,e.return,t)}}break;case 1:aG(t,e),aX(e),512&n&&null!==r&&aN(r,r.return);break;case 5:if(aG(t,e),aX(e),512&n&&null!==r&&aN(r,r.return),32&e.flags){var o=e.stateNode;try{ep(o,"")}catch(t){sH(e,e.return,t)}}if(4&n&&null!=(o=e.stateNode)){var i=e.memoizedProps,a=null!==r?r.memoizedProps:i,s=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===s&&"radio"===i.type&&null!=i.name&&ee(o,i),eS(s,a);var c=eS(s,i);for(a=0;a<l.length;a+=2){var u=l[a],f=l[a+1];"style"===u?eb(o,f):"dangerouslySetInnerHTML"===u?eh(o,f):"children"===u?ep(o,f):E(o,u,f,c)}switch(s){case"input":et(o,i);break;case"textarea":el(o,i);break;case"select":var h=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var p=i.value;null!=p?ei(o,!!i.multiple,p,!1):!!i.multiple!==h&&(null!=i.defaultValue?ei(o,!!i.multiple,i.defaultValue,!0):ei(o,!!i.multiple,i.multiple?[]:"",!1))}o[nP]=i}catch(t){sH(e,e.return,t)}}break;case 6:if(aG(t,e),aX(e),4&n){if(null===e.stateNode)throw Error(d(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(t){sH(e,e.return,t)}}break;case 3:if(aG(t,e),aX(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{tx(t.containerInfo)}catch(t){sH(e,e.return,t)}break;case 4:default:aG(t,e),aX(e);break;case 13:aG(t,e),aX(e),8192&(o=e.child).flags&&(i=null!==o.memoizedState,o.stateNode.isHidden=i,i&&(null===o.alternate||null===o.alternate.memoizedState)&&(sa=eQ())),4&n&&aV(e);break;case 22:if(u=null!==r&&null!==r.memoizedState,1&e.mode?(aR=(c=aR)||u,aG(t,e),aR=c):aG(t,e),aX(e),8192&n){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!u&&0!=(1&e.mode))for(aM=e,u=e.child;null!==u;){for(f=aM=u;null!==aM;){switch(p=(h=aM).child,h.tag){case 0:case 11:case 14:case 15:az(4,h,h.return);break;case 1:aN(h,h.return);var m=h.stateNode;if("function"==typeof m.componentWillUnmount){n=h,r=h.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(e){sH(n,r,e)}}break;case 5:aN(h,h.return);break;case 22:if(null!==h.memoizedState){aZ(f);continue}}null!==p?(p.return=h,aM=p):aZ(f)}u=u.sibling}e:for(u=null,f=e;;){if(5===f.tag){if(null===u){u=f;try{o=f.stateNode,c?(i=o.style,"function"==typeof i.setProperty?i.setProperty("display","none","important"):i.display="none"):(s=f.stateNode,a=null!=(l=f.memoizedProps.style)&&l.hasOwnProperty("display")?l.display:null,s.style.display=ev("display",a))}catch(t){sH(e,e.return,t)}}}else if(6===f.tag){if(null===u)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(t){sH(e,e.return,t)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:aG(t,e),aX(e),4&n&&aV(e);case 21:}}function aX(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(aU(r)){var n=r;break e}r=r.return}throw Error(d(160))}switch(n.tag){case 5:var o=n.stateNode;32&n.flags&&(ep(o,""),n.flags&=-33);var i=aH(e);!function e(t,r,n){var o=t.tag;if(5===o||6===o)t=t.stateNode,r?n.insertBefore(t,r):n.appendChild(t);else if(4!==o&&null!==(t=t.child))for(e(t,r,n),t=t.sibling;null!==t;)e(t,r,n),t=t.sibling}(e,i,o);break;case 3:case 4:var a=n.stateNode.containerInfo,s=aH(e);!function e(t,r,n){var o=t.tag;if(5===o||6===o)t=t.stateNode,r?8===n.nodeType?n.parentNode.insertBefore(t,r):n.insertBefore(t,r):(8===n.nodeType?(r=n.parentNode).insertBefore(t,n):(r=n).appendChild(t),null!=(n=n._reactRootContainer)||null!==r.onclick||(r.onclick=nm));else if(4!==o&&null!==(t=t.child))for(e(t,r,n),t=t.sibling;null!==t;)e(t,r,n),t=t.sibling}(e,s,a);break;default:throw Error(d(161))}}catch(t){sH(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function aY(e){for(;null!==aM;){var t=aM;if(0!=(8772&t.flags)){var r=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:aR||aD(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!aR){if(null===r)n.componentDidMount();else{var o=t.elementType===t.type?r.memoizedProps:oC(t.type,r.memoizedProps);n.componentDidUpdate(o,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}}var i=t.updateQueue;null!==i&&o$(t,i,n);break;case 3:var a=t.updateQueue;if(null!==a){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}o$(t,a,r)}break;case 5:var s=t.stateNode;if(null===r&&4&t.flags){r=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var u=c.memoizedState;if(null!==u){var f=u.dehydrated;null!==f&&tx(f)}}}break;default:throw Error(d(163))}aR||512&t.flags&&aB(t)}catch(e){sH(t,t.return,e)}}if(t===e){aM=null;break}if(null!==(r=t.sibling)){r.return=t.return,aM=r;break}aM=t.return}}function aZ(e){for(;null!==aM;){var t=aM;if(t===e){aM=null;break}var r=t.sibling;if(null!==r){r.return=t.return,aM=r;break}aM=t.return}}function aQ(e){for(;null!==aM;){var t=aM;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{aD(4,t)}catch(e){sH(t,r,e)}break;case 1:var n=t.stateNode;if("function"==typeof n.componentDidMount){var o=t.return;try{n.componentDidMount()}catch(e){sH(t,o,e)}}var i=t.return;try{aB(t)}catch(e){sH(t,i,e)}break;case 5:var a=t.return;try{aB(t)}catch(e){sH(t,a,e)}}}catch(e){sH(t,t.return,e)}if(t===e){aM=null;break}var s=t.sibling;if(null!==s){s.return=t.return,aM=s;break}aM=t.return}}var aJ=Math.ceil,a0=_.ReactCurrentDispatcher,a1=_.ReactCurrentOwner,a2=_.ReactCurrentBatchConfig,a3=0,a5=null,a6=null,a4=0,a8=0,a9=nU(0),a7=0,se=null,st=0,sr=0,sn=0,so=null,si=null,sa=0,ss=1/0,sl=null,sc=!1,su=null,sd=null,sf=!1,sh=null,sp=0,sm=0,sg=null,sv=-1,sb=0;function sy(){return 0!=(6&a3)?eQ():-1!==sv?sv:sv=eQ()}function sw(e){return 0==(1&e.mode)?1:0!=(2&a3)&&0!==a4?a4&-a4:null!==oS.transition?(0===sb&&(sb=ti()),sb):0!==(e=tc)?e:e=void 0===(e=window.event)?16:tU(e.type)}function sS(e,t,r,n){if(50<sm)throw sm=0,sg=null,Error(d(185));ts(e,r,n),(0==(2&a3)||e!==a5)&&(e===a5&&(0==(2&a3)&&(sr|=r),4===a7&&s_(e,a4)),sC(e,n),1===r&&0===a3&&0==(1&t.mode)&&(ss=eQ()+500,n1&&n5()))}function sC(e,t){var r,n=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-e8(i),s=1<<a,l=o[a];-1===l?(0==(s&r)||0!=(s&n))&&(o[a]=function(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return -1}}(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var o=tn(e,e===a5?a4:0);if(0===o)null!==n&&eX(n),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(null!=n&&eX(n),1===t)0===e.tag?(r=sA.bind(null,e),n1=!0,n3(r)):n3(sA.bind(null,e)),nC(function(){0==(6&a3)&&n5()}),n=null;else{switch(tu(o)){case 1:n=e0;break;case 4:n=e1;break;case 16:default:n=e2;break;case 0x20000000:n=e5}n=eK(n,sI.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sI(e,t){if(sv=-1,sb=0,0!=(6&a3))throw Error(d(327));var r=e.callbackNode;if(sB()&&e.callbackNode!==r)return null;var n=tn(e,e===a5?a4:0);if(0===n)return null;if(0!=(30&n)||0!=(n&e.expiredLanes)||t)t=sF(e,n);else{t=n;var o=a3;a3|=2;var i=sM();for((a5!==e||a4!==t)&&(sl=null,ss=eQ()+500,sR(e,t));;)try{(function(){for(;null!==a6&&!eY();)sL(a6)})();break}catch(t){sx(e,t)}oA(),a0.current=i,a3=o,null!==a6?t=0:(a5=null,a4=0,t=a7)}if(0!==t){if(2===t&&0!==(o=to(e))&&(n=o,t=sk(e,o)),1===t)throw r=se,sR(e,0),s_(e,n),sC(e,eQ()),r;if(6===t)s_(e,n);else{if(o=e.current.alternate,0==(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var o=r[n],i=o.getSnapshot;o=o.value;try{if(!rF(i(),o))return!1}catch(e){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=sF(e,n))&&0!==(i=to(e))&&(n=i,t=sk(e,i)),1===t))throw r=se,sR(e,0),s_(e,n),sC(e,eQ()),r;switch(e.finishedWork=o,e.finishedLanes=n,t){case 0:case 1:throw Error(d(345));case 2:case 5:sD(e,si,sl);break;case 3:if(s_(e,n),(0x7c00000&n)===n&&10<(t=sa+500-eQ())){if(0!==tn(e,0))break;if(((o=e.suspendedLanes)&n)!==n){sy(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ny(sD.bind(null,e,si,sl),t);break}sD(e,si,sl);break;case 4:if(s_(e,n),(4194240&n)===n)break;for(o=-1,t=e.eventTimes;0<n;){var a=31-e8(n);i=1<<a,(a=t[a])>o&&(o=a),n&=~i}if(n=o,10<(n=(120>(n=eQ()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*aJ(n/1960))-n)){e.timeoutHandle=ny(sD.bind(null,e,si,sl),n);break}sD(e,si,sl);break;default:throw Error(d(329))}}}return sC(e,eQ()),e.callbackNode===r?sI.bind(null,e):null}function sk(e,t){var r=so;return e.current.memoizedState.isDehydrated&&(sR(e,t).flags|=256),2!==(e=sF(e,t))&&(t=si,si=r,null!==t&&sE(t)),e}function sE(e){null===si?si=e:si.push.apply(si,e)}function s_(e,t){for(t&=~sn,t&=~sr,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-e8(t),n=1<<r;e[r]=-1,t&=~n}}function sA(e){if(0!=(6&a3))throw Error(d(327));sB();var t=tn(e,0);if(0==(1&t))return sC(e,eQ()),null;var r=sF(e,t);if(0!==e.tag&&2===r){var n=to(e);0!==n&&(t=n,r=sk(e,n))}if(1===r)throw r=se,sR(e,0),s_(e,t),sC(e,eQ()),r;if(6===r)throw Error(d(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,sD(e,si,sl),sC(e,eQ()),null}function sT(e,t){var r=a3;a3|=1;try{return e(t)}finally{0===(a3=r)&&(ss=eQ()+500,n1&&n5())}}function sP(e){null!==sh&&0===sh.tag&&0==(6&a3)&&sB();var t=a3;a3|=1;var r=a2.transition,n=tc;try{if(a2.transition=null,tc=1,e)return e()}finally{tc=n,a2.transition=r,0==(6&(a3=t))&&n5()}}function sO(){a8=a9.current,nH(a9)}function sR(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,nw(r)),null!==a6)for(r=a6.return;null!==r;){var n=r;switch(os(n),n.tag){case 1:null!=(n=n.type.childContextTypes)&&nX();break;case 3:ie(),nH(nW),nH(n$),is();break;case 5:ir(n);break;case 4:ie();break;case 13:case 19:nH(io);break;case 10:oT(n.type._context);break;case 22:case 23:sO()}r=r.return}if(a5=e,a6=e=sX(e.current,null),a4=a8=t,a7=0,se=null,sn=sr=st=0,si=so=null,null!==ox){for(t=0;t<ox.length;t++)if(null!==(n=(r=ox[t]).interleaved)){r.interleaved=null;var o=n.next,i=r.pending;if(null!==i){var a=i.next;i.next=o,n.next=a}r.pending=n}ox=null}return e}function sx(e,t){for(;;){var r=a6;try{if(oA(),il.current=i3,im){for(var n=id.memoizedState;null!==n;){var o=n.queue;null!==o&&(o.pending=null),n=n.next}im=!1}if(iu=0,ip=ih=id=null,ig=!1,iv=0,a1.current=null,null===r||null===r.return){a7=1,se=t,a6=null;break}e:{var i=e,a=r.return,s=r,l=t;if(t=a4,s.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var c=l,u=s,f=u.tag;if(0==(1&u.mode)&&(0===f||11===f||15===f)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=an(a);if(null!==p){p.flags&=-257,ao(p,a,s,i,t),1&p.mode&&ar(i,c,t),t=p,l=c;var m=t.updateQueue;if(null===m){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}if(0==(1&t)){ar(i,c,t),sN();break e}l=Error(d(426))}else if(ou&&1&s.mode){var v=an(a);if(null!==v){0==(65536&v.flags)&&(v.flags|=256),ao(v,a,s,i,t),ow(i8(l,s));break e}}i=l=i8(l,s),4!==a7&&(a7=2),null===so?so=[i]:so.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var b=ae(i,l,t);oq(i,b);break e;case 1:s=l;var y=i.type,w=i.stateNode;if(0==(128&i.flags)&&("function"==typeof y.getDerivedStateFromError||null!==w&&"function"==typeof w.componentDidCatch&&(null===sd||!sd.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var S=at(i,s,t);oq(i,S);break e}}i=i.return}while(null!==i)}sz(r)}catch(e){t=e,a6===r&&null!==r&&(a6=r=r.return);continue}break}}function sM(){var e=a0.current;return a0.current=i3,null===e?i3:e}function sN(){(0===a7||3===a7||2===a7)&&(a7=4),null===a5||0==(0xfffffff&st)&&0==(0xfffffff&sr)||s_(a5,a4)}function sF(e,t){var r=a3;a3|=2;var n=sM();for((a5!==e||a4!==t)&&(sl=null,sR(e,t));;)try{(function(){for(;null!==a6;)sL(a6)})();break}catch(t){sx(e,t)}if(oA(),a3=r,a0.current=n,null!==a6)throw Error(d(261));return a5=null,a4=0,a7}function sL(e){var t=l(e.alternate,e,a8);e.memoizedProps=e.pendingProps,null===t?sz(e):a6=t,a1.current=null}function sz(e){var t=e;do{var r=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(r=function(e,t,r){var n=t.pendingProps;switch(os(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return aP(t),null;case 1:case 17:return nK(t.type)&&nX(),aP(t),null;case 3:return n=t.stateNode,ie(),nH(nW),nH(n$),is(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(null===e||null===e.child)&&(ov(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==od&&(sE(od),od=null))),i(e,t),aP(t),null;case 5:ir(t);var l=o9(o8.current);if(r=t.type,null!==e&&null!=t.stateNode)a(e,t,r,n,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(d(166));return aP(t),null}if(e=o9(o6.current),ov(t)){n=t.stateNode,r=t.type;var c=t.memoizedProps;switch(n[nT]=t,n[nP]=c,e=0!=(1&t.mode),r){case"dialog":nt("cancel",n),nt("close",n);break;case"iframe":case"object":case"embed":nt("load",n);break;case"video":case"audio":for(l=0;l<r8.length;l++)nt(r8[l],n);break;case"source":nt("error",n);break;case"img":case"image":case"link":nt("error",n),nt("load",n);break;case"details":nt("toggle",n);break;case"input":J(n,c),nt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!c.multiple},nt("invalid",n);break;case"textarea":es(n,c),nt("invalid",n)}for(var u in ew(r,c),l=null,c)if(c.hasOwnProperty(u)){var f=c[u];"children"===u?"string"==typeof f?n.textContent!==f&&(!0!==c.suppressHydrationWarning&&np(n.textContent,f,e),l=["children",f]):"number"==typeof f&&n.textContent!==""+f&&(!0!==c.suppressHydrationWarning&&np(n.textContent,f,e),l=["children",""+f]):h.hasOwnProperty(u)&&null!=f&&"onScroll"===u&&nt("scroll",n)}switch(r){case"input":X(n),er(n,c,!0);break;case"textarea":X(n),ec(n);break;case"select":case"option":break;default:"function"==typeof c.onClick&&(n.onclick=nm)}n=l,t.updateQueue=n,null!==n&&(t.flags|=4)}else{u=9===l.nodeType?l:l.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=eu(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof n.is?e=u.createElement(r,{is:n.is}):(e=u.createElement(r),"select"===r&&(u=e,n.multiple?u.multiple=!0:n.size&&(u.size=n.size))):e=u.createElementNS(e,r),e[nT]=t,e[nP]=n,o(e,t,!1,!1),t.stateNode=e;e:{switch(u=eS(r,n),r){case"dialog":nt("cancel",e),nt("close",e),l=n;break;case"iframe":case"object":case"embed":nt("load",e),l=n;break;case"video":case"audio":for(l=0;l<r8.length;l++)nt(r8[l],e);l=n;break;case"source":nt("error",e),l=n;break;case"img":case"image":case"link":nt("error",e),nt("load",e),l=n;break;case"details":nt("toggle",e),l=n;break;case"input":J(e,n),l=Q(e,n),nt("invalid",e);break;case"option":default:l=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},l=j({},n,{value:void 0}),nt("invalid",e);break;case"textarea":es(e,n),l=ea(e,n),nt("invalid",e)}for(c in ew(r,l),f=l)if(f.hasOwnProperty(c)){var p=f[c];"style"===c?eb(e,p):"dangerouslySetInnerHTML"===c?null!=(p=p?p.__html:void 0)&&eh(e,p):"children"===c?"string"==typeof p?("textarea"!==r||""!==p)&&ep(e,p):"number"==typeof p&&ep(e,""+p):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(h.hasOwnProperty(c)?null!=p&&"onScroll"===c&&nt("scroll",e):null!=p&&E(e,c,p,u))}switch(r){case"input":X(e),er(e,n,!1);break;case"textarea":X(e),ec(e);break;case"option":null!=n.value&&e.setAttribute("value",""+G(n.value));break;case"select":e.multiple=!!n.multiple,null!=(c=n.value)?ei(e,!!n.multiple,c,!1):null!=n.defaultValue&&ei(e,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof l.onClick&&(e.onclick=nm)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return aP(t),null;case 6:if(e&&null!=t.stateNode)s(e,t,e.memoizedProps,n);else{if("string"!=typeof n&&null===t.stateNode)throw Error(d(166));if(r=o9(o8.current),o9(o6.current),ov(t)){if(n=t.stateNode,r=t.memoizedProps,n[nT]=t,(c=n.nodeValue!==r)&&null!==(e=ol))switch(e.tag){case 3:np(n.nodeValue,r,0!=(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&np(n.nodeValue,r,0!=(1&e.mode))}c&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[nT]=t,t.stateNode=n}return aP(t),null;case 13:if(nH(io),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ou&&null!==oc&&0!=(1&t.mode)&&0==(128&t.flags))ob(),oy(),t.flags|=98560,c=!1;else if(c=ov(t),null!==n&&null!==n.dehydrated){if(null===e){if(!c)throw Error(d(318));if(!(c=null!==(c=t.memoizedState)?c.dehydrated:null))throw Error(d(317));c[nT]=t}else oy(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;aP(t),c=!1}else null!==od&&(sE(od),od=null),c=!0;if(!c)return 65536&t.flags?t:null}if(0!=(128&t.flags))return t.lanes=r,t;return(n=null!==n)!=(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!=(1&t.mode)&&(null===e||0!=(1&io.current)?0===a7&&(a7=3):sN())),null!==t.updateQueue&&(t.flags|=4),aP(t),null;case 4:return ie(),i(e,t),null===e&&no(t.stateNode.containerInfo),aP(t),null;case 10:return oT(t.type._context),aP(t),null;case 19:if(nH(io),null===(c=t.memoizedState))return aP(t),null;if(n=0!=(128&t.flags),null===(u=c.rendering)){if(n)aT(c,!1);else{if(0!==a7||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=ii(e))){for(t.flags|=128,aT(c,!1),null!==(n=u.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)c=r,e=n,c.flags&=0xe00002,null===(u=c.alternate)?(c.childLanes=0,c.lanes=e,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=u.childLanes,c.lanes=u.lanes,c.child=u.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=u.memoizedProps,c.memoizedState=u.memoizedState,c.updateQueue=u.updateQueue,c.type=u.type,e=u.dependencies,c.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return nq(io,1&io.current|2),t.child}e=e.sibling}null!==c.tail&&eQ()>ss&&(t.flags|=128,n=!0,aT(c,!1),t.lanes=4194304)}}else{if(!n){if(null!==(e=ii(u))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),aT(c,!0),null===c.tail&&"hidden"===c.tailMode&&!u.alternate&&!ou)return aP(t),null}else 2*eQ()-c.renderingStartTime>ss&&0x40000000!==r&&(t.flags|=128,n=!0,aT(c,!1),t.lanes=4194304)}c.isBackwards?(u.sibling=t.child,t.child=u):(null!==(r=c.last)?r.sibling=u:t.child=u,c.last=u)}if(null!==c.tail)return t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=eQ(),t.sibling=null,r=io.current,nq(io,n?1&r|2:1&r),t;return aP(t),null;case 22:case 23:return sO(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!=(1&t.mode)?0!=(0x40000000&a8)&&(aP(t),6&t.subtreeFlags&&(t.flags|=8192)):aP(t),null;case 24:case 25:return null}throw Error(d(156,t.tag))}(r,t,a8))){a6=r;return}}else{if(null!==(r=function(e,t){switch(os(t),t.tag){case 1:return nK(t.type)&&nX(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ie(),nH(nW),nH(n$),is(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ir(t),null;case 13:if(nH(io),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(d(340));oy()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return nH(io),null;case 4:return ie(),null;case 10:return oT(t.type._context),null;case 22:case 23:return sO(),null;default:return null}}(r,t))){r.flags&=32767,a6=r;return}if(null!==e)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{a7=6,a6=null;return}}if(null!==(t=t.sibling)){a6=t;return}a6=t=e}while(null!==t)0===a7&&(a7=5)}function sD(e,t,r){var n=tc,o=a2.transition;try{a2.transition=null,tc=1,function(e,t,r,n){do sB();while(null!==sh)if(0!=(6&a3))throw Error(d(327));r=e.finishedWork;var o=e.finishedLanes;if(null!==r){if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(d(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var o=31-e8(r),i=1<<o;t[o]=0,n[o]=-1,e[o]=-1,r&=~i}}(e,i),e===a5&&(a6=a5=null,a4=0),0==(2064&r.subtreeFlags)&&0==(2064&r.flags)||sf||(sf=!0,a=e2,s=function(){return sB(),null},eK(a,s)),i=0!=(15990&r.flags),0!=(15990&r.subtreeFlags)||i){i=a2.transition,a2.transition=null;var a,s,l,c,u,f=tc;tc=1;var h=a3;a3|=4,a1.current=null,function(e,t){if(ng=tN,rU(e=rB())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var o,i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch(e){r=null;break e}var s=0,l=-1,c=-1,u=0,f=0,h=e,p=null;t:for(;;){for(;h!==r||0!==i&&3!==h.nodeType||(l=s+i),h!==a||0!==n&&3!==h.nodeType||(c=s+n),3===h.nodeType&&(s+=h.nodeValue.length),null!==(o=h.firstChild);)p=h,h=o;for(;;){if(h===e)break t;if(p===r&&++u===i&&(l=s),p===a&&++f===n&&(c=s),null!==(o=h.nextSibling))break;p=(h=p).parentNode}h=o}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(nv={focusedElem:e,selectionRange:r},tN=!1,aM=t;null!==aM;)if(e=(t=aM).child,0!=(1028&t.subtreeFlags)&&null!==e)e.return=t,aM=e;else for(;null!==aM;){t=aM;try{var m=t.alternate;if(0!=(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:oC(t.type,g),v);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(d(163))}}catch(e){sH(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,aM=e;break}aM=t.return}m=aL,aL=!1}(e,r),aK(r,e),function(e){var t=rB(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&function e(t,r){return!!t&&!!r&&(t===r||(!t||3!==t.nodeType)&&(r&&3===r.nodeType?e(t,r.parentNode):"contains"in t?t.contains(r):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(r))))}(r.ownerDocument.documentElement,r)){if(null!==n&&rU(r)){if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=r.textContent.length,i=Math.min(n.start,o);n=void 0===n.end?i:Math.min(n.end,o),!e.extend&&i>n&&(o=n,n=i,i=o),o=rD(r,i);var a=rD(r,n);o&&a&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}(nv),tN=!!ng,nv=ng=null,e.current=r,l=r,c=e,u=o,aM=l,function e(t,r,n){for(var o=0!=(1&t.mode);null!==aM;){var i=aM,a=i.child;if(22===i.tag&&o){var s=null!==i.memoizedState||aO;if(!s){var l=i.alternate,c=null!==l&&null!==l.memoizedState||aR;l=aO;var u=aR;if(aO=s,(aR=c)&&!u)for(aM=i;null!==aM;)c=(s=aM).child,22===s.tag&&null!==s.memoizedState?aQ(i):null!==c?(c.return=s,aM=c):aQ(i);for(;null!==a;)aM=a,e(a,r,n),a=a.sibling;aM=i,aO=l,aR=u}aY(t,r,n)}else 0!=(8772&i.subtreeFlags)&&null!==a?(a.return=i,aM=a):aY(t,r,n)}}(l,c,u),eZ(),a3=h,tc=f,a2.transition=i}else e.current=r;if(sf&&(sf=!1,sh=e,sp=o),0===(i=e.pendingLanes)&&(sd=null),function(e){if(e4&&"function"==typeof e4.onCommitFiberRoot)try{e4.onCommitFiberRoot(e6,e,void 0,128==(128&e.current.flags))}catch(e){}}(r.stateNode,n),sC(e,eQ()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)n((o=t[r]).value,{componentStack:o.stack,digest:o.digest});if(sc)throw sc=!1,e=su,su=null,e;0!=(1&sp)&&0!==e.tag&&sB(),0!=(1&(i=e.pendingLanes))?e===sg?sm++:(sm=0,sg=e):sm=0,n5()}}(e,t,r,n)}finally{a2.transition=o,tc=n}return null}function sB(){if(null!==sh){var e=tu(sp),t=a2.transition,r=tc;try{if(a2.transition=null,tc=16>e?16:e,null===sh)var n=!1;else{if(e=sh,sh=null,sp=0,0!=(6&a3))throw Error(d(331));var o=a3;for(a3|=4,aM=e.current;null!==aM;){var i=aM,a=i.child;if(0!=(16&aM.flags)){var s=i.deletions;if(null!==s){for(var l=0;l<s.length;l++){var c=s[l];for(aM=c;null!==aM;){var u=aM;switch(u.tag){case 0:case 11:case 15:az(8,u,i)}var f=u.child;if(null!==f)f.return=u,aM=f;else for(;null!==aM;){var h=(u=aM).sibling,p=u.return;if(function e(t){var r=t.alternate;null!==r&&(t.alternate=null,e(r)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&null!==(r=t.stateNode)&&(delete r[nT],delete r[nP],delete r[nR],delete r[nx],delete r[nM]),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}(u),u===c){aM=null;break}if(null!==h){h.return=p,aM=h;break}aM=p}}}var m=i.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}aM=i}}if(0!=(2064&i.subtreeFlags)&&null!==a)a.return=i,aM=a;else for(;null!==aM;){if(i=aM,0!=(2048&i.flags))switch(i.tag){case 0:case 11:case 15:az(9,i,i.return)}var b=i.sibling;if(null!==b){b.return=i.return,aM=b;break}aM=i.return}}var y=e.current;for(aM=y;null!==aM;){var w=(a=aM).child;if(0!=(2064&a.subtreeFlags)&&null!==w)w.return=a,aM=w;else for(a=y;null!==aM;){if(s=aM,0!=(2048&s.flags))try{switch(s.tag){case 0:case 11:case 15:aD(9,s)}}catch(e){sH(s,s.return,e)}if(s===a){aM=null;break}var S=s.sibling;if(null!==S){S.return=s.return,aM=S;break}aM=s.return}}if(a3=o,n5(),e4&&"function"==typeof e4.onPostCommitFiberRoot)try{e4.onPostCommitFiberRoot(e6,e)}catch(e){}n=!0}return n}finally{tc=r,a2.transition=t}}return!1}function sU(e,t,r){t=ae(e,t=i8(r,t),1),e=oU(e,t,1),t=sy(),null!==e&&(ts(e,1,t),sC(e,t))}function sH(e,t,r){if(3===e.tag)sU(e,e,r);else for(;null!==t;){if(3===t.tag){sU(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===sd||!sd.has(n))){e=at(t,e=i8(r,e),1),t=oU(t,e,1),e=sy(),null!==t&&(ts(t,1,e),sC(t,e));break}}t=t.return}}function sq(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=sy(),e.pingedLanes|=e.suspendedLanes&r,a5===e&&(a4&r)===r&&(4===a7||3===a7&&(0x7c00000&a4)===a4&&500>eQ()-sa?sR(e,0):sn|=r),sC(e,t)}function sj(e,t){0===t&&(0==(1&e.mode)?t=1:(t=tt,0==(0x7c00000&(tt<<=1))&&(tt=4194304)));var r=sy();null!==(e=oF(e,t))&&(ts(e,t,r),sC(e,r))}function s$(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),sj(e,r)}function sW(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,o=e.memoizedState;null!==o&&(r=o.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(d(314))}null!==n&&n.delete(t),sj(e,r)}function sV(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sG(e,t,r,n){return new sV(e,t,r,n)}function sK(e){return!(!(e=e.prototype)||!e.isReactComponent)}function sX(e,t){var r=e.alternate;return null===r?((r=sG(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=0xe00000&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function sY(e,t,r,n,o,i){var a=2;if(n=e,"function"==typeof e)sK(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case P:return sZ(r.children,o,i,t);case O:a=8,o|=8;break;case R:return(e=sG(12,r,t,2|o)).elementType=R,e.lanes=i,e;case F:return(e=sG(13,r,t,o)).elementType=F,e.lanes=i,e;case L:return(e=sG(19,r,t,o)).elementType=L,e.lanes=i,e;case B:return sQ(r,o,i,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case x:a=10;break e;case M:a=9;break e;case N:a=11;break e;case z:a=14;break e;case D:a=16,n=null;break e}throw Error(d(130,null==e?e:typeof e,""))}return(t=sG(a,r,t,o)).elementType=e,t.type=n,t.lanes=i,t}function sZ(e,t,r,n){return(e=sG(7,e,n,t)).lanes=r,e}function sQ(e,t,r,n){return(e=sG(22,e,n,t)).elementType=B,e.lanes=r,e.stateNode={isHidden:!1},e}function sJ(e,t,r){return(e=sG(6,e,null,t)).lanes=r,e}function s0(e,t,r){return(t=sG(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function s1(e,t,r,n,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ta(0),this.expirationTimes=ta(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ta(0),this.identifierPrefix=n,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function s2(e,t,r,n,o,i,a,s,l){return e=new s1(e,t,r,s,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=sG(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},oz(i),e}function s3(e){if(!e)return nj;e=e._reactInternals;e:{if(e$(e)!==e||1!==e.tag)throw Error(d(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(nK(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t)throw Error(d(171))}if(1===e.tag){var r=e.type;if(nK(r))return nZ(e,r,t)}return t}function s5(e,t,r,n,o,i,a,s,l){return(e=s2(r,n,!0,e,o,i,a,s,l)).context=s3(null),r=e.current,(i=oB(n=sy(),o=sw(r))).callback=null!=t?t:null,oU(r,i,o),e.current.lanes=o,ts(e,o,n),sC(e,n),e}function s6(e,t,r,n){var o=t.current,i=sy(),a=sw(o);return r=s3(r),null===t.context?t.context=r:t.pendingContext=r,(t=oB(i,a)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=oU(o,t,a))&&(sS(e,o,a,i),oH(e,o,a)),a}function s4(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function s8(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function s9(e,t){s8(e,t),(e=e.alternate)&&s8(e,t)}l=function(e,t,r){if(null!==e){if(e.memoizedProps!==t.pendingProps||nW.current)aa=!0;else{if(0==(e.lanes&r)&&0==(128&t.flags))return aa=!1,function(e,t,r){switch(t.tag){case 3:ag(t),oy();break;case 5:it(t);break;case 1:nK(t.type)&&nQ(t);break;case 4:o7(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,o=t.memoizedProps.value;nq(oI,n._currentValue),n._currentValue=o;break;case 13:if(null!==(n=t.memoizedState)){if(null!==n.dehydrated)return nq(io,1&io.current),t.flags|=128,null;if(0!=(r&t.child.childLanes))return aw(e,t,r);return nq(io,1&io.current),null!==(e=aA(e,t,r))?e.sibling:null}nq(io,1&io.current);break;case 19:if(n=0!=(r&t.childLanes),0!=(128&e.flags)){if(n)return aE(e,t,r);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),nq(io,io.current),!n)return null;break;case 22:case 23:return t.lanes=0,ad(e,t,r)}return aA(e,t,r)}(e,t,r);aa=0!=(131072&e.flags)}}else aa=!1,ou&&0!=(1048576&t.flags)&&oi(t,n9,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;a_(e,t),e=t.pendingProps;var o=nG(t,n$.current);oO(t,r),o=iS(null,t,n,e,o,r);var i=iC();return t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,nK(n)?(i=!0,nQ(t)):i=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,oz(t),o.updater=oG,t.stateNode=o,o._reactInternals=t,oZ(t,n,e,r),t=am(null,t,n,!0,i,r)):(t.tag=0,ou&&i&&oa(t),as(null,t,o,r),t=t.child),t;case 16:n=t.elementType;e:{switch(a_(e,t),e=t.pendingProps,n=(o=n._init)(n._payload),t.type=n,o=t.tag=function(e){if("function"==typeof e)return sK(e)?1:0;if(null!=e){if((e=e.$$typeof)===N)return 11;if(e===z)return 14}return 2}(n),e=oC(n,e),o){case 0:t=ah(null,t,n,e,r);break e;case 1:t=ap(null,t,n,e,r);break e;case 11:t=al(null,t,n,e,r);break e;case 14:t=ac(null,t,n,oC(n.type,e),r);break e}throw Error(d(306,n,""))}return t;case 0:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:oC(n,o),ah(e,t,n,o,r);case 1:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:oC(n,o),ap(e,t,n,o,r);case 3:e:{if(ag(t),null===e)throw Error(d(387));n=t.pendingProps,o=(i=t.memoizedState).element,oD(e,t),oj(t,n,null,r);var a=t.memoizedState;if(n=a.element,i.isDehydrated){if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){o=i8(Error(d(423)),t),t=av(e,t,n,r,o);break e}if(n!==o){o=i8(Error(d(424)),t),t=av(e,t,n,r,o);break e}for(oc=nE(t.stateNode.containerInfo.firstChild),ol=t,ou=!0,od=null,r=o3(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(oy(),n===o){t=aA(e,t,r);break e}as(e,t,n,r)}t=t.child}return t;case 5:return it(t),null===e&&om(t),n=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,a=o.children,nb(n,o)?a=null:null!==i&&nb(n,i)&&(t.flags|=32),af(e,t),as(e,t,a,r),t.child;case 6:return null===e&&om(t),null;case 13:return aw(e,t,r);case 4:return o7(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=o2(t,null,n,r):as(e,t,n,r),t.child;case 11:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:oC(n,o),al(e,t,n,o,r);case 7:return as(e,t,t.pendingProps,r),t.child;case 8:case 12:return as(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,o=t.pendingProps,i=t.memoizedProps,a=o.value,nq(oI,n._currentValue),n._currentValue=a,null!==i){if(rF(i.value,a)){if(i.children===o.children&&!nW.current){t=aA(e,t,r);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var s=i.dependencies;if(null!==s){a=i.child;for(var l=s.firstContext;null!==l;){if(l.context===n){if(1===i.tag){(l=oB(-1,r&-r)).tag=2;var c=i.updateQueue;if(null!==c){var u=(c=c.shared).pending;null===u?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,null!==(l=i.alternate)&&(l.lanes|=r),oP(i.return,r,t),s.lanes|=r;break}l=l.next}}else if(10===i.tag)a=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(a=i.return))throw Error(d(341));a.lanes|=r,null!==(s=a.alternate)&&(s.lanes|=r),oP(a,r,t),a=i.sibling}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===t){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}}as(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,n=t.pendingProps.children,oO(t,r),n=n(o=oR(o)),t.flags|=1,as(e,t,n,r),t.child;case 14:return o=oC(n=t.type,t.pendingProps),o=oC(n.type,o),ac(e,t,n,o,r);case 15:return au(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:oC(n,o),a_(e,t),t.tag=1,nK(n)?(e=!0,nQ(t)):e=!1,oO(t,r),oX(t,n,o),oZ(t,n,o,r),am(null,t,n,!0,e,r);case 19:return aE(e,t,r);case 22:return ad(e,t,r)}throw Error(d(156,t.tag))};var s7="function"==typeof reportError?reportError:function(e){};function le(e){this._internalRoot=e}function lt(e){this._internalRoot=e}function lr(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function ln(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function lo(){}function li(e,t,r,n,o){var i=r._reactRootContainer;if(i){var a=i;if("function"==typeof o){var s=o;o=function(){var e=s4(a);s.call(e)}}s6(t,a,e,o)}else a=function(e,t,r,n,o){if(o){if("function"==typeof n){var i=n;n=function(){var e=s4(a);i.call(e)}}var a=s5(t,n,e,0,null,!1,!1,"",lo);return e._reactRootContainer=a,e[nO]=a.current,no(8===e.nodeType?e.parentNode:e),sP(),a}for(;o=e.lastChild;)e.removeChild(o);if("function"==typeof n){var s=n;n=function(){var e=s4(l);s.call(e)}}var l=s2(e,0,!1,null,null,!1,!1,"",lo);return e._reactRootContainer=l,e[nO]=l.current,no(8===e.nodeType?e.parentNode:e),sP(function(){s6(t,l,r,n)}),l}(r,t,e,o,n);return s4(a)}lt.prototype.render=le.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(d(409));s6(e,t,null,null)},lt.prototype.unmount=le.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;sP(function(){s6(null,e,null,null)}),t[nO]=null}},lt.prototype.unstable_scheduleHydration=function(e){if(e){var t=tp();e={blockedOn:null,target:e,priority:t};for(var r=0;r<tI.length&&0!==t&&t<tI[r].priority;r++);tI.splice(r,0,e),0===r&&tA(e)}},td=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=tr(t.pendingLanes);0!==r&&(tl(t,1|r),sC(t,eQ()),0==(6&a3)&&(ss=eQ()+500,n5()))}break;case 13:sP(function(){var t=oF(e,1);null!==t&&sS(t,e,1,sy())}),s9(e,1)}},tf=function(e){if(13===e.tag){var t=oF(e,0x8000000);null!==t&&sS(t,e,0x8000000,sy()),s9(e,0x8000000)}},th=function(e){if(13===e.tag){var t=sw(e),r=oF(e,t);null!==r&&sS(r,e,t,sy()),s9(e,t)}},tp=function(){return tc},tm=function(e,t){var r=tc;try{return tc=e,t()}finally{tc=r}},ek=function(e,t,r){switch(t){case"input":if(et(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var o=nz(n);if(!o)throw Error(d(90));Y(n),et(n,o)}}}break;case"textarea":el(e,r);break;case"select":null!=(t=r.value)&&ei(e,!!r.multiple,t,!1)}},eO=sT,eR=sP;var la={findFiberByHostInstance:nN,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ls={bundleType:la.bundleType,version:la.version,rendererPackageName:la.rendererPackageName,rendererConfig:la.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=eG(e))?null:e.stateNode},findFiberByHostInstance:la.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ll=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ll.isDisabled&&ll.supportsFiber)try{e6=ll.inject(ls),e4=ll}catch(e){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED={usingClientEntryPoint:!1,Events:[nF,nL,nz,eT,eP,sT]},t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!lr(t))throw Error(d(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:T,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!lr(e))throw Error(d(299));var r=!1,n="",o=s7;return null!=t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=s2(e,1,!1,null,null,r,!1,n,o),e[nO]=t.current,no(8===e.nodeType?e.parentNode:e),new le(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(d(188));throw Error(d(268,e=Object.keys(e).join(",")))}return e=null===(e=eG(t))?null:e.stateNode},t.flushSync=function(e){return sP(e)},t.hydrate=function(e,t,r){if(!ln(t))throw Error(d(200));return li(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!lr(e))throw Error(d(405));var n=null!=r&&r.hydratedSources||null,o=!1,i="",a=s7;if(null!=r&&(!0===r.unstable_strictMode&&(o=!0),void 0!==r.identifierPrefix&&(i=r.identifierPrefix),void 0!==r.onRecoverableError&&(a=r.onRecoverableError)),t=s5(t,null,e,1,null!=r?r:null,o,!1,i,a),e[nO]=t.current,no(e),n)for(e=0;e<n.length;e++)o=(o=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,o]:t.mutableSourceEagerHydrationData.push(r,o);return new lt(t)},t.render=function(e,t,r){if(!ln(t))throw Error(d(200));return li(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!ln(e))throw Error(d(40));return!!e._reactRootContainer&&(sP(function(){li(null,null,e,!1,function(){e._reactRootContainer=null,e[nO]=null})}),!0)},t.unstable_batchedUpdates=sT,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ln(r))throw Error(d(200));if(null==e||void 0===e._reactInternals)throw Error(d(38));return li(e,t,r,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},819988:(e,t,r)=>{"use strict";var n=r(764859);t.H=n.createRoot,n.hydrateRoot},764859:(e,t,r)=>{"use strict";(function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){}})(),e.exports=r(370077)},868573:(e,t)=>{"use strict";function r(e,t){var r=e.length;for(e.push(t);0<r;){var n=r-1>>>1,o=e[n];if(0<i(o,t))e[n]=t,e[r]=o,r=n;else break}}function n(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;for(var n=0,o=e.length,a=o>>>1;n<a;){var s=2*(n+1)-1,l=e[s],c=s+1,u=e[c];if(0>i(l,r))c<o&&0>i(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[s]=r,n=s);else if(c<o&&0>i(u,r))e[n]=u,e[c]=r,n=c;else break}}return t}function i(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var a,s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var u=[],d=[],f=1,h=null,p=3,m=!1,g=!1,v=!1,b="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,w="undefined"!=typeof setImmediate?setImmediate:null;function S(e){for(var t=n(d);null!==t;){if(null===t.callback)o(d);else if(t.startTime<=e)o(d),t.sortIndex=t.expirationTime,r(u,t);else break;t=n(d)}}function C(e){if(v=!1,S(e),!g){if(null!==n(u))g=!0,M(I);else{var t=n(d);null!==t&&N(C,t.startTime-e)}}}function I(e,r){g=!1,v&&(v=!1,y(_),_=-1),m=!0;var i=p;try{for(S(r),h=n(u);null!==h&&(!(h.expirationTime>r)||e&&!P());){var a=h.callback;if("function"==typeof a){h.callback=null,p=h.priorityLevel;var s=a(h.expirationTime<=r);r=t.unstable_now(),"function"==typeof s?h.callback=s:h===n(u)&&o(u),S(r)}else o(u);h=n(u)}if(null!==h)var l=!0;else{var c=n(d);null!==c&&N(C,c.startTime-r),l=!1}return l}finally{h=null,p=i,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k=!1,E=null,_=-1,A=5,T=-1;function P(){return!(t.unstable_now()-T<A)}function O(){if(null!==E){var e=t.unstable_now();T=e;var r=!0;try{r=E(!0,e)}finally{r?a():(k=!1,E=null)}}else k=!1}if("function"==typeof w)a=function(){w(O)};else if("undefined"!=typeof MessageChannel){var R=new MessageChannel,x=R.port2;R.port1.onmessage=O,a=function(){x.postMessage(null)}}else a=function(){b(O,0)};function M(e){E=e,k||(k=!0,a())}function N(e,r){_=b(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,M(I))},t.unstable_forceFrameRate=function(e){0>e||125<e||(A=0<e?Math.floor(1e3/e):5)},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var r=p;p=t;try{return e()}finally{p=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=p;p=e;try{return t()}finally{p=r}},t.unstable_scheduleCallback=function(e,o,i){var a=t.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?a+i:a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=0x3fffffff;break;case 4:s=1e4;break;default:s=5e3}return s=i+s,e={id:f++,callback:o,priorityLevel:e,startTime:i,expirationTime:s,sortIndex:-1},i>a?(e.sortIndex=i,r(d,e),null===n(u)&&e===n(d)&&(v?(y(_),_=-1):v=!0,N(C,i-a))):(e.sortIndex=s,r(u,e),g||m||(g=!0,M(I))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var r=p;p=t;try{return e.apply(this,arguments)}finally{p=r}}}},763528:(e,t,r)=>{"use strict";e.exports=r(868573)},685130:(e,t,r)=>{"use strict";var n=r(603722),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,i={},c=null,u=null;for(n in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,n)&&!l.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:o,type:e,key:c,ref:u,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},170693:(e,t)=>{"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),h=Symbol.iterator,p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||p}function b(){}function y(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var w=y.prototype=new b;w.constructor=y,m(w,v.prototype),w.isPureReactComponent=!0;var S=Array.isArray,C=Object.prototype.hasOwnProperty,I={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,n){var o,i={},a=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)C.call(t,o)&&!k.hasOwnProperty(o)&&(i[o]=t[o]);var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(o in l=e.defaultProps)void 0===i[o]&&(i[o]=l[o]);return{$$typeof:r,type:e,key:a,ref:s,props:i,_owner:I.current}}function _(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var A=/\/+/g;function T(e,t){var r,n;return"object"==typeof e&&null!==e&&null!=e.key?(r=""+e.key,n={"=":"=0",":":"=2"},"$"+r.replace(/[=:]/g,function(e){return n[e]})):t.toString(36)}function P(e,t,o){if(null==e)return e;var i=[],a=0;return function e(t,o,i,a,s){var l,c,u,d=typeof t;("undefined"===d||"boolean"===d)&&(t=null);var f=!1;if(null===t)f=!0;else switch(d){case"string":case"number":f=!0;break;case"object":switch(t.$$typeof){case r:case n:f=!0}}if(f)return s=s(f=t),t=""===a?"."+T(f,0):a,S(s)?(i="",null!=t&&(i=t.replace(A,"$&/")+"/"),e(s,o,i,"",function(e){return e})):null!=s&&(_(s)&&(l=s,c=i+(!s.key||f&&f.key===s.key?"":(""+s.key).replace(A,"$&/")+"/")+t,s={$$typeof:r,type:l.type,key:c,ref:l.ref,props:l.props,_owner:l._owner}),o.push(s)),1;if(f=0,a=""===a?".":a+":",S(t))for(var p=0;p<t.length;p++){var m=a+T(d=t[p],p);f+=e(d,o,i,m,s)}else if("function"==typeof(m=null===(u=t)||"object"!=typeof u?null:"function"==typeof(u=h&&u[h]||u["@@iterator"])?u:null))for(t=m.call(t),p=0;!(d=t.next()).done;)m=a+T(d=d.value,p++),f+=e(d,o,i,m,s);else if("object"===d)throw Error("Objects are not valid as a React child (found: "+("[object Object]"===(o=String(t))?"object with keys {"+Object.keys(t).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return f}(e,i,"","",function(e){return t.call(o,e,a++)}),i}function O(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){(0===e._status||-1===e._status)&&(e._status=1,e._result=t)},function(t){(0===e._status||-1===e._status)&&(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},x={transition:null};t.Children={map:P,forEach:function(e,t,r){P(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=o,t.Profiler=a,t.PureComponent=y,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:x,ReactCurrentOwner:I},t.cloneElement=function(e,t,n){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=m({},e.props),i=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=I.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)C.call(t,c)&&!k.hasOwnProperty(c)&&(o[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}return{$$typeof:r,type:e.type,key:i,ref:a,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=x.transition;x.transition={};try{e()}finally{x.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,r){return R.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,r){return R.current.useReducer(e,t,r)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return R.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return R.current.useTransition()},t.version="18.2.0"},603722:(e,t,r)=>{"use strict";e.exports=r(170693)},108866:(e,t,r)=>{"use strict";e.exports=r(685130)},158441:(e,t,r)=>{"use strict";function n(e){return e.reduce(function(e,t){var r=t[0],n=t[1];return e[r]=n,e[n]=r,e},{})}function o(e){return"number"==typeof e}function i(e,t){return -1!==e.indexOf(t)}function a(e,t,r,n){return t+(0===parseFloat(r)?r:"-"===r[0]?r.slice(1):"-"+r)+n}function s(e){return e.replace(/ +/g," ").split(" ").map(function(e){return e.trim()}).filter(Boolean).reduce(function(e,t){var r=e.list,n=e.state,o=(t.match(/\(/g)||[]).length,i=(t.match(/\)/g)||[]).length;return n.parensDepth>0?r[r.length-1]=r[r.length-1]+" "+t:r.push(t),n.parensDepth+=o-i,{list:r,state:n}},{list:[],state:{parensDepth:0}}).list}function l(e){var t=s(e);if(t.length<=3||t.length>4)return e;var r=t[0],n=t[1],o=t[2];return[r,t[3],o,n].join(" ")}r.d(t,{c:()=>m,d:()=>g});var c={padding:function(e){var t=e.value;return o(t)?t:l(t)},textShadow:function(e){return(function(e){for(var t=[],r=0,n=0,o=!1;n<e.length;)o||","!==e[n]?("("===e[n]?o=!0:")"===e[n]&&(o=!1),n++):(t.push(e.substring(r,n).trim()),r=++n);return r!=n&&t.push(e.substring(r,n+1)),t})(e.value).map(function(e){return e.replace(/(^|\s)(-*)([.|\d]+)/,function(e,t,r,n){return"0"===n?e:""+t+(""===r?"-":"")+n})}).join(",")},borderColor:function(e){return l(e.value)},borderRadius:function(e){var t=e.value;if(o(t))return t;if(i(t,"/")){var r=t.split("/"),n=r[0],a=r[1];return c.borderRadius({value:n.trim()})+" / "+c.borderRadius({value:a.trim()})}var l=s(t);switch(l.length){case 2:return l.reverse().join(" ");case 4:var u=l[0],d=l[1],f=l[2];return[d,u,l[3],f].join(" ");default:return t}},background:function(e){var t=e.value,r=e.valuesToConvert,n=e.isRtl,i=e.bgImgDirectionRegex,a=e.bgPosDirectionRegex;if(o(t))return t;var s=t.replace(/(url\(.*?\))|(rgba?\(.*?\))|(hsl\(.*?\))|(#[a-fA-F0-9]+)|((^| )(\D)+( |$))/g,"").trim();return t=t.replace(s,c.backgroundPosition({value:s,valuesToConvert:r,isRtl:n,bgPosDirectionRegex:a})),c.backgroundImage({value:t,valuesToConvert:r,bgImgDirectionRegex:i})},backgroundImage:function(e){var t=e.value,r=e.valuesToConvert,n=e.bgImgDirectionRegex;return i(t,"url(")||i(t,"linear-gradient(")?t.replace(n,function(e,t,n){return e.replace(n,r[n])}):t},backgroundPosition:function(e){var t=e.value,r=e.valuesToConvert,n=e.isRtl,o=e.bgPosDirectionRegex;return t.replace(n?/^((-|\d|\.)+%)/:null,function(e,t){return function(e){var t=e.indexOf(".");if(-1===t)e=100-parseFloat(e)+"%";else{var r=e.length-t-2;e=(e=100-parseFloat(e)).toFixed(r)+"%"}return e}(t)}).replace(o,function(e){return r[e]})},backgroundPositionX:function(e){var t=e.value,r=e.valuesToConvert,n=e.isRtl,i=e.bgPosDirectionRegex;return o(t)?t:c.backgroundPosition({value:t,valuesToConvert:r,isRtl:n,bgPosDirectionRegex:i})},transition:function(e){var t=e.value,r=e.propertiesToConvert;return t.split(/,\s*/g).map(function(e){var t=e.split(" ");return t[0]=r[t[0]]||t[0],t.join(" ")}).join(", ")},transitionProperty:function(e){var t=e.value,r=e.propertiesToConvert;return t.split(/,\s*/g).map(function(e){return r[e]||e}).join(", ")},transform:function(e){var t=e.value,r="[^\\u0020-\\u007e]",n="(?:(?:(?:\\[0-9a-f]{1,6})(?:\\r\\n|\\s)?)|\\\\[^\\r\\n\\f0-9a-f])",o="((?:-?"+("(?:[0-9]*\\.[0-9]+|[0-9]+)(?:\\s*(?:em|ex|px|cm|mm|in|pt|pc|deg|rad|grad|ms|s|hz|khz|%)|"+("-?(?:[_a-z]|"+r+"|"+n+")"+("(?:[_a-z0-9-]|"+r)+"|")+n)+")*)?)|(?:inherit|auto))",i=RegExp("(translateX\\s*\\(\\s*)"+o+"(\\s*\\))","gi"),s=RegExp("(translate\\s*\\(\\s*)"+o+"((?:\\s*,\\s*"+o+"){0,1}\\s*\\))","gi"),l=RegExp("(translate3d\\s*\\(\\s*)"+o+"((?:\\s*,\\s*"+o+"){0,2}\\s*\\))","gi"),c=RegExp("(rotate[ZY]?\\s*\\(\\s*)"+o+"(\\s*\\))","gi");return t.replace(i,a).replace(s,a).replace(l,a).replace(c,a)}};c.objectPosition=c.backgroundPosition,c.margin=c.padding,c.borderWidth=c.padding,c.boxShadow=c.textShadow,c.webkitBoxShadow=c.boxShadow,c.mozBoxShadow=c.boxShadow,c.WebkitBoxShadow=c.boxShadow,c.MozBoxShadow=c.boxShadow,c.borderStyle=c.borderColor,c.webkitTransform=c.transform,c.mozTransform=c.transform,c.WebkitTransform=c.transform,c.MozTransform=c.transform,c.transformOrigin=c.backgroundPosition,c.webkitTransformOrigin=c.transformOrigin,c.mozTransformOrigin=c.transformOrigin,c.WebkitTransformOrigin=c.transformOrigin,c.MozTransformOrigin=c.transformOrigin,c.webkitTransition=c.transition,c.mozTransition=c.transition,c.WebkitTransition=c.transition,c.MozTransition=c.transition,c.webkitTransitionProperty=c.transitionProperty,c.mozTransitionProperty=c.transitionProperty,c.WebkitTransitionProperty=c.transitionProperty,c.MozTransitionProperty=c.transitionProperty,c["text-shadow"]=c.textShadow,c["border-color"]=c.borderColor,c["border-radius"]=c.borderRadius,c["background-image"]=c.backgroundImage,c["background-position"]=c.backgroundPosition,c["background-position-x"]=c.backgroundPositionX,c["object-position"]=c.objectPosition,c["border-width"]=c.padding,c["box-shadow"]=c.textShadow,c["-webkit-box-shadow"]=c.textShadow,c["-moz-box-shadow"]=c.textShadow,c["border-style"]=c.borderColor,c["-webkit-transform"]=c.transform,c["-moz-transform"]=c.transform,c["transform-origin"]=c.transformOrigin,c["-webkit-transform-origin"]=c.transformOrigin,c["-moz-transform-origin"]=c.transformOrigin,c["-webkit-transition"]=c.transition,c["-moz-transition"]=c.transition,c["transition-property"]=c.transitionProperty,c["-webkit-transition-property"]=c.transitionProperty,c["-moz-transition-property"]=c.transitionProperty;var u=n([["paddingLeft","paddingRight"],["marginLeft","marginRight"],["left","right"],["borderLeft","borderRight"],["borderLeftColor","borderRightColor"],["borderLeftStyle","borderRightStyle"],["borderLeftWidth","borderRightWidth"],["borderTopLeftRadius","borderTopRightRadius"],["borderBottomLeftRadius","borderBottomRightRadius"],["padding-left","padding-right"],["margin-left","margin-right"],["border-left","border-right"],["border-left-color","border-right-color"],["border-left-style","border-right-style"],["border-left-width","border-right-width"],["border-top-left-radius","border-top-right-radius"],["border-bottom-left-radius","border-bottom-right-radius"]]),d=["content"],f=n([["ltr","rtl"],["left","right"],["w-resize","e-resize"],["sw-resize","se-resize"],["nw-resize","ne-resize"]]),h=RegExp("(^|\\W|_)((ltr)|(rtl)|(left)|(right))(\\W|_|$)","g"),p=RegExp("(left)|(right)");function m(e){return Object.keys(e).reduce(function(t,r){var n=e[r];if("string"==typeof n&&(n=n.trim()),i(d,r))return t[r]=n,t;var o=g(r,n),a=o.key,s=o.value;return t[a]=s,t},Array.isArray(e)?[]:{})}function g(e,t){var r=/\/\*\s?@noflip\s?\*\//.test(t),n=r?e:u[e]||e,i=r?t:function(e,t){if(!("boolean"!=typeof(r=t)&&null!=r))return t;if(t&&"object"==typeof t)return m(t);var r,n,i=o(t),a="function"==typeof t,s=i||a?t:t.replace(/ !important.*?$/,""),l=!i&&s.length!==t.length,d=c[e];return(n=d?d({value:s,valuesToConvert:f,propertiesToConvert:u,isRtl:!0,bgImgDirectionRegex:h,bgPosDirectionRegex:p}):f[s]||s,l)?n+" !important":n}(n,t);return{key:n,value:i}}},418569:(e,t,r)=>{"use strict";r.d(t,{C6:()=>n.c,dG:()=>n.d});var n=r(158441)},174485:(e,t,r)=>{"use strict";var n=r(315307);e.exports={isRtlLang:n.isRtlLang,getLangDir:n.getLangDir}},315307:e=>{"use strict";var t,r=t={_regexEscape:/([\.\*\+\^\$\[\]\\\(\)\|\{\}\,\-\:\?])/g,_regexParseLocale:/^([a-zA-Z]*)([_\-a-zA-Z]*)$/,_escapeRegExpPattern:function(e){return"string"!=typeof e?e:e.replace(t._regexEscape,"\\$1")},_toLowerCase:function(e,t){return"string"!=typeof e?t&&e:e.toLowerCase()},_toUpperCase:function(e,t){return"string"!=typeof e?t&&e:e.toUpperCase()},_trim:function(e,r,n){var o,i=[],a=function(e){i.push("^"+e+"+|"+e+"+$")};if("boolean"==typeof r&&(n=r,r=null),"string"!=typeof e)return n&&e;for(Array.isArray(r)&&r.map(function(e){a(t._escapeRegExpPattern(e))}),"string"==typeof r&&a(t._escapeRegExpPattern(r)),r||a("\\s"),o=RegExp("("+i.join("|")+")","g");e.match(o);)e=e.replace(o,"");return e},_parseLocale:function(e){var r,n=t._regexParseLocale.exec(e);if(e&&n)return n[2]=t._trim(n[2],["-","_"]),{lang:t._toLowerCase(n[1]),countryCode:r=t._toUpperCase(n[2])||r}},isRtlLang:function(e){var r=t._parseLocale(e);if(r)return t._BIDI_RTL_LANGS.indexOf(r.lang)>=0},getLangDir:function(e){return t.isRtlLang(e)?"rtl":"ltr"}};Object.defineProperty(t,"_BIDI_RTL_LANGS",{value:["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","prs","ps","sd","ug","ur","yi"],writable:!1,enumerable:!0,configurable:!1}),e.exports=r},307680:(e,t,r)=>{"use strict";r.d(t,{xH:()=>i});var n=r(29227),o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:r.g;function i(){return o.__satchelGlobalContext}o.__satchelGlobalContext?function(){if(3!=o.__satchelGlobalContext.schemaVersion)throw Error("Detected incompatible SatchelJS versions loaded.")}():o.__satchelGlobalContext={schemaVersion:3,rootStore:n.observable.map({}),nextActionId:0,subscriptions:{},dispatchWithMiddleware:null,currentMutator:null,legacyInDispatch:0,legacyDispatchWithMiddleware:null,legacyTestMode:!1}},45228:(e,t,r)=>{"use strict";r.d(t,{XI:()=>l,Tw:()=>d,y$:()=>p,I$:()=>f,lO:()=>m,jK:()=>v,zZ:()=>g});var n,o=r(29227),i=r(307680);function a(e,t){var r=(0,i.xH)().subscriptions;r[e]||(r[e]=[]),r[e].push(t)}function s(e){var t=c(e),r=(0,i.xH)().subscriptions[t];if(r){for(var n=[],o=0;o<r.length;o++){var a=(0,r[o])(e);a&&n.push(a)}if(n.length)return 1==n.length?n[0]:Promise.all(n)}}function l(e,t){return function(e,t,r){var n=((0,i.xH)().nextActionId++).toString(),a=function(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];var c=t?t.apply(null,a):{};if(c.type)throw Error("Action creators should not include the type property.");return c.type=e,u(c,n),r&&function(e){var t=(0,i.xH)().currentMutator;if(t)throw Error("Mutator ("+t+") may not dispatch action ("+e.type+")");var r=(0,i.xH)().dispatchWithMiddleware||s;(0,o.transaction)(r.bind(null,e))}(c),c};return u(a,n),a.__SATCHELJS_ACTION_TYPE=e,a}(e,t,!0)}function c(e){return e.__SATCHELJS_ACTION_ID}function u(e,t){e.__SATCHELJS_ACTION_ID=t}function d(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];for(var o=s,a=r.length-1;a>=0;a--)e=r[a],t=o,o=e.bind(null,t);(0,i.xH)().dispatchWithMiddleware=o}function f(){return(0,i.xH)().rootStore}var h=(0,o.action)("createStore",function(e,t){if(f().get(e))throw Error("A store named "+e+" has already been created.");f().set(e,t)});function p(e,t){return h(e,t),function(){return f().get(e)}}function m(e,t){var r=c(e);if(!r)throw Error("Mutators can only subscribe to action creators.");var n=e.__SATCHELJS_ACTION_TYPE||"unknown action";return a(r,(0,o.action)(n,function(e){var r=(0,i.xH)();try{r.currentMutator=n,t(e),r.currentMutator=null}catch(e){throw r.currentMutator=null,e}})),t}function g(e,t){var r=c(e);if(!r)throw Error("Orchestrators can only subscribe to action creators.");return a(r,t),t}var v=(n=m,function(e,t){var r=l(e,function(){return{args:arguments}});return n(r,function(e){return t.apply(null,e.args)}),r});(0,o.configure)({enforceActions:"observed"})},164884:function(e,t,r){var n;e=r.nmd(e),function(o){t&&t.nodeType,e&&e.nodeType;var i="object"==typeof r.g&&r.g;i.global===i||i.window===i||i.self;var a,s=/^xn--/,l=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,u={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=Math.floor,f=String.fromCharCode;function h(e){throw RangeError(u[e])}function p(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function m(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+p((e=e.replace(c,".")).split("."),t).join(".")}function g(e){for(var t,r,n=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?(64512&(r=e.charCodeAt(o++)))==56320?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function v(e){return p(e,function(e){var t="";return e>65535&&(e-=65536,t+=f(e>>>10&1023|55296),e=56320|1023&e),t+=f(e)}).join("")}function b(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function y(e,t,r){var n=0;for(e=r?d(e/700):e>>1,e+=d(e/t);e>455;n+=36)e=d(e/35);return d(n+36*e/(e+38))}function w(e){var t,r,n,o,i,a,s,l,c,u,f,p=[],m=e.length,g=0,b=128,w=72;for((n=e.lastIndexOf("-"))<0&&(n=0),o=0;o<n;++o)e.charCodeAt(o)>=128&&h("not-basic"),p.push(e.charCodeAt(o));for(i=n>0?n+1:0;i<m;){for(a=g,s=1,l=36;i>=m&&h("invalid-input"),((c=(t=e.charCodeAt(i++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:36)>=36||c>d((0x7fffffff-g)/s))&&h("overflow"),g+=c*s,!(c<(u=l<=w?1:l>=w+26?26:l-w));l+=36)s>d(0x7fffffff/(f=36-u))&&h("overflow"),s*=f;w=y(g-a,r=p.length+1,0==a),d(g/r)>0x7fffffff-b&&h("overflow"),b+=d(g/r),g%=r,p.splice(g++,0,b)}return v(p)}function S(e){var t,r,n,o,i,a,s,l,c,u,p,m,v,w,S,C=[];for(a=0,m=(e=g(e)).length,t=128,r=0,i=72;a<m;++a)(p=e[a])<128&&C.push(f(p));for(n=o=C.length,o&&C.push("-");n<m;){for(s=0x7fffffff,a=0;a<m;++a)(p=e[a])>=t&&p<s&&(s=p);for(s-t>d((0x7fffffff-r)/(v=n+1))&&h("overflow"),r+=(s-t)*v,t=s,a=0;a<m;++a)if((p=e[a])<t&&++r>0x7fffffff&&h("overflow"),p==t){for(l=r,c=36;!(l<(u=c<=i?1:c>=i+26?26:c-i));c+=36)S=l-u,w=36-u,C.push(f(b(u+S%w,0))),l=d(S/w);C.push(f(b(l,0))),i=y(r,v,n==o),r=0,++n}++r,++t}return C.join("")}a={version:"1.3.2",ucs2:{decode:g,encode:v},decode:w,encode:S,toASCII:function(e){return m(e,function(e){return l.test(e)?"xn--"+S(e):e})},toUnicode:function(e){return m(e,function(e){return s.test(e)?w(e.slice(4).toLowerCase()):e})}},void 0!==(n=(function(){return a}).call(t,r,t,e))&&(e.exports=n)}(0)},425573:(e,t,r)=>{var n=r(164884);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=g,t.resolve=function(e,t){return g(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?g(e,!1,!0).resolveObject(t):t},t.format=function(e){return(v(e)&&(e=g(e)),e instanceof o)?e.format():o.prototype.format.call(e)},t.Url=o;var i=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,s=["'"].concat(["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","	"])),l=["%","/","?",";","#"].concat(s),c=["/","?","#"],u=/^[a-z0-9A-Z_-]{0,63}$/,d=/^([a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},h={javascript:!0,"javascript:":!0},p={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},m=r(989212);function g(e,t,r){if(e&&b(e)&&e instanceof o)return e;var n=new o;return n.parse(e,t,r),n}function v(e){return"string"==typeof e}function b(e){return"object"==typeof e&&null!==e}function y(e){return null===e}o.prototype.parse=function(e,t,r){if(!v(e))throw TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e;o=o.trim();var a=i.exec(o);if(a){var g=(a=a[0]).toLowerCase();this.protocol=g,o=o.substr(a.length)}if(r||a||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var b="//"===o.substr(0,2);b&&!(a&&h[a])&&(o=o.substr(2),this.slashes=!0)}if(!h[a]&&(b||a&&!p[a])){for(var y,w,S=-1,C=0;C<c.length;C++){var I=o.indexOf(c[C]);-1!==I&&(-1===S||I<S)&&(S=I)}-1!==(w=-1===S?o.lastIndexOf("@"):o.lastIndexOf("@",S))&&(y=o.slice(0,w),o=o.slice(w+1),this.auth=decodeURIComponent(y)),S=-1;for(var C=0;C<l.length;C++){var I=o.indexOf(l[C]);-1!==I&&(-1===S||I<S)&&(S=I)}-1===S&&(S=o.length),this.host=o.slice(0,S),o=o.slice(S),this.parseHost(),this.hostname=this.hostname||"";var k="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!k)for(var E=this.hostname.split(/\./),C=0,_=E.length;C<_;C++){var A=E[C];if(A&&!A.match(u)){for(var T="",P=0,O=A.length;P<O;P++)A.charCodeAt(P)>127?T+="x":T+=A[P];if(!T.match(u)){var R=E.slice(0,C),x=E.slice(C+1),M=A.match(d);M&&(R.push(M[1]),x.unshift(M[2])),x.length&&(o="/"+x.join(".")+o),this.hostname=R.join(".");break}}}if(this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),!k){for(var N=this.hostname.split("."),F=[],C=0;C<N.length;++C){var L=N[C];F.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+n.encode(L):L)}this.hostname=F.join(".")}var z=this.port?":"+this.port:"",D=this.hostname||"";this.host=D+z,this.href+=this.host,k&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!f[g])for(var C=0,_=s.length;C<_;C++){var B=s[C],U=encodeURIComponent(B);U===B&&(U=escape(B)),o=o.split(B).join(U)}var H=o.indexOf("#");-1!==H&&(this.hash=o.substr(H),o=o.slice(0,H));var q=o.indexOf("?");if(-1!==q?(this.search=o.substr(q),this.query=o.substr(q+1),t&&(this.query=m.parse(this.query)),o=o.slice(0,q)):t&&(this.search="",this.query={}),o&&(this.pathname=o),p[g]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var z=this.pathname||"",L=this.search||"";this.path=z+L}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":")+"@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&b(this.query)&&Object.keys(this.query).length&&(i=m.stringify(this.query));var a=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||p[t])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),t+o+(r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(a=a.replace("#","%23"))+n},o.prototype.resolve=function(e){return this.resolveObject(g(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(v(e)){var t=new o;t.parse(e,!1,!0),e=t}var r=new o;if(Object.keys(this).forEach(function(e){r[e]=this[e]},this),r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){"protocol"!==t&&(r[t]=e[t])}),p[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r;if(e.protocol&&e.protocol!==r.protocol){if(!p[e.protocol])return Object.keys(e).forEach(function(t){r[t]=e[t]}),r.href=r.format(),r;if(r.protocol=e.protocol,e.host||h[e.protocol])r.pathname=e.pathname;else{for(var n=(e.pathname||"").split("/");n.length&&!(e.host=n.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==n[0]&&n.unshift(""),n.length<2&&n.unshift(""),r.pathname=n.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var i=r.pathname||"",a=r.search||"";r.path=i+a}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var s=r.pathname&&"/"===r.pathname.charAt(0),l=e.host||e.pathname&&"/"===e.pathname.charAt(0),c=l||s||r.host&&e.pathname,u=c,d=r.pathname&&r.pathname.split("/")||[],n=e.pathname&&e.pathname.split("/")||[],f=r.protocol&&!p[r.protocol];if(f&&(r.hostname="",r.port=null,r.host&&(""===d[0]?d[0]=r.host:d.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===n[0]?n[0]=e.host:n.unshift(e.host)),e.host=null),c=c&&(""===n[0]||""===d[0])),l)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,d=n;else if(n.length)d||(d=[]),d.pop(),d=d.concat(n),r.search=e.search,r.query=e.query;else if(null!=e.search){if(f){r.hostname=r.host=d.shift();var m=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");m&&(r.auth=m.shift(),r.host=r.hostname=m.shift())}return r.search=e.search,r.query=e.query,y(r.pathname)&&y(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!d.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var g=d.slice(-1)[0],b=(r.host||e.host)&&("."===g||".."===g)||""===g,w=0,S=d.length;S>=0;S--)"."==(g=d[S])?d.splice(S,1):".."===g?(d.splice(S,1),w++):w&&(d.splice(S,1),w--);if(!c&&!u)for(;w--;w)d.unshift("..");c&&""!==d[0]&&(!d[0]||"/"!==d[0].charAt(0))&&d.unshift(""),b&&"/"!==d.join("/").substr(-1)&&d.push("");var C=""===d[0]||d[0]&&"/"===d[0].charAt(0);if(f){r.hostname=r.host=C?"":d.length?d.shift():"";var m=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");m&&(r.auth=m.shift(),r.host=r.hostname=m.shift())}return(c=c||r.host&&d.length)&&!C&&d.unshift(""),d.length?r.pathname=d.join("/"):(r.pathname=null,r.path=null),y(r.pathname)&&y(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},o.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},417990:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(363500);let o=function(e,t){for(var r=e.length;r--;)if((0,n.A)(e[r][0],t))return r;return -1};var i=Array.prototype.splice;function a(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}a.prototype.clear=function(){this.__data__=[],this.size=0},a.prototype.delete=function(e){var t=this.__data__,r=o(t,e);return!(r<0)&&(r==t.length-1?t.pop():i.call(t,r,1),--this.size,!0)},a.prototype.get=function(e){var t=this.__data__,r=o(t,e);return r<0?void 0:t[r][1]},a.prototype.has=function(e){return o(this.__data__,e)>-1},a.prototype.set=function(e,t){var r=this.__data__,n=o(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};let s=a},943275:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(44648),o=r(737745);let i=(0,n.A)(o.A,"Map")},644951:(e,t,r)=>{"use strict";r.d(t,{A:()=>f});var n=(0,r(44648).A)(Object,"create"),o=Object.prototype.hasOwnProperty,i=Object.prototype.hasOwnProperty;function a(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}a.prototype.clear=function(){this.__data__=n?n(null):{},this.size=0},a.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},a.prototype.get=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return o.call(t,e)?t[e]:void 0},a.prototype.has=function(e){var t=this.__data__;return n?void 0!==t[e]:i.call(t,e)},a.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this};var s=r(417990),l=r(943275);let c=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},u=function(e,t){var r=e.__data__;return c(t)?r["string"==typeof t?"string":"hash"]:r.map};function d(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}d.prototype.clear=function(){this.size=0,this.__data__={hash:new a,map:new(l.A||s.A),string:new a}},d.prototype.delete=function(e){var t=u(this,e).delete(e);return this.size-=t?1:0,t},d.prototype.get=function(e){return u(this,e).get(e)},d.prototype.has=function(e){return u(this,e).has(e)},d.prototype.set=function(e,t){var r=u(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};let f=d},804933:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(44648),o=r(737745);let i=(0,n.A)(o.A,"Set")},918757:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(644951);function o(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n.A;++t<r;)this.add(e[t])}o.prototype.add=o.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},o.prototype.has=function(e){return this.__data__.has(e)};let i=o},194575:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(417990),o=r(943275),i=r(644951);function a(e){var t=this.__data__=new n.A(e);this.size=t.size}a.prototype.clear=function(){this.__data__=new n.A,this.size=0},a.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},a.prototype.get=function(e){return this.__data__.get(e)},a.prototype.has=function(e){return this.__data__.has(e)},a.prototype.set=function(e,t){var r=this.__data__;if(r instanceof n.A){var a=r.__data__;if(!o.A||a.length<199)return a.push([e,t]),this.size=++r.size,this;r=this.__data__=new i.A(a)}return r.set(e,t),this.size=r.size,this};let s=a},369445:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=r(737745).A.Symbol},975784:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=r(737745).A.Uint8Array},91403:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(44648),o=r(737745);let i=(0,n.A)(o.A,"WeakMap")},980670:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i}},559555:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(754932),o=r(188530),i=r(790085),a=r(508294),s=r(759749),l=r(80455),c=Object.prototype.hasOwnProperty;let u=function(e,t){var r=(0,i.A)(e),u=!r&&(0,o.A)(e),d=!r&&!u&&(0,a.A)(e),f=!r&&!u&&!d&&(0,l.A)(e),h=r||u||d||f,p=h?(0,n.A)(e.length,String):[],m=p.length;for(var g in e)(t||c.call(e,g))&&!(h&&("length"==g||d&&("offset"==g||"parent"==g)||f&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||(0,s.A)(g,m)))&&p.push(g);return p}},622024:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}},444028:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}},49654:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e,t,r,n){var o=-1,i=null==e?0:e.length;for(n&&i&&(r=e[++o]);++o<i;)r=t(r,e[o],o,e);return r}},958532:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},213813:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(444028),o=r(369445),i=r(188530),a=r(790085),s=o.A?o.A.isConcatSpreadable:void 0;let l=function(e){return(0,a.A)(e)||(0,i.A)(e)||!!(s&&e&&e[s])},c=function e(t,r,o,i,a){var s=-1,c=t.length;for(o||(o=l),a||(a=[]);++s<c;){var u=t[s];r>0&&o(u)?r>1?e(u,r-1,o,i,a):(0,n.A)(a,u):i||(a[a.length]=u)}return a}},372699:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(444028),o=r(790085);let i=function(e,t,r){var i=t(e);return(0,o.A)(e)?i:(0,n.A)(i,r(e))}},511227:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(369445),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=n.A?n.A.toStringTag:void 0;let l=function(e){var t=i.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var o=a.call(e);return n&&(t?e[s]=r:delete e[s]),o};var c=Object.prototype.toString,u=n.A?n.A.toStringTag:void 0;let d=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":u&&u in Object(e)?l(e):c.call(e)}},214050:(e,t,r)=>{"use strict";r.d(t,{A:()=>P});var n=r(194575),o=r(918757),i=r(958532),a=r(26023);let s=function(e,t,r,n,s,l){var c=1&r,u=e.length,d=t.length;if(u!=d&&!(c&&d>u))return!1;var f=l.get(e),h=l.get(t);if(f&&h)return f==t&&h==e;var p=-1,m=!0,g=2&r?new o.A:void 0;for(l.set(e,t),l.set(t,e);++p<u;){var v=e[p],b=t[p];if(n)var y=c?n(b,v,p,t,e,l):n(v,b,p,e,t,l);if(void 0!==y){if(y)continue;m=!1;break}if(g){if(!(0,i.A)(t,function(e,t){if(!(0,a.A)(g,t)&&(v===e||s(v,e,r,n,l)))return g.push(t)})){m=!1;break}}else if(!(v===b||s(v,b,r,n,l))){m=!1;break}}return l.delete(e),l.delete(t),m};var l=r(369445),c=r(975784),u=r(363500),d=r(771249),f=r(40419),h=l.A?l.A.prototype:void 0,p=h?h.valueOf:void 0;let m=function(e,t,r,n,o,i,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!i(new c.A(e),new c.A(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return(0,u.A)(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var l=d.A;case"[object Set]":var h=1&n;if(l||(l=f.A),e.size!=t.size&&!h)break;var m=a.get(e);if(m)return m==t;n|=2,a.set(e,t);var g=s(l(e),l(t),n,o,i,a);return a.delete(e),g;case"[object Symbol]":if(p)return p.call(e)==p.call(t)}return!1};var g=r(918670),v=Object.prototype.hasOwnProperty;let b=function(e,t,r,n,o,i){var a=1&r,s=(0,g.A)(e),l=s.length;if(l!=(0,g.A)(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:v.call(t,u)))return!1}var d=i.get(e),f=i.get(t);if(d&&f)return d==t&&f==e;var h=!0;i.set(e,t),i.set(t,e);for(var p=a;++c<l;){var m=e[u=s[c]],b=t[u];if(n)var y=a?n(b,m,u,t,e,i):n(m,b,u,e,t,i);if(!(void 0===y?m===b||o(m,b,r,n,i):y)){h=!1;break}p||(p="constructor"==u)}if(h&&!p){var w=e.constructor,S=t.constructor;w!=S&&"constructor"in e&&"constructor"in t&&!("function"==typeof w&&w instanceof w&&"function"==typeof S&&S instanceof S)&&(h=!1)}return i.delete(e),i.delete(t),h};var y=r(545514),w=r(790085),S=r(508294),C=r(80455),I="[object Arguments]",k="[object Array]",E="[object Object]",_=Object.prototype.hasOwnProperty;let A=function(e,t,r,o,i,a){var l=(0,w.A)(e),c=(0,w.A)(t),u=l?k:(0,y.A)(e),d=c?k:(0,y.A)(t);u=u==I?E:u,d=d==I?E:d;var f=u==E,h=d==E,p=u==d;if(p&&(0,S.A)(e)){if(!(0,S.A)(t))return!1;l=!0,f=!1}if(p&&!f)return a||(a=new n.A),l||(0,C.A)(e)?s(e,t,r,o,i,a):m(e,t,u,r,o,i,a);if(!(1&r)){var g=f&&_.call(e,"__wrapped__"),v=h&&_.call(t,"__wrapped__");if(g||v){var A=g?e.value():e,T=v?t.value():t;return a||(a=new n.A),i(A,T,r,o,a)}}return!!p&&(a||(a=new n.A),b(e,t,r,o,i,a))};var T=r(239502);let P=function e(t,r,n,o,i){return t===r||(null!=t&&null!=r&&((0,T.A)(t)||(0,T.A)(r))?A(t,r,n,o,e,i):t!=t&&r!=r)}},503153:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(774003),o=(0,r(16227).A)(Object.keys,Object),i=Object.prototype.hasOwnProperty;let a=function(e){if(!(0,n.A)(e))return o(e);var t=[];for(var r in Object(e))i.call(e,r)&&"constructor"!=r&&t.push(r);return t}},355764:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=e[n+t];return i}},754932:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},360816:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(369445),o=r(622024),i=r(790085),a=r(398718),s=1/0,l=n.A?n.A.prototype:void 0,c=l?l.toString:void 0;let u=function e(t){if("string"==typeof t)return t;if((0,i.A)(t))return(0,o.A)(t,e)+"";if((0,a.A)(t))return c?c.call(t):"";var r=t+"";return"0"==r&&1/t==-s?"-0":r}},159137:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e){return function(t){return e(t)}}},26023:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e,t){return e.has(t)}},788574:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(355764);let o=function(e,t,r){var o=e.length;return r=void 0===r?o:r,!t&&r>=o?e:(0,n.A)(e,t,r)}},971727:(e,t,r)=>{"use strict";r.d(t,{A:()=>M});var n=r(49654),o=function(e){return function(t){return null==e?void 0:e[t]}}({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"}),i=r(444618),a=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,s=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g"),l=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,c=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,u="\ud800-\udfff",d="\\u2700-\\u27bf",f="a-z\\xdf-\\xf6\\xf8-\\xff",h="A-Z\\xc0-\\xd6\\xd8-\\xde",p="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",m="[']",g="["+p+"]",v="["+f+"]",b="[^"+u+p+"\\d+"+d+f+h+"]",y="(?:\ud83c[\udde6-\uddff]){2}",w="[\ud800-\udbff][\udc00-\udfff]",S="["+h+"]",C="(?:"+v+"|"+b+")",I="(?:"+S+"|"+b+")",k="(?:"+m+"(?:d|ll|m|re|s|t|ve))?",E="(?:"+m+"(?:D|LL|M|RE|S|T|VE))?",_="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\ud83c[\udffb-\udfff])?",A="[\\ufe0e\\ufe0f]?",T="(?:\\u200d(?:"+["[^"+u+"]",y,w].join("|")+")"+A+_+")*",P="(?:"+["["+d+"]",y,w].join("|")+")"+(A+_+T),O=RegExp([S+"?"+v+"+"+k+"(?="+[g,S,"$"].join("|")+")",I+"+"+E+"(?="+[g,S+C,"$"].join("|")+")",S+"?"+C+"+"+k,S+"+"+E,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",P].join("|"),"g");let R=function(e,t,r){if(e=(0,i.A)(e),void 0===(t=r?void 0:t)){var n;return(n=e,c.test(n))?e.match(O)||[]:e.match(l)||[]}return e.match(t)||[]};var x=RegExp("[']","g");let M=function(e){return function(t){var r;return(0,n.A)(R((r=t,(r=(0,i.A)(r))&&r.replace(a,o).replace(s,"")).replace(x,"")),e,"")}}},389692:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n="object"==typeof global&&global&&global.Object===Object&&global},918670:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(372699),o=r(421860),i=r(620034);let a=function(e){return(0,n.A)(e,i.A,o.A)}},44648:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=r(519350),o=r(737745).A["__core-js_shared__"],i=function(){var e=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),a=r(768305),s=r(449349),l=/^\[object .+?Constructor\]$/,c=Object.prototype,u=Function.prototype.toString,d=c.hasOwnProperty,f=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");let h=function(e,t){var r,o=null==e?void 0:e[t];return(r=o,(0,a.A)(r)&&(!i||!(i in r))&&((0,n.A)(r)?f:l).test((0,s.A)(r)))?o:void 0}},421860:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(980670),o=r(52405),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols;let s=a?function(e){return null==e?[]:(e=Object(e),(0,n.A)(a(e),function(t){return i.call(e,t)}))}:o.A},545514:(e,t,r)=>{"use strict";r.d(t,{A:()=>I});var n=r(44648),o=r(737745),i=(0,n.A)(o.A,"DataView"),a=r(943275),s=(0,n.A)(o.A,"Promise"),l=r(804933),c=r(91403),u=r(511227),d=r(449349),f="[object Map]",h="[object Promise]",p="[object Set]",m="[object WeakMap]",g="[object DataView]",v=(0,d.A)(i),b=(0,d.A)(a.A),y=(0,d.A)(s),w=(0,d.A)(l.A),S=(0,d.A)(c.A),C=u.A;(i&&C(new i(new ArrayBuffer(1)))!=g||a.A&&C(new a.A)!=f||s&&C(s.resolve())!=h||l.A&&C(new l.A)!=p||c.A&&C(new c.A)!=m)&&(C=function(e){var t=(0,u.A)(e),r="[object Object]"==t?e.constructor:void 0,n=r?(0,d.A)(r):"";if(n)switch(n){case v:return g;case b:return f;case y:return h;case w:return p;case S:return m}return t});let I=C},715334:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=RegExp("[\\u200d\ud800-\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");let o=function(e){return n.test(e)}},759749:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=/^(?:0|[1-9]\d*)$/;let o=function(e,t){var r=typeof e;return!!(t=null==t?0x1fffffffffffff:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},774003:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=Object.prototype;let o=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},771249:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}},83965:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(389692),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof module&&module&&!module.nodeType&&module,a=i&&i.exports===o&&n.A.process;let s=function(){try{var e=i&&i.require&&i.require("util").types;if(e)return e;return a&&a.binding&&a.binding("util")}catch(e){}}()},16227:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e,t){return function(r){return e(t(r))}}},737745:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(389692),o="object"==typeof self&&self&&self.Object===Object&&self;let i=n.A||o||Function("return this")()},40419:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}},31257:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var n=r(715334),o="\ud800-\udfff",i="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",a="\ud83c[\udffb-\udfff]",s="[^"+o+"]",l="(?:\ud83c[\udde6-\uddff]){2}",c="[\ud800-\udbff][\udc00-\udfff]",u="(?:"+i+"|"+a+")?",d="[\\ufe0e\\ufe0f]?",f="(?:\\u200d(?:"+[s,l,c].join("|")+")"+d+u+")*",h=RegExp(a+"(?="+a+")|(?:"+[s+i+"?",i,l,c,"["+o+"]"].join("|")+")"+(d+u+f),"g");let p=function(e){return(0,n.A)(e)?e.match(h)||[]:e.split("")}},449349:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=Function.prototype.toString;let o=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},868630:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(444618),o=r(458764);let i=(0,r(971727).A)(function(e,t,r){var i;return t=t.toLowerCase(),e+(r?(i=t,(0,o.A)((0,n.A)(i).toLowerCase())):t)})},363500:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e,t){return e===t||e!=e&&t!=t}},824806:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(213813);let o=function(e){return(null==e?0:e.length)?(0,n.A)(e,1):[]}},188530:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(511227),o=r(239502);let i=function(e){return(0,o.A)(e)&&"[object Arguments]"==(0,n.A)(e)};var a=Object.prototype,s=a.hasOwnProperty,l=a.propertyIsEnumerable;let c=i(function(){return arguments}())?i:function(e){return(0,o.A)(e)&&s.call(e,"callee")&&!l.call(e,"callee")}},790085:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=Array.isArray},570706:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(519350),o=r(634106);let i=function(e){return null!=e&&(0,o.A)(e.length)&&!(0,n.A)(e)}},508294:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(737745),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof module&&module&&!module.nodeType&&module,a=i&&i.exports===o?n.A.Buffer:void 0;let s=(a?a.isBuffer:void 0)||function(){return!1}},480829:(e,t,r)=>{"use strict";r.d(t,{A:()=>f});var n=r(503153),o=r(545514),i=r(188530),a=r(790085),s=r(570706),l=r(508294),c=r(774003),u=r(80455),d=Object.prototype.hasOwnProperty;let f=function(e){if(null==e)return!0;if((0,s.A)(e)&&((0,a.A)(e)||"string"==typeof e||"function"==typeof e.splice||(0,l.A)(e)||(0,u.A)(e)||(0,i.A)(e)))return!e.length;var t=(0,o.A)(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if((0,c.A)(e))return!(0,n.A)(e).length;for(var r in e)if(d.call(e,r))return!1;return!0}},966464:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(214050);let o=function(e,t){return(0,n.A)(e,t)}},519350:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(511227),o=r(768305);let i=function(e){if(!(0,o.A)(e))return!1;var t=(0,n.A)(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},634106:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}},768305:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},239502:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(e){return null!=e&&"object"==typeof e}},849291:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(929806);let o=function(e){return"number"==typeof e&&e==(0,n.A)(e)&&e>=-0x1fffffffffffff&&e<=0x1fffffffffffff}},398718:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(511227),o=r(239502);let i=function(e){return"symbol"==typeof e||(0,o.A)(e)&&"[object Symbol]"==(0,n.A)(e)}},80455:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(511227),o=r(634106),i=r(239502),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1;var s=r(159137),l=r(83965),c=l.A&&l.A.isTypedArray;let u=c?(0,s.A)(c):function(e){return(0,i.A)(e)&&(0,o.A)(e.length)&&!!a[(0,n.A)(e)]}},620034:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(559555),o=r(503153),i=r(570706);let a=function(e){return(0,i.A)(e)?(0,n.A)(e):(0,o.A)(e)}},52405:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=function(){return[]}},929806:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(911159),o=1/0;let i=function(e){var t,r=(t=e)?(t=(0,n.A)(t))===o||t===-o?(t<0?-1:1)*17976931348623157e292:t==t?t:0:0===t?t:0,i=r%1;return r==r?i?r-i:r:0}},911159:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=/\s/;let o=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t};var i=/^\s+/,a=r(768305),s=r(398718),l=0/0,c=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,d=/^0o[0-7]+$/i,f=parseInt;let h=function(e){if("number"==typeof e)return e;if((0,s.A)(e))return l;if((0,a.A)(e)){var t,r="function"==typeof e.valueOf?e.valueOf():e;e=(0,a.A)(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=(t=e)?t.slice(0,o(t)+1).replace(i,""):t;var n=u.test(e);return n||d.test(e)?f(e.slice(2),n?2:8):c.test(e)?l:+e}},444618:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(360816);let o=function(e){return null==e?"":(0,n.A)(e)}},458764:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(788574),o=r(715334),i=r(31257),a=r(444618);let s=function(e){e=(0,a.A)(e);var t=(0,o.A)(e)?(0,i.A)(e):void 0,r=t?t[0]:e.charAt(0),s=t?(0,n.A)(t,1).join(""):e.slice(1);return r.toUpperCase()+s}},447101:(e,t,r)=>{"use strict";r.r(t),r.d(t,{createSingletonState:()=>o});let n={};function o(e,t){return e in n||(n[e]=t),{get:()=>n[e],set:t=>n[e]=t}}},917674:(e,t,r)=>{"use strict";r.d(t,{$1:()=>u,CU:()=>d,IO:()=>h,LU:()=>s,Rn:()=>l,Sv:()=>f,XZ:()=>a,YK:()=>i,j:()=>o,vd:()=>n,yE:()=>c});var n="-moz-",o="-webkit-",i="comm",a="rule",s="decl",l="@media",c="@import",u="@supports",d="@namespace",f="@keyframes",h="@layer"},991707:(e,t,r)=>{"use strict";r.d(t,{MY:()=>i,r1:()=>o});var n=r(923203);function o(e){var t=(0,n.FK)(e);return function(r,n,o,i){for(var a="",s=0;s<t;s++)a+=e[s](r,n,o,i)||"";return a}}function i(e){return function(t){!t.root&&(t=t.return)&&e(t)}}},260496:(e,t,r)=>{"use strict";r.d(t,{wE:()=>a});var n=r(917674),o=r(923203),i=r(620682);function a(e){return(0,i.VF)(function e(t,r,a,c,u,d,f,h,p){for(var m,g=0,v=0,b=f,y=0,w=0,S=0,C=1,I=1,k=1,E=0,_="",A=u,T=d,P=c,O=_;I;)switch(S=E,E=(0,i.K2)()){case 40:if(108!=S&&58==(0,o.wN)(O,b-1)){-1!=(0,o.K5)(O+=(0,o.HC)((0,i.Tb)(E),"&","&\f"),"&\f",(0,o.tn)(g?h[g-1]:0))&&(k=-1);break}case 34:case 39:case 91:O+=(0,i.Tb)(E);break;case 9:case 10:case 13:case 32:O+=(0,i.mw)(S);break;case 92:O+=(0,i.Nc)((0,i.OW)()-1,7);continue;case 47:switch((0,i.se)()){case 42:case 47:(0,o.BC)((m=(0,i.nf)((0,i.K2)(),(0,i.OW)()),(0,i.rH)(m,r,a,n.YK,(0,o.HT)((0,i.Tp)()),(0,o.c1)(m,2,-2),0,p)),p),(5==(0,i.Sh)(S||1)||5==(0,i.Sh)((0,i.se)()||1))&&(0,o.b2)(O)&&" "!==(0,o.c1)(O,-1,void 0)&&(O+=" ");break;default:O+="/"}break;case 123*C:h[g++]=(0,o.b2)(O)*k;case 125*C:case 59:case 0:switch(E){case 0:case 125:I=0;case 59+v:-1==k&&(O=(0,o.HC)(O,/\f/g,"")),w>0&&((0,o.b2)(O)-b||0===C&&47===S)&&(0,o.BC)(w>32?l(O+";",c,a,b-1,p):l((0,o.HC)(O," ","")+";",c,a,b-2,p),p);break;case 59:O+=";";default:if((0,o.BC)(P=s(O,r,a,g,v,u,h,_,A=[],T=[],b,d),d),123===E){if(0===v)e(O,r,P,P,A,d,b,h,T);else{switch(y){case 99:if(110===(0,o.wN)(O,3))break;case 108:if(97===(0,o.wN)(O,2))break;default:v=0;case 100:case 109:case 115:}v?e(t,P,P,c&&(0,o.BC)(s(t,P,P,0,0,u,h,_,u,A=[],b,T),T),u,T,b,h,c?A:T):e(O,P,P,P,[""],T,0,h,T)}}}g=v=w=0,C=k=1,_=O="",b=f;break;case 58:b=1+(0,o.b2)(O),w=S;default:if(C<1){if(123==E)--C;else if(125==E&&0==C++&&125==(0,i.YL)())continue}switch(O+=(0,o.HT)(E),E*C){case 38:k=v>0?1:(O+="\f",-1);break;case 44:h[g++]=((0,o.b2)(O)-1)*k,k=1;break;case 64:45===(0,i.se)()&&(O+=(0,i.Tb)((0,i.K2)())),y=(0,i.se)(),v=b=(0,o.b2)(_=O+=(0,i.Cv)((0,i.OW)())),E++;break;case 45:45===S&&2==(0,o.b2)(O)&&(C=0)}}return d}("",null,null,null,[""],e=(0,i.c4)(e),0,[0],e))}function s(e,t,r,a,s,l,c,u,d,f,h,p){for(var m=s-1,g=0===s?l:[""],v=(0,o.FK)(g),b=0,y=0,w=0;b<a;++b)for(var S=0,C=(0,o.c1)(e,m+1,m=(0,o.tn)(y=c[b])),I=e;S<v;++S)(I=(0,o.Bq)(y>0?g[S]+" "+C:(0,o.HC)(C,/&\f/g,g[S])))&&(d[w++]=I);return(0,i.rH)(e,t,r,0===s?n.XZ:u,d,f,h,p)}function l(e,t,r,a,s){return(0,i.rH)(e,t,r,n.LU,(0,o.c1)(e,0,a),(0,o.c1)(e,a+1,-1),a,s)}},956463:(e,t,r)=>{"use strict";r.d(t,{A:()=>a,l:()=>i});var n=r(917674),o=r(923203);function i(e,t){for(var r="",n=0;n<e.length;n++)r+=t(e[n],n,e,t)||"";return r}function a(e,t,r,a){switch(e.type){case n.IO:if(e.children.length)break;case n.yE:case n.CU:case n.LU:return e.return=e.return||e.value;case n.YK:return"";case n.Sv:return e.return=e.value+"{"+i(e.children,a)+"}";case n.XZ:if(!(0,o.b2)(e.value=e.props.join(",")))return""}return(0,o.b2)(r=i(e.children,a))?e.return=e.value+"{"+r+"}":""}},620682:(e,t,r)=>{"use strict";r.d(t,{C:()=>d,Cv:()=>_,K2:()=>p,Nc:()=>k,OW:()=>g,Sh:()=>b,Tb:()=>S,Tp:()=>f,VF:()=>w,YL:()=>h,c4:()=>y,mw:()=>I,nf:()=>E,qw:()=>C,rH:()=>u,se:()=>m});var n=r(923203),o=1,i=1,a=0,s=0,l=0,c="";function u(e,t,r,n,a,s,l,c){return{value:e,root:t,parent:r,type:n,props:a,children:s,line:o,column:i,length:l,return:"",siblings:c}}function d(e,t){return(0,n.kp)(u("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function f(){return l}function h(){return l=s>0?(0,n.wN)(c,--s):0,i--,10===l&&(i=1,o--),l}function p(){return l=s<a?(0,n.wN)(c,s++):0,i++,10===l&&(i=1,o++),l}function m(){return(0,n.wN)(c,s)}function g(){return s}function v(e,t){return(0,n.c1)(c,e,t)}function b(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function y(e){return o=i=1,a=(0,n.b2)(c=e),s=0,[]}function w(e){return c="",e}function S(e){return(0,n.Bq)(v(s-1,function e(t){for(;p();)switch(l){case t:return s;case 34:case 39:34!==t&&39!==t&&e(l);break;case 40:41===t&&e(t);break;case 92:p()}return s}(91===e?e+2:40===e?e+1:e)))}function C(e){return w(function(e){for(;p();)switch(b(l)){case 0:(0,n.BC)(_(s-1),e);break;case 2:(0,n.BC)(S(l),e);break;default:(0,n.BC)((0,n.HT)(l),e)}return e}(y(e)))}function I(e){for(;l=m();)if(l<33)p();else break;return b(e)>2||b(l)>3?"":" "}function k(e,t){for(;--t&&p()&&!(l<48)&&!(l>102)&&(!(l>57)||!(l<65))&&(!(l>70)||!(l<97)););return v(e,s+(t<6&&32==m()&&32==p()))}function E(e,t){for(;p();)if(e+l===57)break;else if(e+l===84&&47===m())break;return"/*"+v(t,s-1)+"*"+(0,n.HT)(47===e?e:p())}function _(e){for(;!b(m());)p();return v(e,s)}},923203:(e,t,r)=>{"use strict";r.d(t,{BC:()=>m,Bq:()=>s,FK:()=>p,HC:()=>c,HT:()=>o,K5:()=>u,YW:()=>l,b2:()=>h,c1:()=>f,kg:()=>g,kp:()=>i,tW:()=>a,tn:()=>n,wN:()=>d});var n=Math.abs,o=String.fromCharCode,i=Object.assign;function a(e,t){return 45^d(e,0)?(((t<<2^d(e,0))<<2^d(e,1))<<2^d(e,2))<<2^d(e,3):0}function s(e){return e.trim()}function l(e,t){return(e=t.exec(e))?e[0]:e}function c(e,t,r){return e.replace(t,r)}function u(e,t,r){return e.indexOf(t,r)}function d(e,t){return 0|e.charCodeAt(t)}function f(e,t,r){return e.slice(t,r)}function h(e){return e.length}function p(e){return e.length}function m(e,t){return t.push(e),e}function g(e,t){return e.map(t).join("")}},85453:(e,t,r)=>{"use strict";r.d(t,{$u:()=>b,Al:()=>l,CC:()=>c,Ct:()=>s,Fi:()=>E,G8:()=>y,H3:()=>f,JD:()=>a,JE:()=>C,L$:()=>I,P3:()=>k,Q1:()=>i,T$:()=>p,WJ:()=>w,X8:()=>n,_p:()=>u,dh:()=>d,f7:()=>v,jb:()=>g,nN:()=>S,sA:()=>h,uq:()=>m});var n,o=r(841304);let i={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},a={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},s={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},l={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},c={GET:"GET",POST:"POST"},u={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},d={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},f={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},h={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(n||(n={}));let p={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},m={scopes:o.aZ},g="jwk",v={React:"@azure/msal-react",Angular:"@azure/msal-angular"},b="msal.db",y=1,w=`${b}.keys`,S={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},C=[S.Default,S.Skip,S.RefreshTokenAndNetwork],I="msal.browser.log.level",k="msal.browser.log.pii",E="msal.browser.performance.enabled"},802046:(e,t,r)=>{"use strict";r.d(t,{lR:()=>a,pz:()=>s});var n=r(841304),o=r(465488);let i={[o.W]:"Unexpected error in authentication.",[o.z]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};o.W,i[o.W],o.z,i[o.z];class a extends Error{constructor(e,t,r){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,a.prototype),this.errorCode=e||n.YM.EMPTY_STRING,this.errorMessage=t||n.YM.EMPTY_STRING,this.subError=r||n.YM.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function s(e,t){return new a(e,t?`${i[e]} ${t}`:i[e])}},465488:(e,t,r)=>{"use strict";r.d(t,{W:()=>n,z:()=>o});let n="unexpected_error",o="post_request_failed"},47807:(e,t,r)=>{"use strict";r.d(t,{CB:()=>c,IE:()=>d,a:()=>u});var n=r(841304),o=r(802046),i=r(454023);let a=[i.mP,i.CY,i.Zv,i.j9],s=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],l={[i.oF]:"No refresh token found in the cache. Please sign-in.",[i.B]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[i.AG]:"Refresh token has expired.",[i.j9]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};i.oF,l[i.oF],i.B,l[i.B],i.j9,l[i.j9];class c extends o.lR{constructor(e,t,r,o,i,a,s,l){super(e,t,r),Object.setPrototypeOf(this,c.prototype),this.timestamp=o||n.YM.EMPTY_STRING,this.traceId=i||n.YM.EMPTY_STRING,this.correlationId=a||n.YM.EMPTY_STRING,this.claims=s||n.YM.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}}function u(e,t,r){let n=!!e&&a.indexOf(e)>-1,o=!!r&&s.indexOf(r)>-1,i=!!t&&a.some(e=>t.indexOf(e)>-1);return n||i||o}function d(e){return new c(e,l[e])}},454023:(e,t,r)=>{"use strict";r.d(t,{AG:()=>i,B:()=>o,CY:()=>s,Zv:()=>l,j9:()=>c,mP:()=>a,oF:()=>n});let n="no_tokens_found",o="native_account_unavailable",i="refresh_token_expired",a="interaction_required",s="consent_required",l="login_required",c="bad_token"},841304:(e,t,r)=>{"use strict";r.d(t,{$x:()=>m,E_:()=>I,F0:()=>N,Fq:()=>u,GU:()=>y,Gd:()=>l,I:()=>A,IO:()=>E,JR:()=>w,Kk:()=>P,LR:()=>v,Lz:()=>M,OK:()=>s,Qd:()=>g,Rv:()=>x,Tq:()=>T,Xw:()=>_,YM:()=>n,_2:()=>R,_A:()=>a,_M:()=>d,aG:()=>b,aZ:()=>i,gT:()=>k,hB:()=>S,iF:()=>f,jZ:()=>O,p:()=>p,t3:()=>o,u0:()=>C,v2:()=>c,zL:()=>h});let n={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},o={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},i=[n.OPENID_SCOPE,n.PROFILE_SCOPE,n.OFFLINE_ACCESS_SCOPE],a=[...i,n.EMAIL_SCOPE],s={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},l={ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},c={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},u={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},d={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},f={PLAIN:"plain",S256:"S256"},h={QUERY:"query",FRAGMENT:"fragment"},p={...h,FORM_POST:"form_post"},m={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},g={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},v={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},b={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},y="appmetadata",w="client_info",S="1",C={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:86400},I={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},k={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},E={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},_={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},A={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},T={username:"username",password:"password"},P={httpSuccess:200,httpBadRequest:400},O={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},R={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},x={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},M={Jwt:"JWT",Jwk:"JWK",Pop:"pop"},N=300},748527:(e,t,r)=>{"use strict";let n,o,i,a,s;function l(e){let t=e.length;for(;--t>=0;)e[t]=0}r.d(t,{Ay:()=>tq});let c=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),u=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),f=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),h=Array(576);l(h);let p=Array(60);l(p);let m=Array(512);l(m);let g=Array(256);l(g);let v=Array(29);l(v);let b=Array(30);function y(e,t,r,n,o){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=o,this.has_stree=e&&e.length}function w(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}l(b);let S=e=>e<256?m[e]:m[256+(e>>>7)],C=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},I=(e,t,r)=>{e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,C(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},k=(e,t,r)=>{I(e,r[2*t],r[2*t+1])},E=(e,t)=>{let r=0;do r|=1&e,e>>>=1,r<<=1;while(--t>0)return r>>>1},_=e=>{16===e.bi_valid?(C(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)},A=(e,t)=>{let r,n,o,i,a,s;let l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(i=0;i<=15;i++)e.bl_count[i]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(i=l[2*l[2*(n=e.heap[r])+1]+1]+1)>p&&(i=p,m++),l[2*n+1]=i,!(n>c)&&(e.bl_count[i]++,a=0,n>=h&&(a=f[n-h]),s=l[2*n],e.opt_len+=s*(i+a),d&&(e.static_len+=s*(u[2*n+1]+a)));if(0!==m){do{for(i=p-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[p]--,m-=2}while(m>0)for(i=p;0!==i;i--)for(n=e.bl_count[i];0!==n;)!((o=e.heap[--r])>c)&&(l[2*o+1]!==i&&(e.opt_len+=(i-l[2*o+1])*l[2*o],l[2*o+1]=i),n--)}},T=(e,t,r)=>{let n,o;let i=Array(16),a=0;for(n=1;n<=15;n++)i[n]=a=a+r[n-1]<<1;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=E(i[t]++,t))}},P=()=>{let e,t,r,a,s;let l=Array(16);for(a=0,r=0;a<28;a++)for(e=0,v[a]=r;e<1<<c[a];e++)g[r++]=a;for(g[r-1]=a,s=0,a=0;a<16;a++)for(e=0,b[a]=s;e<1<<u[a];e++)m[s++]=a;for(s>>=7;a<30;a++)for(e=0,b[a]=s<<7;e<1<<u[a]-7;e++)m[256+s++]=a;for(t=0;t<=15;t++)l[t]=0;for(e=0;e<=143;)h[2*e+1]=8,e++,l[8]++;for(;e<=255;)h[2*e+1]=9,e++,l[9]++;for(;e<=279;)h[2*e+1]=7,e++,l[7]++;for(;e<=287;)h[2*e+1]=8,e++,l[8]++;for(T(h,287,l),e=0;e<30;e++)p[2*e+1]=5,p[2*e]=E(e,5);n=new y(h,c,257,286,15),o=new y(p,u,0,30,15),i=new y([],d,0,19,7)},O=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},R=e=>{e.bi_valid>8?C(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},x=(e,t,r,n)=>{R(e),n&&(C(e,r),C(e,~r)),e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},M=(e,t,r,n)=>{let o=2*t,i=2*r;return e[o]<e[i]||e[o]===e[i]&&n[t]<=n[r]},N=(e,t,r)=>{let n=e.heap[r],o=r<<1;for(;o<=e.heap_len&&(o<e.heap_len&&M(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!M(t,n,e.heap[o],e.depth));)e.heap[r]=e.heap[o],r=o,o<<=1;e.heap[r]=n},F=(e,t,r)=>{let n,o,i,a;let s=0;if(0!==e.last_lit)do n=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],o=e.pending_buf[e.l_buf+s],s++,0===n?k(e,o,t):(k(e,(i=g[o])+256+1,t),0!==(a=c[i])&&I(e,o-=v[i],a),k(e,i=S(--n),r),0!==(a=u[i])&&I(e,n-=b[i],a));while(s<e.last_lit)k(e,256,t)},L=(e,t)=>{let r,n,o;let i=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(r=0,e.heap_len=0,e.heap_max=573;r<l;r++)0!==i[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):i[2*r+1]=0;for(;e.heap_len<2;)i[2*(o=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[o]=0,e.opt_len--,s&&(e.static_len-=a[2*o+1]);for(t.max_code=c,r=e.heap_len>>1;r>=1;r--)N(e,i,r);o=l;do r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],N(e,i,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,i[2*o]=i[2*r]+i[2*n],e.depth[o]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,i[2*r+1]=i[2*n+1]=o,e.heap[1]=o++,N(e,i,1);while(e.heap_len>=2)e.heap[--e.heap_max]=e.heap[1],A(e,t),T(i,c,e.bl_count)},z=(e,t,r)=>{let n,o;let i=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)o=a,a=t[(n+1)*2+1],++s<l&&o===a||(s<c?e.bl_tree[2*o]+=s:0!==o?(o!==i&&e.bl_tree[2*o]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,i=o,0===a?(l=138,c=3):o===a?(l=6,c=3):(l=7,c=4))},D=(e,t,r)=>{let n,o;let i=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),n=0;n<=r;n++)if(o=a,a=t[(n+1)*2+1],!(++s<l)||o!==a){if(s<c)do k(e,o,e.bl_tree);while(0!=--s)else 0!==o?(o!==i&&(k(e,o,e.bl_tree),s--),k(e,16,e.bl_tree),I(e,s-3,2)):s<=10?(k(e,17,e.bl_tree),I(e,s-3,3)):(k(e,18,e.bl_tree),I(e,s-11,7));s=0,i=o,0===a?(l=138,c=3):o===a?(l=6,c=3):(l=7,c=4)}},B=e=>{let t;for(z(e,e.dyn_ltree,e.l_desc.max_code),z(e,e.dyn_dtree,e.d_desc.max_code),L(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*f[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t},U=(e,t,r,n)=>{let o;for(I(e,t-257,5),I(e,r-1,5),I(e,n-4,4),o=0;o<n;o++)I(e,e.bl_tree[2*f[o]+1],3);D(e,e.dyn_ltree,t-1),D(e,e.dyn_dtree,r-1)},H=e=>{let t,r=0xf3ffc07f;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0},q=!1,j=(e,t,r,n)=>{I(e,0+(n?1:0),3),x(e,t,r,!0)};var $={_tr_init:e=>{q||(P(),q=!0),e.l_desc=new w(e.dyn_ltree,n),e.d_desc=new w(e.dyn_dtree,o),e.bl_desc=new w(e.bl_tree,i),e.bi_buf=0,e.bi_valid=0,O(e)},_tr_stored_block:j,_tr_flush_block:(e,t,r,n)=>{let o,i;let a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=H(e)),L(e,e.l_desc),L(e,e.d_desc),a=B(e),o=e.opt_len+3+7>>>3,(i=e.static_len+3+7>>>3)<=o&&(o=i)):o=i=r+5,r+4<=o&&-1!==t?j(e,t,r,n):4===e.strategy||i===o?(I(e,2+(n?1:0),3),F(e,h,p)):(I(e,4+(n?1:0),3),U(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),F(e,e.dyn_ltree,e.dyn_dtree)),O(e),n&&R(e)},_tr_tally:(e,t,r)=>(e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[(g[r]+256+1)*2]++,e.dyn_dtree[2*S(t)]++),e.last_lit===e.lit_bufsize-1),_tr_align:e=>{I(e,2,3),k(e,256,h),_(e)}},W=(e,t,r,n)=>{let o=65535&e|0,i=e>>>16&65535|0,a=0;for(;0!==r;){a=r>2e3?2e3:r,r-=a;do i=i+(o=o+t[n++]|0)|0;while(--a)o%=65521,i%=65521}return o|i<<16|0};let V=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?0xedb88320^e>>>1:e>>>1;t[r]=e}return t})());var G=(e,t,r,n)=>{let o=n+r;e^=-1;for(let r=n;r<o;r++)e=e>>>8^V[(e^t[r])&255];return -1^e},K={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},X={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};let{_tr_init:Y,_tr_stored_block:Z,_tr_flush_block:Q,_tr_tally:J,_tr_align:ee}=$,{Z_NO_FLUSH:et,Z_PARTIAL_FLUSH:er,Z_FULL_FLUSH:en,Z_FINISH:eo,Z_BLOCK:ei,Z_OK:ea,Z_STREAM_END:es,Z_STREAM_ERROR:el,Z_DATA_ERROR:ec,Z_BUF_ERROR:eu,Z_DEFAULT_COMPRESSION:ed,Z_FILTERED:ef,Z_HUFFMAN_ONLY:eh,Z_RLE:ep,Z_FIXED:em,Z_DEFAULT_STRATEGY:eg,Z_UNKNOWN:ev,Z_DEFLATED:eb}=X,ey=(e,t)=>(e.msg=K[t],t),ew=e=>(e<<1)-(e>4?9:0),eS=e=>{let t=e.length;for(;--t>=0;)e[t]=0},eC=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,eI=e=>{let t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))},ek=(e,t)=>{Q(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,eI(e.strm)},eE=(e,t)=>{e.pending_buf[e.pending++]=t},e_=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},eA=(e,t,r,n)=>{let o=e.avail_in;return(o>n&&(o=n),0===o)?0:(e.avail_in-=o,t.set(e.input.subarray(e.next_in,e.next_in+o),r),1===e.state.wrap?e.adler=W(e.adler,t,o,r):2===e.state.wrap&&(e.adler=G(e.adler,t,o,r)),e.next_in+=o,e.total_in+=o,o)},eT=(e,t)=>{let r,n,o=e.max_chain_length,i=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,c=e.window,u=e.w_mask,d=e.prev,f=e.strstart+258,h=c[i+a-1],p=c[i+a];e.prev_length>=e.good_match&&(o>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(r=t)+a]!==p||c[r+a-1]!==h||c[r]!==c[i]||c[++r]!==c[i+1])continue;i+=2,r++;do;while(c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&i<f)if(n=258-(f-i),i=f-258,n>a){if(e.match_start=t,a=n,n>=s)break;h=c[i+a-1],p=c[i+a]}}while((t=d[t&u])>l&&0!=--o)return a<=e.lookahead?a:e.lookahead},eP=e=>{let t,r,n,o,i;let a=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-262)){e.window.set(e.window.subarray(a,a+a),0),e.match_start-=a,e.strstart-=a,e.block_start-=a,t=r=e.hash_size;do n=e.head[--t],e.head[t]=n>=a?n-a:0;while(--r)t=r=a;do n=e.prev[--t],e.prev[t]=n>=a?n-a:0;while(--r)o+=a}if(0===e.strm.avail_in)break;if(r=eA(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=r,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=eC(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=eC(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)},eO=(e,t)=>{let r,n;for(;;){if(e.lookahead<262){if(eP(e),e.lookahead<262&&t===et)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=eC(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-262&&(e.match_length=eT(e,r)),e.match_length>=3){if(n=J(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do e.strstart++,e.ins_h=eC(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!=--e.match_length)e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=eC(e,e.ins_h,e.window[e.strstart+1])}else n=J(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(ek(e,!1),0===e.strm.avail_out))return 1}return(e.insert=e.strstart<2?e.strstart:2,t===eo)?(ek(e,!0),0===e.strm.avail_out)?3:4:e.last_lit&&(ek(e,!1),0===e.strm.avail_out)?1:2},eR=(e,t)=>{let r,n,o;for(;;){if(e.lookahead<262){if(eP(e),e.lookahead<262&&t===et)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=eC(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-262&&(e.match_length=eT(e,r),e.match_length<=5&&(e.strategy===ef||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-3,n=J(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=o&&(e.ins_h=eC(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!=--e.prev_length)if(e.match_available=0,e.match_length=2,e.strstart++,n&&(ek(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=J(e,0,e.window[e.strstart-1]))&&ek(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return(e.match_available&&(n=J(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===eo)?(ek(e,!0),0===e.strm.avail_out)?3:4:e.last_lit&&(ek(e,!1),0===e.strm.avail_out)?1:2},ex=(e,t)=>{let r,n,o,i;let a=e.window;for(;;){if(e.lookahead<=258){if(eP(e),e.lookahead<=258&&t===et)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=a[o=e.strstart-1])===a[++o]&&n===a[++o]&&n===a[++o]){i=e.strstart+258;do;while(n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&n===a[++o]&&o<i)e.match_length=258-(i-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=J(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=J(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(ek(e,!1),0===e.strm.avail_out))return 1}return(e.insert=0,t===eo)?(ek(e,!0),0===e.strm.avail_out)?3:4:e.last_lit&&(ek(e,!1),0===e.strm.avail_out)?1:2},eM=(e,t)=>{let r;for(;;){if(0===e.lookahead&&(eP(e),0===e.lookahead)){if(t===et)return 1;break}if(e.match_length=0,r=J(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(ek(e,!1),0===e.strm.avail_out))return 1}return(e.insert=0,t===eo)?(ek(e,!0),0===e.strm.avail_out)?3:4:e.last_lit&&(ek(e,!1),0===e.strm.avail_out)?1:2};function eN(e,t,r,n,o){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=o}let eF=[new eN(0,0,0,0,(e,t)=>{let r=65535;for(65535>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(eP(e),0===e.lookahead&&t===et)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;let n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,ek(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-262&&(ek(e,!1),0===e.strm.avail_out))return 1}return(e.insert=0,t===eo)?(ek(e,!0),0===e.strm.avail_out)?3:4:(e.strstart>e.block_start&&(ek(e,!1),e.strm.avail_out),1)}),new eN(4,4,8,4,eO),new eN(4,5,16,8,eO),new eN(4,6,32,32,eO),new eN(4,4,16,16,eR),new eN(8,16,32,32,eR),new eN(8,16,128,128,eR),new eN(8,32,128,256,eR),new eN(32,128,258,1024,eR),new eN(32,258,258,4096,eR)],eL=e=>{e.window_size=2*e.w_size,eS(e.head),e.max_lazy_match=eF[e.level].max_lazy,e.good_match=eF[e.level].good_length,e.nice_match=eF[e.level].nice_length,e.max_chain_length=eF[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0};function ez(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=eb,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),eS(this.dyn_ltree),eS(this.dyn_dtree),eS(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),eS(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),eS(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}let eD=e=>{if(!e||!e.state)return ey(e,el);e.total_in=e.total_out=0,e.data_type=ev;let t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=et,Y(t),ea},eB=e=>{let t=eD(e);return t===ea&&eL(e.state),t};var eU={deflateInit2:(e,t,r,n,o,i)=>{if(!e)return el;let a=1;if(t===ed&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),o<1||o>9||r!==eb||n<8||n>15||t<0||t>9||i<0||i>em)return ey(e,el);8===n&&(n=9);let s=new ez;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=o+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<o+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=i,s.method=r,eB(e)},deflateSetHeader:(e,t)=>e&&e.state&&2===e.state.wrap?(e.state.gzhead=t,ea):el,deflate:(e,t)=>{let r,n;if(!e||!e.state||t>ei||t<0)return e?ey(e,el):el;let o=e.state;if(!e.output||!e.input&&0!==e.avail_in||666===o.status&&t!==eo)return ey(e,0===e.avail_out?eu:el);o.strm=e;let i=o.last_flush;if(o.last_flush=t,42===o.status){if(2===o.wrap)e.adler=0,eE(o,31),eE(o,139),eE(o,8),o.gzhead?(eE(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),eE(o,255&o.gzhead.time),eE(o,o.gzhead.time>>8&255),eE(o,o.gzhead.time>>16&255),eE(o,o.gzhead.time>>24&255),eE(o,9===o.level?2:o.strategy>=eh||o.level<2?4:0),eE(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(eE(o,255&o.gzhead.extra.length),eE(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(e.adler=G(e.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=69):(eE(o,0),eE(o,0),eE(o,0),eE(o,0),eE(o,0),eE(o,9===o.level?2:o.strategy>=eh||o.level<2?4:0),eE(o,3),o.status=113);else{let t=eb+(o.w_bits-8<<4)<<8;t|=(o.strategy>=eh||o.level<2?0:o.level<6?1:6===o.level?2:3)<<6,0!==o.strstart&&(t|=32),t+=31-t%31,o.status=113,e_(o,t),0!==o.strstart&&(e_(o,e.adler>>>16),e_(o,65535&e.adler)),e.adler=1}}if(69===o.status){if(o.gzhead.extra){for(r=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>r&&(e.adler=G(e.adler,o.pending_buf,o.pending-r,r)),eI(e),r=o.pending,o.pending!==o.pending_buf_size));)eE(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>r&&(e.adler=G(e.adler,o.pending_buf,o.pending-r,r)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=73)}else o.status=73}if(73===o.status){if(o.gzhead.name){r=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>r&&(e.adler=G(e.adler,o.pending_buf,o.pending-r,r)),eI(e),r=o.pending,o.pending===o.pending_buf_size)){n=1;break}n=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,eE(o,n)}while(0!==n)o.gzhead.hcrc&&o.pending>r&&(e.adler=G(e.adler,o.pending_buf,o.pending-r,r)),0===n&&(o.gzindex=0,o.status=91)}else o.status=91}if(91===o.status){if(o.gzhead.comment){r=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>r&&(e.adler=G(e.adler,o.pending_buf,o.pending-r,r)),eI(e),r=o.pending,o.pending===o.pending_buf_size)){n=1;break}n=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,eE(o,n)}while(0!==n)o.gzhead.hcrc&&o.pending>r&&(e.adler=G(e.adler,o.pending_buf,o.pending-r,r)),0===n&&(o.status=103)}else o.status=103}if(103===o.status&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&eI(e),o.pending+2<=o.pending_buf_size&&(eE(o,255&e.adler),eE(o,e.adler>>8&255),e.adler=0,o.status=113)):o.status=113),0!==o.pending){if(eI(e),0===e.avail_out)return o.last_flush=-1,ea}else if(0===e.avail_in&&ew(t)<=ew(i)&&t!==eo)return ey(e,eu);if(666===o.status&&0!==e.avail_in)return ey(e,eu);if(0!==e.avail_in||0!==o.lookahead||t!==et&&666!==o.status){let r=o.strategy===eh?eM(o,t):o.strategy===ep?ex(o,t):eF[o.level].func(o,t);if((3===r||4===r)&&(o.status=666),1===r||3===r)return 0===e.avail_out&&(o.last_flush=-1),ea;if(2===r&&(t===er?ee(o):t!==ei&&(Z(o,0,0,!1),t===en&&(eS(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),eI(e),0===e.avail_out))return o.last_flush=-1,ea}return t!==eo?ea:o.wrap<=0?es:(2===o.wrap?(eE(o,255&e.adler),eE(o,e.adler>>8&255),eE(o,e.adler>>16&255),eE(o,e.adler>>24&255),eE(o,255&e.total_in),eE(o,e.total_in>>8&255),eE(o,e.total_in>>16&255),eE(o,e.total_in>>24&255)):(e_(o,e.adler>>>16),e_(o,65535&e.adler)),eI(e),o.wrap>0&&(o.wrap=-o.wrap),0!==o.pending?ea:es)},deflateEnd:e=>{if(!e||!e.state)return el;let t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?ey(e,el):(e.state=null,113===t?ey(e,ec):ea)},deflateSetDictionary:(e,t)=>{let r=t.length;if(!e||!e.state)return el;let n=e.state,o=n.wrap;if(2===o||1===o&&42!==n.status||n.lookahead)return el;if(1===o&&(e.adler=W(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){0===o&&(eS(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(r-n.w_size,r),0),t=e,r=n.w_size}let i=e.avail_in,a=e.next_in,s=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,eP(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do n.ins_h=eC(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++;while(--t)n.strstart=e,n.lookahead=2,eP(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=a,e.input=s,e.avail_in=i,n.wrap=o,ea}};let eH=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var eq={assign:function(e){let t=Array.prototype.slice.call(arguments,1);for(;t.length;){let r=t.shift();if(r){if("object"!=typeof r)throw TypeError(r+"must be non-object");for(let t in r)eH(r,t)&&(e[t]=r[t])}}return e},flattenChunks:e=>{let t=0;for(let r=0,n=e.length;r<n;r++)t+=e[r].length;let r=new Uint8Array(t);for(let t=0,n=0,o=e.length;t<o;t++){let o=e[t];r.set(o,n),n+=o.length}return r}};let ej=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){ej=!1}let e$=new Uint8Array(256);for(let e=0;e<256;e++)e$[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;e$[254]=e$[254]=1;let eW=(e,t)=>{if(t<65534&&e.subarray&&ej)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var eV={string2buf:e=>{let t,r,n,o,i,a=e.length,s=0;for(o=0;o<a;o++)(64512&(r=e.charCodeAt(o)))==55296&&o+1<a&&(64512&(n=e.charCodeAt(o+1)))==56320&&(r=65536+(r-55296<<10)+(n-56320),o++),s+=r<128?1:r<2048?2:r<65536?3:4;for(i=0,t=new Uint8Array(s),o=0;i<s;o++)(64512&(r=e.charCodeAt(o)))==55296&&o+1<a&&(64512&(n=e.charCodeAt(o+1)))==56320&&(r=65536+(r-55296<<10)+(n-56320),o++),r<128?t[i++]=r:(r<2048?t[i++]=192|r>>>6:(r<65536?t[i++]=224|r>>>12:(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63),t[i++]=128|r>>>6&63),t[i++]=128|63&r);return t},buf2string:(e,t)=>{let r,n;let o=t||e.length,i=Array(2*o);for(n=0,r=0;r<o;){let t=e[r++];if(t<128){i[n++]=t;continue}let a=e$[t];if(a>4){i[n++]=65533,r+=a-1;continue}for(t&=2===a?31:3===a?15:7;a>1&&r<o;)t=t<<6|63&e[r++],a--;if(a>1){i[n++]=65533;continue}t<65536?i[n++]=t:(t-=65536,i[n++]=55296|t>>10&1023,i[n++]=56320|1023&t)}return eW(i,n)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(192&e[r])==128;)r--;return r<0||0===r?t:r+e$[e[r]]>t?r:t}},eG=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};let eK=Object.prototype.toString,{Z_NO_FLUSH:eX,Z_SYNC_FLUSH:eY,Z_FULL_FLUSH:eZ,Z_FINISH:eQ,Z_OK:eJ,Z_STREAM_END:e0,Z_DEFAULT_COMPRESSION:e1,Z_DEFAULT_STRATEGY:e2,Z_DEFLATED:e3}=X;function e5(e){this.options=eq.assign({level:e1,method:e3,chunkSize:16384,windowBits:15,memLevel:8,strategy:e2},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new eG,this.strm.avail_out=0;let r=eU.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==eJ)throw Error(K[r]);if(t.header&&eU.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?eV.string2buf(t.dictionary):"[object ArrayBuffer]"===eK.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=eU.deflateSetDictionary(this.strm,e))!==eJ)throw Error(K[r]);this._dict_set=!0}}function e6(e,t){let r=new e5(t);if(r.push(e,!0),r.err)throw r.msg||K[r.err];return r.result}e5.prototype.push=function(e,t){let r,n;let o=this.strm,i=this.options.chunkSize;if(this.ended)return!1;for(n=t===~~t?t:!0===t?eQ:eX,"string"==typeof e?o.input=eV.string2buf(e):"[object ArrayBuffer]"===eK.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;;){if(0===o.avail_out&&(o.output=new Uint8Array(i),o.next_out=0,o.avail_out=i),(n===eY||n===eZ)&&o.avail_out<=6){this.onData(o.output.subarray(0,o.next_out)),o.avail_out=0;continue}if((r=eU.deflate(o,n))===e0)return o.next_out>0&&this.onData(o.output.subarray(0,o.next_out)),r=eU.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===eJ;if(0===o.avail_out){this.onData(o.output);continue}if(n>0&&o.next_out>0){this.onData(o.output.subarray(0,o.next_out)),o.avail_out=0;continue}if(0===o.avail_in)break}return!0},e5.prototype.onData=function(e){this.chunks.push(e)},e5.prototype.onEnd=function(e){e===eJ&&(this.result=eq.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var e4=function(e,t){let r,n,o,i,a,s,l,c,u,d,f,h,p,m,g,v,b,y,w,S,C,I,k,E;let _=e.state;r=e.next_in,k=e.input,n=r+(e.avail_in-5),o=e.next_out,E=e.output,i=o-(t-e.avail_out),a=o+(e.avail_out-257),s=_.dmax,l=_.wsize,c=_.whave,u=_.wnext,d=_.window,f=_.hold,h=_.bits,p=_.lencode,m=_.distcode,g=(1<<_.lenbits)-1,v=(1<<_.distbits)-1;r:do for(h<15&&(f+=k[r++]<<h,h+=8,f+=k[r++]<<h,h+=8),b=p[f&g];;){if(f>>>=y=b>>>24,h-=y,0==(y=b>>>16&255))E[o++]=65535&b;else if(16&y)for(w=65535&b,(y&=15)&&(h<y&&(f+=k[r++]<<h,h+=8),w+=f&(1<<y)-1,f>>>=y,h-=y),h<15&&(f+=k[r++]<<h,h+=8,f+=k[r++]<<h,h+=8),b=m[f&v];;){if(f>>>=y=b>>>24,h-=y,16&(y=b>>>16&255)){if(S=65535&b,h<(y&=15)&&(f+=k[r++]<<h,(h+=8)<y&&(f+=k[r++]<<h,h+=8)),(S+=f&(1<<y)-1)>s){e.msg="invalid distance too far back",_.mode=30;break r}if(f>>>=y,h-=y,S>(y=o-i)){if((y=S-y)>c&&_.sane){e.msg="invalid distance too far back",_.mode=30;break r}if(C=0,I=d,0===u){if(C+=l-y,y<w){w-=y;do E[o++]=d[C++];while(--y)C=o-S,I=E}}else if(u<y){if(C+=l+u-y,(y-=u)<w){w-=y;do E[o++]=d[C++];while(--y)if(C=0,u<w){w-=y=u;do E[o++]=d[C++];while(--y)C=o-S,I=E}}}else if(C+=u-y,y<w){w-=y;do E[o++]=d[C++];while(--y)C=o-S,I=E}for(;w>2;)E[o++]=I[C++],E[o++]=I[C++],E[o++]=I[C++],w-=3;w&&(E[o++]=I[C++],w>1&&(E[o++]=I[C++]))}else{C=o-S;do E[o++]=E[C++],E[o++]=E[C++],E[o++]=E[C++],w-=3;while(w>2)w&&(E[o++]=E[C++],w>1&&(E[o++]=E[C++]))}}else if((64&y)==0){b=m[(65535&b)+(f&(1<<y)-1)];continue}else{e.msg="invalid distance code",_.mode=30;break r}break}else if((64&y)==0){b=p[(65535&b)+(f&(1<<y)-1)];continue}else if(32&y){_.mode=12;break r}else{e.msg="invalid literal/length code",_.mode=30;break r}break}while(r<n&&o<a)r-=w=h>>3,h-=w<<3,f&=(1<<h)-1,e.next_in=r,e.next_out=o,e.avail_in=r<n?5+(n-r):5-(r-n),e.avail_out=o<a?257+(a-o):257-(o-a),_.hold=f,_.bits=h};let e8=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),e9=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),e7=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),te=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var tt=(e,t,r,n,o,i,a,s)=>{let l,c,u,d,f,h,p,m,g;let v=s.bits,b=0,y=0,w=0,S=0,C=0,I=0,k=0,E=0,_=0,A=0,T=null,P=0,O=new Uint16Array(16),R=new Uint16Array(16),x=null,M=0;for(b=0;b<=15;b++)O[b]=0;for(y=0;y<n;y++)O[t[r+y]]++;for(S=15,C=v;S>=1&&0===O[S];S--);if(C>S&&(C=S),0===S)return o[i++]=0x1400000,o[i++]=0x1400000,s.bits=1,0;for(w=1;w<S&&0===O[w];w++);for(C<w&&(C=w),E=1,b=1;b<=15;b++)if(E<<=1,(E-=O[b])<0)return -1;if(E>0&&(0===e||1!==S))return -1;for(b=1,R[1]=0;b<15;b++)R[b+1]=R[b]+O[b];for(y=0;y<n;y++)0!==t[r+y]&&(a[R[t[r+y]]++]=y);if(0===e?(T=x=a,h=19):1===e?(T=e8,P-=257,x=e9,M-=257,h=256):(T=e7,x=te,h=-1),A=0,y=0,b=w,f=i,I=C,k=0,u=-1,d=(_=1<<C)-1,1===e&&_>852||2===e&&_>592)return 1;for(;;){p=b-k,a[y]<h?(m=0,g=a[y]):a[y]>h?(m=x[M+a[y]],g=T[P+a[y]]):(m=96,g=0),l=1<<b-k,w=c=1<<I;do o[f+(A>>k)+(c-=l)]=p<<24|m<<16|g|0;while(0!==c)for(l=1<<b-1;A&l;)l>>=1;if(0!==l?(A&=l-1,A+=l):A=0,y++,0==--O[b]){if(b===S)break;b=t[r+a[y]]}if(b>C&&(A&d)!==u){for(0===k&&(k=C),f+=w,E=1<<(I=b-k);I+k<S&&!((E-=O[I+k])<=0);)I++,E<<=1;if(_+=1<<I,1===e&&_>852||2===e&&_>592)return 1;o[u=A&d]=C<<24|I<<16|f-i|0}}return 0!==A&&(o[f+A]=b-k<<24|4194304),s.bits=C,0};let{Z_FINISH:tr,Z_BLOCK:tn,Z_TREES:to,Z_OK:ti,Z_STREAM_END:ta,Z_NEED_DICT:ts,Z_STREAM_ERROR:tl,Z_DATA_ERROR:tc,Z_MEM_ERROR:tu,Z_BUF_ERROR:td,Z_DEFLATED:tf}=X,th=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function tp(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}let tm=e=>{if(!e||!e.state)return tl;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,ti},tg=e=>{if(!e||!e.state)return tl;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,tm(e)},tv=(e,t)=>{let r;if(!e||!e.state)return tl;let n=e.state;return(t<0?(r=0,t=-t):(r=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15))?tl:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,tg(e))},tb=!0,ty=e=>{if(tb){a=new Int32Array(512),s=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(tt(1,e.lens,0,288,a,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;tt(2,e.lens,0,32,s,0,e.work,{bits:5}),tb=!1}e.lencode=a,e.lenbits=9,e.distcode=s,e.distbits=5},tw=(e,t,r,n)=>{let o;let i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):((o=i.wsize-i.wnext)>n&&(o=n),i.window.set(t.subarray(r-n,r-n+o),i.wnext),(n-=o)?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=o,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=o))),0};var tS={inflateReset:tg,inflateInit2:(e,t)=>{if(!e)return tl;let r=new tp;e.state=r,r.window=null;let n=tv(e,t);return n!==ti&&(e.state=null),n},inflate:(e,t)=>{let r,n,o,i,a,s,l,c,u,d,f,h,p,m,g,v,b,y,w,S,C,I,k,E;let _=0,A=new Uint8Array(4),T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return tl;12===(r=e.state).mode&&(r.mode=13),a=e.next_out,o=e.output,l=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,d=s,f=l,I=ti;n:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;u<16;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}if(2&r.wrap&&35615===c){r.check=0,A[0]=255&c,A[1]=c>>>8&255,r.check=G(r.check,A,2,0),c=0,u=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=30;break}if((15&c)!==tf){e.msg="unknown compression method",r.mode=30;break}if(c>>>=4,u-=4,C=(15&c)+8,0===r.wbits)r.wbits=C;else if(C>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<r.wbits,e.adler=r.check=1,r.mode=512&c?10:12,c=0,u=0;break;case 2:for(;u<16;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}if(r.flags=c,(255&r.flags)!==tf){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&(A[0]=255&c,A[1]=c>>>8&255,r.check=G(r.check,A,2,0)),c=0,u=0,r.mode=3;case 3:for(;u<32;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}r.head&&(r.head.time=c),512&r.flags&&(A[0]=255&c,A[1]=c>>>8&255,A[2]=c>>>16&255,A[3]=c>>>24&255,r.check=G(r.check,A,4,0)),c=0,u=0,r.mode=4;case 4:for(;u<16;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&(A[0]=255&c,A[1]=c>>>8&255,r.check=G(r.check,A,2,0)),c=0,u=0,r.mode=5;case 5:if(1024&r.flags){for(;u<16;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&(A[0]=255&c,A[1]=c>>>8&255,r.check=G(r.check,A,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((h=r.length)>s&&(h=s),h&&(r.head&&(C=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+h),C)),512&r.flags&&(r.check=G(r.check,n,h,i)),s-=h,i+=h,r.length-=h),r.length))break n;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===s)break n;h=0;do C=n[i+h++],r.head&&C&&r.length<65536&&(r.head.name+=String.fromCharCode(C));while(C&&h<s)if(512&r.flags&&(r.check=G(r.check,n,h,i)),s-=h,i+=h,C)break n}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===s)break n;h=0;do C=n[i+h++],r.head&&C&&r.length<65536&&(r.head.comment+=String.fromCharCode(C));while(C&&h<s)if(512&r.flags&&(r.check=G(r.check,n,h,i)),s-=h,i+=h,C)break n}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;u<16;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}if(c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;u<32;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}e.adler=r.check=th(c),c=0,u=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=c,r.bits=u,ts;e.adler=r.check=1,r.mode=12;case 12:if(t===tn||t===to)break n;case 13:if(r.last){c>>>=7&u,u-=7&u,r.mode=27;break}for(;u<3;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}switch(r.last=1&c,u-=1,3&(c>>>=1)){case 0:r.mode=14;break;case 1:if(ty(r),r.mode=20,t===to){c>>>=2,u-=2;break n}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}c>>>=2,u-=2;break;case 14:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&c,c=0,u=0,r.mode=15,t===to)break n;case 15:r.mode=16;case 16:if(h=r.length){if(h>s&&(h=s),h>l&&(h=l),0===h)break n;o.set(n.subarray(i,i+h),a),s-=h,i+=h,l-=h,a+=h,r.length-=h;break}r.mode=12;break;case 17:for(;u<14;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}if(r.nlen=(31&c)+257,c>>>=5,u-=5,r.ndist=(31&c)+1,c>>>=5,u-=5,r.ncode=(15&c)+4,c>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;u<3;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}r.lens[T[r.have++]]=7&c,c>>>=3,u-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,k={bits:r.lenbits},I=tt(0,r.lens,0,19,r.lencode,0,r.work,k),r.lenbits=k.bits,I){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;g=(_=r.lencode[c&(1<<r.lenbits)-1])>>>24,v=_>>>16&255,b=65535&_,!(g<=u);){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}if(b<16)c>>>=g,u-=g,r.lens[r.have++]=b;else{if(16===b){for(E=g+2;u<E;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}if(c>>>=g,u-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}C=r.lens[r.have-1],h=3+(3&c),c>>>=2,u-=2}else if(17===b){for(E=g+3;u<E;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}c>>>=g,u-=g,C=0,h=3+(7&c),c>>>=3,u-=3}else{for(E=g+7;u<E;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}c>>>=g,u-=g,C=0,h=11+(127&c),c>>>=7,u-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;h--;)r.lens[r.have++]=C}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,k={bits:r.lenbits},I=tt(1,r.lens,0,r.nlen,r.lencode,0,r.work,k),r.lenbits=k.bits,I){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,k={bits:r.distbits},I=tt(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,k),r.distbits=k.bits,I){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,t===to)break n;case 20:r.mode=21;case 21:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=c,r.bits=u,e4(e,f),a=e.next_out,o=e.output,l=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,c=r.hold,u=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;g=(_=r.lencode[c&(1<<r.lenbits)-1])>>>24,v=_>>>16&255,b=65535&_,!(g<=u);){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}if(v&&(240&v)==0){for(y=g,w=v,S=b;g=(_=r.lencode[S+((c&(1<<y+w)-1)>>y)])>>>24,v=_>>>16&255,b=65535&_,!(y+g<=u);){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}c>>>=y,u-=y,r.back+=y}if(c>>>=g,u-=g,r.back+=g,r.length=b,0===v){r.mode=26;break}if(32&v){r.back=-1,r.mode=12;break}if(64&v){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&v,r.mode=22;case 22:if(r.extra){for(E=r.extra;u<E;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;g=(_=r.distcode[c&(1<<r.distbits)-1])>>>24,v=_>>>16&255,b=65535&_,!(g<=u);){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}if((240&v)==0){for(y=g,w=v,S=b;g=(_=r.distcode[S+((c&(1<<y+w)-1)>>y)])>>>24,v=_>>>16&255,b=65535&_,!(y+g<=u);){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}c>>>=y,u-=y,r.back+=y}if(c>>>=g,u-=g,r.back+=g,64&v){e.msg="invalid distance code",r.mode=30;break}r.offset=b,r.extra=15&v,r.mode=24;case 24:if(r.extra){for(E=r.extra;u<E;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===l)break n;if(h=f-l,r.offset>h){if((h=r.offset-h)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}h>r.wnext?(h-=r.wnext,p=r.wsize-h):p=r.wnext-h,h>r.length&&(h=r.length),m=r.window}else m=o,p=a-r.offset,h=r.length;h>l&&(h=l),l-=h,r.length-=h;do o[a++]=m[p++];while(--h)0===r.length&&(r.mode=21);break;case 26:if(0===l)break n;o[a++]=r.length,l--,r.mode=21;break;case 27:if(r.wrap){for(;u<32;){if(0===s)break n;s--,c|=n[i++]<<u,u+=8}if(f-=l,e.total_out+=f,r.total+=f,f&&(e.adler=r.check=r.flags?G(r.check,o,f,a-f):W(r.check,o,f,a-f)),f=l,(r.flags?c:th(c))!==r.check){e.msg="incorrect data check",r.mode=30;break}c=0,u=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;u<32;){if(0===s)break n;s--,c+=n[i++]<<u,u+=8}if(c!==(0xffffffff&r.total)){e.msg="incorrect length check",r.mode=30;break}c=0,u=0}r.mode=29;case 29:I=ta;break n;case 30:I=tc;break n;case 31:return tu;default:return tl}return e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=c,r.bits=u,(r.wsize||f!==e.avail_out&&r.mode<30&&(r.mode<27||t!==tr))&&tw(e,e.output,e.next_out,f-e.avail_out),d-=e.avail_in,f-=e.avail_out,e.total_in+=d,e.total_out+=f,r.total+=f,r.wrap&&f&&(e.adler=r.check=r.flags?G(r.check,o,f,e.next_out-f):W(r.check,o,f,e.next_out-f)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===d&&0===f||t===tr)&&I===ti&&(I=td),I},inflateEnd:e=>{if(!e||!e.state)return tl;let t=e.state;return t.window&&(t.window=null),e.state=null,ti},inflateGetHeader:(e,t)=>{if(!e||!e.state)return tl;let r=e.state;return(2&r.wrap)==0?tl:(r.head=t,t.done=!1,ti)},inflateSetDictionary:(e,t)=>{let r;let n=t.length;return e&&e.state&&(0===(r=e.state).wrap||11===r.mode)?11===r.mode&&W(1,t,n,0)!==r.check?tc:tw(e,t,n,n)?(r.mode=31,tu):(r.havedict=1,ti):tl}},tC=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};let tI=Object.prototype.toString,{Z_NO_FLUSH:tk,Z_FINISH:tE,Z_OK:t_,Z_STREAM_END:tA,Z_NEED_DICT:tT,Z_STREAM_ERROR:tP,Z_DATA_ERROR:tO,Z_MEM_ERROR:tR}=X;function tx(e){this.options=eq.assign({chunkSize:65536,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits)==0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new eG,this.strm.avail_out=0;let r=tS.inflateInit2(this.strm,t.windowBits);if(r!==t_||(this.header=new tC,tS.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=eV.string2buf(t.dictionary):"[object ArrayBuffer]"===tI.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=tS.inflateSetDictionary(this.strm,t.dictionary))!==t_)))throw Error(K[r])}function tM(e,t){let r=new tx(t);if(r.push(e),r.err)throw r.msg||K[r.err];return r.result}tx.prototype.push=function(e,t){let r,n,o;let i=this.strm,a=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(n=t===~~t?t:!0===t?tE:tk,"[object ArrayBuffer]"===tI.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),(r=tS.inflate(i,n))===tT&&s&&((r=tS.inflateSetDictionary(i,s))===t_?r=tS.inflate(i,n):r===tO&&(r=tT));i.avail_in>0&&r===tA&&i.state.wrap>0&&0!==e[i.next_in];)tS.inflateReset(i),r=tS.inflate(i,n);switch(r){case tP:case tO:case tT:case tR:return this.onEnd(r),this.ended=!0,!1}if(o=i.avail_out,i.next_out&&(0===i.avail_out||r===tA)){if("string"===this.options.to){let e=eV.utf8border(i.output,i.next_out),t=i.next_out-e,r=eV.buf2string(i.output,e);i.next_out=t,i.avail_out=a-t,t&&i.output.set(i.output.subarray(e,e+t),0),this.onData(r)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out))}if(r!==t_||0!==o){if(r===tA)return r=tS.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},tx.prototype.onData=function(e){this.chunks.push(e)},tx.prototype.onEnd=function(e){e===t_&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=eq.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};let{Deflate:tN,deflate:tF,deflateRaw:tL,gzip:tz}={Deflate:e5,deflate:e6,deflateRaw:function(e,t){return(t=t||{}).raw=!0,e6(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,e6(e,t)},constants:X},{Inflate:tD,inflate:tB,inflateRaw:tU,ungzip:tH}={Inflate:tx,inflate:tM,inflateRaw:function(e,t){return(t=t||{}).raw=!0,tM(e,t)},ungzip:tM,constants:X},tq={Deflate:tN,deflate:tF,deflateRaw:tL,gzip:tz,Inflate:tD,inflate:tB,inflateRaw:tU,ungzip:tH,constants:X}},856911:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>N,__assign:()=>i,__asyncDelegator:()=>E,__asyncGenerator:()=>k,__asyncValues:()=>_,__await:()=>I,__awaiter:()=>p,__classPrivateFieldGet:()=>R,__classPrivateFieldIn:()=>M,__classPrivateFieldSet:()=>x,__createBinding:()=>g,__decorate:()=>s,__disposeResources:()=>L,__esDecorate:()=>c,__exportStar:()=>v,__extends:()=>o,__generator:()=>m,__importDefault:()=>O,__importStar:()=>P,__makeTemplateObject:()=>A,__metadata:()=>h,__param:()=>l,__propKey:()=>d,__read:()=>y,__rest:()=>a,__runInitializers:()=>u,__setFunctionName:()=>f,__spread:()=>w,__spreadArray:()=>C,__spreadArrays:()=>S,__values:()=>b,default:()=>z});var n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)0>t.indexOf(n[o])&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function s(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function l(e,t){return function(r,n){t(r,n,e)}}function c(e,t,r,n,o,i){function a(e){if(void 0!==e&&"function"!=typeof e)throw TypeError("Function expected");return e}for(var s,l=n.kind,c="getter"===l?"get":"setter"===l?"set":"value",u=!t&&e?n.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),f=!1,h=r.length-1;h>=0;h--){var p={};for(var m in n)p[m]="access"===m?{}:n[m];for(var m in n.access)p.access[m]=n.access[m];p.addInitializer=function(e){if(f)throw TypeError("Cannot add initializers after decoration has completed");i.push(a(e||null))};var g=(0,r[h])("accessor"===l?{get:d.get,set:d.set}:d[c],p);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw TypeError("Object expected");(s=a(g.get))&&(d.get=s),(s=a(g.set))&&(d.set=s),(s=a(g.init))&&o.unshift(s)}else(s=a(g))&&("field"===l?o.unshift(s):d[c]=s)}u&&Object.defineProperty(u,n.name,d),f=!0}function u(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function f(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function h(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})}function m(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}var g=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function v(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function S(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),o=0,t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}function C(e,t,r){if(r||2==arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function I(e){return this instanceof I?(this.v=e,this):new I(e)}function k(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),n[Symbol.asyncIterator]=function(){return this},n;function a(e,t){o[e]&&(n[e]=function(t){return new Promise(function(r,n){i.push([e,t,r,n])>1||s(e,t)})},t&&(n[e]=t(n[e])))}function s(e,t){try{var r;(r=o[e](t)).value instanceof I?Promise.resolve(r.value.v).then(l,c):u(i[0][2],r)}catch(e){u(i[0][3],e)}}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function E(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:I(e[n](t)),done:!1}:o?o(t):t}:o}}function _(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}}function A(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var T=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return T(t,e),t}function O(e){return e&&e.__esModule?e:{default:e}}function R(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!o)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function N(e,t,r){if(null!=t){var n,o;if("object"!=typeof t&&"function"!=typeof t)throw TypeError("Object expected.");if(r){if(!Symbol.asyncDispose)throw TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(o=n)}if("function"!=typeof n)throw TypeError("Object not disposable.");o&&(n=function(){try{o.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var F="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function L(e){function t(t){e.error=e.hasError?new F(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,n=0;return function o(){for(;r=e.stack.pop();)try{if(!r.async&&1===n)return n=0,e.stack.push(r),Promise.resolve().then(o);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(i).then(o,function(e){return t(e),o()})}else n|=1}catch(e){t(e)}if(1===n)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}let z={__extends:o,__assign:i,__rest:a,__decorate:s,__param:l,__metadata:h,__awaiter:p,__generator:m,__createBinding:g,__exportStar:v,__values:b,__read:y,__spread:w,__spreadArrays:S,__spreadArray:C,__await:I,__asyncGenerator:k,__asyncDelegator:E,__asyncValues:_,__makeTemplateObject:A,__importStar:P,__importDefault:O,__classPrivateFieldGet:R,__classPrivateFieldSet:x,__classPrivateFieldIn:M,__addDisposableResource:N,__disposeResources:L}},87837:e=>{"use strict";e.exports={rE:"6.0.42"}},714915:e=>{"use strict";e.exports={rE:"26.0.42"}}},e=>{var t=e(e.s=121562);(self.Owa=self.Owa||{}).semanticoverviewindex=t}]),self.scriptsLoaded=self.scriptsLoaded||{},self.scriptsLoaded["owa.semanticoverviewindex.0f2cda59.js"]=1;