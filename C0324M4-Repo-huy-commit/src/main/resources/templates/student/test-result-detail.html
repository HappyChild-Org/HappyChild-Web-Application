<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Chi tiết kết quả bài kiểm tra</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h2>Chi tiết kết quả bài kiểm tra</h2>
        
        <!-- Thông tin bài kiểm tra -->
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title" th:text="${result.test.testName}">Tên bài kiểm tra</h5>
                <p class="card-text">
                    Điểm: <span th:text="${result.totalScore}">0</span>
                </p>
                <p class="card-text">
                    Ngày hoàn thành: <span th:text="${#temporals.format(result.completedAt, 'dd/MM/yyyy HH:mm')}">Ngày</span>
                </p>
                <p class="card-text">
                    Trạng thái: <span th:text="${result.status}">Trạng thái</span>
                </p>
            </div>
        </div>

        <!-- Lời nhận xét của giáo viên -->
        <div class="card mb-4">
            <div class="card-header">
                <h4>Lời nhận xét của giáo viên</h4>
            </div>
            <div class="card-body">
                <div th:if="${result.teacherNotes != null and !result.teacherNotes.isEmpty()}">
                    <p th:text="${result.teacherNotes}"></p>
                    <small class="text-muted">
                        Đánh giá bởi: <span th:text="${result.reviewedBy.name}"></span>
                        vào ngày: <span th:text="${#temporals.format(result.reviewedAt, 'dd/MM/yyyy HH:mm')}"></span>
                    </small>
                </div>
                <div th:if="${result.teacherNotes == null or result.teacherNotes.isEmpty()}">
                    <p class="text-muted">Chưa có lời nhận xét từ giáo viên</p>
                </div>
            </div>
        </div>

        <!-- Câu trả lời theo danh mục -->
        <div th:each="category : ${answersByCategory}" class="card mb-4">
            <div class="card-header">
                <h4 th:text="${category.key}">Tên danh mục</h4>
            </div>
            <div class="card-body">
                <div th:each="answer : ${category.value}" class="mb-3">
                    <p th:text="${answer.question.question}">Câu hỏi</p>
                    <p>
                        Câu trả lời: <span th:text="${answer.answerValue}">Trả lời</span>
                    </p>
                </div>
            </div>
        </div>

        <a th:href="@{/autism-test/results}" class="btn btn-secondary">Quay lại danh sách kết quả</a>
    </div>
</body>
</html>