var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_themeplus_start"),(self["suiteux_shell_webpackJsonp_suiteux-bootstrapper"]=self["suiteux_shell_webpackJsonp_suiteux-bootstrapper"]||[]).push([["themeplus"],{6e3:function(e,t,r){r.r(t),r.d(t,{applySearchStyles:function(){return u},getAllThemes:function(){return o},getUserThemeByID:function(){return i},loadAllTheme:function(){return c},saveDarkModePreference:function(){return m},setModeLogo:function(){return h}});var n=r(391),s=r(6968),a=r(5795),l=r(3317);function o(e,t){(0,s.NP)().subscribe("StringsLoaded",(r=>{c().then((n=>{let o=(0,s.Vz)().getThemeState(),u=(0,l.cv)(n,o.currentThemeId===a.Fx?a.Mm:o.currentThemeId,o.preferOfficeTheme,o.userPersonalizationAllowed).map((e=>{let n=(0,l.jI)(e,r,o,null!=t?t:o.appTheme);return null!=t?"unicorn"===e.Id?(n.BackgroundImageRepeat=!1,n.DarkTheme&&(n.DarkTheme.BackgroundImageRepeat=!1),n):(n.BackgroundImageRepeat=!0,n.DarkTheme&&(n.DarkTheme.BackgroundImageRepeat=!0),n):n}));if(null!=t){let e,n,s;u.forEach(((t,r)=>{t.Id===a.Fx?e=r:t.Id===a.Mm?n=r:t.Id===a.ux&&(s=r)}));let l=t.DarkTheme;l.BadgeText="#212121";let m=t;m.BadgeText="#FFFFFF";let h=function(e){var t;u[e]=Object.assign(Object.assign({Id:a.Fx,Order:20,Name:null!==(t=r.NeutralTheme)&&void 0!==t?t:"Neutral theme"},m),{DarkTheme:l,ThemeType:"App"})};e>0?(h(n),u.splice(e,1)):0===e?(h(e),u.splice(n,1)):h(n),n&&!o.shellThemeData.HasTenantBranding?u.splice(s,1):o.shellThemeData.HasTenantBranding||h(s)}e(u)}))}),!0)}function u(e){let t=(0,s.Vz)().getThemeState();t.currentThemeId===a.ux&&!t.preferOfficeTheme||((0,s.NP)().invoke(e?"EnterSearchMode":"ExitSearchMode"),(0,s.Vz)().updateThemeCss(e))}function m(){(0,s.NP)().subscribe("SuiteAPILoaded",(()=>{(function(){let e=(0,s.Vz)().getThemeState();return e.userThemesHandler&&null!=e.isDarkMode?e.userThemesHandler.SaveDarkTheme(e.isDarkMode):Promise.reject(new Error("No UserThemeSettingsHandler provided"))})().catch((e=>(0,s.tZ)().exception("UserThemesManager_SaveDarkModeThemeFailure",6,e,[(0,s.Vz)().getThemeState().isDarkMode])))}),!0)}function h(e){(0,s.NP)().subscribe("SuiteAPILoaded",(()=>{(function(e){let t=(0,s.Vz)().getThemeState();return t.userThemesHandler&&null!=e?t.userThemesHandler.GetModeLogo(e):Promise.reject(new Error("No UserThemeSettingsHandler provided"))})(e).then((e=>(0,s.Vz)().setThemeOverrides({tenantLogoValue:e}))).catch((e=>(0,s.tZ)().exception("ThemeSettings_setModeLogo: error in GET API ",6,e,[(0,s.Vz)().getThemeState().isDarkMode])))}),!0)}function i(e){let t=(0,s.Vz)().getThemeState();return new Promise(((r,n)=>{let o=function(e){let n=null;if(e){let r=(0,s.Vz)().getAppTheme();n=(0,l.jI)(e,{},t,r)}r(n)};e&&""!==e?(e=e.toLowerCase(),t.userThemes[e]&&t.userThemes[e].Name?o(t.userThemes[e]):e===a.Mm?o({Id:a.Mm,Order:20}):c().then((n=>{t=(0,s.Vz)().getThemeState(),t.userThemes[e]?o(t.userThemes[e]):r(null)})).catch((()=>{n(null)}))):n(null)}))}function c(){let e=(0,s.Vz)().getThemeState(),t=(0,s.Vz)().getLoadUserThemesDataJsonUrl();return new Promise(((r,a)=>{t?(0,n.F)(t,(t=>{(0,l.m3)(t);const n=Object.keys(e.userThemes).map((t=>e.userThemes[t]));r(n)}),(e=>{const r=new Error(e.Details.toString());(0,s.tZ)().exception("UserThemesManager_LoadUserThemesJsonFailure",6,r,t),a(r)})):a()}))}}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_themeplus_end"),shellPerformance.measure("shell_themeplus","shell_themeplus_start","shell_themeplus_end"));