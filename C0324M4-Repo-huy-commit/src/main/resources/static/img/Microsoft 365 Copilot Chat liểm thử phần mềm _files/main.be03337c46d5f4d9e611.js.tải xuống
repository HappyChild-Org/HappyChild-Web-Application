"use strict";(self.webpackChunkstandalone_copilot=self.webpackChunkstandalone_copilot||[]).push([[8792],{26233:(e,o,t)=>{var n=t(36870);!function(){var e=document.currentScript;if(e){var o=e.src;!function(e){t.p=e}(o.substring(0,o.lastIndexOf("/")+1))}}();var r=t(52304),i=t(90323),a=t(54154),l=t(40487),c=t(28203),s=t(73577),u=t(85582),d=t(58684),f=t(71884),v=t(79009),h=t(86326),p=t(35623),w=t(70489),m=t(6480);function g(e,o){return o&&o.message?e+": "+o.message:e}var b=function(e){return function(e,o,t,n){return new(t||(t=Promise))((function(e,o){function r(e){try{a(n.next(e))}catch(e){o(e)}}function i(e){try{a(n.throw(e))}catch(e){o(e)}}function a(o){o.done?e(o.value):function(e){return e instanceof t?e:new t((function(o){o(e)}))}(o.value).then(r,i)}a((n=n.apply(undefined,[])).next())}))}(0,0,void 0,(function(){return function(e,o){var t,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=o.call(e,a)}catch(e){i=[6,e],n=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}(this,(function(e){return[2]}))}))},y=function(){return y=Object.assign||function(e){for(var o,t=1,n=arguments.length;t<n;t++)for(var r in o=arguments[t])Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);return e},y.apply(this,arguments)};(0,f.xH)();var k=function(){var e,o,t,r=(0,i.w)().data,l=null===(o=null===(e=null==r?void 0:r.result)||void 0===e?void 0:e.serviceWorkerSaCopilotGates)||void 0===o?void 0:o.serviceWorkerSaCopilotEnabled,c=(0,a.T)(),f=null===(t=null==c?void 0:c.data)||void 0===t?void 0:t.result,v=null==f?void 0:f.serviceWorker;return(0,h.useEffect)((function(){var e,o,t,n,i,a,c,d,f,h;if(v){var p=v.fileLimit,w=void 0===p?100:p,m=v.updateIntervalInMinutes,g=void 0===m?60:m,b=v.htmlCacheUpdateIntervalInMinutes,y=void 0===b?720:b,k=new URL(window.location.href).searchParams,S=k.get("flight"),C=k.get("ohomeclientversion"),R="/reactsw?workload=".concat(s.w.OfficeHomeReact).concat(S?"&flight=".concat(S):"").concat(C?"&ohomeclientversion=".concat(C):"");!0===l?(0,u.Lz)({swUrl:R,shouldScheduleUpdates:!1,updateInterval:60*Number(g)*1e3,fileLimit:Number(w),periodicRefreshEnabled:null!==(t=null===(o=null===(e=null==r?void 0:r.result)||void 0===e?void 0:e.swPeriodicRefreshGates)||void 0===o?void 0:o.swPeriodicRefreshEnabled)&&void 0!==t&&t,periodicRefreshAllCacheKeys:null!==(a=null===(i=null===(n=null==r?void 0:r.result)||void 0===n?void 0:n.swPeriodicRefreshGates)||void 0===i?void 0:i.swPeriodicRefreshAllCacheKeys)&&void 0!==a&&a,periodicRefreshDeleteCacheKeys:null!==(f=null===(d=null===(c=null==r?void 0:r.result)||void 0===c?void 0:c.swPeriodicRefreshGates)||void 0===d?void 0:d.swPeriodicRefreshDeleteCacheKeys)&&void 0!==f&&f,htmlCacheUpdateInterval:60*Number(y)*1e3}):(null===(h=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===h?void 0:h.controller)&&(0,u.lK)()}}),[l,v,r]),l?(0,n.jsx)(d.A,{}):null},S=function(e){var o,t,i,a,u;if(!e){var d=!!(null===(o=new URLSearchParams(window.location.search).get("flight"))||void 0===o?void 0:o.toLowerCase().split(",").includes("disablelegacynetworkconfigs"));e={buildDateUtc:(new Date).toISOString(),buildVersion:"1.0",cdnDomain:"res-1-sdf.cdn.office.net/officehub",correlationId:(0,l.g)(),deploymentEnvironment:"Dev",disableLegacyNetworkConfigs:d,domainOrigin:"Microsoft365",geoName:"wus",inMockMode:!0,isCorpNet:!1,mockReactShell:!0,officeHomeApiRoot:"http://localhost:".concat("3001","/mock"),officeMarketLcid:1033,officeStartManifestVersion:"7834100",preferredCulture:"en-US",requestOrigin:"Direct",sessionId:"00000000-0000-0000-0000-000000000000",stringsContainerName:"officestartstrings",useLocalFiles:!0,testTraffic:!1,appSwitchUrl:"",appSwitchToUrl:"",thirdPartyNoticeUrl:"",logoutUrl:""}}var f=y(y({},e),{sourceRepo:"office-start",sourceApp:"standalone-copilot"}),b=null===window||void 0===window?void 0:window.Windows;!f.wrapperVersion&&b&&(f=y(y({},f),{wrapperVersion:null===(u=null===(a=null===(i=null===(t=null==b?void 0:b.ApplicationModel)||void 0===t?void 0:t.Package)||void 0===i?void 0:i.current)||void 0===a?void 0:a.id)||void 0===u?void 0:u.version}));var S={aadAppId:"4345a7b9-9a63-4910-a426-35363201d503",workload:s.w.OfficeHomeReact,defaultLinkTarget:"_blank",jwtAuthEnabled:!1};p.render((0,n.jsx)(n.Fragment,{children:(0,n.jsx)(h.StrictMode,{children:(0,n.jsx)(r.t,{children:(0,n.jsxs)(c.m,y({workload:S.workload,isStandaloneCopilot:!0},{children:[(0,n.jsx)(v.V,{props:f,commonContext:S}),(0,n.jsx)(k,{})]}))})})}),document.getElementById("root")),function(e){try{!function(e){if(e&&history&&history.replaceState){var o=history.state||{};history.replaceState(o,"",e+window.location.hash)}}(e)}catch(e){(0,w.l)({eventName:"ReactOhome_PathAndQuery_Set_Error",message:g("Caught exception while updating path and query string",e),errorClassification:m.J.FeatureUnusable,isCustomerImpacting:!0})}}(f.browserPathAndQueryString||"")};Object.defineProperty(window,"ReactOhomeShim",{get:function(){return{renderReactOhome:S,loadShellBootstrapper:b}}})}},e=>{e.O(0,[7270,997,8224,8145,7845,4772,9765,489,9936],(()=>(()=>e(e.s=26233))())),e.O()}]);
//# sourceMappingURL=main.be03337c46d5f4d9e611.js.map