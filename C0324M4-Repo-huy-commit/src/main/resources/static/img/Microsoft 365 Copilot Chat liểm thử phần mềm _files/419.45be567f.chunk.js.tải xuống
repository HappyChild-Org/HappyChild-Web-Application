/*! For license information please see 419.45be567f.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[419],{35430:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(15662),o=n(15840),a=n(17191),c=n(21727),i=n(19299),u=()=>{var e=Object(a.useEnvironmentId)(),t=Object(o.i)(),{search:n}=Object(o.j)(),{setIsVisible:u}=Object(c.q)(),s=Object(i.useRefFrom)(e),l=Object(i.useRefFrom)(n);return Object(r.useCallback)(e=>{var n,r=null!==(n=null==e?void 0:e(l.current))&&void 0!==n?n:l.current;t.replace({pathname:a.GenerateRoutes.embedded.authoring.new({environmentId:s.current}),search:"?".concat(r.toString()),key:"".concat(Date.now())}),u(!1)},[s,t,l,u])}},35431:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(15840),o=n(21557),a=n(16998),c=n(17191),i=n(23256),u=()=>{var e=Object(r.i)(),{search:t}=Object(r.j)(),n=Object(c.useEnvironmentId)();Object(o.a)(()=>{Object(i.l)(()=>{e.replace({pathname:c.GenerateRoutes.embedded.preload({environmentId:n}),search:t})})}),Object(a.a)(()=>{Object(i.s)()})}},35433:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(17615),o=n(21727),a=(e,t)=>{try{r.a.sendCustomMessage(e,[t])}catch(n){o.i.trackEvent("SendTeamsCustomMessage",{message:e,error:n}),console.error("Error sending the custom message from TeamsMessageService",n)}}},35434:function(e,t,n){"use strict";n.r(t),n.d(t,"EmbeddedAuthoring",(function(){return u}));var r=n(15662),o=n.n(r),a=n(23255),c=n(35435),i=n(35437),u=()=>Object(a.a)()?o.a.createElement(i.a,null):o.a.createElement(c.a,null)},35435:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(15662),o=n.n(r),a=n(21727),c=n(35436),i=()=>{var e=Object(c.a)();return o.a.createElement(a.c,e)}},35436:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(15662),o=n(15840),a=n(21557),c=n(16998),i=n(17387),u=n(17997),s=n(16567),l=n(15665),b=n(17191),d=n(21727),O=n(16029),v=n(19299),j=n(23256),m=n(35430),p=n(35431);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t,n,r,o,a,c){try{var i=e[a](c),u=i.value}catch(s){return void n(s)}i.done?t(u):Promise.resolve(u).then(r,o)}var{region:w}=Object(l.i)(),I=e=>{var t=new URLSearchParams(e);return t.delete("authoringPivot"),t.toString()},y=e=>{var t=Object(b.useEnvironmentId)(),n=Object(o.i)(),l=Object(b.useTenantId)(),{search:g}=Object(o.j)(),{copilotExtensionId:f}=Object(o.k)(),{enableEnvironmentRouting:y}=Object(d.o)(),[C,k]=Object(b.useQueryParamState)("authoringPivot","describe"),P=Object(v.useRefFrom)(t),R=Object(r.useRef)("new"===f),S=Object(v.useRefFrom)(g),x=Object(b.getClusterCategoryByRegion)(u.b[w]),A=Object(v.useRefFrom)(e),T=Object(m.a)(),G=Object(r.useCallback)(e=>{n.replace({pathname:b.GenerateRoutes.embedded.authoring.details({environmentId:P.current,copilotExtensionId:e}),search:S.current})},[P,n,S]),D=Object(r.useCallback)(()=>{Object(j.c)(),d.i.trackEvent("AgentBuilderClosed"),T(I)},[T]),L=Object(r.useCallback)(j.a,[]),F=Object(r.useCallback)(()=>{n.push({pathname:b.GenerateRoutes.embedded.authoring.base({environmentId:y?b.personalEnvironmentId:i.k}),search:S.current})},[y,n,S]),M=Object(r.useCallback)((e,t,r)=>{var o,a=new URLSearchParams(S.current);a.set("authoringPivot","configure"),a.set("isOwner",null!==(o=null==r?void 0:r.toString())&&void 0!==o?o:"false"),n.push({pathname:b.GenerateRoutes.embedded.authoring.details({copilotExtensionId:t,environmentId:e}),search:"?".concat(a.toString())})},[n,S]),U=Object(r.useCallback)(function(){var e,t=(e=function*(e){var{accessToken:t}=yield Object(s.f)(e);return t},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){E(a,r,o,c,i,"next",e)}function i(e){E(a,r,o,c,i,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}(),[]),B=Object(r.useCallback)(e=>{Object(j.f)(e),T()},[T]),N=Object(r.useCallback)(e=>{var t=new URLSearchParams(S.current);t.set("theme",e),n.replace({search:t.toString()})},[n,S]),z=Object(d.s)();return Object(p.a)(),Object(r.useEffect)(()=>{"string"==typeof f&&Boolean(f.trim())&&Object(O.t)(f)&&![d.k,d.n].includes(f)&&Object(j.b)(f)},[f]),Object(a.a)(()=>{d.i.trackEvent("EmbeddedCreateExtensionPageLoad",h(h({},z),{},{tenantId:l})),Object(j.p)(e=>{N(e)}),Object(j.n)(e=>{var t,r;("true"===e.toLowerCase()&&n.replace({pathname:b.GenerateRoutes.embedded.authoring.base({environmentId:P.current}),search:S.current,key:"".concat(Date.now())}),null!=A&&null!==(t=A.current)&&void 0!==t&&t.onRenderExtensionsList)&&(null==A||null===(r=A.current)||void 0===r||r.onRenderExtensionsList(e))}),Object(j.k)(e=>{var t,n,{agentId:r,environmentId:o,isOwner:a}=e,c=null!=o?o:P.current;r?(M(c,r,a),null!=A&&null!==(t=A.current)&&void 0!==t&&t.onEditAgentId&&(null==A||null===(n=A.current)||void 0===n||n.onEditAgentId(r))):d.i.trackException("EmbeddedAuthoringRpcEventWithoutAgentId","EditAgentIdEvent",{agentId:r,environmentId:o,isOwner:a})}),Object(j.o)(e=>{var t,{agentId:r,environmentId:o,isOwner:a}=e;if(r){var c,i=new URLSearchParams(S.current);if(i.set("isOwner",a.toString()),n.replace({pathname:b.GenerateRoutes.embedded.share({copilotExtensionId:r,environmentId:null!=o?o:P.current}),search:i.toString(),key:"".concat(Date.now())}),null!=A&&null!==(t=A.current)&&void 0!==t&&t.onShareAgentToggle)null==A||null===(c=A.current)||void 0===c||c.onShareAgentToggle(e)}else d.i.trackException("EmbeddedAuthoringRpcEventWithoutAgentId","ShareAgentToggleEvent",{agentId:r,environmentId:o,isOwner:a})}),Object(j.j)()}),Object(c.a)(()=>{Object(j.w)(),Object(j.u)(),Object(j.r)(),Object(j.v)()}),Object(r.useMemo)(()=>({authoringPivot:Object(d.m)(C)?C:"describe",copilotExtensionId:f,environmentId:P.current,isNewAgent:R.current,mode:"embedded",onChangeAuthoringPivot:k,onCopilotCreated:G,onDismiss:D,onEmbeddedExperienceReload:L,onGetTokenAsync:U,onGoToCopilotExtension:B,onOpenCopilotExtensions:F,onOpenExtension:M,onThemeChange:N,realm:x,tenantId:l}),[C,f,P,G,D,L,U,B,F,M,N,x,k,l])}},35437:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(15662),o=n.n(r),a=n(21557),c=n(17615),i=n(21727),u=n(35433),s=n(35436);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var b=()=>{var e=Object(s.a)();Object(a.a)(()=>{c.a.app.isInitialized()&&c.a.app.registerOnThemeChangeHandler(t=>{e.onThemeChange(t)})});var t=Object(r.useCallback)(e=>{u.a("GotoCopilotExtension",e)},[]),n=Object(r.useCallback)(()=>{c.a.app.isInitialized()&&c.a.pages.tabs.navigateToTab({tabName:"myAgents"}),e.onOpenCopilotExtensions()},[e]);return o.a.createElement(i.c,l({},e,{onGoToCopilotExtension:t,onOpenCopilotExtensions:n}))}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/419.45be567f.chunk.js.map